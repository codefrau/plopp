!function(){"use strict";if(self.Squeak||(self.Squeak={}),!Squeak.Settings){var settings;try{if(settings=self.localStorage,settings["squeak-foo:"]="bar","bar"!==settings["squeak-foo:"])throw Error();delete settings["squeak-foo:"]}catch(e){settings={}}Squeak.Settings=settings}function RS(e,t){return 31<t?0:e<<t}function SS(e,t){return 31<t?0:e>>>t}function $S(){return YS}function _S(e,t){var r,i,a;for((i=t-e)<0&&(i=0-i),r=63,a=1;a<=62;a++)63===r&&ZS[a-1]>=i&&(r=a);return r}function aT(e){var t,r,i;for(r=0,t=e;;){if(!(0<(i=t-TS)))return r+=SS(VS,0-i),VS&=SS(255,8-(TS-=t)),r;r+=RS(VS,i),t-=TS,VS=WS[++US-1],TS=8}}function bT(e,t){var r,i,a,s;for(i=t,a=e;;){if(!((s=(r=8-TS)-a)<0))return VS+=RS(i,s),TS+=a,self;VS+=SS(i,0-s),WS[++US-1]=VS,i&=RS(1,(VS=TS=0)-s)-1,a-=r}}function cT(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b;if(e=XS.stackValue(1),t=XS.stackIntegerValue(0),d=XS.fetchIntegerofObject(0,e),f=XS.fetchIntegerofObject(1,e),u=XS.fetchIntegerofObject(2,e),c=XS.fetchIntegerofObject(3,e),l=XS.fetchIntegerofObject(4,e),h=XS.fetchIntegerofObject(5,e),VS=XS.fetchIntegerofObject(6,e),TS=XS.fetchIntegerofObject(7,e),US=XS.fetchIntegerofObject(8,e),WS=XS.fetchBytesofObject(9,e),b=XS.fetchInt16ArrayofObject(10,e),m=XS.fetchIntegerofObject(12,e),o=XS.fetchIntegerofObject(13,e),ZS=XS.fetchInt16ArrayofObject(14,e),p=XS.fetchInt16ArrayofObject(15,e),XS.failed())return null;for(a=1;a<=t;a++)if(1==(a&h))32767<(d=aT(16))&&(d-=65536),f=aT(6),b[++m-1]=d;else{for(i=aT(o),n=ZS[f],s=0,r=l;0<r;)0<(i&r)&&(s+=n),n>>>=1,r>>>=1;s+=n,0<(i&u)?d-=s:d+=s,32767<d?d=32767:d<-32768&&(d=-32768),(f+=p[i&c])<0?f=0:88<f&&(f=88),b[++m-1]=d}if(XS.failed())return null;XS.storeIntegerofObjectwithValue(0,e,d),XS.storeIntegerofObjectwithValue(1,e,f),XS.storeIntegerofObjectwithValue(6,e,VS),XS.storeIntegerofObjectwithValue(7,e,TS),XS.storeIntegerofObjectwithValue(8,e,US),XS.storeIntegerofObjectwithValue(12,e,m),XS.pop(1)}function dT(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O,w;if(e=XS.stackValue(1),t=XS.stackIntegerValue(0),y=XS.fetchInt16ArrayofObject(0,e),k=XS.fetchInt16ArrayofObject(1,e),m=XS.fetchIntegerofObject(2,e),v=XS.fetchIntegerofObject(3,e),b=XS.fetchIntegerofObject(4,e),g=XS.fetchIntegerofObject(5,e),VS=XS.fetchIntegerofObject(6,e),TS=XS.fetchIntegerofObject(7,e),US=XS.fetchIntegerofObject(8,e),WS=XS.fetchBytesofObject(9,e),w=XS.fetchInt16ArrayofObject(10,e),S=XS.fetchInt16ArrayofObject(11,e),O=XS.fetchIntegerofObject(12,e),d=XS.fetchIntegerofObject(13,e),ZS=XS.fetchInt16ArrayofObject(14,e),_=XS.fetchInt16ArrayofObject(15,e),XS.failed())return null;for(c=y[0],h=y[1],n=k[0],o=k[1],s=1;s<=t;s++)if(1==(s&g))c=aT(16),n=aT(6),h=aT(16),o=aT(6),32767<c&&(c-=65536),32767<h&&(h-=65536),w[++O-1]=c,S[O-1]=h;else{for(i=aT(d),a=aT(d),f=ZS[n],p=ZS[o],u=l=0,r=b;0<r;)0<(i&r)&&(u+=f),0<(a&r)&&(l+=p),f>>>=1,p>>>=1,r>>>=1;u+=f,l+=p,0<(i&m)?c-=u:c+=u,0<(a&m)?h-=l:h+=l,32767<c?c=32767:c<-32768&&(c=-32768),32767<h?h=32767:h<-32768&&(h=-32768),(n+=_[i&v])<0?n=0:88<n&&(n=88),(o+=_[a&v])<0?o=0:88<o&&(o=88),w[++O-1]=c,S[O-1]=h}if(y[0]=c,y[1]=h,k[0]=n,k[1]=o,XS.failed())return null;XS.storeIntegerofObjectwithValue(6,e,VS),XS.storeIntegerofObjectwithValue(7,e,TS),XS.storeIntegerofObjectwithValue(8,e,US),XS.storeIntegerofObjectwithValue(12,e,O),XS.pop(1)}function eT(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g;if(e=XS.stackValue(1),t=XS.stackIntegerValue(0),b=XS.fetchIntegerofObject(0,e),d=XS.fetchIntegerofObject(1,e),h=XS.fetchIntegerofObject(2,e),f=XS.fetchIntegerofObject(4,e),p=XS.fetchIntegerofObject(5,e),VS=XS.fetchIntegerofObject(6,e),TS=XS.fetchIntegerofObject(7,e),US=XS.fetchIntegerofObject(8,e),WS=XS.fetchBytesofObject(9,e),g=XS.fetchInt16ArrayofObject(10,e),v=XS.fetchIntegerofObject(12,e),c=XS.fetchIntegerofObject(13,e),ZS=XS.fetchInt16ArrayofObject(14,e),m=XS.fetchInt16ArrayofObject(15,e),XS.failed())return null;for(l=ZS[0],s=1;s<=t;s++)if(1==(s&p))(n=b=g[++v-1])<0&&(n+=65536),bT(16,n),s<t&&(d=_S(b,g[v])),bT(6,d);else{for(u=0,(a=g[++v-1]-b)<0&&(u=h,a=0-a),o=i=0,r=f;0<r;)l<=a&&(i+=r,o+=l,a-=l),l>>>=1,r>>>=1;o+=l,0<u?b-=o:b+=o,32767<b?b=32767:b<-32768&&(b=-32768),(d+=m[i])<0?d=0:88<d&&(d=88),l=ZS[d],bT(c,u|i)}if(0<TS&&(WS[++US-1]=VS),XS.failed())return null;XS.storeIntegerofObjectwithValue(0,e,b),XS.storeIntegerofObjectwithValue(1,e,d),XS.storeIntegerofObjectwithValue(6,e,VS),XS.storeIntegerofObjectwithValue(7,e,TS),XS.storeIntegerofObjectwithValue(8,e,US),XS.storeIntegerofObjectwithValue(12,e,v),XS.pop(1)}function fT(){var e;return e=XS.stackValue(1),XS.stackIntegerValue(0),VS=XS.fetchIntegerofObject(6,e),TS=XS.fetchIntegerofObject(7,e),US=XS.fetchIntegerofObject(8,e),WS=XS.fetchIntegerofObject(9,e),ZS=XS.fetchIntegerofObject(14,e),XS.failed()?null:(success(!1),XS.failed()?null:(XS.storeIntegerofObjectwithValue(6,e,VS),XS.storeIntegerofObjectwithValue(7,e,TS),XS.storeIntegerofObjectwithValue(8,e,US),void XS.pop(1)))}function gT(e){return!1!=((XS=e).majorVersion()==PS)&&XS.minorVersion()>=QS}var PS,QS,TS,US,VS,WS,XS,YS,ZS,NU,OU,YU,ZU,$U,_U,aV,bV,cV,dV,eV,fV,gV,hV,iV,jV,kV,lV,mV,nV,oV,pV,qV,rV,sV,tV,uV,vV,wV,xV,yV,zV,AV,BV,CV,DV,EV,FV,GV,HV,IV,JV,KV,LV,MV,NV,OV,PV,QV,RV,SV,TV,UV,VV,WV,XV,YV,ZV,$V,_V,aW,bW,cW,dW,eW,fW,gW,hW,iW,jW,kW,lW,mW,nW,oW,pW,qW,rW,sW,tW,uW,vW,wW,xW,yW,zW,AW,BW,CW,DW,EW,FW,GW,HW,IW,JW,KW,LW,MW,NW,OW,PW,QW,RW,SW,TW,UW,VW,WW,XW,YW,ZW,$W,_W,aX,bX,cX,dX,eX,fX,gX,hX,iX,jX,kX,lX,mX,nX,oX,pX,qX,rX,sX,tX,uX,vX,wX,xX,yX,zX,AX,BX,CX,DX,EX,FX,GX,HX,IX,JX,KX,LX,MX,NX,OX,PX,QX,RX,SX,TX,UX,VX,WX,XX,YX,ZX,$X,_X,aY,bY,cY,dY,eY,fY,gY,hY,iY,jY,kY,lY,mY,nY,oY,pY,qY,rY,sY,tY,uY,vY,wY,xY,yY,zY,AY,BY,CY,DY,EY,FY,GY,HY,IY,JY,KY,LY,MY,NY,OY,PY,QY,RY,SY,TY,UY,VY,WY,XY,YY,ZY,$Y,_Y,aZ,bZ,cZ,dZ,eZ,fZ,gta,hta,qta,rta,sta,tta,uta,vta,wta,xta,yta,zta,Ata,Bta,Cta,Dta,Eta,Fta,Gta,Hta,Ita,Jta,Kta,Lta,Mta,Nta,Ota,Pta,Qta,Rta,Sta,Tta,Uta,Vta,Wta,Xta,Yta,Zta,$ta,_ta,aua,bua,cua,dua,eua,fua,gua,hua,iua,jua,kua,lua,mua,nua,oua,pua,qua,rua,sua,tua,uua,vua,wua,xua,yua,zua,Aua,Bua,Cua,Dua,Eua,Fua,Gua,Hua,Iua,Jua,Kua,Lua,Mua,Nua,Oua,Pua,Qua,Rua,Sua,Tua,Uua,Vua,Wua,Xua,Yua,Zua,$ua,_ua,ava,bva,cva,dva,eva,fva,gva,hva,iva,jva,kva,lva,mva,nva,ova,pva,qva,rva,sva,tva,uva,vva,wva,xva,yva,zva,GIa,HIa,LIa,MIa,NIa,OIa,PIa,QIa,RIa,SIa,TIa,UIa,VIa,WIa,WJa,XJa,ZJa,$Ja,bMa,cMa,fMa,gMa,FNa,GNa,MNa,NNa,ONa,PNa,QNa,RNa,SNa,TNa,UNa,VNa,WNa,XNa,YNa,ZNa,$Na,_Na,aOa,bOa,cOa,dOa,eOa,fOa,gOa,hOa,iOa,jOa,kOa,lOa,mOa,nOa,oOa,pOa,qOa,rOa,sOa,tOa,uOa,vOa,wOa,xOa,yOa,zOa,AOa,BOa,COa,DOa,EOa,FOa,GOa,HOa,IOa,JOa,KOa,LOa,MOa,NOa,lRa,mRa,rRa,sRa,tRa,uRa,vRa,wRa,xRa,m_a,n_a,s_a,t_a,u_a,v_a,w_a,x_a,y_a,Seb,Teb,Xeb,Yeb,Zeb,$eb,_eb,afb,bfb,cfb,dfb,efb,ffb,gfb,hfb,ifb,jfb,kfb,lfb,mfb,nfb,ofb,pfb,qfb,rfb,sfb,tfb,ufb,vfb,wfb,xfb,yfb,zfb,Afb,Bfb,Cfb,Dfb,Efb,Ffb,Gfb,Hfb,Ifb,Jfb,Kfb,Lfb,Mfb,Nfb,Ofb,Pfb,Qfb,Rfb,Sfb,Tfb,Ufb,Vfb,Wfb,Xfb,Yfb,Zfb,$fb,_fb,agb,bgb,cgb,dgb,egb,fgb,ggb,hgb,igb,jgb,kgb,lgb,mgb,ngb,ogb,pgb,qgb,rgb,sgb,tgb,ugb,vgb,wgb,xgb,ygb,zgb,Agb,Bgb,Cgb,Dgb,Egb,Fgb,Ggb,Hgb,Igb,Jgb,Kgb,Lgb,Mgb,Ngb,Ogb,xkb,ykb,Fkb,Gkb,Hkb,Ikb,Jkb,ltb,mtb,ptb,qtb,rtb,stb,ttb,utb,hvb,ivb,mvb,nvb,rxb,sxb,wxb,xxb,kIb,lIb,oIb,pIb,qIb,rIb,sIb,tIb,SKb,TKb,XKb,YKb,aMb,bMb,jMb,kMb,lMb,mMb,nMb,oMb,pMb,qMb,rMb,sMb,tMb,uMb,vMb,wMb,xMb,yMb,zMb,AMb,BMb,CMb,DMb,EMb,FMb,GMb,HMb,IMb,JMb,KMb,LMb,MMb,NMb,OMb,PMb,QMb,RMb,SMb,TMb,UMb,VMb,WMb,XMb,YMb,ZMb,$Mb,_Mb,aNb,bNb;function PU(e){return"number"==typeof e?_Y.classSmallInteger():e.sqClass}function QU(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function SU(e,t){return 0|Math.floor(e/t)}function UU(e,t){return 31<t?0:e<<t}function VU(e,t){return 31<t?0:e>>>t}function WU(e,t){return new Int32Array(e.buffer,e.byteOffset+4*t)}function XU(e,t){return new Float32Array(e.buffer,e.byteOffset+4*t)}function gZ(){return fZ[wX]}function hZ(e){return fZ[wX]=e}function iZ(){return fZ[xX]}function kZ(e,t){var r;return t<(r=e+nZ()-1&~(nZ()-1))?t:r}function mZ(e,t){return t-1&~(nZ()-1)}function nZ(){return fZ[zX]}function pZ(){return fZ[AX]}function qZ(e){return fZ[AX]=e}function rZ(){return fZ[BX]}function sZ(e){return fZ[BX]=e}function uZ(e,t){var r;return 0===e?t<0?0-t:t:0===t?e<0?0-e:e:(r=e*e+t*t)<32?[0,1,1,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6][r]:Math.sqrt(r)+.5|0}function vZ(e){HZ(1)&&($Y[x0()]=e,y0(x0()+1))}function zZ(){return fZ[CX]}function AZ(e){return fZ[CX]=e}function BZ(){return fZ[DX]}function CZ(e){return fZ[DX]=e}function DZ(e){return b2(e)}function FZ(){return a5(6),b5()}function GZ(e,t){var r,i,a,s;if(!KZ(a=xV+e))return 0;if(dZ=(i=dZ)+a,r2(i,vW),n2(i,0),p2(i,a),r=Y$(i),C0())for(s=0;s<=e-1;s++)r[s]=R4(t[s]);else for(s=0;s<=e-1;s++)r[s]=t[s];return g2(i,tV,e),i}function HZ(e){var t,r,i,a;if(DZ(e)){if(0!==BZ())for(i=BZ(),t=BZ()+e,r=1,a=BZ();r<=a;r++)QY[--t]=QY[--i];return QY=WU(QY,e),1}}function IZ(e,t,r){var i,a,s,n;if(!KZ(a=gX+t))return 0;if(dZ=(i=dZ)+a,r2(i,r?CW:BW),n2(i,0),p2(i,a),n=B0(i),C0())for(s=0;s<=t-1;s++)n[s]=R4(e[s]);else for(s=0;s<=t-1;s++)n[s]=e[s];return g2(i,eX,t),i}function KZ(e){var t,r,i,a;if(HZ(e)){if(0!==x0())for(i=x0(),t=x0()+e,r=1,a=x0();r<=a;r++)$Y[--t]=$Y[--i];return $Y=WU($Y,e),1}}function MZ(){return a5(3)}function PZ(e){return 0==(f2(e,tW)&RV)}function QZ(e,t,r){if(r<t){if(t<e)return t;if(e<r)return r}else{if(e<t)return t;if(r<e)return r}return e}function RZ(e){return f2(e,uV)}function SZ(e,t){return g2(e,uV,t)}function TZ(e){return f2(e,vV)}function UZ(e,t){return g2(e,vV,t)}function VZ(e){return f2(e,wV)}function WZ(e,t){return g2(e,wV,t)}function XZ(e){return WU(cZ,e+DV)}function ZZ(e,t){return g2(e,GV,t)}function _Z(e,t){return g2(e,HV,t)}function e$(e){return f2(e,oV)}function k$(e){return f2(e,yV)}function m$(e,t,r,i){var a,s,n,o,u,l,c,h;return s=f2(e,nV),n=f2(e,pV),32===s?0!==(h=0|t[n*i+r])&&0==(4278190080&h)&&(h|=4278190080):(h=t[n*i+VU(r,c=[0,5,4,0,3,0,0,0,2,0,0,0,0,0,0,0,1][s])],o=UU(1,s)-1,h=VU(h,c=32-s-(r&UU(1,c)-1)*s)&o,16===s?0!==h&&(a=(31&h)<<3,u=(h>>>5&31)<<3,l=(h>>>10&31)<<3,h=(a+=a>>>5)+((u+=u>>>5)<<8)+((l+=l>>>5)<<16)+(255<<24)):h=0===f2(e,tV)?0:Y$(e)[h]),X4(h)}function n$(e){return f2(e,rV)}function p$(e){return c5(b5()-e+4)}function q$(e,t){return d5(b5()-e+4,t)}function r$(e){return c5(b5()-e+5)}function s$(e,t){return d5(b5()-e+5,t)}function t$(e){return c5(b5()-e+0)}function u$(e,t){return d5(b5()-e+0,t)}function v$(e){return c5(b5()-e+1)}function w$(e,t){return d5(b5()-e+1,t)}function x$(e){return c5(b5()-e+2)}function y$(e,t){return d5(b5()-e+2,t)}function z$(e){return c5(b5()-e+3)}function A$(e,t){return d5(b5()-e+3,t)}function B$(e,t,r){var i,a,s,n,o,u;for(s=QU(e),i=e.wordsAsInt32Array(),a=n=0;a<=s-1;a++){if(o=F3(a,i),!(0<=(u=G3(a,i))&&u<=t))return;n+=o}return n===r}function F$(e,t,r,i,a,s,n){var o,u,l,c;if((u=e,l=t,_Y.isWords(u)&&((c=QU(u))===3*l||c===6*l))&&(function(e){var t,r,i;if(_Y.isWords(e)){for(i=QU(e),t=e.wordsAsInt32Array(),r=0;r<=i-1;r++)if(!V0(t[r]))return;return 1}}(n)&&B$(r,o=QU(n),t)&&B$(i,o,t)&&B$(s,o,t)&&function(e,t){var r,i,a,s;for(i=QU(e),s=e.wordsAsInt32Array(),r=a=0;r<=i-1;r++)a+=F3(r,s);return a===t}(a,t)))return 1}function H$(e){return(q2(e)&HW)===AW?function(e){var t;t=Z0(e)?v5(e):0;if(i1(e)+t<W_())return 0;if(w_(e)-t>=Q_()&&g1(e)-t>=Q_())return 0;vZ(e)}(e):(q2(e)&HW)===uW?(r=Z0(t=e)?k5(t):0,!(TZ(t)+r<W_()||w_(t)-r>=Q_()&&RZ(t)-r>=Q_())&&void vZ(t)):void vZ(e);var t,r}function J$(){return[1,.98078528040323,.923879532511287,.831469612302545,.7071067811865475,.555570233019602,.38268343236509,.1950903220161286,0,-.1950903220161283,-.3826834323650896,-.555570233019602,-.707106781186547,-.831469612302545,-.9238795325112865,-.98078528040323,-1,-.98078528040323,-.923879532511287,-.831469612302545,-.707106781186548,-.555570233019602,-.3826834323650903,-.1950903220161287,0,.1950903220161282,.38268343236509,.555570233019602,.707106781186547,.831469612302545,.9238795325112865,.98078528040323,1]}function K$(){return[0,.1950903220161282,.3826834323650897,.555570233019602,.707106781186547,.831469612302545,.923879532511287,.98078528040323,1,.98078528040323,.923879532511287,.831469612302545,.7071067811865475,.555570233019602,.38268343236509,.1950903220161286,0,-.1950903220161283,-.3826834323650896,-.555570233019602,-.707106781186547,-.831469612302545,-.9238795325112865,-.98078528040323,-1,-.98078528040323,-.923879532511287,-.831469612302545,-.707106781186548,-.555570233019602,-.3826834323650903,-.1950903220161287,0]}function L$(e,t){return e<0?0:t<=e?t-1:e}function M$(){var e,t;for((e=VU(Q3(),rZ()))<0&&(e=0),(t=VU(M3(),rZ())+1)>O3()&&(t=O3());e<t;)eZ[e]=0,++e;R3(O3()),N3(0)}function N$(){return fZ[JX]}function O$(e){return fZ[JX]=e}function P$(){return fZ[KX]}function Q$(e){return fZ[KX]=e}function R$(){return fZ[LX]}function S$(e){return fZ[LX]=e}function T$(){return fZ[MX]}function U$(e){return fZ[MX]=e}function V$(){return fZ[NX]}function W$(e){return fZ[NX]=e}function X$(){return XU(fZ,OX)}function Y$(e){return WU(cZ,e+sV)}function Z$(e,t){var r,i,a,s,n,o,u,l,c,h,f,p,d;return a=h=t$(e),s=f=v$(e),o=p=x$(e),u=d=z$(e),l=a+=(p-h)*t|0,c=s+=(d-f)*t|0,l+=((o+=((r=p$(e))-p)*t|0)-a)*t|0,s=QZ(s,f,c+=((u+=((i=r$(e))-d)*t|0)-s)*t|0),u=QZ(u,c,i),n=FZ(),XY?0:(y$(e,a),A$(e,s),q$(e,l),s$(e,c),u$(n,l),w$(n,c),y$(n,o),A$(n,u),q$(n,r),s$(n,i),n)}function $$(e){var t,r,i,a,s,n,o,u,l,c,h,f,p;return s=FZ(),XY?0:(i=c=t$(e),a=h=v$(e),n=f=x$(e),o=p=z$(e),u=n+=(t=p$(e))-f>>1,l=o+=(r=r$(e))-p>>1,u+=(i+=f-c>>1)-n>>1,l+=(a+=p-h>>1)-o>>1,y$(e,i),A$(e,a),q$(e,u),s$(e,l),u$(s,u),w$(s,l),y$(s,n),A$(s,o),q$(s,t),s$(s,r),s)}function _$(e,t){var r,i,a;r=XZ(e)[EV]>>8,(i=o5(e)[EV]>>8)<r&&(a=r,r=i,i=a),x_(e,r),q5(e,t<i-r?i-r:t)}function d_(){return fZ[YX]}function e_(e){return fZ[YX]=e}function f_(){return fZ[ZX]}function g_(e){return fZ[ZX]=e}function h_(){return fZ[$X]}function j_(){return fZ[_X]}function l_(e){var t,r,i,a,s,n;(t=VU(Q3(),rZ()))<T$()&&(t=T$()),(r=VU(M3()+nZ()-1,rZ()))>P$()&&(r=P$()),(i=VU(e,rZ()))<V$()||i>=R$()||r<T$()||t>=P$()||(a=t,s=r,n=i,(SY||N0())&&SY(a,s,n))}function m_(e){return r2(e,q2(e)|RV)}function n_(e){return r2(e,q2(e)&~RV)}function p_(e,t){return g2(e,oW,t)}function q_(e){return f2(e,qW)}function r_(e,t){return g2(e,qW,t)}function t_(e,t){return g2(e,pW,t)}function u_(){return XU(fZ,aY)}function w_(e){return f2(e,RW)}function x_(e,t){return g2(e,RW,t)}function y_(e){return f2(e,SW)}function z_(e,t){return g2(e,SW,t)}function A_(e){return f2(e,TW)}function B_(e,t){return g2(e,TW,t)}function C_(e,t){var r,i,a;for(r=J4(),i=e,a=Q4();a<t;){if(0!==(r=J4())&&l0(r,i,a))return 1;s3(a),i=a,a=Q4()}return 0!==(r=J4())?l0(r,i,t):void 0}function D_(){return function(e,t,r,i){var a,s,n,o,u,l,c,h,f,p,d,m,b,v,g;if(1!==nZ())return function(e,t,r,i){var a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O,w;if(!(n=C1(e)))return null;u=n$(e),o=e$(e),y=1===k$(e),h=t-a0(e),f=i-c0(e),d=J_(e),b=Y_(e),p=h*d+f*L_(e),m=h*b+f*$_(e),a=nZ(),g=kZ(t,r),_=mZ(0,r),s=rZ(),l=gZ(),c=iZ(),S=t;for(;S<g;)y&&(p=w3(p,u<<16),m=w3(m,o<<16)),O=p>>16,w=m>>16,y||(O=L$(O,u),w=L$(w,o)),0<=O&&0<=w&&O<u&&w<o&&(v=VU((v=m$(e,n,O,w))&l,c),k=VU(S,s),eZ[k]=eZ[k]+v),p+=d,m+=b,++S;l=4042322160|VU(gZ(),rZ()),c=rZ();for(;S<_;)y&&(p=w3(p,u<<16),m=w3(m,o<<16)),O=p>>16,w=m>>16,y||(O=L$(O,u),w=L$(w,o)),0<=O&&0<=w&&O<u&&w<o&&(v=VU((v=m$(e,n,O,w))&l,c),k=VU(S,s),eZ[k]=eZ[k]+v),p+=UU(d,c),m+=UU(b,c),S+=a;l=gZ(),c=iZ();for(;S<r;)y&&(p=w3(p,u<<16),m=w3(m,o<<16)),O=p>>16,w=m>>16,y||(O=L$(O,u),w=L$(w,o)),0<=O&&0<=w&&O<u&&w<o&&(v=VU((v=m$(e,n,O,w))&l,c),k=VU(S,s),eZ[k]=eZ[k]+v),p+=d,m+=b,++S}(e,t,r,i);if(!(a=C1(e)))return null;n=n$(e),s=e$(e),d=1===k$(e),o=t-a0(e),u=i-c0(e),c=J_(e),f=Y_(e),l=o*c+u*L_(e),h=o*f+u*$_(e),m=t,b=r;for(;m<b;)d&&(l=w3(l,n<<16),h=w3(h,s<<16)),v=l>>16,g=h>>16,d||(v=L$(v,n),g=L$(g,s)),0<=v&&0<=g&&v<n&&g<s&&(p=m$(e,a,v,g),eZ[m]=p),l+=c,h+=f,++m}(a1(),c1(),e1(),d_())}function H_(e,t,r){var i,a;if(1!==nZ())return function(e,t,r){var i,a,s,n,o,u,l,c;if(n=kZ(t,r),u=mZ(0,r),i=nZ(),a=rZ(),(c=t)<n)for(l=VU(e&gZ(),iZ());c<n;)o=VU(c,a),eZ[o]=eZ[o]+l,++c;if(c<u)for(s=4042322160|VU(gZ(),rZ()),l=VU(e&s,rZ());c<u;)o=VU(c,a),eZ[o]=eZ[o]+l,c+=i;if(c<r)for(l=VU(e&gZ(),iZ());c<r;)o=VU(c,a),eZ[o]=eZ[o]+l,++c}(e,t,r);for(i=t,a=r;i+4<a;)eZ[i]=e,eZ[i+1]=e,eZ[i+2]=e,eZ[i+3]=e,i+=4;for(;i<a;)eZ[i]=e,++i}function J_(e){return f2(e,$W)}function L_(e){return f2(e,_W)}function N_(){return function(e,t,r,i){var a,s,n,o,u,l,c,h;n=B0(e),u=z0(e),s=J_(e),a=(t-a0(e))*s+(i-c0(e))*L_(e),l=c=t,h=r;for(;((o=a>>16)<0||u<=o)&&l<h;)++l,a+=s;c<l&&(o<0&&(o=0),u<=o&&(o=u-1),H_(n[o],c,l));if(1===nZ())for(;(o=a>>16)<u&&0<=o&&l<h;)eZ[l]=n[o],++l,a+=s;else l=function(e,t,r,i,a,s){var n,o,u,l,c,h,f,p,d,m,b,v;n=nZ(),o=rZ(),m=z0(e),d=(c=r)>>16,h=kZ(v=a,s),p=mZ(0,s),u=gZ(),l=iZ();for(;v<h&&d<m&&0<=d;){for(b=VU((b=t[d])&u,l);v<h&&c>>16===d;)f=VU(v,o),eZ[f]=eZ[f]+b,++v,c+=i;d=c>>16}u=4042322160|VU(gZ(),rZ()),l=rZ();for(;v<p&&d<m&&0<=d;){for(b=VU((b=t[d])&u,l);v<p&&c>>16===d;)f=VU(v,o),eZ[f]=eZ[f]+b,v+=n,c+=UU(i,l);d=c>>16}u=gZ(),l=iZ();for(;v<s&&d<m&&0<=d;){for(b=VU((b=t[d])&u,l);v<s&&c>>16===d;)f=VU(v,o),eZ[f]=eZ[f]+b,++v,c+=i;d=c>>16}return v}(e,n,a,s,l,r);l<h&&(o<0&&(o=0),u<=o&&(o=u-1),H_(n[o],l,h))}(a1(),c1(),e1(),d_())}function Q_(){return fZ[bY]}function S_(){return fZ[cY]}function U_(){return fZ[dY]}function W_(){return fZ[eY]}function Y_(e){return f2(e,aX)}function $_(e){return f2(e,bX)}function a0(e){return f2(e,cX)}function c0(e){return f2(e,dX)}function g0(){return function(e,t,r,i){var a,s,n,o,u,l,c,h,f,p,d,m;f=B0(e),p=z0(e),s=t-a0(e),n=i-c0(e),u=J_(e),c=Y_(e),o=s*u+n*L_(e),l=s*c+n*$_(e),d=t,m=r,h=(p-1)*(p-1);for(;S3(o>>16,l>>16)>=h&&d<m;)++d,o+=u,l+=c;t<d&&H_(f[p-1],t,d);(a=t2())[0]=o,a[1]=l,d<a0(e)&&(d=(1===nZ()?function(e,t,r,i,a,s,n){var o,u,l,c,h,f,p,d;for(f=t[h=uZ((o=0|r[0])>>16,(u=0|r[1])>>16)],l=(h-1)*(h-1),p=s,(d=n)>a0(e)&&(d=a0(e));p<d;){for(;p<d&&S3(o>>16,u>>16)>=l;)eZ[p]=f,++p,o+=i,u+=a;for(c=S3(o>>16,u>>16);c<l;)f=t[--h],l=(h-1)*(h-1)}return r[0]=o,r[1]=u,p}:function(e,t,r,i,a,s,n){var o,u,l,c,h,f,p,d,m,b,v,g,k,_,y;if(h=0|r[0],f=0|r[1],o=nZ(),u=rZ(),b=((g=uZ(h>>16,f>>16))-1)*(g-1),_=s,n<(y=a0(e))&&(y=n),p=kZ(s,y),m=mZ(0,y),_<p)for(l=gZ(),c=iZ(),k=VU((k=t[g])&l,c);_<p;){for(;_<p&&S3(h>>16,f>>16)>=b;)d=VU(_,u),eZ[d]=eZ[d]+k,++_,h+=i,f+=a;for(v=S3(h>>16,f>>16);v<b;)k=VU((k=t[--g])&l,c),b=(g-1)*(g-1)}if(_<m)for(l=4042322160|VU(gZ(),rZ()),c=rZ(),k=VU((k=t[g])&l,c);_<m;){for(;_<m&&S3(h>>16,f>>16)>=b;)d=VU(_,u),eZ[d]=eZ[d]+k,_+=o,h+=UU(i,c),f+=UU(a,c);for(v=S3(h>>16,f>>16);v<b;)k=VU((k=t[--g])&l,c),b=(g-1)*(g-1)}if(_<y)for(l=gZ(),c=iZ(),k=VU((k=t[g])&l,c);_<y;){for(;_<y&&S3(h>>16,f>>16)>=b;)d=VU(_,u),eZ[d]=eZ[d]+k,++_,h+=i,f+=a;for(v=S3(h>>16,f>>16);v<b;)k=VU((k=t[--g])&l,c),b=(g-1)*(g-1)}return r[0]=h,r[1]=f,_})(e,f,a,u,c,d,m));d<m&&(d=(1===nZ()?function(e,t,r,i,a,s,n){var o,u,l,c,h,f,p,d,m,b;o=0|r[0],u=0|r[1],f=uZ(o>>16,u>>16),d=t[f],p=z0(e),c=(p-1)*(p-1),h=(f+1)*(f+1),l=S3(o>>16,u>>16),m=s,b=n;for(;m<b&&l<c;){for(;m<b&&S3(o>>16,u>>16)<=h;)eZ[m]=d,++m,o+=i,u+=a;for(l=S3(o>>16,u>>16);h<l;)d=t[++f],h=(f+1)*(f+1)}return r[0]=o,r[1]=u,m}:function(e,t,r,i,a,s,n){var o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S;if(h=0|r[0],f=0|r[1],o=nZ(),u=rZ(),k=uZ(h>>16,f>>16),_=z0(e),v=(_-1)*(_-1),g=(k+1)*(k+1),m=S3(h>>16,f>>16),p=kZ(S=s,n),b=mZ(0,n),S<p&&m<v)for(l=gZ(),c=iZ(),y=VU((y=t[k])&l,c);S<p&&m<v;){for(;S<p&&S3(h>>16,f>>16)<=g;)d=VU(S,u),eZ[d]=eZ[d]+y,++S,h+=i,f+=a;for(m=S3(h>>16,f>>16);g<m;)y=VU((y=t[++k])&l,c),g=(k+1)*(k+1)}if(S<b&&m<v)for(l=4042322160|VU(gZ(),rZ()),c=rZ(),y=VU((y=t[k])&l,c);S<b&&m<v;){for(;S<b&&S3(h>>16,f>>16)<=g;)d=VU(S,u),eZ[d]=eZ[d]+y,S+=o,h+=UU(i,c),f+=UU(a,c);for(m=S3(h>>16,f>>16);g<m;)y=VU((y=t[++k])&l,c),g=(k+1)*(k+1)}if(S<n&&m<v)for(l=gZ(),c=iZ(),y=VU((y=t[k])&l,c);S<n&&m<v;){for(;S<n&&S3(h>>16,f>>16)<=g;)d=VU(S,u),eZ[d]=eZ[d]+y,++S,h+=i,f+=a;for(m=S3(h>>16,f>>16);g<m;)y=VU((y=t[++k])&l,c),g=(k+1)*(k+1)}return r[0]=h,r[1]=f,S})(e,f,a,u,c,d,m));d<r&&H_(f[p-1],d,r)}(a1(),c1(),e1(),d_())}function k0(e,t){var r;return 0!=(r=T3(e)-T3(t))?0<r:Z3(e)>>>0<Z3(t)>>>0}function l0(e,t,r){var i,a,s,n,o,u;if(0===e)return!1;if(a=t<K3()?K3():t,s=r>UU(O3(),rZ())?UU(O3(),rZ()):r,a<U_()&&(a=U_()),s>Q_()&&(s=Q_()),a<Q3()&&R3(a),s>M3()&&N3(s),s>K3()&&L3(s),s<=a)return!1;if(U0(e))H_(e,a,s);else{if(u=e,fZ[lY]=u,o=a,fZ[mY]=o,n=s,fZ[nY]=n,(i=(q2(e)&zW)>>>8)<=1)return!0;switch(i){case 0:case 1:break;case 2:N_();break;case 3:g0();break;case 4:case 5:D_()}}return!1}function n0(){var e,t,r;for(r=d_();v0()<x0();){if(y_(e=$Y[v0()])>r)return!1;if(((t=q2(e))&HW)===wW)return!0;if(!b2(1))return!1;switch(t){case 0:case 1:case 2:case 3:break;case 4:e4($Y[v0()],d_());break;case 5:!function(e,t){var r,i,a,s,n,o,u,l;a=v5(e),i=s2(a),n=w_(e),o=y_(e),e4(e,o),s=q_(e),u=q1(e),x_(e,n-i),r_(e,s+a),0<u?A5(e,s1(e)+a):(A5(e,a-s1(e)),x_(e,w_(e)+s1(e)));l=0-s-i,s5(e,0),u5(e,l),(i<=0&&l<0?n_:m_)(e);if(o!==t){for(r=o;r<=t-1;r++)r4(e);r_(e,q_(e)-(t-o))}}($Y[v0()],d_());break;case 6:c4($Y[v0()],d_());break;case 7:!function(e,t){var r,i,a,s,n,o,u,l;for(s=k5(e),a=s2(s),r=RZ(e),o=y_(e),c4(e,o),n=q_(e),i=0;i<=5;i++)o5(e)[i]=XZ(e)[i];0===(u=XZ(e)[BV])&&XZ(e)[zV];u=0<=u?1:-1;(u<0?function(e,t,r,i){var a,s;XZ(e)[EV]=XZ(e)[EV]-256*r,a=o5(e)[EV],o5(e)[EV]=a+256*(t-r),s=o5(e)[FV],o5(e)[FV]=s+256*t,WZ(e,i-r)}:function(e,t,r,i){var a,s;XZ(e)[EV]=XZ(e)[EV]+256*r,a=o5(e)[EV],o5(e)[EV]=a-256*(t-r),s=o5(e)[FV],o5(e)[FV]=s+256*t,WZ(e,i-r+t)})(e,s,a,r);0===n&&(XZ(e)[EV]=256*VZ(e));r_(e,n+s),l=0-n-a,h5(e,0),j5(e,l),(a<=0&&l<0?n_:m_)(e);if(_$(e,s),o!==t){for(i=o;i<=t-1;i++)p4(e,i);r_(e,q_(e)-(t-o))}}($Y[v0()],d_())}P0(e),w0(v0()+1)}return!1}function o0(){var e,t,r;for(t=r=Q_();zZ()<BZ();){if((t=r=w_(e=QY[zZ()]))>=Q_())return!1;if(s3(t),Z0(e)&&H4(e),PZ(e)&&(G4(e),XY))return!1;AZ(zZ()+1),zZ()<BZ()&&(r=w_(QY[zZ()]))>=U_()&&C_(t,r)}return r<Q_()&&C_(r,Q_()),!1}function p0(){for(var e,t,r;zZ()<BZ();)if(0==(e=q_(t=QY[zZ()])-1))v3();else{if(r_(t,e),((r=q2(t))&HW)===wW)return!0;switch(r){case 0:case 1:case 2:case 3:break;case 4:n4(QY[zZ()],d_());break;case 5:r4(QY[zZ()],d_());break;case 6:l4(QY[zZ()],d_());break;case 7:p4(QY[zZ()],d_())}y3(),AZ(zZ()+1)}return!1}function q0(e,t){var r;for(r=0;r<Y3()&&(Z3(r)!==e||T3(r)!==t);)r+=3;return r>=Y3()?-1:r}function r0(){return _3()===KW}function s0(){var e;e=3,f5(e5()+e)}function t0(){return bZ}function u0(e,t){var r;return e===t||(0!==(r=y_(e)-y_(t))?r<0:(r=w_(e)-w_(t))<0)}function v0(){return fZ[fY]}function w0(e){return fZ[fY]=e}function x0(){return fZ[gY]}function y0(e){return fZ[gY]=e}function z0(e){return f2(e,eX)}function B0(e){return WU(cZ,e+fX)}function C0(){return 0!==fZ[hY]}function E0(e){return fZ[hY]=e}function F0(){return 0!==fZ[iY]}function H0(e){return fZ[iY]=e}function I0(e,t){var r,i,a,s,n;if(-1===(r=q0(e,t)))return!1;if(0===r)return s0(),!0;if($3(r,Z3(0)),U3(r,T3(0)),X3(r,W3(0)),s0(),Y3()<=3)return!0;for(n=0,r=3;r<Y3();)k0(r,n)&&(n=r),r+=3;return n+3===Y3()||(s=Z3(n),$3(n,O4()),P4(s),i=T3(n),U3(n,K4()),L4(i),a=W3(n),X3(n,M4()),N4(a)),!0}function J0(e,t){return fZ[e]=fZ[e]+t}function N0(){return aZ=_Y.ioLoadFunctionFrom("loadBitBltFrom",RY),SY=_Y.ioLoadFunctionFrom("copyBitsFromtoat",RY),!!aZ&&!!SY}function O0(){var e,t,r,i;D3(nZ()),T$()<0&&U$(0),P$()>O3()&&Q$(O3()),e=UU(T$(),rZ()),fZ[dY]=e,t=UU(V$(),rZ()),fZ[eY]=t,r=UU(P$(),rZ()),fZ[bY]=r,i=UU(R$(),rZ()),fZ[cY]=i,y0(0),CZ(0),$Y=WU(cZ,dZ),QY=WU(cZ,dZ),function(){var e,t;for(t=0,e=dZ;t<e;)S0(t)&&(y_(t)>=S_()||H$(t)),t+=f2(t,sW)}(),XY||(0!==x0()?(function e(t,r,i){var a;var s;var n;var o;var u;var l;var c;var h;var f;var p;var d;if((f=i+1-r)<=1)return 0;n=t[r];u=t[i];s=u0(n,u);s||(p=t[r],t[r]=t[i],t[i]=p,d=n,n=u,u=d);if(f<=2)return 0;l=r+i>>1;o=t[l];s=u0(n,o);s?(s=u0(o,u))||(p=t[i],t[i]=t[l],t[l]=p,o=u):(p=t[r],t[r]=t[l],t[l]=p,o=n);if(f<=3)return 0;c=r;h=i;a=!0;for(;a;){for(s=!0;s;)s=c<=--h&&(p=t[h],u0(o,p));for(s=!0;s;)s=++c<=h&&u0(p=t[c],o);(a=c<=h)&&(p=t[c],t[c]=t[h],t[h]=p)}e(t,r,h);e(t,c,i)}($Y,0,x0()-1),e_(y_($Y[0])),d_()<W_()&&e_(W_()),R3(0),N3(UU(O3(),rZ())-1),M$()):e_(S_()))}function P0(e){q_(e)<=0||function(e,t){var r;if(!DZ(1))return;r=BZ()-1;for(;!(r<t);)QY[r+1]=QY[r],--r;QY[t]=e,CZ(BZ()+1)}(e,function(e){var t,r;for(r=w_(e),t=0;t<BZ()&&w_(QY[t])<r;)++t;for(;t<BZ()&&w_(QY[t])===r&&u0(QY[t],e);)++t;return t}(e))}function S0(e){var t;return t=q2(e),!(xW<t)&&0!=(q2(e)&xW)}function T0(e){return U0(e)||0!=(q2(e)&zW)}function U0(e){return 0!=(4278190080&e)}function V0(e){return 0===e||U0(e)||0<=(t=e)&&t<dZ&&T0(e);var t}function Z0(e){return 0!=(q2(e)&EW)}function a1(){return fZ[lY]}function c1(){return fZ[mY]}function e1(){return fZ[nY]}function g1(e){return f2(e,iX)}function i1(e){return f2(e,jX)}function p1(e,t){return g2(e,kX,t)}function q1(e){return f2(e,tX)}function s1(e){return f2(e,uX)}function v1(e,t,r,i){var a,s,n,o,u;if(a=FZ(),XY)return 0;for(u$(a,e[0]),w$(a,e[1]),y$(a,t[0]),A$(a,t[1]),q$(a,r[0]),s$(a,r[1]),u=s=function(e,t){var r,i,a;r=i=a=function(e){var t,r,i,a,s,n,o;if(n=v$(e),o=z$(e),a=r$(e),0<=(r=o-n)*(i=a-o))return e;J0(GX,1),(s=r)<0&&(s=0-s);(t=i-r)<0&&(t=0-t);return Z$(e,s/t)}(e),t&&(i=D4(e));a<i&&(a=i);e!==r&&t&&(i=D4(r));a<i&&(a=i);return a}(a,i),n=a;n<=s;n+=6)if(u<(o=B4(n))&&(u=o),XY)return 0;return SU(u,6)}function A1(e){return(aZ||N0())&&aZ(e)}function B1(e,t,r,i,a,s,n){var o,u,l,c,h,f,p,d,m,b;if(t.isNil)m=0,d=null;else{if(PU(t)!==_Y.classBitmap())return _Y.primitiveFail();m=QU(t),d=t.wordsAsInt32Array()}return"number"==typeof e||!_Y.isPointers(e)||QU(e)<5||PU(o=_Y.fetchPointerofObject(0,e))!==_Y.classBitmap()?_Y.primitiveFail():(u=QU(o),p=_Y.fetchIntegerofObject(1,e),h=_Y.fetchIntegerofObject(2,e),l=_Y.fetchIntegerofObject(3,e),_Y.failed()?null:!(0<=p&&0<=h)||32!==l&&8!==l&&16!==l&&1!==l&&2!==l&&4!==l||0!==m&&m!==UU(1,l)?_Y.primitiveFail():(b=SU(32,l),u!==(f=SU(p+(b-1),b))*h?_Y.primitiveFail():(c=GZ(m,d),XY?null:(g2(c,rV,p),g2(c,oV,h),g2(c,nV,l),g2(c,pV,f),g2(c,qV,u),g2(c,yV,r),n2(c,n),I1(c,i,a,s,p,h),c))))}function C1(e){var t,r,i;return(i=m2(e))>QU(YY)?null:(r=_Y.fetchPointerofObject(i,YY),QU(t=_Y.fetchPointerofObject(0,r))!==f2(e,qV)?null:t.wordsAsInt32Array())}function E1(e,t,r,i,a,s,n){var o,u,l,c,h,f,p,d;if(i!==a||0!==s&&0!==n){if(o=6*e,d=r?(l=(t.int16Array||(t.int16Array=new Int16Array(t.buffer,t.byteOffset)))[0+o],f=(t.int16Array||(t.int16Array=new Int16Array(t.buffer,t.byteOffset)))[1+o],c=(t.int16Array||(t.int16Array=new Int16Array(t.buffer,t.byteOffset)))[2+o],p=(t.int16Array||(t.int16Array=new Int16Array(t.buffer,t.byteOffset)))[3+o],h=(t.int16Array||(t.int16Array=new Int16Array(t.buffer,t.byteOffset)))[4+o],(t.int16Array||(t.int16Array=new Int16Array(t.buffer,t.byteOffset)))[5+o]):(l=0|t[0+o],f=0|t[1+o],c=0|t[2+o],p=0|t[3+o],h=0|t[4+o],0|t[5+o]),l===c&&f===p||c===h&&p===d)return(l!==h||f!==d)&&(t2()[0]=l,t2()[1]=f,u2()[0]=h,u2()[1]=d,V4(2),W1(s,t2(),u2(),n,i,a));t2()[0]=l,t2()[1]=f,u2()[0]=c,u2()[1]=p,v2()[0]=h,v2()[1]=d,V4(3),u=v1(t2(),u2(),v2(),0!==s&&0!==n),XY||V1(s,n,i,a,u)}}function G1(e){var t;return t=fZ[kY],QU(e)<bV?null:(x_(t,_Y.fetchIntegerofObject(eV,e)),z_(t,_Y.fetchIntegerofObject(fV,e)),B_(t,_Y.fetchIntegerofObject(gV,e)),r_(t,_Y.fetchIntegerofObject(dV,e)),t)}function I1(e,t,r,i,a,s){var n,o,u,l,c,h,f,p,d,m,b,v,g,k;r[0]=r[0]+t[0],r[1]=r[1]+t[1],i[0]=i[0]+t[0],i[1]=i[1]+t[1],S4(t),S4(r),S4(i),c=0<(u=(n=r[0]-t[0])*n+(o=r[1]-t[1])*o)?(l=n*a*65536/u|0,o*a*65536/u|0):l=0,p=0<(h=(d=i[0]-t[0])*d+(m=i[1]-t[1])*m)?(f=d*s*65536/h|0,m*s*65536/h|0):f=0,b=e,v=t[0],g2(b,cX,v),g=e,k=t[1],g2(g,dX,k),g2(e,$W,l),g2(e,_W,c),g2(e,aX,f),g2(e,bX,p)}function J1(e){var t,r,i,a,s,n,o,u;if(_Y.isArray(e)){for(YY=e,o=0;o<=QU(YY)-1;o++){if("number"==typeof(n=_Y.fetchPointerofObject(o,YY)))return;if(!_Y.isPointers(n))return;if(QU(n)<5)return;if(PU(t=_Y.fetchPointerofObject(0,n))!==_Y.classBitmap())return;if(r=QU(t),s=_Y.fetchIntegerofObject(1,n),a=_Y.fetchIntegerofObject(2,n),i=_Y.fetchIntegerofObject(3,n),_Y.failed())return;if(!(0<=s&&0<=a))return;if(u=SU(32,i),r!==SU(s+(u-1),u)*a)return}return 1}}function L1(e,t,r,i,a,s){var n,o,u,l,c,h,f;u=t[1]<=r[1]?(n=t,o=r,1):(n=r,o=t,-1),x_(e,n[0]),z_(e,n[1]-i),B_(e,f_()),p_(e,a),t_(e,s),l=e,c=o[0],g2(l,iX,c),h=e,f=o[1]-i,g2(h,jX,f),g2(e,vX,u)}function N1(e,t,r,i,a){var s,n,o,u,l,c;s=J$()[2*e+0]*t+i|0,u=K$()[2*e+0]*r+a|0,t2()[0]=s,t2()[1]=u,o=J$()[2*e+2]*t+i|0,c=K$()[2*e+2]*r+a|0,v2()[0]=o,v2()[1]=c,n=2*(n=J$()[2*e+1]*t+i|0)-(s+o>>1),l=2*(l=K$()[2*e+1]*r+a|0)-(u+c>>1),u2()[0]=n,u2()[1]=l}function O1(e,t){var r;return PU(t)===_Y.classPoint()&&("number"==typeof(r=_Y.fetchPointerofObject(0,t))||r.isFloat)?(e[0]="number"==typeof r?r:0|_Y.floatValueOf(r),"number"==typeof(r=_Y.fetchPointerofObject(1,t))||r.isFloat?void(e[1]="number"==typeof r?r:0|_Y.floatValueOf(r)):_Y.primitiveFail()):_Y.primitiveFail()}function R1(){var e,t,r,i;return 2!==_Y.methodArgumentCount()?PY:0!==(t=p3(_Y.stackValue(2)))?t:(r=_Y.stackObjectValue(0),e=_Y.stackObjectValue(1),_Y.failed()?OY:0!==(t=T1(_Y.fetchPointerofObject(_U,WY)))?t:A1(_Y.fetchPointerofObject(ZU,WY))?J1(_Y.fetchPointerofObject($U,WY))?QU(e)<bV?WV:QU(r)<hV?bW:(i=_3())===PW||i===QW||i===OW?nW:0:cW:UV)}function T1(e){return PU(e)!==_Y.classBitmap()?VV:(eZ=e.words,t=QU(e)-1,fZ[BY]=t,0);var t}function U1(e,t,r){return!e.isNil&&("number"==typeof e||QU(e)!==r?_Y.primitiveFail():((_Y.isWords(e)?function(e,t,r){var i,a;for(a=e.wordsAsFloat32Array(),i=0;i<=r-1;i++)t[i]=a[i]}:function(e,t,r){var i,a;for(i=0;i<=r-1;i++){if("number"!=typeof(a=_Y.fetchPointerofObject(i,e))&&!a.isFloat)return _Y.primitiveFail();t[i]="number"==typeof a?a:_Y.floatValueOf(a)}})(e,t,r),!0))}function V1(e,t,r,i,a){var s,n,o,u,l,c,h,f,p,d,m;for(o=0===e||0===t?(u=!1,0):(u=!0,s2(e)),n=6*a;0<n;){if(s=u?(m=void 0,KZ(MV)?(dZ=(m=dZ)+MV,r2(m,FW),n2(m,0),p2(m,MV),m):0):(d=void 0,KZ(mV)?(dZ=(d=dZ)+mV,r2(d,uW),n2(d,0),p2(d,mV),d):0),XY)return;l=s,h=r,f=i,p=o,r$(c=n)>=v$(c)?(x_(l,t$(c)),z_(l,v$(c)-p),ZZ(l,x$(c)),_Z(l,z$(c)-p),SZ(l,p$(c)),UZ(l,r$(c)-p)):(x_(l,p$(c)),z_(l,r$(c)-p),ZZ(l,x$(c)),_Z(l,z$(c)-p),SZ(l,t$(c)),UZ(l,v$(c)-p)),B_(l,f_()),p_(l,h),t_(l,f),u&&(g2(s,LV,t),q5(s,e),g2(s,KV,e)),n-=6}$4()}function W1(e,t,r,i,a,s){var n,o,u,l;if(o=0===e||0===i?(n=KZ(hX)?(dZ=(l=dZ)+hX,r2(l,AW),n2(l,0),p2(l,hX),l):0,0):(n=KZ(rX)?(dZ=(u=dZ)+rX,r2(u,GW),n2(u,0),p2(u,rX),u):0,s2(e)),XY)return 0;L1(n,t,r,o,a,s),Z0(n)&&(g2(n,qX,i),A5(n,e),g2(n,pX,e))}function Y1(e){return"number"==typeof e?fW:_Y.isWords(e)?QU(e)<qY?iW:(B5(e),fZ[oY]!==pY?eW:Y4()!==QU(e)?jW:h2()!==jY?hW:(cZ=WU(fZ,h2()),$Y=WU(cZ,j2()),QY=WU($Y,x0()),jY+j2()+x0()+BZ()>Y4()?kW:0)):gW}function _1(e){0===strcmp(e,RY)&&(SY=aZ=0)}function b2(e){return!(jY+dZ+x0()+BZ()+e>e5())||(s4(ZW),!1)}function c2(){return 0!==fZ[rY]}function e2(e){return fZ[rY]=e}function f2(e,t){return cZ[e+t]}function g2(e,t,r){return cZ[e+t]=r}function h2(){return fZ[sY]}function j2(){return fZ[tY]}function k2(e){return fZ[tY]=e}function m2(e){return f2(e,rW)}function n2(e,t){return g2(e,rW,t)}function p2(e,t){return g2(e,sW,t)}function q2(e){return f2(e,tW)&DW}function r2(e,t){return g2(e,tW,t)}function s2(e){return e>>1}function t2(){return WU(fZ,uY)}function u2(){return WU(fZ,vY)}function v2(){return WU(fZ,wY)}function w2(){return WU(fZ,xY)}function x2(){v0()>=x0()&&0===BZ()&&a4(KW),d_()>=S_()&&a4(KW)}function y2(){var e;return 0!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=p3(_Y.stackValue(0)))?_Y.primitiveFailFor(e):(a4(KW),void w4())}function z2(){var e,t,r;return VY&&(ZY=_Y.ioMicroMSecs()),1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(r=q3(_Y.stackValue(1),PW))?_Y.primitiveFailFor(r):(t=_Y.stackObjectValue(0),_Y.failed()?_Y.primitiveFailFor(OY):(e=G1(t))?b2(1)?(0<q_(e)&&P0(e),XY?_Y.primitiveFailFor(ZV):(a4(IW),w4(),_Y.pop(1),void(VY&&(J0(PX,1),J0(FY,_Y.ioMicroMSecs()-ZY))))):_Y.primitiveFailFor(kW):_Y.primitiveFailFor(WV))}function A2(){var e,t,r,i,a,s,n;return 5!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):(a=_Y.positive32BitValueOf(_Y.stackValue(0)),r=_Y.positive32BitValueOf(_Y.stackValue(1)),n=_Y.stackObjectValue(2),e=_Y.stackObjectValue(3),s=_Y.stackObjectValue(4),_Y.failed()?_Y.primitiveFailFor(OY):0!==(t=q3(_Y.stackValue(5),MW))?_Y.primitiveFailFor(t):V0(r)&&V0(a)?(O1(t2(),s),O1(u2(),n),O1(v2(),e),_Y.failed()?_Y.primitiveFailFor(OY):(V4(3),b2((i=v1(t2(),u2(),v2(),!1))*mV),XY||(r=R4(r),a=R4(a)),XY||V1(0,0,r,a,i),XY?($4(),_Y.primitiveFailFor(ZV)):_Y.failed()?_Y.primitiveFailFor(aW):(w4(),void _Y.pop(5)))):_Y.primitiveFailFor(mW))}function B2(){var e,t,r,i,a,s,n,o;if(5!==_Y.methodArgumentCount())return _Y.primitiveFailFor(PY);if(i=_Y.positive32BitValueOf(_Y.stackValue(0)),a=_Y.stackIntegerValue(1),t=_Y.positive32BitValueOf(_Y.stackValue(2)),s=_Y.stackIntegerValue(3),n=_Y.stackObjectValue(4),_Y.failed())return _Y.primitiveFailFor(OY);if(0!==(e=q3(_Y.stackValue(5),MW)))return _Y.primitiveFailFor(e);if(r=QU(n),_Y.isWords(n)){if(o=!1,r!==3*s&&r!==6*s)return _Y.primitiveFailFor(OY)}else{if(!_Y.isArray(n))return _Y.primitiveFailFor(OY);if(r!==3*s)return _Y.primitiveFailFor(OY);o=!0}return b2((0===a||0===i?hX:rX)*s)?V0(i)&&V0(t)?(i=R4(i),t=R4(t),XY?_Y.primitiveFailFor(ZV):0!==i&&0!==a||0!==t?(0!==a&&(a=W4(a))<1&&(a=1),o?function(e,t,r,i,a){var s,n,o,u,l,c,h,f,p;for(s=0;s<=t-1;s++){if(n=_Y.fetchPointerofObject(3*s,e),O1(t2(),n),n=_Y.fetchPointerofObject(3*s+1,e),O1(u2(),n),n=_Y.fetchPointerofObject(3*s+2,e),O1(v2(),n),_Y.failed())return;if(V4(3),u=t2()[0],h=t2()[1],l=u2()[0],f=u2()[1],c=v2()[0],p=v2()[1],u===h&&l===f||l===c&&f===p)W1(i,t2(),v2(),a,r,0);else{if(o=v1(t2(),u2(),v2(),0!==i&&0!==a),XY)return;V1(i,a,r,0,o)}if(XY)return}}(n,s,t,a,i):function(e,t,r,i,a,s){var n;for(n=1;n<=t;n++)if(E1(n-1,e,s,r,0,i,a),XY)return}(n.wordsAsInt32Array(),s,t,a,i,3*s===r),XY?_Y.primitiveFailFor(ZV):_Y.failed()?_Y.primitiveFailFor(aW):(e2(1),w4(),void _Y.pop(5))):_Y.pop(5)):_Y.primitiveFailFor(mW):_Y.primitiveFailFor(kW)}function C2(){var e,t,r,i,a,s,n,o,u;return 7!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):(u=_Y.stackIntegerValue(0))<=0?_Y.primitiveFailFor(OY):(s=_Y.stackObjectValue(1),t=_Y.stackObjectValue(2),n=_Y.stackObjectValue(3),o=_Y.booleanValueOf(_Y.stackValue(4)),e=_Y.stackObjectValue(5),a=_Y.stackObjectValue(6),_Y.failed()?_Y.primitiveFailFor(OY):0!==(r=q3(_Y.stackValue(7),MW))?_Y.primitiveFailFor(r):(O1(t2(),n),O1(u2(),t),O1(v2(),s),_Y.failed()?_Y.primitiveFailFor(TV):(i=B1(a,e,o?1:0,t2(),u2(),v2(),u-1),XY?_Y.primitiveFailFor(ZV):_Y.failed()?_Y.primitiveFailFor(aW):(w4(),void _Y.popthenPush(8,_Y.positive32BitIntegerFor(i))))))}function D2(){var e,t,r,i,a,s,n,o,u;return 7!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):(t=_Y.stackObjectValue(0),i=_Y.stackObjectValue(1),a=_Y.stackObjectValue(2),u=_Y.stackObjectValue(3),r=_Y.stackObjectValue(4),s=_Y.stackIntegerValue(5),n=_Y.stackObjectValue(6),_Y.failed()?_Y.primitiveFailFor(OY):0!==(e=q3(_Y.stackValue(7),MW))?_Y.primitiveFailFor(e):F$(n,s,r,u,a,i,t)?b2(Math.max(mV,hX)*s)?(o=QU(n)===3*s,function(e,t,r,i,a,s,n,o){var u,l,c,h,f,p,d,m,b,v,g,k,_;if(0!==t)for(c=b=k=p=-1,l=m=g=f=1,h=v=_=d=0,u=1;u<=t;u++){if(--l<=0&&(l=F3(++c,r),0!==(h=G3(c,r))&&(h=R4(h=n[h-1]),XY)))return;if(--m<=0&&(m=F3(++b,i),0!==(v=G3(b,i))&&(v=R4(v=n[v-1]))),--g<=0&&(g=F3(++k,a),0!==(_=G3(k,a))&&(_=W4(_))),--f<=0&&(f=F3(++p,s),0!==(d=G3(p,s))&&(d=n[d-1])),E1(u-1,e,o,h,v,_,d),XY)return}}(n.wordsAsInt32Array(),s,r.wordsAsInt32Array(),u.wordsAsInt32Array(),a.wordsAsInt32Array(),i.wordsAsInt32Array(),t.wordsAsInt32Array(),o),XY?_Y.primitiveFailFor(ZV):_Y.failed()?_Y.primitiveFailFor(aW):(e2(1),w4(),void _Y.pop(7))):_Y.primitiveFailFor(kW):_Y.primitiveFailFor(_V))}function E2(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p;return 5!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):(i=_Y.booleanValueOf(_Y.stackValue(0)),a=_Y.stackValue(1),e=_Y.stackValue(2),s=_Y.stackValue(3),n=_Y.stackValue(4),_Y.failed()?_Y.primitiveFailFor(OY):0!==(t=q3(_Y.stackValue(5),MW))?_Y.primitiveFailFor(t):(O1(t2(),s),O1(u2(),e),O1(v2(),a),_Y.failed()?_Y.primitiveFailFor(TV):(o=n,u=t2(),l=u2(),c=v2(),h=i,r=PU(o)!==_Y.classBitmap()?_Y.primitiveFail():(p=QU(o),f=IZ(o.wordsAsInt32Array(),p,h),XY?null:(I1(f,u,l,c,p,p),f)),XY?_Y.primitiveFailFor(ZV):_Y.failed()?_Y.primitiveFailFor(aW):(w4(),void _Y.popthenPush(6,_Y.positive32BitIntegerFor(r))))))}function F2(){var e,t,r,i,a;return 4!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):(i=_Y.positive32BitValueOf(_Y.stackValue(0)),r=_Y.positive32BitValueOf(_Y.stackValue(1)),e=_Y.stackObjectValue(2),a=_Y.stackObjectValue(3),_Y.failed()?_Y.primitiveFailFor(OY):0!==(t=q3(_Y.stackValue(4),MW))?_Y.primitiveFailFor(t):V0(r)&&V0(i)?(O1(t2(),a),O1(u2(),e),_Y.failed()?_Y.primitiveFailFor(TV):(V4(2),r=R4(r),i=R4(i),XY?_Y.primitiveFailFor(ZV):(W1(0,t2(),u2(),0,r,i),XY?_Y.primitiveFailFor(ZV):_Y.failed()?_Y.primitiveFailFor(aW):(w4(),void _Y.pop(4))))):_Y.primitiveFailFor(mW))}function G2(){var e,t,r,i,a,s;return 5!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):(e=_Y.positive32BitValueOf(_Y.stackValue(0)),t=_Y.stackIntegerValue(1),a=_Y.positive32BitValueOf(_Y.stackValue(2)),r=_Y.stackObjectValue(3),s=_Y.stackObjectValue(4),_Y.failed()?_Y.primitiveFailFor(OY):0!==(i=q3(_Y.stackValue(5),MW))?_Y.primitiveFailFor(i):V0(e)&&V0(a)?(a=R4(a),e=R4(e),XY?_Y.primitiveFailFor(ZV):0===a&&(0===e||t<=0)?_Y.pop(5):b2(16*mV)?(t=0<t&&0!==e?W4(t):0,O1(t2(),s),O1(u2(),r),_Y.failed()?_Y.primitiveFailFor(TV):(function(e,t,r,i){var a,s,n,o,u,l;for(l=u2()[0]-t2()[0]>>1,n=u2()[1]-t2()[1]>>1,a=u2()[0]+t2()[0]>>1,s=u2()[1]+t2()[1]>>1,o=0;o<=15;o++){if(N1(o,l,n,a,s),V4(3),u=v1(t2(),u2(),v2(),0!==e&&0!==t),XY)return;if(V1(e,t,r,i,u),XY)return}}(t,e,0,a),XY?($4(),_Y.primitiveFailFor(ZV)):_Y.failed()?_Y.primitiveFailFor(aW):(e2(1),w4(),void _Y.pop(5)))):_Y.primitiveFailFor(kW)):_Y.primitiveFailFor(mW))}function H2(){var e,t,r,i,a,s,n,o;if(5!==_Y.methodArgumentCount())return _Y.primitiveFailFor(PY);if(i=_Y.positive32BitValueOf(_Y.stackValue(0)),a=_Y.stackIntegerValue(1),t=_Y.positive32BitValueOf(_Y.stackValue(2)),s=_Y.stackIntegerValue(3),n=_Y.stackObjectValue(4),_Y.failed())return _Y.primitiveFailFor(OY);if(0!==(e=q3(_Y.stackValue(5),MW)))return _Y.primitiveFailFor(e);if(r=QU(n),_Y.isWords(n)){if(o=!1,r!==s&&2*s!==r)return _Y.primitiveFailFor(OY)}else{if(!_Y.isArray(n))return _Y.primitiveFailFor(OY);if(r!==s)return _Y.primitiveFailFor(OY);o=!0}return b2((0===a||0===i?hX:rX)*s)?V0(i)&&V0(t)?(i=R4(i),t=R4(t),XY?_Y.primitiveFailFor(ZV):0!==i&&0!==a||0!==t?(0!==a&&(a=W4(a)),o?function(e,t,r,i,a){var s,n,o,u,l;if(O1(t2(),_Y.fetchPointerofObject(0,e)),!_Y.failed())for(n=t2()[0],u=t2()[1],s=1;s<=t-1;s++){if(O1(t2(),_Y.fetchPointerofObject(s,e)),_Y.failed())return;if(o=t2()[0],l=t2()[1],t2()[0]=n,t2()[1]=u,u2()[0]=o,u2()[1]=l,V4(2),W1(i,t2(),u2(),a,r,0),XY)return;n=o,u=l}}(n,s,t,a,i):function(e,t,r,i,a,s){var n,o,u,l,c;for(l=s?(o=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[0],(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[1]):(o=0|e[0],0|e[1]),n=1;n<=t-1;n++){if(c=s?(u=(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[2*n],(e.int16Array||(e.int16Array=new Int16Array(e.buffer,e.byteOffset)))[2*n+1]):(u=0|e[2*n],0|e[2*n+1]),t2()[0]=o,t2()[1]=l,u2()[0]=u,u2()[1]=c,V4(2),W1(i,t2(),u2(),a,r,0),XY)return;o=u,l=c}}(n.wordsAsInt32Array(),s,t,a,i,s===r),XY?_Y.primitiveFailFor(ZV):_Y.failed()?_Y.primitiveFailFor(aW):(e2(1),w4(),void _Y.pop(5))):_Y.pop(5)):_Y.primitiveFailFor(mW):_Y.primitiveFail()}function I2(){var e,t,r,i,a,s,n,o,u,l;return 5!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):(e=_Y.positive32BitValueOf(_Y.stackValue(0)),t=_Y.stackIntegerValue(1),a=_Y.positive32BitValueOf(_Y.stackValue(2)),r=_Y.stackObjectValue(3),s=_Y.stackObjectValue(4),_Y.failed()?_Y.primitiveFailFor(OY):0!==(i=q3(_Y.stackValue(5),MW))?_Y.primitiveFailFor(i):V0(e)&&V0(a)?(e=R4(e),a=R4(a),XY?_Y.primitiveFailFor(ZV):0!==a||0!==e&&0!==t?b2(4*hX)?(t=0<t&&0!==e?W4(t):0,O1(t2(),s),O1(v2(),r),_Y.failed()?_Y.primitiveFailFor(TV):(u2()[0]=v2()[0],u2()[1]=t2()[1],w2()[0]=t2()[0],w2()[1]=v2()[1],V4(4),o=e,u=0,l=a,W1(n=t,t2(),u2(),o,u,l),W1(n,u2(),v2(),o,u,l),W1(n,v2(),w2(),o,u,l),W1(n,w2(),t2(),o,u,l),_Y.failed()?_Y.primitiveFailFor(aW):(e2(1),w4(),void _Y.pop(5)))):_Y.primitiveFailFor(kW):_Y.pop(5)):_Y.primitiveFailFor(mW))}function J2(){var e,t,r;return VY&&(ZY=_Y.ioMicroMSecs()),1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(r=q3(_Y.stackValue(1),OW))?_Y.primitiveFailFor(r):(t=_Y.stackObjectValue(0),_Y.failed()?_Y.primitiveFailFor(OY):(e=G1(t))?(0===q_(e)?v3():(y3(),AZ(zZ()+1)),a4(NW),w4(),_Y.pop(1),void(VY&&(J0(QX,1),J0(GY,_Y.ioMicroMSecs()-ZY)))):_Y.primitiveFailFor(WV))}function K2(){var e,t,r,i,a,s,n,o;if(2!==_Y.methodArgumentCount())return _Y.primitiveFailFor(PY);if(t=_Y.stackValue(0),0!==(a=Y1(e=_Y.stackValue(1))))return _Y.primitiveFailFor(a);if(PU(e)!==PU(t))return _Y.primitiveFailFor(VV);if((r=QU(t)-QU(e))<0)return _Y.primitiveFailFor(dW);for(n=fZ,i=t.wordsAsInt32Array(),s=0,o=e5()-1;s<=o;s++)i[s]=n[s];for(i[IX]=e5()+r,i[yY]=Y4()+r,n=WU(n,e5()),i=WU(i,e5()+r),s=0,o=Y4()-e5()-1;s<=o;s++)i[s]=n[s];if(0!==(a=Y1(t)))return _Y.primitiveFailFor(a);_Y.pop(2)}function L2(){var e;return VY&&(ZY=_Y.ioMicroMSecs()),0!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=q3(_Y.stackValue(0),JW))||0!==(e=T1(_Y.fetchPointerofObject(_U,WY)))?_Y.primitiveFailFor(e):A1(_Y.fetchPointerofObject(ZU,WY))?((d_()&pZ())===pZ()&&(l_(d_()),x2()),r0()||(AZ(0),e_(d_()+1),a4(NW)),w4(),void(VY&&(J0(RX,1),J0(HY,_Y.ioMicroMSecs()-ZY)))):_Y.primitiveFailFor(UV)}function M2(){var e,t;t=VY,e=_Y.stackObjectValue(0),e=_Y.booleanValueOf(e),_Y.failed()||(VY=e,_Y.pop(2),_Y.pushBool(t))}function N2(){var e,t;return VY&&(ZY=_Y.ioMicroMSecs()),0!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=p3(_Y.stackValue(0)))?_Y.primitiveFailFor(e):(t=r0(),w4(),_Y.pop(1),_Y.pushBool(t),void(VY&&(J0(SX,1),J0(IY,_Y.ioMicroMSecs()-ZY))))}function O2(){var e;return 0!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=p3(_Y.stackValue(0)))?_Y.primitiveFailFor(e):(_Y.pop(1),void _Y.pushInteger(nZ()))}function P2(){var e,t,r;return 1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=p3(_Y.stackValue(1)))?_Y.primitiveFailFor(e):(t=_Y.stackObjectValue(0),!_Y.failed()&&_Y.isWords(t)&&4<=QU(t)?((r=t.wordsAsInt32Array())[0]=r[0]+fZ[GX],r[1]=r[1]+fZ[EX],r[2]=r[2]+fZ[HX],r[3]=r[3]+fZ[FX],void _Y.pop(1)):_Y.primitiveFailFor(OY))}function Q2(){var e,t,r;return 1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=p3(_Y.stackValue(1)))?_Y.primitiveFailFor(e):(r=_Y.stackObjectValue(0),!_Y.failed()&&_Y.isPointers(r)&&2<=QU(r)?(_Y.pushRemappableOop(r),t=_Y.makePointwithxValueyValue(T$(),V$()),_Y.storePointerofObjectwithValue(0,_Y.topRemappableOop(),t),t=_Y.makePointwithxValueyValue(P$(),R$()),r=_Y.popRemappableOop(),_Y.storePointerofObjectwithValue(1,r,t),void _Y.popthenPush(2,r)):_Y.primitiveFailFor(OY))}function R2(){var e,t,r;return 1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=p3(_Y.stackValue(1)))?_Y.primitiveFailFor(e):(t=_Y.stackObjectValue(0),!_Y.failed()&&_Y.isWords(t)&&9<=QU(t)?((r=t.wordsAsInt32Array())[0]=r[0]+fZ[TX],r[1]=r[1]+fZ[SX],r[2]=r[2]+fZ[XX],r[3]=r[3]+fZ[PX],r[4]=r[4]+fZ[WX],r[5]=r[5]+fZ[UX],r[6]=r[6]+fZ[RX],r[7]=r[7]+fZ[VX],r[8]=r[8]+fZ[QX],void _Y.pop(1)):_Y.primitiveFailFor(OY))}function S2(){var e;return 0!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=p3(_Y.stackValue(0)))?_Y.primitiveFailFor(e):(_Y.pop(1),void _Y.pushInteger(f_()))}function T2(){var e;return 0!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):"number"==typeof(WY=_Y.stackValue(0))?_Y.primitiveFailFor(XV):_Y.isPointers(WY)?QU(WY)<YU?_Y.primitiveFailFor($V):0!==(e=Y1(_Y.fetchPointerofObject(aV,WY)))?_Y.primitiveFailFor(e):(_Y.pop(1),void _Y.pushInteger(t4())):_Y.primitiveFailFor(YV)}function U2(){var e,t;return 0!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=p3(_Y.stackValue(0)))?_Y.primitiveFailFor(e):(t=_Y.makePointwithxValueyValue(h_(),j_()),void _Y.popthenPush(1,t))}function V2(){var e,t,r;return 1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=p3(_Y.stackValue(1)))?_Y.primitiveFailFor(e):(t=_Y.stackObjectValue(0),!_Y.failed()&&_Y.isWords(t)&&9<=QU(t)?((r=t.wordsAsInt32Array())[0]=r[0]+fZ[JY],r[1]=r[1]+fZ[IY],r[2]=r[2]+fZ[NY],r[3]=r[3]+fZ[FY],r[4]=r[4]+fZ[MY],r[5]=r[5]+fZ[KY],r[6]=r[6]+fZ[HY],r[7]=r[7]+fZ[LY],r[8]=r[8]+fZ[GY],void _Y.pop(1)):_Y.primitiveFailFor(OY))}function W2(){var e,t,r,i,a,s,n;return 1!==_Y.methodArgumentCount()?_Y.primitiveFail():(t=_Y.stackObjectValue(0),_Y.failed()?null:!_Y.isWords(t)||(e=QU(t))<qY?_Y.primitiveFail():(B5(t),cZ=WU(fZ,jY),r=pY,fZ[oY]=r,i=e,fZ[yY]=i,f5(e),a4(MW),a=jY,fZ[sY]=a,k2(4),r2(0,yW),p2(0,4),n2(0,0),w0(0),y0(0),AZ(0),CZ(0),u4(0),e2(0),U$(0),Q$(0),W$(0),S$(0),g_(0),fZ[JY]=0,fZ[IY]=0,fZ[NY]=0,fZ[FY]=0,fZ[MY]=0,fZ[KY]=0,fZ[HY]=0,fZ[LY]=0,fZ[GY]=0,fZ[TX]=0,fZ[SX]=0,fZ[XX]=0,fZ[PX]=0,fZ[WX]=0,fZ[UX]=0,fZ[RX]=0,fZ[VX]=0,fZ[QX]=0,fZ[GX]=0,fZ[EX]=0,fZ[HX]=0,fZ[FX]=0,(s=u_())[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=1,H0(s[5]=0),(n=X$())[0]=1,n[1]=0,n[2]=1,n[3]=0,n[4]=1,n[5]=0,n[6]=1,E0(n[7]=0),_Y.pop(2),void _Y.push(t)))}function X2(){var e;return VY&&(ZY=_Y.ioMicroMSecs()),0!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=q3(_Y.stackValue(0),MW))||0!==(e=T1(_Y.fetchPointerofObject(_U,WY)))?_Y.primitiveFailFor(e):(O0(),XY?_Y.primitiveFailFor(ZV):(a4(IW),_Y.failed()||w4(),void(VY&&(J0(TX,1),J0(JY,_Y.ioMicroMSecs()-ZY)))))}function Y2(){var e,t,r,i;return VY&&(ZY=_Y.ioMicroMSecs()),2!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(t=q3(_Y.stackValue(2),QW))||0!==(t=T1(_Y.fetchPointerofObject(_U,WY)))?_Y.primitiveFailFor(t):(r=_Y.stackObjectValue(0),e=_Y.stackObjectValue(1),_Y.failed()||PU(e)!==_Y.classBitmap()?_Y.primitiveFailFor(OY):QU(r)<hV?_Y.primitiveFailFor(bW):(i=_Y.fetchIntegerofObject(iV,r),m2(a1())!==i?_Y.primitiveFailFor(mW):(i=_Y.fetchIntegerofObject(kV,r),c1()!==i?_Y.primitiveFailFor(mW):(i=_Y.fetchIntegerofObject(jV,r),e1()!==i?_Y.primitiveFailFor(mW):QU(e)<e1()-c1()?_Y.primitiveFailFor(OY):_Y.failed()?null:(function(e,t,r){var i,a,s,n,o,u,l,c;if(l=t,c=r,a=-1,1===nZ())for(;l<c;)o=0|e[++a],eZ[l]=o,++l;else for(s=gZ(),n=iZ(),i=rZ();l<c;)u=VU(l,i),o=VU((o=0|e[++a])&s,n),eZ[u]=eZ[u]+o,++l;c>M3()&&N3(c),c>K3()&&L3(c)}(e.wordsAsInt32Array(),c1(),e1()),a4(LW),w4(),_Y.pop(2),void(VY&&(J0(UX,1),J0(KY,_Y.ioMicroMSecs()-ZY))))))))}function Z2(){var e,t;return 0!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=p3(_Y.stackValue(0)))?_Y.primitiveFailFor(e):(t=c2(),w4(),_Y.pop(1),void _Y.pushBool(t))}function $2(){var e,t;return 1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=p3(_Y.stackValue(1)))?_Y.primitiveFailFor(e):(t=_Y.booleanValueOf(_Y.stackValue(0)),_Y.failed()?_Y.primitiveFailFor(OY):(e2(!0===t?1:0),w4(),void _Y.pop(1)))}function _2(){var e,t,r,i,a,s,n;return VY&&(ZY=_Y.ioMicroMSecs()),1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(i=_Y.stackValue(1),a=NW,s=KW,t=0===(n=p3(i))?_3()!==a&&_3()!==s?(u4(VW),nW):0:n)?_Y.primitiveFailFor(t):(e=_Y.stackObjectValue(0),_Y.failed()?_Y.primitiveFailFor(OY):(r=!1,_3()!==KW&&((r=p0())?(v4(QY[zZ()],e),a4(OW)):a4(IW)),_Y.failed()?null:(w4(),_Y.pop(2),_Y.pushBool(!r),void(VY&&(J0(VX,1),J0(LY,_Y.ioMicroMSecs()-ZY))))))}function a3(){var e,t,r;return VY&&(ZY=_Y.ioMicroMSecs()),1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=q3(_Y.stackValue(1),LW))||0!==(e=T1(_Y.fetchPointerofObject(_U,WY)))?_Y.primitiveFailFor(e):J1(_Y.fetchPointerofObject($U,WY))?(0!==N$()&&(0==(d_()&pZ())&&M$(),O$(0)),t=_Y.stackObjectValue(0),r=o0(),XY?_Y.primitiveFailFor(ZV):(r&&x4(t),_Y.failed()?_Y.primitiveFailFor(mW):(r?a4(QW):($4(),L3(0),a4(JW)),w4(),_Y.pop(2),_Y.pushBool(!r),void(VY&&(J0(WX,1),J0(MY,_Y.ioMicroMSecs()-ZY)))))):_Y.primitiveFailFor(cW)}function b3(){var e,t,r;return VY&&(ZY=_Y.ioMicroMSecs()),1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(t=q3(_Y.stackValue(1),IW))?_Y.primitiveFailFor(t):(e=_Y.stackObjectValue(0),(r=n0())&&(v4($Y[v0()],e),w0(v0()+1)),_Y.failed()?_Y.primitiveFailFor(lW):(r?a4(PW):(a4(LW),O$(1),AZ(0),$4()),w4(),_Y.pop(2),_Y.pushBool(!r),void(VY&&(J0(XX,1),J0(NY,_Y.ioMicroMSecs()-ZY)))))}function c3(){var e,t,r,i,a,s,n,o;return 6!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(t=q3(_Y.stackValue(6),MW))?_Y.primitiveFailFor(t):(o=_Y.positive32BitValueOf(_Y.stackValue(0)),n=_Y.positive32BitValueOf(_Y.stackValue(1)),s=_Y.stackIntegerValue(2),a=_Y.stackIntegerValue(3),i=_Y.stackIntegerValue(4),r=_Y.stackIntegerValue(5),_Y.failed()?_Y.primitiveFailFor(OY):KZ(PV)?V0(n)&&V0(o)?(dZ=(e=dZ)+PV,r2(e,wW),p2(e,PV),n2(e,r),x_(e,i),z_(e,a),B_(e,s),p_(e,R4(n)),t_(e,R4(o)),XY?_Y.primitiveFailFor(ZV):void(_Y.failed()||(w4(),_Y.pop(6)))):_Y.primitiveFailFor(mW):_Y.primitiveFailFor(kW))}function d3(){var e,t,r;if(1!==_Y.methodArgumentCount())return _Y.primitiveFailFor(PY);if(0!==(e=q3(_Y.stackValue(1),MW)))return _Y.primitiveFailFor(e);if(r=_Y.stackIntegerValue(0),_Y.failed())return _Y.primitiveFailFor(OY);for(t=0;0===t;){if(!KZ(PV))return _Y.primitiveFailFor(kW);dZ=(t=dZ)+QV,r2(t,yW),p2(t,QV),n2(t,r)}_Y.failed()||(w4(),_Y.pop(2),_Y.pushInteger(t))}function e3(){var e;return 0!==(e=R1())?_Y.primitiveFailFor(e):(o3(),XY?y4():(function(){var e;for(;!r0();){if(VY&&(ZY=_Y.ioMicroMSecs()),e=n0(),VY&&(J0(XX,1),J0(NY,_Y.ioMicroMSecs()-ZY)),XY)return a4(IW);if(e)return a4(PW),s4(XW);if(AZ(0),$4(),O$(1),VY&&(ZY=_Y.ioMicroMSecs()),0!==N$()&&0==(d_()&pZ())&&M$(),O$(0),e=o0(),VY&&(J0(WX,1),J0(MY,_Y.ioMicroMSecs()-ZY)),XY)return a4(LW);if(e)return a4(QW),s4(WW);if($4(),L3(0),VY&&(ZY=_Y.ioMicroMSecs()),(d_()&pZ())===pZ()&&(l_(d_()),x2()),VY&&(J0(RX,1),J0(HY,_Y.ioMicroMSecs()-ZY)),XY)return a4(JW);if(r0())return;if(AZ(0),e_(d_()+1),VY&&(ZY=_Y.ioMicroMSecs()),e=p0(),VY&&(J0(VX,1),J0(LY,_Y.ioMicroMSecs()-ZY)),XY)return a4(NW);if(e)return a4(OW),s4(UW)}}(),void y4()))}function f3(){var e;if(0!==(e=R1()))return _Y.primitiveFailFor(e);o3(),y4()}function g3(){var e,t;return 1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=q3(_Y.stackValue(1),MW))?_Y.primitiveFailFor(e):(t=_Y.stackIntegerValue(0),_Y.failed()?_Y.primitiveFailFor(OY):(D3(t),w4(),void _Y.pop(1)))}function h3(){var e,t,r;if(t=_Y.stackValue(0),!_Y.isBytes(t))return _Y.primitiveFail();if(256<=((r=t).bytes?r.bytes.length:r.words?4*r.words.length:0))return _Y.primitiveFail();t.bytes,e=!1;var i=t.bytesAsString();if(i!==RY&&(RY=i,e=!0),e&&!N0())return _Y.primitiveFail();_Y.pop(1)}function i3(){var e,t;return 1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=q3(_Y.stackValue(1),MW))?_Y.primitiveFailFor(e):(t=_Y.stackObjectValue(0),!_Y.failed()&&_Y.isPointers(t)&&2<=QU(t)?(O1(t2(),_Y.fetchPointerofObject(0,t)),O1(u2(),_Y.fetchPointerofObject(1,t)),_Y.failed()?_Y.primitiveFailFor(OY):(U$(t2()[0]),W$(t2()[1]),Q$(u2()[0]),S$(u2()[1]),w4(),void _Y.pop(1))):_Y.primitiveFailFor(OY))}function j3(){var e,t,r,i;return 1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=q3(_Y.stackValue(1),MW))?_Y.primitiveFailFor(e):(t=_Y.stackObjectValue(0),_Y.failed()?_Y.primitiveFailFor(OY):(r=t,i=X$(),E0(0),U1(r,i,8)&&(E0(1),i[1]=256*i[1],i[3]=256*i[3],i[5]=256*i[5],i[7]=256*i[7]),_Y.failed()?_Y.primitiveFailFor(aW):(w4(),void _Y.pop(1))))}function k3(){var e,t;return 1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(t=q3(_Y.stackValue(1),MW))?_Y.primitiveFailFor(t):(e=_Y.stackIntegerValue(0),_Y.failed()?_Y.primitiveFailFor(OY):(g_(e),w4(),void _Y.pop(1)))}function l3(){var e,t,r,i,a;return 1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=q3(_Y.stackValue(1),MW))?_Y.primitiveFailFor(e):(t=_Y.stackObjectValue(0),_Y.failed()?_Y.primitiveFailFor(OY):(r=t,H0(0),i=U1(r,a=u_(),6),!_Y.failed()&&i&&(H0(1),a[2]=a[2]+h_(),a[5]=a[5]+j_()),_Y.failed()?_Y.primitiveFailFor(OY):(w4(),void _Y.pop(1))))}function m3(){var e,t,r,i;return 1!==_Y.methodArgumentCount()?_Y.primitiveFailFor(PY):0!==(e=q3(_Y.stackValue(1),MW))?_Y.primitiveFailFor(e):PU(t=_Y.stackValue(0))!==_Y.classPoint()?_Y.primitiveFailFor(OY):(O1(t2(),t),_Y.failed()?_Y.primitiveFailFor(OY):(r=t2()[0],fZ[$X]=r,i=t2()[1],fZ[_X]=i,w4(),void _Y.pop(1)))}function o3(){var e,t;if((t=_3())===MW){if(O0(),XY)return;t=IW}if(t===IW){if(VY&&(ZY=_Y.ioMicroMSecs()),e=n0(),VY&&(J0(XX,1),J0(NY,_Y.ioMicroMSecs()-ZY)),XY)return a4(IW);if(e)return a4(PW),s4(XW);AZ(0),$4(),O$(1),t=LW}if(t===LW){if(VY&&(ZY=_Y.ioMicroMSecs()),0!==N$()&&0==(d_()&pZ())&&M$(),O$(0),e=o0(),VY&&(J0(WX,1),J0(MY,_Y.ioMicroMSecs()-ZY)),XY)return a4(LW);if(e)return a4(QW),s4(WW);t=JW,$4(),L3(0)}if(t===JW){if(VY&&(ZY=_Y.ioMicroMSecs()),(d_()&pZ())===pZ()&&(l_(d_()),x2()),VY&&(J0(RX,1),J0(HY,_Y.ioMicroMSecs()-ZY)),XY)return a4(JW);if(r0())return;t=NW,AZ(0),e_(d_()+1)}if(t===NW){if(VY&&(ZY=_Y.ioMicroMSecs()),e=p0(),VY&&(J0(VX,1),J0(LY,_Y.ioMicroMSecs()-ZY)),XY)return a4(NW);if(e)return a4(OW),s4(UW);a4(IW)}}function p3(e){var t;return _Y.failed()?SV:"number"==typeof e?XV:_Y.isPointers(e)?QU(e)<YU?$V:(WY=e,0!==(t=Y1(_Y.fetchPointerofObject(aV,e)))?t:(u4(0),dZ=j2(),XY=!1,0)):YV}function q3(e,t){var r;return 0!==(r=p3(e))?r:_3()===t?0:(u4(VW),nW)}function s3(e){if(0!==Y3())for(;Q4()<=e;)if(I0(J4(),I4()),0===Y3())return}function v3(){var e;for(e=zZ(),CZ(BZ()-1);e<BZ();)QY[e]=QY[e+1],++e}function w3(e,t){var r;for(r=e;r<0;)r+=t;for(;t<=r;)r-=t;return r}function y3(){var e,t;0!==zZ()&&(t=w_(e=QY[zZ()]),w_(QY[zZ()-1])<=t||function(e,t,r){var i;for(i=e;0<i&&w_(QY[i-1])>r;)QY[i]=QY[i-1],--i;QY[i]=t}(zZ(),e,t))}function z3(){return TY=f2(UY,LV)}function A3(){return TY=f2(UY,OV)}function B3(){return TY=f2(UY,qX)}function D3(e){var t,r,i,a;4<=e&&(t=4),2<=e&&e<4&&(t=2),e<2&&(t=1),r=t,fZ[zX]=r,1===t&&(sZ(0),hZ(4294967295),qZ(0)),2===t&&(sZ(1),hZ(4244438268),qZ(1)),4===t&&(sZ(2),hZ(4042322160),qZ(3)),i=2*rZ(),fZ[xX]=i,a=rZ(),fZ[yX]=a}function E3(e){return!1!=((_Y=e).majorVersion()==NU)&&_Y.minorVersion()>=OU}function F3(e,t){return(0|t[e])>>>16}function G3(e,t){return 65535&(0|t[e])}function H3(e,t,r){MZ()&&($3(0,e),U3(0,t),X3(0,r),3!==Y3()&&k0(0,Y3()-3)&&($3(0,O4()),U3(0,K4()),X3(0,M4()),P4(e),L4(t),N4(r)))}function K3(){return fZ[AY]}function L3(e){return fZ[AY]=e}function M3(){return fZ[zY]}function N3(e){return fZ[zY]=e}function O3(){return fZ[BY]}function Q3(){return fZ[CY]}function R3(e){return fZ[CY]=e}function S3(e,t){return e*e+t*t}function T3(e){return c5(e+1)}function U3(e,t){return d5(e+1,t)}function W3(e){return c5(e+2)}function X3(e,t){return d5(e+2,t)}function Y3(){return b5()}function Z3(e){return c5(e)}function $3(e,t){return d5(e,t)}function _3(){return fZ[DY]}function a4(e){return fZ[DY]=e}function c4(e,t){var r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S;if(!Z0(e)&&t>=TZ(e))return r_(e,0);m=w_(e),b=y_(e),g=f2(e,GV),k=f2(e,HV),u=2*(g-m),l=m+RZ(e)-2*g,c=2*(k-b),h=b+(i=TZ(e))-2*k,(f=2*(r=i-b))<2&&(f=2),p=SU(16777216,f),n=u*(_=p),n+=(a=l*(d=((y=65535&_)*y>>>16)+y*(S=_>>>16&255)*2+(S*S<<16)>>>8)*2)>>1,o=c*p,o+=(s=h*d*2)>>1,r_(e,r),(v=XZ(e))[EV]=256*m,v[FV]=256*b,v[BV]=n,v[CV]=o,v[zV]=a,v[AV]=s,(b=y_(e))!==t&&(l4(e,t),r_(e,r-(t-b)))}function e4(e,t){var r,i,a,s,n,o,u,l,c,h,f;if(!Z0(e)&&t>=i1(e))return r_(e,0);if(r=g1(e)-w_(e),i=i1(e)-y_(e),a=0<=r?(l=1,u=r,0):(l=-1,u=0-r,1-i),s=0==i?(c=r,a=0):u<i?(c=0,u):(c=SU(u,i)*l,(h=u)-SU(h,f=i)*f|0),r_(e,i),g2(e,tX,l),g2(e,uX,c),p1(e,a),g2(e,mX,s),g2(e,lX,i),(o=y_(e))!==t){for(n=o;n<=t-1;n++)n4(e);r_(e,i-(t-o))}}function k4(e,t){var r,i,a,s,n;for(a=e[EV],s=e[FV],r=e[BV],i=e[CV],n=256*t;s<n&&0<=i;)a+=r+32768>>16,s+=i+32768>>16,r+=e[zV],i+=e[AV];return e[EV]=a,e[FV]=s,e[BV]=r,e[CV]=i,a>>8}function l4(e,t){x_(e,k4(XZ(e),t))}function n4(e){var t,r;r=w_(e)+s1(e),0<(t=f2(e,kX)+f2(e,mX))&&(r+=q1(e),t-=f2(e,lX)),p1(e,t),x_(e,r)}function p4(e,t){var r,i,a,s;r=s2(i=k5(e)),a=f2(e,IV)+1,s=f2(e,JV)+1,h5(e,a),j5(e,s),r<=a&&n_(e),0<=s&&m_(e),s+r<0?k4(XZ(e),t):XZ(e)[EV]=256*VZ(e),k4(o5(e),t),_$(e,i)}function r4(e){var t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b;s=r5(e)+1,n=t5(e)+1,s5(e,s),u5(e,n),(r=s2(i=v5(e)))<=s&&n_(e),0<=n&&m_(e),t=w_(e),n4(e),a=w_(e),(s<=i||0<=n+r)&&(u=t,l=a,m=r5(o=e),b=t5(o),f=s2(c=v5(o)),p=z5(o),d=q1(o),h=l-u,m<c&&(d<0?p-=h:(p+=h,x_(o,u))),b+f===0&&(0<d?p-=s1(o):(p+=s1(o),x_(o,u))),0<b+f&&(d<0?(p+=h,x_(o,u)):p-=h),A5(o,p))}function s4(e){u4(e),XY=!0}function t4(){return fZ[EY]}function u4(e){return fZ[EY]=e}function v4(e,t){if(QU(t)<bV)return _Y.primitiveFail();var r;_Y.storeIntegerofObjectwithValue(cV,t,m2(e)),_Y.storeIntegerofObjectwithValue(eV,t,w_(e)),_Y.storeIntegerofObjectwithValue(fV,t,d_()),_Y.storeIntegerofObjectwithValue(gV,t,A_(e)),_Y.storeIntegerofObjectwithValue(dV,t,q_(e)),r=e,fZ[kY]=r}function w4(){k2(dZ)}function x4(e){var t,r,i;if(t=a1(),r=c1(),i=e1(),QU(e)<hV)return _Y.primitiveFail();_Y.storeIntegerofObjectwithValue(iV,e,m2(t)),_Y.storeIntegerofObjectwithValue(kV,e,r),_Y.storeIntegerofObjectwithValue(jV,e,i),_Y.storeIntegerofObjectwithValue(lV,e,d_())}function y4(){if(_Y.failed())return null;XY&&function(e,t){var r;(r=t4())===XW&&(v4($Y[v0()],e),w0(v0()+1));r===WW&&x4(t);r===UW&&v4(QY[zZ()],e)}(_Y.stackObjectValue(1),_Y.stackObjectValue(0)),w4(),_Y.pop(3),_Y.pushInteger(t4())}function B4(e){var t,r,i,a,s,n,o,u,l;return l=v$(a=e),(i=(o=r$(a))===l?a:((n=o-l)<0&&(n=0-n),255<n?(J0(EX,1),$$(a)):(u=t$(a),(s=p$(a)-u)<0&&(s=0-s),32*n<s?(J0(HX,1),$$(a)):a)))!==e?(t=B4(e),XY?0:(r=B4(i),XY?0:r<=t?t:r)):e}function D4(e){var t,r,i,a,s,n;return s=t$(e),0<=(r=(n=x$(e))-s)*(i=p$(e)-n)?e:(J0(GX,1),(a=r)<0&&(a=0-a),(t=i-r)<0&&(t=0-t),Z$(e,a/t))}function F4(e,t,r){0===Y3()?MZ()&&(P4(e),L4(t),N4(r)):I0(e,t)||H3(e,t,r)}function G4(e){var t,r;b2(6)&&(t=A_(e)<<1,0!==(r=f2(e,oW))&&F4(r,t,999999999),0!==(r=f2(e,pW))&&F4(r,t,999999999),s3(w_(e)))}function H4(e){var t,r,i,a,s,n;switch(n=q2(e)>>>1,UY=e,n){case 0:case 1:break;case 2:TY=z5(UY);break;case 3:A3()}switch(a=TY,n){case 0:case 1:break;case 2:B3();break;case 3:z3()}0!==(r=TY)&&b2(3)&&(t=1+(A_(e)<<1),s=w_(e)+a,-1===(i=q0(r,t))?H3(r,t,s):W3(i)<s&&X3(i,s),s3(w_(e)))}function I4(){return 0===Y3()?-1:K4()}function J4(){return 0===Y3()?0:O4()}function K4(){return T3(Y3()-3)}function L4(e){return U3(Y3()-3,e)}function M4(){return W3(Y3()-3)}function N4(e){return X3(Y3()-3,e)}function O4(){return Z3(Y3()-3)}function P4(e){return $3(Y3()-3,e)}function Q4(){return 0===Y3()?999999999:M4()}function R4(e){var t,r,i,a,s,n;return 0===e||U0(e)?(i=255&e,a=e>>>8&255,s=e>>>16&255,t=e>>>24&255,C0()&&(r=(t*(n=X$())[6]+n[7])/t,s=(s*n[0]+n[1])*r|0,a=(a*n[2]+n[3])*r|0,i=(i*n[4]+n[5])*r|0,t=t*r|0,s=Math.max(s,0),s=Math.min(s,255),a=Math.max(a,0),a=Math.min(a,255),i=Math.max(i,0),i=Math.min(i,255),t=Math.max(t,0),t=Math.min(t,255)),t<1?0:(t<255&&c2()&&s4(YW),i+(a<<8)+(s<<16)+(t<<24))):e}function S4(e){var t,r;F0()?(r=t=e,function(e,t,r){var i,a,s;i=u_(),a=(i[0]*e+i[1]*t+i[2])*nZ()|0,s=(i[3]*e+i[4]*t+i[5])*nZ()|0,r[0]=a,r[1]=s}(0|t[0],0|t[1],r)):(e[0]=(e[0]+h_())*nZ(),e[1]=(e[1]+j_())*nZ())}function V4(e){0<e&&S4(t2()),1<e&&S4(u2()),2<e&&S4(v2()),3<e&&S4(w2())}function W4(e){var t,r,i,a;return 0===e?0:(t2()[0]=0,t2()[1]=0,u2()[0]=256*e,u2()[1]=0,v2()[0]=0,v2()[1]=256*e,V4(3),t=u2()[0]-t2()[0],r=u2()[1]-t2()[1],i=128+(0|Math.sqrt(t*t+r*r))>>8,t=v2()[0]-t2()[0],r=v2()[1]-t2()[1],(a=128+(0|Math.sqrt(t*t+r*r))>>8)<i&&(i=a),0===i?1:i)}function X4(e){var t,r,i,a,s;return C0()?(r=255&e,i=e>>>8&255,t=e>>>24&255,a=(a=e>>>16&255)*(s=X$())[0]+s[1]|0,i=i*s[2]+s[3]|0,r=r*s[4]+s[5]|0,t=t*s[6]+s[7]|0,a=Math.max(a,0),a=Math.min(a,255),i=Math.max(i,0),i=Math.min(i,255),r=Math.max(r,0),r=Math.min(r,255),t=Math.max(t,0),(t=Math.min(t,255))<16?0:r+(i<<8)+(a<<16)+(t<<24)):e}function Y4(){return fZ[yY]}function $4(){f5(Y4())}function a5(e){return!!b2(e)&&(f5(e5()-e),!0)}function b5(){return Y4()-e5()}function c5(e){return fZ[e5()+e]}function d5(e,t){return fZ[e5()+e]=t}function e5(){return fZ[IX]}function f5(e){return fZ[IX]=e}function h5(e,t){return g2(e,IV,t)}function j5(e,t){return g2(e,JV,t)}function k5(e){return f2(e,KV)}function o5(e){return WU(cZ,e+NV)}function q5(e,t){return g2(e,OV,t)}function r5(e){return f2(e,nX)}function s5(e,t){return g2(e,nX,t)}function t5(e){return f2(e,oX)}function u5(e,t){return g2(e,oX,t)}function v5(e){return f2(e,pX)}function z5(e){return f2(e,sX)}function A5(e,t){return g2(e,sX,t)}function B5(e){fZ=e.wordsAsInt32Array()}function ita(e){return"number"==typeof e?Pua.classSmallInteger():e.sqClass}function jta(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function kta(e){return e.bytes?e.bytes.length:e.words?4*e.words.length:0}function lta(e,t){return 0|Math.floor(e/t)}function nta(e,t){return 31<t?0:e<<t}function ota(e,t){return 31<t?0:e>>>t}function pta(e,t){return t<0?t<-31?0:e>>>0-t:31<t?0:e<<t}function Ava(e,t){var r,i;if(qua<16){for(r=e^t,i=Uua[qua];0!==r;)0!=(r&i)&&++aua,r=ota(r,qua);return t}return aua=16===qua?(r=Pwa(e,t,5,3),aua=aua+(31&r)+(r>>>5&31)+(r>>>10&31),r=Pwa(e>>>16,t>>>16,5,3),aua+(31&r)+(r>>>5&31)+(r>>>10&31)):(r=Pwa(e,t,8,3),aua+(255&r)+(r>>>8&255)+(r>>>16&255)),t}function Bva(e,t){var r,i,a,s;if((gua&(Mta|Kta))!=(Mta|Kta))return t;if(qua<16){for(r=Uua[qua]&iua,s=t,a=1;a<=wua;a++)Bxa(i=s&r,Axa(i)+1),s=ota(s,qua);return t}return 16===qua?(Bxa(i=lxa(65535&t,5,fua),Axa(i)+1),Bxa(i=lxa(t>>>16,5,fua),Axa(i)+1)):Bxa(i=lxa(t,8,fua),Axa(i)+1),t}function Cva(e,t){return e+t}function Dva(e,t){var r,i,a,s;return 0==(s=e>>>24)?t:255==s?e:(i=(i=(16711935&e)*s+(16711935&t)*(r=255-s)+16711935)+(i-65537>>>8&16711935)>>>8&16711935)|(a=(a=(16711935&(e>>>8|16711680))*s+(t>>>8&16711935)*r+16711935)+(a-65537>>>8&16711935)>>>8&16711935)<<8}function Eva(e,t){return Fva(e,t,!1)}function Fva(e,t,r){var i,a,s,n,o,u,l,c,h,f,p,d,m,b;if(qua<16)return t;if(h=255-bva,o=t,1===wua)r&&0===e||(o=(p=(p=(16711935&e)*bva+(16711935&t)*h+16711935)+(p-65537>>>8&16711935)>>>8&16711935)|(d=(d=(e>>>8&16711935)*bva+(t>>>8&16711935)*h+16711935)+(d-65537>>>8&16711935)>>>8&16711935)<<8);else for(i=Uua[qua],b=vua,m=t,n=e,s=1;s<=wua;s++){if(l=n&i,!(0==(b&i)||r&&0==l)){for(f=m&i,a=0,c=1;c<=3;c++)a|=nta(31&lta((31&ota(l,u=5*(c-1)))*bva+(31&ota(f,u))*h+254,255),u);o=o&~nta(i,16*(s-1))|nta(a,16*(s-1))}b=ota(b,qua),n=ota(n,qua),m=ota(m,qua)}return o}function Gva(e,t){var r,i,a;return(a=(16711935&(a=((t>>>8&16711935)*(r=255-(e>>>24))>>>8&16711935)+(e>>>8&16711935)))<<8|255*(16777472&a))|(i=16711935&(i=((16711935&t)*r>>>8&16711935)+(16711935&e))|255*(16777472&i)>>>8)}function Hva(e,t){return 0===e?t:Fva(e,t,!0)}function Lva(e,t){return e&t}function Mva(e,t){return e&~t}function Nva(e,t){return~e&t}function Ova(e,t){return~e&~t}function Pva(e,t){return~t}function Qva(e,t){return~e|t}function Rva(e,t){return~e|~t}function Sva(e,t){return~e}function Tva(e,t){return~e^t}function Uva(e,t){return e|t}function Vva(e,t){return e|~t}function Wva(e,t){return e^t}function Yva(e,t){return 0}function Zva(){dua<=zua?(pva=mva,Gua=zua,$ta=zva):(pva=mva+(dua-zua),$ta=zva-(dua-zua),Gua=dua),dua+cua<Gua+$ta&&($ta-=Gua+$ta-(dua+cua)),eua<=Aua?(qva=nva,Hua=Aua,Zta=Oua):(qva=nva+eua-Aua,Zta=Oua-(eua-Aua),Hua=eua),eua+bua<Hua+Zta&&(Zta-=Hua+Zta-(eua+bua)),Yua||(pva<0&&(Gua-=pva,$ta+=pva,pva=0),lva<pva+$ta&&($ta-=pva+$ta-lva),qva<0&&(Hua-=qva,Zta+=qva,qva=0),gva<qva+Zta&&(Zta-=qva+Zta-gva))}function $va(){return Zva(),$ta<=0||Zta<=0?(Wta=Xta=Yta=Vta=0,null):Gwa()?(function(){if(function(){var e,t;if(41===lua)if(mua=255,nua=16777215,rva=Iua=null,2<=Pua.methodArgumentCount()){if(mua=Pua.stackIntegerValue(Pua.methodArgumentCount()-2),Pua.failed())return Pua.primitiveFail();if(nua=Pua.stackIntegerValue(Pua.methodArgumentCount()-1),Pua.failed())return Pua.primitiveFail();4===Pua.methodArgumentCount()&&(t=Pua.stackObjectValue(1),Pua.isBytes(t)&&(Iua=t.bytes),e=Pua.stackObjectValue(0),Pua.isBytes(e)&&(rva=e.bytes))}else{if(1!==Pua.methodArgumentCount())return Pua.primitiveFail();if(nua=Pua.stackIntegerValue(0),Pua.failed())Pua.primitiveFail()}}(),Pua.failed())return Pua.primitiveFail();if(function(){if(Yua)return!1;if(34!==lua&&41!==lua)return!1;if(32!==eva)return!1;if(fva===rua)return!1;if(41===lua)return 32===qua?(function(){var e,t,r,i,a,s,n,o;a=Zta+1,s=qva,o=Hua;for(;0!=--a;){for(t=s*kva+4*pva,i=o*xua+4*Gua,r=$ta+1;0!=--r;)if(e=cva[t>>>2],0==(16777215&e)){for(t+=4,i+=4;0!=--r&&0==(16777215&(e=cva[t>>>2]));)t+=4,i+=4;++r}else n=oua[i>>>2],n=fxa(e,n),oua[i>>>2]=n,t+=4,i+=4;++s,++o}}(),Xta=(Wta=Gua)+$ta,Vta=(Yta=Hua)+Zta,!0):16===qua?(function(){var e,t,r,i,a,s,n,o,u,l,c,h,f;u=Zta+1,l=qva,h=Hua,r=16*(1&Gua),uua&&(r=16-r);Sua=nta(65535,16-r);for(;0!=--u;){for(a=l*kva+4*pva,n=h*xua+4*(Gua>>1),e=4*(3&h),f=(3&pva)-1,s=$ta+1,r=65535===(o=Sua)?16:0;0!=--s;)t=Cua[e+(f=f+1&3)],i=cva[a>>>2],0!=(16777215&i)&&(c=oua[n>>>2],c=ota(c&=~o,r),i=nta(0===(i=jwa(i=fxa(i,c=(31744&c)<<9|(992&c)<<6|(31&c)<<3|4278190080),t))?1:i,r),lwa(n,i,o)),a+=4,uua?0===r&&(n+=4):0!==r&&(n+=4),r^=16,o=~o;++l,++h}}(),Xta=(Wta=Gua)+$ta,Vta=(Yta=Hua)+Zta,!0):8===qua&&(function(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p;a=fwa(),o=gua&~Lta,c=Zta+1,h=qva,Sua=8*(3&Gua),uua&&(Sua=24-Sua);Tua=qta^nta(255,Sua),n=0==(1&Gua)?0:522133279;0==(1&(p=Hua))&&(n^=522133279);for(;0!=--c;){for(n^=522133279,r=h*kva+4*pva,s=p*xua+4*(Gua>>2),i=$ta+1,e=Sua,l=Tua;0!=--i;)t=(cva[r>>>2]&~n)+n,31<(u=lta(((u=16777215&t)>>>16)+(u>>>8&255)+(255&u),3))&&(224<u&&(t=4294967295),f=oua[s>>>2],f=ota(f&=~l,e),f=a[f],t=nta(t=Hwa(t=fxa(t,f),o),e),lwa(s,t,l)),r+=4,l=uua?0===e?(s+=4,e=24,16777215):(e-=8,l>>>8|4278190080):32===e?(s+=4,e=0,4294967040):(e+=8,l<<8|255),n^=522133279;++h,++p}}(),Xta=(Wta=Gua)+$ta,Vta=(Yta=Hua)+Zta,!0);if(qua<8)return!1;if(8===qua&&0==(gua&Mta))return!1;32===qua&&function(){var e,t,r,i,a,s,n,o,u;for(s=Zta+1,n=qva,u=Hua;0!=--s;){for(t=n*kva+4*pva,i=u*xua+4*Gua,r=$ta+1;0!=--r;)if(255==(a=(e=cva[t>>>2])>>>24)){for(oua[i>>>2]=e,t+=4,i+=4;0!=--r&&(e=cva[t>>>2])>>>24==255;)oua[i>>>2]=e,t+=4,i+=4;++r}else if(0==a){for(t+=4,i+=4;0!=--r&&(e=cva[t>>>2])>>>24==0;)t+=4,i+=4;++r}else o=Gva(e,o=oua[i>>>2]),oua[i>>>2]=o,t+=4,i+=4;++n,++u}}();16===qua&&function(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p;for(l=Zta+1,c=qva,f=Hua,r=16*(1&Gua),uua&&(r=16-r),Sua=nta(65535,16-r);0!=--l;){for(a=c*kva+4*pva,n=f*xua+4*(Gua>>1),e=4*(3&f),p=(3&pva)-1,s=$ta+1,r=65535===(u=Sua)?16:0;0!=--s;)t=Cua[e+(p=p+1&3)],255==(o=(i=cva[a>>>2])>>>24)?lwa(n,i=nta(0===(i=jwa(i,t))?1:i,r),u):0!=o&&(h=oua[n>>>2],lwa(n,i=nta(0===(i=jwa(i=Gva(i,h=(31744&(h=ota(h&=~u,r)))<<9|(992&h)<<6|(31&h)<<3|4278190080),t))?1:i,r),u)),a+=4,uua?0===r&&(n+=4):0!==r&&(n+=4),r^=16,u=~u;++c,++f}}();8===qua&&function(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p;for(a=fwa(),o=gua&~Lta,c=Zta+1,h=qva,Sua=8*(3&Gua),uua&&(Sua=24-Sua),Tua=qta^nta(255,Sua),n=0==(1&Gua)?0:522133279,0==(1&(p=Hua))&&(n^=522133279);0!=--c;){for(n^=522133279,r=h*kva+4*pva,s=p*xua+4*(Gua>>2),i=$ta+1,e=Sua,l=Tua;0!=--i;)31<(u=(t=(cva[r>>>2]&~n)+n)>>>24)&&(u<224&&(f=oua[s>>>2],t=Gva(t,f=a[f=ota(f&=~l,e)])),lwa(s,t=nta(t=Hwa(t,o),e),l)),r+=4,l=uua?0===e?(s+=4,e=24,16777215):(e-=8,l>>>8|4278190080):24===e?(s+=4,e=0,4294967040):(e+=8,l<<8|255),n^=522133279;++h,++p}}();return Xta=(Wta=Gua)+$ta,Vta=(Yta=Hua)+Zta,!0}())return;if(30===lua||31===lua){if(1!==Pua.methodArgumentCount())return Pua.primitiveFail();if(bva=Pua.stackIntegerValue(0),!(!Pua.failed()&&0<=bva&&bva<=255))return Pua.primitiveFail()}aua=0,hwa(),Yua?function(){var e,t,r,i,a,s;for(r=Zua[lua+1],s=1;s<=Zta;s++){if(t=Xua?qta:rwa(Hua+s-1),vua=Sua,i=oua[tua>>>2],e=r(t,i),i=vua&e|i&~vua,oua[tua>>>2]=i,tua+=4,vua=qta,3===lua)for(i=t,a=2;a<=Wua-1;a++)oua[tua>>>2]=i,tua+=4;else for(a=2;a<=Wua-1;a++)i=oua[tua>>>2],e=r(t,i),oua[tua>>>2]=e,tua+=4;1<Wua&&(vua=Tua,i=oua[tua>>>2],e=r(t,i),i=vua&e|i&~vua,oua[tua>>>2]=i,tua+=4),tua+=pua}}():(function(){var e;fva===rua&&qva<=Hua&&(qva<Hua?(tva=-1,qva=qva+Zta-1,Hua=Hua+Zta-1):Hua===qva&&pva<Gua&&(Jua=-1,pva=pva+$ta-1,Gua=Gua+$ta-1,1<Wua&&(e=Sua,Sua=Tua,Tua=e)),tua=Hua*xua+4*lta(Gua,wua),pua=xua*tva-Wua*Jua*4)}(),eva!==qua||0!==gua||iva!==uua?ewa():(function(){var e,t,r,i;t=pva&(i=wua-1),e=Gua&i,$ua=0<Jua?(r=Math.min($ta,wua-e),i<t+r):(r=Math.min($ta,1+e),t-r+1<0);ava=iva?(t-e)*qua:(e-t)*qua;$ua&&(ava<0?ava+=32:ava-=32);hva=qva*kva+4*lta(pva,lta(32,eva)),dva=kva*tva-Wua*Jua*4,$ua&&(dva-=4*Jua)}(),function(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p;s=Zua[lua+1],n=4*Jua,-32===ava?ava=a=r=0:r=ava<0?(a=ava+32,nta(qta,0-ava)):0===ava?(a=0,qta):(a=ava-32,ota(qta,ava));p=~r,Xua?(i=qta,Mua=0):i=rwa(0);for(c=Hua,h=1;h<=Zta;h++){if(1<Mua&&(i=rwa(c),c+=tva),$ua?(l=cva[hva>>>2],hva+=n):l=0,vua=Sua,f=cva[hva>>>2],hva+=n,t=pta(l&p,a)|pta(f&r,ava),l=f,o=oua[tua>>>2],e=s(t&i,o),o=vua&e|o&~vua,oua[tua>>>2]=o,tua+=n,vua=qta,3===lua)if(0===ava&&i===qta)if(-1===Jua)for(u=2;u<=Wua-1;u++)f=cva[hva>>>2],hva+=n,oua[tua>>>2]=f,tua+=n;else for(u=2;u<=Wua-1;u++)oua[tua>>>2]=l,tua+=n,l=cva[hva>>>2],hva+=n;else for(u=2;u<=Wua-1;u++)f=cva[hva>>>2],hva+=n,t=pta(l&p,a)|pta(f&r,ava),l=f,oua[tua>>>2]=t&i,tua+=n;else for(u=2;u<=Wua-1;u++)f=cva[hva>>>2],hva+=n,t=pta(l&p,a)|pta(f&r,ava),l=f,e=s(t&i,oua[tua>>>2]),oua[tua>>>2]=e,tua+=n;1<Wua&&(vua=Tua,f=cva[hva>>>2],hva+=n,t=pta(l&p,a)|pta(f&r,ava),o=oua[tua>>>2],e=s(t&i,o),o=vua&e|o&~vua,oua[tua>>>2]=o,tua+=n),hva+=dva,tua+=pua}}())),22!==lua&&32!==lua||(Wta=Xta=Yta=Vta=0);Xta=0<Jua?(Wta=Gua)+$ta:(Wta=Gua-$ta+1,Gua+1);Vta=0<tva?(Yta=Hua)+Zta:(Yta=Hua-Zta+1,Hua+1)}(),void Dxa()):Pua.primitiveFail()}function _va(e,t,r){Aua=r,zva=t-(mva=zua=e),$va(),vxa()}function ewa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k;for(l=Zua[lua+1],jva=lta(32,eva),i=Uua[eva],d=Uua[qua],e=gua&~Lta,hva=qva*kva+4*lta(pva,jva),a=$ta<(k=jva-(pva&jva-1))?0:lta($ta-k,jva)+1,dva=kva-4*a,v=1+(Gua+$ta-1&wua-1),$ta<(u=wua-(Gua&wua-1))&&(u=$ta),b=(pva&jva-1)*eva,c=(Gua&wua-1)*qua,t=eva,m=qua,r=0,iva&&(b=32-eva-b,t=0-t),uua&&(c=32-qua-c,m=0-m,r=32-qua),h=1;h<=Zta;h++){for(f=Xua?qta:rwa(Hua+h-1),ova=b,Fua=c,vua=Sua,g=u,n=Wua;s=Rwa(g,e,i,d,t,m),Fua=r,vua===qta?(p=l(s&f,oua[tua>>>2]),oua[tua>>>2]=vua&p):(p=l(s&f,(o=oua[tua>>>2])&vua),o=vua&p|o&~vua,oua[tua>>>2]=o),tua+=4,g=2===n?(vua=Tua,v):(vua=qta,wua),0!=--n;);hva+=dva,tua+=pua}}function fwa(){return[0,4278190081,4294967295,4286611584,4294901760,4278255360,4278190335,4278255615,4294967040,4294902015,4280295456,4282400832,4284506208,4288651167,4290756543,4292861919,4278716424,4279242768,4279769112,4280821800,4281348144,4281874488,4282927176,4283453520,4283979864,4285032552,4285558896,4286085240,4287072135,4287598479,4288124823,4289177511,4289703855,4290230199,4291282887,4291809231,4292335575,4293388263,4293914607,4294440951,4278190081,4278203136,4278216192,4278229248,4278242304,4278255360,4278190131,4278203187,4278216243,4278229299,4278242355,4278255411,4278190182,4278203238,4278216294,4278229350,4278242406,4278255462,4278190233,4278203289,4278216345,4278229401,4278242457,4278255513,4278190284,4278203340,4278216396,4278229452,4278242508,4278255564,4278190335,4278203391,4278216447,4278229503,4278242559,4278255615,4281532416,4281545472,4281558528,4281571584,4281584640,4281597696,4281532467,4281545523,4281558579,4281571635,4281584691,4281597747,4281532518,4281545574,4281558630,4281571686,4281584742,4281597798,4281532569,4281545625,4281558681,4281571737,4281584793,4281597849,4281532620,4281545676,4281558732,4281571788,4281584844,4281597900,4281532671,4281545727,4281558783,4281571839,4281584895,4281597951,4284874752,4284887808,4284900864,4284913920,4284926976,4284940032,4284874803,4284887859,4284900915,4284913971,4284927027,4284940083,4284874854,4284887910,4284900966,4284914022,4284927078,4284940134,4284874905,4284887961,4284901017,4284914073,4284927129,4284940185,4284874956,4284888012,4284901068,4284914124,4284927180,4284940236,4284875007,4284888063,4284901119,4284914175,4284927231,4284940287,4288217088,4288230144,4288243200,4288256256,4288269312,4288282368,4288217139,4288230195,4288243251,4288256307,4288269363,4288282419,4288217190,4288230246,4288243302,4288256358,4288269414,4288282470,4288217241,4288230297,4288243353,4288256409,4288269465,4288282521,4288217292,4288230348,4288243404,4288256460,4288269516,4288282572,4288217343,4288230399,4288243455,4288256511,4288269567,4288282623,4291559424,4291572480,4291585536,4291598592,4291611648,4291624704,4291559475,4291572531,4291585587,4291598643,4291611699,4291624755,4291559526,4291572582,4291585638,4291598694,4291611750,4291624806,4291559577,4291572633,4291585689,4291598745,4291611801,4291624857,4291559628,4291572684,4291585740,4291598796,4291611852,4291624908,4291559679,4291572735,4291585791,4291598847,4291611903,4291624959,4294901760,4294914816,4294927872,4294940928,4294953984,4294967040,4294901811,4294914867,4294927923,4294940979,4294954035,4294967091,4294901862,4294914918,4294927974,4294941030,4294954086,4294967142,4294901913,4294914969,4294928025,4294941081,4294954137,4294967193,4294901964,4294915020,4294928076,4294941132,4294954188,4294967244,4294902015,4294915071,4294928127,4294941183,4294954239,4294967295]}function gwa(e,t,r){return e<t?lta(t-e+Nta,r+1)+1:t===e?0:0-(lta(e-t+Nta,r+1)+1)}function hwa(){var e,t;Sua=(uua?ota:nta)(qta,32-(e=wua-(Gua&(t=wua-1)))*qua),Tua=(uua?nta:ota)(qta,32-(1+(Gua+$ta-1&t))*qua),Wua=$ta<e?(Sua&=Tua,Tua=0,1):lta($ta-e+t,wua)+1,Jua=tva=1,tua=Hua*xua+4*lta(Gua,wua),pua=xua*tva-Wua*Jua*4}function iwa(e,t){return t}function jwa(e,t){var r;return(Bua[(r=t<<8)+(e>>>16&255)]<<10)+(Bua[r+(e>>>8&255)]<<5)+Bua[r+(255&e)]}function lwa(e,t,r){var i;i=oua[e>>>2],i&=r,i|=t,oua[e>>>2]=i}function nwa(e,t){var r,i;return"number"==typeof(i=Pua.fetchPointerofObject(e,t))?i:-2147483648<=(r=Pua.floatValueOf(i))&&r<=2147483647?0|r:(Pua.primitiveFail(),0)}function owa(e,t,r){var i,a;return"number"==typeof(a=Pua.fetchPointerofObject(e,t))?a:a.isNil?r:-2147483648<=(i=Pua.floatValueOf(a))&&i<=2147483647?0|i:(Pua.primitiveFail(),0)}function pwa(e,t){return 32!==qua?t:0===t?0:0!=(4278190080&t)?t:t|4278190080&e}function qwa(){return Vua}function rwa(e){return Kua[(t=e)-lta(t,r=Mua)*r|0];var t,r}function swa(e){return!!e.isNil||(0===lua||(5===lua||(10===lua||15===lua)))}function vwa(){return Zua[1]=Yva,Zua[2]=Lva,Zua[3]=Mva,Zua[4]=xxa,Zua[5]=Nva,Zua[6]=iwa,Zua[7]=Wva,Zua[8]=Uva,Zua[9]=Ova,Zua[10]=Tva,Zua[11]=Pva,Zua[12]=Vva,Zua[13]=Sva,Zua[14]=Qva,Zua[15]=Rva,Zua[16]=iwa,Zua[17]=iwa,Zua[18]=iwa,Zua[19]=Cva,Zua[20]=yxa,Zua[21]=cxa,Zua[22]=rxa,Zua[23]=Ava,Zua[24]=Bva,Zua[25]=Dva,Zua[26]=Vwa,Zua[27]=Uwa,Zua[28]=nxa,Zua[29]=oxa,Zua[30]=pxa,Zua[31]=Eva,Zua[32]=Hva,Zua[33]=ixa,Zua[34]=zxa,Zua[35]=Gva,Zua[36]=Gva,Zua[37]=Gva,Zua[38]=qxa,Zua[39]=Wwa,Zua[40]=Twa,Zua[41]=pwa,Zua[42]=hxa,function(){var e,t,r,i,a,s,n,o,u;for(t=0;t<=255;t++)for(e=0;e<=15;e++)a=e,u=o=n=s=void 0,n=Dua[7&(s=255&(i=t))],o=Eua[s>>>3],u=a<n?o+1:o,n=Dua[7&(s=i>>>8&255)],o=Eua[s>>>3],u|=a<n?o+1<<5:o<<5,n=Dua[7&(s=i>>>16&255)],o=Eua[s>>>3],r=u|=a<n?o+1<<10:o<<10,Bua[(e<<8)+t]=r}(),!0}function xwa(){var e;if(oua=Pua.fetchPointerofObject(Ota,rua),yua=Pua.fetchIntegerofObject(Rta,rua),sua=Pua.fetchIntegerofObject(Qta,rua),!(0<=yua&&0<=sua))return!1;if(qua=Pua.fetchIntegerofObject(Pta,rua),uua=0<qua,qua<0&&(qua=0-qua),"number"==typeof oua){if(!function(e){if(!_ua&&!Ewa())return;return _ua(e,function(e,t,r,i){yua=e,sua=t,qua=r,uua=i})}(oua))return!1;wua=lta(32,qua),oua=xua=0}else{if(wua=lta(32,qua),xua=4*lta(yua+(wua-1),wua),e=kta(oua),!Pua.isWordsOrBytes(oua)||e!==xua*sua){if(!(Pua.isWordsOrBytes(oua)&&xua*sua<e))return!1;Pua.vm.warnOnce("BitBlt>>loadBitBltDestForm: destBitsSize != destPitch * destHeight, expected "+xua+"*"+sua+"="+xua*sua+", got "+e)}oua=oua.wordsOrBytes()}return!0}function ywa(e){return zwa(e,!1)}function zwa(e,t){if(_ta=e,Qua=t,lua=Pua.fetchIntegerofObject(Cta,_ta),Pua.failed()||lua<0||Tta-2<lua)return!1;if(16<=lua&&lua<=17)return!1;if(fva=Pua.fetchPointerofObject(Dta,_ta),Yua=swa(fva),Lua=Pua.fetchPointerofObject(Ata,_ta),Xua=swa(Lua),rua=Pua.fetchPointerofObject(xta,e),!(Pua.isPointers(rua)&&4<=jta(rua)))return!1;if(!xwa())return!1;if(zua=owa(yta,_ta,0),Aua=owa(zta,_ta,0),zva=owa(Hta,_ta,yua),Oua=owa(Bta,_ta,sua),Pua.failed())return!1;if(Yua)mva=nva=0;else{if(!(Pua.isPointers(fva)&&4<=jta(fva)))return!1;if(!function(){var e;if(cva=Pua.fetchPointerofObject(Ota,fva),lva=nwa(Rta,fva),gva=nwa(Qta,fva),!(0<=lva&&0<=gva))return!1;eva=Pua.fetchIntegerofObject(Pta,fva),iva=0<eva,eva<0&&(eva=0-eva);if("number"==typeof cva){if(!function(e){if(!_ua&&!Ewa())return;return _ua(e,function(e,t,r,i){lva=e,gva=t,eva=r,iva=i})}(cva))return!1;jva=lta(32,eva),cva=kva=0}else{if(jva=lta(32,eva),kva=4*lta(lva+(jva-1),jva),e=kta(cva),!Pua.isWordsOrBytes(cva)||e!==kva*gva){if(!(Pua.isWordsOrBytes(cva)&&kva*gva<e))return!1;Pua.vm.warnOnce("BitBlt>>loadBitBltSourceForm: sourceBitsSize != sourcePitch * sourceHeight, expected "+kva+"*"+gva+"="+kva*gva+", got "+e)}cva=cva.wordsOrBytes()}return!0}())return!1;if(!function(){var e,t,r,i;if(gua=iua=fua=0,hua=jua=kua=null,(t=Pua.fetchPointerofObject(wta,_ta)).isNil)return!0;if(gua=Mta,i=!1,Pua.isWords(t))r=jta(t),hua=t.words,i=!0;else{if(!(Pua.isPointers(t)&&3<=jta(t)))return!1;if(kua=Cwa(Pua.fetchPointerofObject(0,t)),jua=Cwa(Pua.fetchPointerofObject(1,t)),(e=Pua.fetchPointerofObject(2,t)).isNil)r=0;else{if(!Pua.isWords(e))return!1;r=jta(e),hua=e.words}gua|=Lta}if(0!=(r&r-1))return!1;iua=r-1,fua=0,512===r&&(fua=3);4096===r&&(fua=4);32768===r&&(fua=5);0===r?(hua=null,iua=0):gua|=Kta;i&&txa();!function(e,t){return!e||!t||0===e[Uta]&&0===e[Sta]&&0===e[Ita]&&0===e[rta]&&16711680===t[Uta]&&65280===t[Sta]&&255===t[Ita]&&4278190080===t[rta]}(kua,jua)?gua|=Jta:kua=jua=null;return!0}())return!1;0==(gua&Lta)&&txa(),mva=owa(Eta,_ta,0),nva=owa(Fta,_ta,0)}return!!function(){var e;if(Xua)return!(Kua=null);if(Pua.isPointers(Lua)&&4<=jta(Lua))e=Pua.fetchPointerofObject(Ota,Lua),Mua=Pua.fetchIntegerofObject(Qta,Lua),Pua.isWords(e)||(Xua=!0);else{if(Pua.isPointers(Lua)||!Pua.isWords(Lua))return!1;Mua=jta(e=Lua)}return Kua=e.wordsOrBytes(),!0}()&&(dua=owa(uta,_ta,0),eua=owa(vta,_ta,0),cua=owa(tta,_ta,yua),bua=owa(sta,_ta,sua),!Pua.failed()&&(dua<0&&(cua+=dua,dua=0),eua<0&&(bua+=eua,eua=0),yua<dua+cua&&(cua=yua-dua),sua<eua+bua&&(bua=sua-eua),!0))}function Cwa(e){return e.isNil?null:"number"!=typeof e&&Pua.isWords(e)&&4===jta(e)?e.wordsAsInt32Array():(Pua.primitiveFail(),null)}function Ewa(){return _ua=Pua.ioLoadFunctionFrom("ioGetSurfaceFormat","SurfacePlugin"),Rua=Pua.ioLoadFunctionFrom("ioLockSurface","SurfacePlugin"),sva=Pua.ioLoadFunctionFrom("ioUnlockSurface","SurfacePlugin"),_ua&&Rua&&sva}function Gwa(){var e,t,r,i,a,s;if(Nua=!1,0===oua){if(!Rua&&!Ewa())return;if(i=Rua,e=Pua.fetchIntegerofObject(Ota,rua),0===cva&&!Yua&&(t=Pua.fetchIntegerofObject(Ota,fva))===e)return cva=Qua?(s=Math.min(pva,Gua),a=Math.max(pva,Gua)+$ta,i(t,function(e){kva=e},s,r=Math.min(qva,Hua),a-s,Math.max(qva,Hua)+Zta-r)):i(t,function(e){kva=e},0,0,lva,gva),xua=kva,Nua=!0,0!==(oua=cva);oua=i(e,function(e){xua=e},Gua,Hua,$ta,Zta),Nua=!0}if(0===cva&&!Yua){if(t=Pua.fetchIntegerofObject(Ota,fva),!Rua&&!Ewa())return;i=Rua,cva=Qua?i(t,function(e){kva=e},0,0,lva,gva):i(t,function(e){kva=e},pva,qva,$ta,Zta),Nua=!0}return 0!==oua&&(0!==cva||Yua)}function Hwa(e,t){var r,i,a;return r=e,0!=(t&Mta)&&(0!=(t&Jta)&&(a=pta((i=e)&jua[0],kua[0]),a|=pta(i&jua[1],kua[1]),0===(r=(a|=pta(i&jua[2],kua[2]))|pta(i&jua[3],kua[3]))&&0!==e&&(r=1)),0!=(t&Kta)&&(r=hua[r&iua])),r}function Iwa(e){0===strcmp(e,"SurfacePlugin")&&(_ua=Rua=sva=0)}function Jwa(e,t,r,i){var a,s,n;for(n=Uua[r],a=0,s=1;s<=i;s++)(e&n)===n&&(a|=t&n),n=nta(n,r);return a}function Kwa(e,t,r,i,a){var s,n,o;return(n=(e^(o=e&a))+(t^(s=t&a)))^o^s|ota(o&s|(o|s)&n,r-1)*i}function Lwa(e,t,r,i){var a,s,n;for(n=Uua[r],a=0,s=1;s<=i;s++)a|=Math.max(t&n,e&n),n=nta(n,r);return a}function Mwa(e,t,r,i){var a,s,n;for(n=Uua[r],a=0,s=1;s<=i;s++)a|=Math.min(t&n,e&n),n=nta(n,r);return a}function Nwa(e,t,r,i){var a,s,n;return s=ota((1+(e&(n=Uua[r])))*(1+(t&n))-1&(a=nta(n,r)),r),1===i?s:(s|=(1+(ota(e,r)&n))*(1+(ota(t,r)&n))-1&a,2===i?s:(s|=nta((1+(ota(e,2*r)&n))*(1+(ota(t,2*r)&n))-1&a,r),3===i?s:s|=nta((1+(ota(e,3*r)&n))*(1+(ota(t,3*r)&n))-1&a,2*r)))}function Pwa(e,t,r,i){var a,s,n,o,u;for(u=Uua[r],s=0,o=1;o<=i;o++)s|=(n=e&u)<(a=t&u)?a-n:n-a,u=nta(u,r);return s}function Rwa(e,t,r,i,a,s){var n,o,u,l,c,h;if(u=cva[hva>>>2],h=0,o=ova,l=Fua,c=e,t===(Mta|Kta))for(;n=ota(u,o)&r,h|=nta(hua[n&iua]&i,l),l+=s,0!=(4294967264&(o+=a))&&(iva?o+=32:o-=32,u=cva[(hva+=4)>>>2]),0!=--c;);else for(;h|=nta(Hwa(n=ota(u,o)&r,t)&i,l),l+=s,0!=(4294967264&(o+=a))&&(iva?o+=32:o-=32,u=cva[(hva+=4)>>>2]),0!=--c;);return ova=o,h}function Swa(e,t){var r,i,a;return e<0||t<0||(i=e>>>14)>=lva||(a=t>>>14)>=gva?0:(r=a*kva+4*ota(i,vva),ota(cva[r>>>2],ova=wva[i&uva])&xva)}function Twa(e,t){var r,i,a,s,n;if(32===qua)return e===t?0:t;for(n=Uua[i=qua],a=0,s=1;s<=wua;s++)(e&n)===(r=t&n)&&(r=0),a|=r,n=nta(n,i);return a}function Uwa(e,t){return Jwa(~e,t,qua,wua)}function Vwa(e,t){return 0===e?t:e|Jwa(~e,t,qua,wua)}function Wwa(e,t){var r,i,a,s,n;if(1===wua)return t;if(r=0,a=nta(1,qua)-1,s=nta(a,(wua-1)*qua),r|=nta(t&a,i=32-qua)|ota(t&s,i),wua<=2)return r;for(n=2;n<=wua>>1;n++)a=nta(a,qua),s=ota(s,qua),r|=nta(t&a,i-=2*qua)|ota(t&s,i);return r}function Xwa(){return ywa(Pua.stackValue(Pua.methodArgumentCount()))?($va(),Pua.failed()?null:(vxa(),Pua.failed()?null:(Pua.pop(Pua.methodArgumentCount()),22===lua||32===lua?(Pua.pop(1),Pua.pushInteger(aua)):void 0))):Pua.primitiveFail()}function Ywa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p;if(6!==Pua.methodArgumentCount())return Pua.primitiveFail();if(c=Pua.stackIntegerValue(0),a=Pua.stackObjectValue(1),u=Pua.stackObjectValue(2),ita(a)!==Pua.classArray()||ita(u)!==Pua.classArray())return Pua.primitiveFail();if(256!==jta(u))return Pua.primitiveFail();if(Pua.failed())return null;if(s=jta(a)-2,r=Pua.stackIntegerValue(3),h=Pua.stackIntegerValue(4),p=Pua.stackObjectValue(5),!Pua.isBytes(p))return Pua.primitiveFail();if(!(0<h&&0<r&&r<=kta(p)))return Pua.primitiveFail();if(!ywa(i=Pua.stackObjectValue(6)))return Pua.primitiveFail();if(30===lua||31===lua)return Pua.primitiveFail();for(n=0!==oua&&0!==cva&&!1===Yua&&fva!==rua&&(0!==gua||iva!==uua||eva!==qua),l=zua,t=p.bytes,e=h;e<=r;e++){if(f=t[e-1],(o=Pua.fetchIntegerofObject(f,u))<0||s<o)return Pua.primitiveFail();if(mva=Pua.fetchIntegerofObject(o,a),zva=Pua.fetchIntegerofObject(o+1,a)-mva,Pua.failed())return null;if(Zva(),0<$ta&&0<Zta&&(n?(hwa(),ewa(),Xta=(Wta=Gua)+$ta,Vta=(Yta=Hua)+Zta):$va()),Pua.failed())return null;zua=zua+zva+c}Wta=l,vxa(),Pua.storeIntegerofObjectwithValue(yta,i,zua),Pua.pop(6)}function Zwa(){var e,t,r;if(t=Pua.stackValue(2),r=Pua.stackIntegerValue(1),e=Pua.stackIntegerValue(0),!ywa(t))return Pua.primitiveFail();Pua.failed()||(function(e,t){var r,i,a,s,n,o,u,l,c,h;if(a=0<e?1:0===e?0:-1,h=0<t?1:0===t?0:-1,o=i=9999,n=c=-9999,(s=Math.abs(t))<(u=Math.abs(e))){for(r=u>>1,l=1;l<=u;l++)if(zua+=a,(r-=s)<0&&(Aua+=h,r+=u),l<u){if($va(),Pua.failed())return;Wta<Xta&&Yta<Vta&&(o=Math.min(o,Wta),n=Math.max(n,Xta),i=Math.min(i,Yta),4e3<(n-o)*((c=Math.max(c,Vta))-i)&&(Wta=o,Xta=n,Yta=i,Vta=c,vxa(),o=i=9999,n=c=-9999))}}else for(r=s>>1,l=1;l<=s;l++)if(Aua+=h,(r-=u)<0&&(zua+=a,r+=s),l<s){if($va(),Pua.failed())return;Wta<Xta&&Yta<Vta&&(o=Math.min(o,Wta),n=Math.max(n,Xta),i=Math.min(i,Yta),4e3<(n-o)*((c=Math.max(c,Vta))-i)&&(Wta=o,Xta=n,Yta=i,Vta=c,vxa(),o=i=9999,n=c=-9999))}Wta=o,Xta=n,Yta=i,Vta=c,Pua.storeIntegerofObjectwithValue(yta,_ta,zua),Pua.storeIntegerofObjectwithValue(zta,_ta,Aua)}(r,e),vxa()),Pua.failed()||Pua.pop(2)}function $wa(){var e,t,r,i,a,s,n,o,u,l,c;return u=Pua.stackIntegerValue(1),l=Pua.stackIntegerValue(0),Pua.stackValue(2),Pua.failed()?null:u<0||l<0?(c=0,Pua.failed()||Pua.popthenPush(3,c),null):(t=Pua.stackValue(Pua.methodArgumentCount()),Pua.isPointers(t)&&4<=jta(t)?(i=Pua.fetchPointerofObject(Ota,t),Pua.isWordsOrBytes(i)?(zva=Pua.fetchIntegerofObject(Rta,t),Oua=Pua.fetchIntegerofObject(Qta,t),r=Pua.fetchIntegerofObject(Pta,t),Pua.failed()?null:zva<=u||Oua<=l?(c=0,Pua.failed()||Pua.popthenPush(3,c),null):r<0?(Pua.primitiveFail(),null):(a=lta(32,r),n=lta(zva+(a-1),a),kta(i)!==n*Oua*4?(Pua.primitiveFail(),null):(s=Pua.fetchLong32ofObject(l*n+lta(u,a),i),o=ota(4294967295,32-r),e=ota(s,32-(1+(u&a-1))*r)&o,c=Pua.positive32BitIntegerFor(e),Pua.failed()||Pua.popthenPush(3,c),null))):(Pua.primitiveFail(),null)):(Pua.primitiveFail(),null))}function _wa(){var e;return e=Pua.stackValue(Pua.methodArgumentCount()),zwa(e,!0)?(function(){var e;if(e=Yua,Yua=!0,Zva(),(Yua=e)||$ta<=0||Zta<=0)return Wta=Xta=Yta=Vta=0;if(!Gwa())return Pua.primitiveFail();hwa(),function(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O,w,I;if(u=Zua[lua+1],!(jta(_ta)>=Gta+12))return Pua.primitiveFail();(a=Oua-1)<=0&&(a=1);_=nwa(Gta,_ta),r=nwa(Gta+3,_ta),(w=gwa(_,r,a))<0&&(_=r-a*w);m=nwa(Gta+1,_ta),r=nwa(Gta+4,_ta),(y=gwa(m,r,a))<0&&(m=r-a*y);v=nwa(Gta+9,_ta),r=nwa(Gta+6,_ta),(l=gwa(v,r,a))<0&&(v=r-a*l);c=nwa(Gta+10,_ta),r=nwa(Gta+7,_ta),(s=gwa(c,r,a))<0&&(c=r-a*s);if(Pua.failed())return;if(2===Pua.methodArgumentCount())if(I=Pua.stackIntegerValue(1),(g=Pua.stackValue(0)).isNil){if(eva<16)return Pua.primitiveFail()}else{if(jta(g)<nta(1,eva))return Pua.primitiveFail();g=g.wordsOrBytes()}else I=1,g=Pua.nilObject();(a=zva-1)<=0&&(a=1);S=1+(Gua+$ta-1&wua-1),$ta<(o=wua-(Gua&wua-1))&&(o=$ta);Aua<eua&&(_+=(eua-Aua)*w,m+=(eua-Aua)*y,v+=(eua-Aua)*l,c+=(eua-Aua)*s);(function(){var e,t;yva=0,t=eva;for(;1!==t;)++yva,t>>>=1;for(xva=Uua[eva],uva=nta(1,vva=5-yva)-1,e=0;e<=uva;e++)wva[e]=iva?32-nta(e+1,yva):nta(e,yva)})(),1<I&&0==(gua&Lta)&&(hua?uxa(8,fua):16===qua&&uxa(8,5));e=gua&~Lta,t=uua?(b=0-qua,32-qua):(b=qua,0);for(h=1;h<=Zta;h++){for(k=gwa(_,v,a),pva=0<=k?_:v-a*k,f=gwa(m,c,a),qva=0<=f?m:c-a*f,Fua=uua?32-(1+(Gua&wua-1))*qua:(Gua&wua-1)*qua,zua<dua&&(pva+=(dua-zua)*k,qva+=(dua-zua)*f),p=Xua?qta:rwa(Hua+h-1),vua=Sua,O=o,r=Wua;i=1===I?Ixa(O,k,f,w,y,b,e):Hxa(O,k,f,w,y,g,I,b),Fua=t,vua===qta?(d=u(i&p,oua[tua>>>2]),oua[tua>>>2]=vua&d):(n=oua[tua>>>2],d=u(i&p,n&vua),n=vua&d|n&~vua,oua[tua>>>2]=n),tua+=4,O=2===r?(vua=Tua,S):(vua=qta,wua),0!=--r;);_+=w,m+=y,v+=l,c+=s,tua+=pua}}(),Xta=0<Jua?(Wta=Gua)+$ta:(Wta=Gua-$ta+1,Gua+1);Vta=0<tva?(Yta=Hua)+Zta:(Yta=Hua-Zta+1,Hua+1);Dxa()}(),Pua.failed()?null:(vxa(),Pua.failed()?null:void Pua.pop(Pua.methodArgumentCount()))):Pua.primitiveFail()}function cxa(e,t){var r,i;return qua<16?(i=nta(1,qua)-1,r=nta(lta(4294967295,i),qua-1),Kwa(e,t,qua,i,r)):16===qua?Kwa(2147450879&e,2147450879&t,5,i=31,r=1108361744):Kwa(e,t,8,i=255,r=2155905152)}function fxa(e,t){var r,i,a,s,n,o,u,l,c,h,f,p,d,m;return 0===(d=e)?t:(p=255&d,a=255&(d>>>=8),u=255&(d>>>=8),o=255&(d>>>=8),255!=(c=255&mua)&&(o=o*c>>>8,u=u*c>>>8,a=a*c>>>8,p=p*c>>>8),s=255&(l=t),m=255&(i=nua),rva&&(s=rva[s],m=rva[m]),255<(f=(s*(255-p)>>>8)+(m*p>>>8))&&(f=255),Iua&&(f=Iua[f]),s=255&(l>>>=8),m=255&(i>>>=8),rva&&(s=rva[s],m=rva[m]),255<(r=(s*(255-a)>>>8)+(m*a>>>8))&&(r=255),Iua&&(r=Iua[r]),s=255&(l>>>=8),m=255&(i>>>=8),rva&&(s=rva[s],m=rva[m]),255<(h=(s*(255-u)>>>8)+(m*u>>>8))&&(h=255),Iua&&(h=Iua[h]),i>>>=8,255<(n=((255&(l>>>=8))*(255-o)>>>8)+o)&&(n=255),(((n<<8)+h<<8)+r<<8)+f)}function hxa(e,t){return 0===e?t:function(e,t,r,i){var a,s,n,o,u,l;for(l=Uua[r],s=0,o=1;o<=i;o++)n=ota(e&l,(o-1)*r),a=ota(t&l,(o-1)*r),32!==r&&(a=16===r?(n=4278190080|jxa(n),4278190080|jxa(a)):(n=4278190080|lxa(n,r,32),4278190080|lxa(a,r,32))),u=fxa(n,a),32!==r&&(u=lxa(u,32,r)),s|=nta(u,(o-1)*r),l=nta(l,r);return s}(e,t,qua,wua)}function ixa(e,t){var r,i,a,s,n,o,u,l,c,h;for(n=Uua[qua],o=16===qua?(i=5,31):(i=8,255),c=vua,u=t,s=e,l=1;l<=wua;l++)0<(c&n)&&(h=u&n,r=s&n,a=qua<16?r==h?0:1:((a=Pwa(r,h,i,3))&o)+(ota(a,i)&o)+(ota(ota(a,i),i)&o),aua+=a),c=ota(c,qua),s=ota(s,qua),u=ota(u,qua);return t}function jxa(e){return(31&e)<<3|(992&e)<<6|(31744&e)<<9}function lxa(e,t,r){var i,a,s,n;return 0<(i=r-t)?(n=nta(1,t)-1,a=(s=nta(e,i))&(n=nta(n,i)),n=nta(n,r),a+((s=nta(s,i))&n)+(nta(s,i)&nta(n,r))):0===i?5===t?32767&e:8===t?16777215&e:e:0===e?e:(n=nta(1,r)-1,a=(s=ota(e,i=t-r))&n,n=nta(n,r),0===(a=a+((s=ota(s,i))&n)+(ota(s,i)&nta(n,r)))?1:a)}function nxa(e,t){return qua<16?Lwa(e,t,qua,wua):16===qua?Lwa(e,t,5,3)+(Lwa(e>>>16,t>>>16,5,3)<<16):Lwa(e,t,8,4)}function oxa(e,t){return qua<16?Mwa(e,t,qua,wua):16===qua?Mwa(e,t,5,3)+(Mwa(e>>>16,t>>>16,5,3)<<16):Mwa(e,t,8,4)}function pxa(e,t){var r;return r=~e,qua<16?Mwa(r,t,qua,wua):16===qua?Mwa(r,t,5,3)+(Mwa(r>>>16,t>>>16,5,3)<<16):Mwa(r,t,8,4)}function qxa(e,t){return qua<16?Nwa(e,t,qua,wua):16===qua?Nwa(e,t,5,3)+(Nwa(e>>>16,t>>>16,5,3)<<16):Nwa(e,t,8,4)}function rxa(e,t){return qua<16?Pwa(e,t,qua,wua):16===qua?Pwa(e,t,5,3)+(Pwa(e>>>16,t>>>16,5,3)<<16):Pwa(e,t,8,4)}function sxa(e){return!1!=((Pua=e).majorVersion()==gta)&&Pua.minorVersion()>=hta}function txa(){var e,t;if(e=t=0,!(eva<=8)){if(16===eva&&(e=5),32===eva&&(e=8),0===fua){if(qua<=8)return;16===qua&&(t=5),32===qua&&(t=8)}else t=fua;uxa(e,t)}}function uxa(e,t){var r,i,a=[0,0,0,0],s=[0,0,0,0];0!=(r=t-e)&&(r<=0?(i=nta(1,t)-1,s[Uta]=nta(i,2*e-r),s[Sta]=nta(i,e-r),s[Ita]=nta(i,0-r),s[rta]=0):(i=nta(1,e)-1,s[Uta]=nta(i,2*e),s[Sta]=nta(i,e),s[Ita]=i),a[Uta]=3*r,a[Sta]=2*r,a[Ita]=r,a[rta]=0,kua=a,jua=s,gua=gua|Mta|Jta)}function vxa(){Pua.showDisplayBitsLeftTopRightBottom(rua,Wta,Yta,Xta,Vta)}function xxa(e,t){return e}function yxa(e,t){return e-t}function zxa(e,t){var r,i,a,s,n,o;if((gua&(Mta|Kta))!=(Mta|Kta))return t;for(r=Uua[qua],a=t,n=vua,s=1;s<=wua;s++)0!=(n&r)&&(o=a&r,Bxa(i=qua<16?o:lxa(o,16===qua?5:8,fua),Axa(i)+1)),n=ota(n,qua),a=ota(a,qua);return t}function Axa(e){return hua[e&iua]}function Bxa(e,t){return hua[e&iua]=t}function Dxa(){var e,t,r,i;if(Nua){if(!sva&&!Ewa())return;r=sva,i=!1,"number"==typeof(e=Pua.fetchPointerofObject(Ota,rua))&&(r(e=e,Wta,Yta,Xta-Wta,Vta-Yta),oua=xua=0,i=!0),Yua||"number"==typeof(t=Pua.fetchPointerofObject(Ota,fva))&&(t=t,i&&t===e||r(t,0,0,0,0),cva=kva=0),Nua=!1}}function Hxa(e,t,r,i,a,s,n,o){var u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O,w,I,F;m=Uua[qua],l=0,b=2===n?(c=t>>1,f=r>>1,d=i>>1,a>>1):(c=lta(t,n),f=lta(r,n),d=lta(i,n),lta(a,n)),p=e;do{S=pva,g=qva,O=w=y=k=0,I=0,h=n;do{for(F=S,_=g,u=n;v=Swa(F,_),25===lua&&0===v||(++I,k+=255&(v=eva<16?s[v]:16===eva?jxa(v):v),y+=v>>>8&255,w+=v>>>16&255,O+=v>>>24),F+=c,_+=f,0!=--u;);S+=d,g+=b}while(0!=--h);l|=nta((v=0===I||25===lua&&I<n*n>>1?0:(4===I?(w>>>=2,y>>>=2,k>>>=2,O>>>=2):(w=lta(w,I),y=lta(y,I),k=lta(k,I),O=lta(O,I)),0===(v=(O<<24)+(w<<16)+(y<<8)+k)&&0<w+y+k+O&&(v=1),Hwa(v,gua)))&m,Fua),Fua+=o,pva+=t,qva+=r}while(0!=--p);return l}function Ixa(e,t,r,i,a,s,n){var o,u,l,c;if(l=Uua[qua],c=0,u=e,n===(Mta|Kta))for(;o=Swa(pva,qva),c|=nta(hua[o&iua]&l,Fua),Fua+=s,pva+=t,qva+=r,0!=--u;);else for(;c|=nta(Hwa(o=Swa(pva,qva),n)&l,Fua),Fua+=s,pva+=t,qva+=r,0!=--u;);return c}function CroquetPlugin(){return{getModuleName:function(){return"CroquetPlugin"},interpreterProxy:null,setInterpreter:function(e){return this.interpreterProxy=e,!0},primitiveGatherEntropy:function(e){var t=this.interpreterProxy.stackObjectValue(0);return this.interpreterProxy.failed()?null:t.isBytes()?(window.crypto.getRandomValues(t.bytes),this.interpreterProxy.popthenPush(e+1,this.interpreterProxy.trueObject()),!0):this.interpreterProxy.primitiveFail()}}}function registerCroquetPlugin(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("CroquetPlugin",CroquetPlugin()):self.setTimeout(registerCroquetPlugin,100)}function IIa(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function KIa(e,t){return 31<t?0:e<<t}function XIa(e){return OIa.success(OIa.isWords(e)),OIa.failed()?0:e.wordsAsFloat32Array()}function ZIa(){return PIa}function $Ia(e){var t,r;return OIa.success(6<=IIa(e)),!OIa.failed()&&(QIa=OIa.fetchIntegerofObject(0,e),LIa=OIa.fetchIntegerofObject(1,e),t=OIa.fetchPointerofObject(2,e),WIa=IIa(t),VIa=XIa(t),t=OIa.fetchPointerofObject(3,e),SIa=IIa(t),r=t,OIa.success(OIa.isWords(r)),RIa=r.words,t=OIa.fetchPointerofObject(4,e),UIa=IIa(t),TIa=XIa(t),t=OIa.fetchPointerofObject(5,e),NIa=IIa(t),MIa=XIa(t),OIa.success(KIa(1,QIa)===LIa&&1+(LIa>>2)===WIa&&LIa===UIa&&LIa===NIa&&UIa===NIa),!1===OIa.failed())}function _Ia(){var e,t,r,i,a;for(i=0,r=SIa;i<r;){if(e=RIa[i]-1,t=RIa[i+1]-1,!(e<UIa&&t<UIa))return OIa.success(!1);a=TIa[e],TIa[e]=TIa[t],TIa[t]=a,a=MIa[e],MIa[e]=MIa[t],MIa[t]=a,i+=2}}function aJa(){if(!$Ia(OIa.stackObjectValue(0)))return null;_Ia(),OIa.failed()&&_Ia()}function bJa(){if(!$Ia(OIa.stackObjectValue(0)))return null;dJa()}function cJa(){var e;if(e=OIa.booleanValueOf(OIa.stackValue(0)),!$Ia(OIa.stackObjectValue(1)))return null;!function(e){if(_Ia(),OIa.failed())return _Ia();(function(e){var t,r,i,a,s,n,o,u,l,c,h,f,p,d,m;for(r=LIa>>1,i=LIa>>2,f=1;f<=QIa;f++)for(c=KIa(1,f),h=c>>1,b=LIa,v=c,t=0|Math.floor(b/v),l=1;l<=h;l++)for(o=(m=(l-1)*t)<i?(d=VIa[WIa-m-1],VIa[m]):(d=0-VIa[m-i],VIa[r-m]),e||(o=0-o),a=l;a<=LIa;)s=a-1,p=TIa[u=a+h-1]*d-MIa[u]*o,n=TIa[u]*o+MIa[u]*d,TIa[u]=TIa[s]-p,MIa[u]=MIa[s]-n,TIa[s]=TIa[s]+p,MIa[s]=MIa[s]+n,a+=c;var b,v})(e),e||dJa()}(e),OIa.failed()||OIa.pop(1)}function dJa(){var e,t;if(!(LIa<=1))for(t=1/LIa,e=0;e<=LIa-1;e++)TIa[e]=TIa[e]*t,MIa[e]=MIa[e]*t}function eJa(e){return!1!=((OIa=e).majorVersion()==GIa)&&OIa.minorVersion()>=HIa}function YJa(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function _Ja(){return $Ja}function aKa(){var e,t,r,i,a,s;if(e=ZJa.stackObjectValue(0),a=ZJa.stackObjectValue(1),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(e)),ZJa.success(ZJa.isWords(a)),ZJa.failed())return null;if(i=YJa(e),ZJa.success(i===YJa(a)),ZJa.failed())return null;for(s=a.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),r=0;r<=i-1;r++)s[r]=s[r]+t[r];ZJa.pop(1)}function bKa(){var e,t,r,i,a;if(a=ZJa.stackFloatValue(0),r=ZJa.stackObjectValue(1),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(r)),ZJa.failed())return null;for(t=YJa(r),i=r.wordsAsFloat32Array(),e=0;e<=t-1;e++)i[e]=i[e]+a;ZJa.pop(1)}function cKa(){var e,t,r;return t=ZJa.stackIntegerValue(0),r=ZJa.stackObjectValue(1),ZJa.failed()?null:(ZJa.success(ZJa.isWords(r)),ZJa.success(0<t&&t<=YJa(r)),ZJa.failed()?null:(e=r.wordsAsFloat32Array()[t-1],ZJa.pop(2),void ZJa.pushFloat(e)))}function dKa(){var e,t,r,i;return e="number"==typeof(i=ZJa.stackValue(0))?i:ZJa.floatValueOf(i),t=ZJa.stackIntegerValue(1),r=ZJa.stackObjectValue(2),ZJa.failed()?null:(ZJa.success(ZJa.isWords(r)),ZJa.success(0<t&&t<=YJa(r)),ZJa.failed()?null:(r.wordsAsFloat32Array()[t-1]=e,void(ZJa.failed()||ZJa.popthenPush(3,i))))}function eKa(){var e,t,r,i,a,s;if(e=ZJa.stackObjectValue(0),a=ZJa.stackObjectValue(1),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(e)),ZJa.success(ZJa.isWords(a)),ZJa.failed())return null;if(i=YJa(e),ZJa.success(i===YJa(a)),ZJa.failed())return null;for(s=a.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),r=0;r<=i-1;r++)if(0===t[r])return ZJa.primitiveFail();for(r=0;r<=i-1;r++)s[r]=s[r]/t[r];ZJa.pop(1)}function fKa(){var e,t,r,i,a,s;if(s=ZJa.stackFloatValue(0),i=ZJa.stackObjectValue(1),ZJa.failed())return null;if(0===s)return ZJa.primitiveFail();if(ZJa.success(ZJa.isWords(i)),ZJa.failed())return null;for(r=YJa(i),a=i.wordsAsFloat32Array(),t=1/s,e=0;e<=r-1;e++)a[e]=a[e]*t;ZJa.pop(1)}function gKa(){var e,t,r,i,a,s,n;if(e=ZJa.stackObjectValue(0),a=ZJa.stackObjectValue(1),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(e)),ZJa.success(ZJa.isWords(a)),ZJa.failed())return null;if(i=YJa(e),ZJa.success(i===YJa(a)),ZJa.failed())return null;for(s=a.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),r=n=0;r<=i-1;r++)n+=s[r]*t[r];ZJa.pop(2),ZJa.pushFloat(n)}function hKa(){var e,t,r,i,a,s;if(e=ZJa.stackObjectValue(0),a=ZJa.stackObjectValue(1),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(e)),ZJa.success(ZJa.isWords(a)),ZJa.failed())return null;if(ZJa.pop(2),(i=YJa(e))!==YJa(a))return ZJa.pushBool(!1);for(s=a.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),r=0;r<=i-1;r++)if(s[r]!==t[r])return ZJa.pushBool(!1);return ZJa.pushBool(!0)}function iKa(){var e,t,r,i,a;if(r=ZJa.stackObjectValue(0),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(r)),ZJa.failed())return null;for(t=YJa(r),i=r.wordsAsInt32Array(),e=a=0;e<=t-1;e++)a+=i[e];return ZJa.pop(1),ZJa.pushInteger(536870911&a)}function jKa(){var e,t,r,i,a;if(r=ZJa.stackObjectValue(0),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(r)),ZJa.failed())return null;for(t=YJa(r),ZJa.success(!0),i=r.wordsAsFloat32Array(),e=a=0;e<=t-1;e++)a+=i[e]*i[e];a=Math.sqrt(a),ZJa.popthenPush(1,ZJa.floatObjectOf(a))}function kKa(){var e,t,r,i,a,s;if(e=ZJa.stackObjectValue(0),a=ZJa.stackObjectValue(1),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(e)),ZJa.success(ZJa.isWords(a)),ZJa.failed())return null;if(i=YJa(e),ZJa.success(i===YJa(a)),ZJa.failed())return null;for(s=a.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),r=0;r<=i-1;r++)s[r]=s[r]*t[r];ZJa.pop(1)}function lKa(){var e,t,r,i,a;if(a=ZJa.stackFloatValue(0),r=ZJa.stackObjectValue(1),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(r)),ZJa.failed())return null;for(t=YJa(r),i=r.wordsAsFloat32Array(),e=0;e<=t-1;e++)i[e]=i[e]*a;ZJa.pop(1)}function mKa(){var e,t,r,i,a;if(i=ZJa.stackObjectValue(0),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(i)),ZJa.failed())return null;for(r=YJa(i),ZJa.success(!0),a=i.wordsAsFloat32Array(),e=t=0;e<=r-1;e++)t+=a[e]*a[e];if(ZJa.success(0<t),ZJa.failed())return null;for(t=Math.sqrt(t),e=0;e<=r-1;e++)a[e]=a[e]/t}function nKa(){var e,t,r,i,a,s;if(e=ZJa.stackObjectValue(0),a=ZJa.stackObjectValue(1),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(e)),ZJa.success(ZJa.isWords(a)),ZJa.failed())return null;if(i=YJa(e),ZJa.success(i===YJa(a)),ZJa.failed())return null;for(s=a.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),r=0;r<=i-1;r++)s[r]=s[r]-t[r];ZJa.pop(1)}function oKa(){var e,t,r,i,a;if(a=ZJa.stackFloatValue(0),r=ZJa.stackObjectValue(1),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(r)),ZJa.failed())return null;for(t=YJa(r),i=r.wordsAsFloat32Array(),e=0;e<=t-1;e++)i[e]=i[e]-a;ZJa.pop(1)}function pKa(){var e,t,r,i,a;if(r=ZJa.stackObjectValue(0),ZJa.failed())return null;if(ZJa.success(ZJa.isWords(r)),ZJa.failed())return null;for(t=YJa(r),i=r.wordsAsFloat32Array(),e=a=0;e<=t-1;e++)a+=i[e];ZJa.popthenPush(1,ZJa.floatObjectOf(a))}function qKa(e){return!1!=((ZJa=e).majorVersion()==WJa)&&ZJa.minorVersion()>=XJa}function dMa(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function eMa(e,t){return new Int32Array(e.buffer,e.byteOffset+4*t)}function hMa(e,t){var r,i,a,s;return r=e[0],a=e[1],(i=t[0]-r)*i+(s=t[1]-a)*s}function jMa(){return gMa}function mMa(e){console.log(gMa+": "+e)}function nMa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O,w,I,F,P,A,x,C,V,M,R,j,q,Y,N,B,W,T,Z,E,L,z,D,G,U,X,K;if(j=fMa.stackValue(11),q=fMa.stackValue(10),Y=fMa.stackValue(9),N=fMa.stackValue(8),B=fMa.stackValue(7),W=fMa.stackValue(6),T=fMa.stackValue(5),Z=fMa.stackValue(4),E=fMa.stackIntegerValue(3),L=fMa.stackValue(2),z=fMa.stackValue(1),D=fMa.stackValue(0),fMa.failed())return null;if(fMa.failed())return mMa("failed 1"),null;if(fMa.success(fMa.isWords(j)&&fMa.isWords(q)&&fMa.isWords(Y)&&fMa.isWords(N)&&fMa.isWords(B)&&fMa.isWords(W)&&fMa.isWords(T)&&fMa.isWords(Z)&&fMa.isWords(L)&&fMa.isWords(z)&&fMa.isWords(D)),fMa.failed())return mMa("failed 2"),null;if(fMa.success(fMa.isMemberOf(j,"PointArray")&&fMa.isMemberOf(q,"PointArray")),fMa.failed())return mMa("failed 3"),null;if(f=j.wordsAsInt32Array(),v=q.wordsAsInt32Array(),k=Y.wordsAsInt32Array(),u=N.wordsAsInt32Array(),d=B.wordsAsInt32Array(),c=W.wordsAsInt32Array(),C=T.wordsAsInt32Array(),e=Z.wordsAsInt32Array(),y=L.wordsAsInt32Array(),M=z.wordsAsInt32Array(),_=D.wordsAsInt32Array(),g=dMa(q)>>>1,F=dMa(Y)>>>1,l=dMa(N)>>>1,t=dMa(W),h=dMa(L),fMa.success(h===dMa(z)&&h===dMa(D)&&l<h),fMa.failed())return mMa("failed 4"),null;if(fMa.success(dMa(B)>=F-1&&dMa(j)>>>1>=F&&l-1<=t&&l<=g&&dMa(T)>=F-1&&dMa(Z)>=l-1),fMa.failed())return mMa("failed 5"),null;if(P=E>>>1,m=(r=1&E)?0:P*P>>>10,_[M[y[0]=0]=0]=2,w=0-m,!((p=l)-1<=g&&p-1<=t))return fMa.primitiveFail(),null;for(O=1;O<=p;O++)w=w+(c[i=O-1]+hMa(eMa(v,i<<1),f)>>>7)+m,M[O]=w,y[O]=w*O,_[O]=O+1;for(w=M[0]-m,I=1;I<=F;I++){for(S=(a=I-1)<<1,x=y[0],w=w+(d[a]+hMa(eMa(f,S),v)>>>7)+m,M[0]=w,y[0]=w*I,_[0]=I+1,p=l,O=1;O<=p;O++)s=(i=O-1)<<1,A=y[O],R=y[i],b=d[a]+hMa(eMa(f,S),eMa(v,O<<1))>>>7,0===(w=M[O])?A+=b:(A=A+w+b*_[O],b+=w),o=c[i]+hMa(eMa(v,s),eMa(f,I<<1))>>>7,0===(w=M[i])?R+=o:(R=R+w+o*_[i],o+=w),r?x=1<<29:x+=(hMa(eMa(u,s),eMa(k,S))+hMa(eMa(v,s),eMa(f,S)))*(16+(U=e[i],X=C[a],K=void 0,180<(K=Math.abs(X-U))&&(K=360-K),K*K>>>6))>>>11,V=x<=A&&x<=R?(n=x,w=0,1):A<=R?(n=A,w=b+m,_[O]+1):(n=R,w=o+m,_[i]+1),x=y[O],y[O]=Math.min(n,1<<29),M[O]=Math.min(w,1<<29),_[O]=V;w=M[0]}return G=n,fMa.failed()||fMa.popthenPush(13,G),null}function oMa(){return fMa.failed()||fMa.popthenPush(1,2e3),null}function pMa(e){return!1!=((fMa=e).majorVersion()==bMa)&&fMa.minorVersion()>=cMa}function HNa(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function JNa(e,t){return 0|Math.floor(e/t)}function KNa(e,t){return 31<t?0:e<<t}function POa(e,t){return"number"!=typeof t&&(!!BOa.isPointers(t)&&(!(HNa(t)<nOa)&&(e[ONa]=BOa.fetchIntegerofObject(ONa,t),e[PNa]=BOa.fetchIntegerofObject(PNa,t),e[hOa]=BOa.fetchIntegerofObject(hOa,t),e[rOa]=BOa.fetchIntegerofObject(rOa,t),e[MNa]=BOa.fetchIntegerofObject(MNa,t),e[jOa]=BOa.fetchIntegerofObject(jOa,t),e[oOa]=BOa.fetchIntegerofObject(oOa,t),!BOa.failed())))}function QOa(e,t){var r,i,a,s;if("number"==typeof t)return!1;if(!BOa.isPointers(t))return!1;if(HNa(t)<nOa)return!1;if("number"==typeof(r=BOa.fetchPointerofObject(iOa,t)))return!1;if(!BOa.isPointers(r))return!1;if(s=HNa(r),lOa<s)return!1;for(a=0;a<=s-1;a++){if("number"==typeof(i=BOa.fetchPointerofObject(a,r)))return!1;if(!BOa.isWords(i))return!1;if(HNa(i)!==RNa)return!1;e[a]=i.wordsAsInt32Array()}return!BOa.failed()}function WOa(e){var t,r;return GOa<e&&(function(){for(var e;GOa<=16;){if(!(IOa<JOa))return;if(e=HOa[IOa],++IOa,255===e){if(!(IOa<JOa&&0===HOa[IOa]))return--IOa;++IOa}FOa=FOa<<8|e,GOa+=8}}(),GOa<e)?-1:(t=FOa,FOa&=KNa(1,r=GOa-=e)-1,31<r?0:t>>>r)}function XOa(){return KOa}function ZOa(e,t){var r,i,a,s,n;if(i=e[0]>>>24,kOa<i)return-1;for(s=2;;){if((r=WOa(i))<0)return-1;if(t<=(a=s+r-1))return-1;if(0==(1056964608&(n=e[a])))return n;if(s=65535&n,kOa<(i=n>>>24&255))return-1}return-1}function _Oa(){var e,t,r,i,a,s,n,o;return r=t=vOa[ONa],i=vOa[PNa],n=vOa[hOa],o=vOa[rOa],0!==n&&0!==o&&(r=JNa(r,n),i=JNa(i,o)),e=(i>>>3)*vOa[MNa]+(r>>>3),s=((7&i)<<3)+(7&r),a=uOa[e][s],++t<8*vOa[jOa]?vOa[ONa]=t:(vOa[ONa]=0,vOa[PNa]++),a}function aPa(){var e,t,r,i,a,s,n,o;return r=t=xOa[ONa],i=xOa[PNa],n=xOa[hOa],o=xOa[rOa],0!==n&&0!==o&&(r=JNa(r,n),i=JNa(i,o)),e=(i>>>3)*xOa[MNa]+(r>>>3),s=((7&i)<<3)+(7&r),a=wOa[e][s],++t<8*xOa[jOa]?xOa[ONa]=t:(xOa[ONa]=0,xOa[PNa]++),a}function bPa(){var e,t,r,i,a,s,n,o;return r=t=NOa[ONa],i=NOa[PNa],n=NOa[hOa],o=NOa[rOa],0!==n&&0!==o&&(r=JNa(r,n),i=JNa(i,o)),e=(i>>>3)*NOa[MNa]+(r>>>3),s=((7&i)<<3)+(7&r),a=MOa[e][s],++t<8*NOa[jOa]?NOa[ONa]=t:(NOa[ONa]=0,NOa[PNa]++),a}function cPa(){var e;return 4!==BOa.methodArgumentCount()?BOa.primitiveFail():(AOa=BOa.stackIntegerValue(0),e=BOa.stackObjectValue(1),BOa.failed()?null:BOa.isWords(e)&&3===HNa(e)?(LOa=e.wordsAsInt32Array(),e=BOa.stackObjectValue(2),BOa.failed()?null:BOa.isWords(e)?(DOa=HNa(e),COa=e.wordsAsInt32Array(),e=BOa.stackObjectValue(3),BOa.failed()?null:jPa(e)?(function(){var e,t;for(NOa[ONa]=0,e=NOa[PNa]=0;e<=DOa-1;e++)t=bPa(),t+=LOa[gOa],t=Math.min(t,mOa),LOa[gOa]=t&AOa,t&=mOa-AOa,t=Math.max(t,1),COa[e]=4278190080+(t<<16)+(t<<8)+t}(),void BOa.pop(4)):BOa.primitiveFail()):BOa.primitiveFail()):BOa.primitiveFail())}function dPa(){var e,t,r;return 4!==BOa.methodArgumentCount()?BOa.primitiveFail():(AOa=BOa.stackIntegerValue(0),e=BOa.stackObjectValue(1),BOa.failed()?null:BOa.isWords(e)&&3===HNa(e)?(LOa=e.wordsAsInt32Array(),e=BOa.stackObjectValue(2),BOa.failed()?null:BOa.isWords(e)?(DOa=HNa(e),COa=e.wordsAsInt32Array(),e=BOa.stackObjectValue(3),BOa.failed()?null:BOa.isPointers(e)&&3===HNa(e)&&jPa(BOa.fetchPointerofObject(0,e))?(t=BOa.fetchPointerofObject(1,e),POa(vOa,t)&&QOa(uOa,t)?(r=BOa.fetchPointerofObject(2,e),POa(xOa,r)&&QOa(wOa,r)?(function(){var e,t,r,i,a,s,n;for(NOa[ONa]=0,NOa[PNa]=0,vOa[ONa]=0,vOa[PNa]=0,xOa[ONa]=0,a=xOa[PNa]=0;a<=DOa-1;a++)n=bPa(),t=_Oa(),t-=qOa,r=aPa(),s=n+($Na*(r-=qOa)>>16)+LOa[pOa],s=Math.min(s,mOa),s=Math.max(s,0),LOa[pOa]=s&AOa,s&=mOa-AOa,s=Math.max(s,1),i=n-(TNa*t>>16)-(WNa*r>>16)+LOa[gOa],i=Math.min(i,mOa),i=Math.max(i,0),LOa[gOa]=i&AOa,i&=mOa-AOa,i=Math.max(i,1),e=n+(aOa*t>>16)+LOa[NNa],e=Math.min(e,mOa),e=Math.max(e,0),LOa[NNa]=e&AOa,e&=mOa-AOa,e=Math.max(e,1),COa[a]=4278190080+(s<<16)+(i<<8)+e}(),void BOa.pop(4)):BOa.primitiveFail()):BOa.primitiveFail()):BOa.primitiveFail()):BOa.primitiveFail()):BOa.primitiveFail())}function ePa(){var e,t,r,i;return 5!==BOa.methodArgumentCount()?BOa.primitiveFail():(r=BOa.stackObjectValue(0),BOa.failed()?null:function(e){var t,r,i;if(!(HNa(e)<5)&&BOa.isPointers(e)&&"number"!=typeof(t=BOa.fetchPointerofObject(0,e))&&BOa.isBytes(t)&&(HOa=t.bytes,r=(i=t).bytes?i.bytes.length:i.words?4*i.words.length:0,IOa=BOa.fetchIntegerofObject(1,e),JOa=BOa.fetchIntegerofObject(2,e),FOa=BOa.fetchIntegerofObject(3,e),GOa=BOa.fetchIntegerofObject(4,e),!BOa.failed()&&!(r<JOa||IOa<0||JOa<=IOa)))return 1}(r)?(t=BOa.stackObjectValue(1),BOa.failed()?null:BOa.isWords(t)?(tOa=HNa(t),sOa=t.wordsAsInt32Array(),t=BOa.stackObjectValue(2),BOa.failed()?null:BOa.isWords(t)?(zOa=HNa(t),yOa=t.wordsAsInt32Array(),r=BOa.stackObjectValue(3),BOa.failed()?null:POa(NOa,r)?(t=BOa.stackObjectValue(4),BOa.failed()?null:!BOa.isWords(t)||HNa(t)!==RNa?BOa.primitiveFail():(e=t.wordsAsInt32Array(),BOa.failed()?null:(function(e,t){var r,i,a,s;if((r=ZOa(yOa,zOa))<0)return BOa.primitiveFail();for(0!==r&&(r=gPa(WOa(r),r)),r=t[oOa]=t[oOa]+r,e[0]=r,i=1;i<=RNa-1;i++)e[i]=0;for(a=1;a<RNa;){if((r=ZOa(sOa,tOa))<0)return BOa.primitiveFail();if(s=r>>>4,0!==(r&=15)){if(a+=s,r=gPa(WOa(r),r),a<0||RNa<=a)return BOa.primitiveFail();e[EOa[a]]=r}else{if(15!=s)return;a+=s}++a}}(e,NOa),BOa.failed()?null:(i=BOa.stackValue(0),BOa.storeIntegerofObjectwithValue(1,i,IOa),BOa.storeIntegerofObjectwithValue(3,i,FOa),BOa.storeIntegerofObjectwithValue(4,i,GOa),BOa.storeIntegerofObjectwithValue(oOa,BOa.stackValue(3),NOa[oOa]),void BOa.pop(5))))):BOa.primitiveFail()):BOa.primitiveFail()):BOa.primitiveFail()):BOa.primitiveFail())}function fPa(){var e,t;return 2!==BOa.methodArgumentCount()?BOa.primitiveFail():(e=BOa.stackObjectValue(0),BOa.failed()?null:BOa.isWords(e)&&HNa(e)===RNa?(t=e.wordsAsInt32Array(),e=BOa.stackObjectValue(1),BOa.failed()?null:BOa.isWords(e)&&HNa(e)===RNa?(function(e,t){var r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y=new Array(64);for(a=0;a<=QNa-1;a++){for(r=-1,n=1;n<=QNa-1;n++)-1===r&&0!==e[n*QNa+a]&&(r=n);if(-1===r)for(i=e[a]*t[0]<<2,s=0;s<=QNa-1;s++)y[s*QNa+a]=i;else p=(b=((v=e[2*QNa+a]*t[2*QNa+a])+(g=e[6*QNa+a]*t[6*QNa+a]))*VNa)+g*(0-bOa),d=b+v*XNa,l=(o=(v=e[a]*t[a])+(g=e[4*QNa+a]*t[4*QNa+a])<<13)+d,f=o-d,c=(u=v-g<<13)+p,h=u-p,o=e[7*QNa+a]*t[7*QNa+a],u=e[5*QNa+a]*t[5*QNa+a],p=e[3*QNa+a]*t[3*QNa+a],b=o+(d=e[QNa+a]*t[QNa+a]),v=u+p,_=((g=o+p)+(k=u+d))*ZNa,g*=0-cOa,k*=0-UNa,o=(o*=SNa)+(b*=0-YNa)+(g+=_),u=(u*=dOa)+(v*=0-eOa)+(k+=_),p=(p*=fOa)+v+g,d=(d*=_Na)+b+k,y[a]=l+d>>11,y[7*QNa+a]=l-d>>11,y[+QNa+a]=c+p>>11,y[6*QNa+a]=c-p>>11,y[2*QNa+a]=h+u>>11,y[5*QNa+a]=h-u>>11,y[3*QNa+a]=f+o>>11,y[4*QNa+a]=f-o>>11}for(a=0;a<=RNa-QNa;a+=QNa)p=(b=((v=y[a+2])+(g=y[a+6]))*VNa)+g*(0-bOa),d=b+v*XNa,l=(o=y[a]+y[a+4]<<13)+d,f=o-d,c=(u=y[a]-y[a+4]<<13)+p,h=u-p,o=y[a+7],u=y[a+5],p=y[a+3],b=o+(d=y[a+1]),v=u+p,_=((g=o+p)+(k=u+d))*ZNa,g*=0-cOa,k*=0-UNa,o=(o*=SNa)+(b*=0-YNa)+(g+=_),u=(u*=dOa)+(v*=0-eOa)+(k+=_),p=(p*=fOa)+v+g,m=(l+(d=(d*=_Na)+b+k)>>18)+qOa,m=Math.min(m,mOa),m=Math.max(m,0),e[a]=m,m=(l-d>>18)+qOa,m=Math.min(m,mOa),m=Math.max(m,0),e[a+7]=m,m=(c+p>>18)+qOa,m=Math.min(m,mOa),m=Math.max(m,0),e[a+1]=m,m=(c-p>>18)+qOa,m=Math.min(m,mOa),m=Math.max(m,0),e[a+6]=m,m=(h+u>>18)+qOa,m=Math.min(m,mOa),m=Math.max(m,0),e[a+2]=m,m=(h-u>>18)+qOa,m=Math.min(m,mOa),m=Math.max(m,0),e[a+5]=m,m=(f+o>>18)+qOa,m=Math.min(m,mOa),m=Math.max(m,0),e[a+3]=m,m=(f-o>>18)+qOa,m=Math.min(m,mOa),m=Math.max(m,0),e[a+4]=m}(e.wordsAsInt32Array(),t),void BOa.pop(2)):BOa.primitiveFail()):BOa.primitiveFail())}function gPa(e,t){return e<KNa(1,t-1)?e-KNa(1,t)+1:e}function hPa(e){return!1!=((BOa=e).majorVersion()==FNa)&&BOa.minorVersion()>=GNa}function jPa(e){return POa(NOa,e)&&QOa(MOa,e)}function nRa(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function oRa(e,t){return 0|Math.floor(e/t)}function pRa(e,t){return e-oRa(e,t)*t|0}function yRa(e,t){var r,i;return 0===e?0<=t?90:270:(r=t/e,i=Math.atan(r),0<=e?0<=t?i/.0174532925199433:360+i/.0174532925199433:180+i/.0174532925199433)}function zRa(e){var t,r;return r=(t=90-e)/360|0,t<0&&--r,.0174532925199433*(t-360*r)}function ARa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m;if(l=rRa.stackValue(0),t=rRa.stackValue(1),m=rRa.stackValue(2),f=rRa.stackValue(3),i=rRa.stackIntegerValue(4),s=rRa.stackIntegerValue(5),a=rRa.stackValue(6),rRa.failed())return null;if(!rRa.isWords(a))return rRa.primitiveFail(),null;if(!rRa.isWords(f))return rRa.primitiveFail(),null;if(!rRa.isWords(m))return rRa.primitiveFail(),null;if(!rRa.isWords(t))return rRa.primitiveFail(),null;if(!rRa.isBytes(l))return rRa.primitiveFail(),null;if(i*s!==nRa(a))return rRa.primitiveFail(),null;if(o=nRa(f),nRa(m)!==o)return rRa.primitiveFail(),null;if(nRa(t)!==o)return rRa.primitiveFail(),null;if(nRa(l)!==o)return rRa.primitiveFail(),null;for(h=f.wordsAsFloat32Array(),d=m.wordsAsFloat32Array(),e=t.words,u=l.bytes,r=a.words,n=0;n<=o-1;n++)c=0|h[n],p=0|d[n],0!==u[n]&&0<=c&&0<=p&&c<s&&p<i&&(r[p*s+c]=e[n]);if(rRa.failed())return null;rRa.pop(7)}function BRa(){var e,t,r,i,a,s,n;if(s=rRa.stackValue(0),r=rRa.stackValue(1),rRa.failed())return null;if(!rRa.isWords(r))return rRa.primitiveFail(),null;if(!rRa.isWords(s))return rRa.primitiveFail(),null;if(n=nRa(r),nRa(s)!==n)return rRa.primitiveFail(),null;for(t=r.wordsAsFloat32Array(),a=s.wordsAsFloat32Array(),i=0;i<=n-1;i++)e=t[i],0<(e=90-(e/=.0174532925199433))||(e+=360),a[i]=e;if(rRa.failed())return null;rRa.pop(2)}function CRa(){return tRa}function DRa(){var e,t,r;return t=rRa.stackValue(0),r=rRa.stackIntegerValue(1),rRa.failed()?null:!rRa.isWords(t)||nRa(t)<r?(rRa.primitiveFail(),null):(e=ZRa(e=t.wordsAsFloat32Array()[r-1]),rRa.failed()?null:(rRa.pop(3),void rRa.pushFloat(e)))}function ERa(){sRa=17,wRa=oRa(vRa=2147483647,uRa=16807),xRa=pRa(vRa,uRa)}function FRa(e){var t,r,i,a;return i=e<0?0-e:e,t=oRa(sRa,wRa),r=pRa(sRa,wRa),a=(65535&(sRa=uRa*r-xRa*t))*(i+1)>>>16,e<0?0-a:a}function GRa(){var e;if(e=rRa.stackIntegerValue(0),rRa.failed())return null;sRa=65536&e,rRa.pop(1)}function HRa(){var e,t,r,i,a,s,n,o,u,l,c,h;if(l=rRa.stackIntegerValue(0),u=rRa.stackIntegerValue(1),o=rRa.stackValue(2),i=rRa.stackValue(3),rRa.failed())return null;if((a=nRa(i))!==nRa(o))return rRa.primitiveFail(),null;if(l<-32)return rRa.primitiveFail(),null;if(8<l)return rRa.primitiveFail(),null;for(t=i.words,n=o.words,s=0;s<=a-1;s++)r=t[s],c=r,255<(e=(h=l)<0?h<-31?0:c>>>0-h:31<h?0:c<<h)&&(e=255),e<0&&(e=0),n[s]=e<<24&4278190080|u;rRa.pop(4)}function IRa(){var e,t,r,i,a,s,n,o,u,l,c,h;if(c=rRa.stackValue(0),h=rRa.stackIntegerValue(1),o=rRa.stackValue(2),i=rRa.stackValue(3),rRa.failed())return null;if(u=c.words[0],rRa.failed())return null;if(l=Math.log(u),(a=nRa(i))!==nRa(o))return rRa.primitiveFail(),null;for(t=i.words,n=o.words,s=0;s<=a-1;s++)255<(e=0===(r=t[s])?0:255/l*Math.log(r)|0)&&(e=255),n[s]=e<<24&4278190080|h;rRa.pop(4)}function JRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p;if(e=rRa.stackIntegerValue(0),u=rRa.stackIntegerValue(1),p=rRa.stackValue(2),h=rRa.stackValue(3),o=rRa.stackValue(4),a=rRa.stackValue(5),!rRa.isWords(p))return rRa.primitiveFail(),null;if(!rRa.isWords(h))return rRa.primitiveFail(),null;if(!rRa.isWords(o))return rRa.primitiveFail(),null;if(!rRa.isWords(a))return rRa.primitiveFail(),null;if(s=nRa(o),nRa(h)!==s)return rRa.primitiveFail(),null;if(nRa(p)!==s)return rRa.primitiveFail(),null;if(nRa(a)!==e*u)return rRa.primitiveFail(),null;for(c=h.wordsAsFloat32Array(),f=p.wordsAsFloat32Array(),n=o.words,r=a.words,t=0;t<=e*u-1;t++)r[t]=0;for(t=0;t<=s-1;t++)l=c[t],0<=(i=u*f[t]+l)&&i<e*u&&(r[i]=n[t]);if(rRa.failed())return null;rRa.pop(6)}function KRa(){var e,t,r,i,a,s,n,o,u;return r=rRa.stackIntegerValue(0),a=rRa.stackIntegerValue(1),u=rRa.stackFloatValue(2),n=rRa.stackFloatValue(3),t=rRa.stackValue(4),rRa.failed()?null:!rRa.isWords(t)||nRa(t)!==r*a?(rRa.primitiveFail(),null):(s=0|n,o=0|u,e=t.words,i=0<=s&&s<a&&0<=o&&o<r?e[o*a+s]:0,rRa.failed()?null:(rRa.pop(6),void rRa.pushInteger(i)))}function LRa(){var e,t,r,i,a,s,n,o,u,l;return r=rRa.stackIntegerValue(0),s=rRa.stackIntegerValue(1),a=rRa.stackIntegerValue(2),l=rRa.stackFloatValue(3),o=rRa.stackFloatValue(4),t=rRa.stackValue(5),rRa.failed()?null:!rRa.isWords(t)||nRa(t)!==r*s?(rRa.primitiveFail(),null):(n=0|o,u=0|l,1073741823<(i=a)&&(i=1073741823),i<0&&(i=0),e=t.words,0<=n&&n<s&&0<=u&&u<r&&(e[u*s+n]=i),rRa.failed()?null:void rRa.pop(6))}function MRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d;if(n=rRa.stackValue(0),t=rRa.stackIntegerValue(1),a=rRa.stackIntegerValue(2),i=rRa.stackValue(3),d=rRa.stackValue(4),h=rRa.stackValue(5),rRa.failed())return null;if(!rRa.isWords(n))return rRa.primitiveFail(),null;if(!rRa.isWords(h))return rRa.primitiveFail(),null;if(!rRa.isWords(d))return rRa.primitiveFail(),null;if(!rRa.isWords(i))return rRa.primitiveFail(),null;if(t*a!==nRa(i))return rRa.primitiveFail(),null;if(u=nRa(h),nRa(d)!==u)return rRa.primitiveFail(),null;if(nRa(n)!==u)return rRa.primitiveFail(),null;for(c=h.wordsAsFloat32Array(),p=d.wordsAsFloat32Array(),s=n.words,e=i.words,o=0;o<=u-1;o++)l=0|c[o],f=0|p[o],0<=l&&0<=f&&l<a&&f<t&&(r=f*a+l,s[o]=e[r]);if(rRa.failed())return null;rRa.pop(6)}function NRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g;return e=rRa.stackIntegerValue(0),p=rRa.stackIntegerValue(1),h=rRa.stackIntegerValue(2),u=rRa.stackIntegerValue(3),t=rRa.stackFloatValue(4),r=rRa.stackFloatValue(5),d=rRa.stackFloatValue(6),s=rRa.stackValue(7),g=rRa.stackValue(8),b=rRa.stackValue(9),o=rRa.stackIntegerValue(10),rRa.failed()?null:rRa.isWords(b)&&rRa.isWords(g)&&rRa.isWords(s)?(f=nRa(b),nRa(g)!==f||nRa(s)!==f?(rRa.primitiveFail(),null):(m=b.wordsAsFloat32Array(),v=g.wordsAsFloat32Array(),a=s.wordsAsFloat32Array(),i=d,l=m[n=o-1]+i*Math.cos(a[n]),c=v[n]-i*Math.sin(a[n]),dSa(n,m,a,l,r,u,h),eSa(n,v,a,c,t,p,e),rRa.failed()?null:void rRa.pop(11))):(rRa.primitiveFail(),null)}function ORa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v;if(c=rRa.stackValue(0),t=rRa.stackIntegerValue(1),a=rRa.stackIntegerValue(2),i=rRa.stackValue(3),v=rRa.stackValue(4),d=rRa.stackValue(5),rRa.failed())return null;if(!rRa.isWords(d))return rRa.primitiveFail(),null;if(!rRa.isWords(v))return rRa.primitiveFail(),null;if(!rRa.isWords(i))return rRa.primitiveFail(),null;if(t*a!==nRa(i))return rRa.primitiveFail(),null;if(u=nRa(d),nRa(v)!==u)return rRa.primitiveFail(),null;if((o="number"==typeof c)&&(n=c),!o){if(!rRa.isMemberOf(c,"WordArray"))return rRa.primitiveFail(),null;if(nRa(c)!==u)return rRa.primitiveFail(),null}for(p=d.wordsAsFloat32Array(),b=v.wordsAsFloat32Array(),o||(h=c.words),e=i.words,o&&(l=n),s=0;s<=u-1;s++)f=0|p[s],m=0|b[s],0<=f&&0<=m&&f<a&&m<t&&(r=m*a+f,o||(l=h[s]),e[r]=l);if(rRa.failed())return null;rRa.pop(6)}function PRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_;if(e=rRa.stackIntegerValue(0),p=rRa.stackIntegerValue(1),h=rRa.stackIntegerValue(2),u=rRa.stackIntegerValue(3),t=rRa.stackFloatValue(4),r=rRa.stackFloatValue(5),b=rRa.stackValue(6),s=rRa.stackValue(7),_=rRa.stackValue(8),g=rRa.stackValue(9),rRa.failed())return null;if(!rRa.isWords(g))return rRa.primitiveFail(),null;if(!rRa.isWords(_))return rRa.primitiveFail(),null;if(!rRa.isWords(s))return rRa.primitiveFail(),null;if(b.isFloat)o=!1;else{if(!rRa.isWords(b))return rRa.primitiveFail(),null;o=!0}if(f=nRa(g),nRa(_)!==f)return rRa.primitiveFail(),null;if(nRa(s)!==f)return rRa.primitiveFail(),null;if(o&&nRa(b)!==f)return rRa.primitiveFail(),null;for(v=g.wordsAsFloat32Array(),k=_.wordsAsFloat32Array(),a=s.wordsAsFloat32Array(),o?m=b.wordsAsFloat32Array():d=rRa.floatValueOf(b),n=0;n<=f-1;n++)i=o?m[n]:d,l=v[n]+i*Math.cos(a[n]),c=k[n]-i*Math.sin(a[n]),dSa(n,v,a,l,r,u,h),eSa(n,k,a,c,t,p,e);if(rRa.failed())return null;rRa.pop(10)}function QRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y;if(c=rRa.stackIntegerValue(0),a=rRa.stackIntegerValue(1),k=rRa.stackIntegerValue(2),t=rRa.stackValue(3),p=rRa.stackFloatValue(4),m=rRa.stackFloatValue(5),d=rRa.stackFloatValue(6),rRa.failed())return null;if(!rRa.isWords(t))return rRa.primitiveFail(),null;if(nRa(t)!==a*k)return rRa.primitiveFail(),null;for(e=t.words,v=d,g=m,v=Math.max(v,0),g=Math.max(g,0),v=Math.min(v,k-1),g=Math.min(g,a-1),h=Math.max(v-c,0),r=Math.min(v+c,k-1),f=Math.max(g-c,0),i=Math.min(g+c,a-1),s=e[g*k+v],n=-1,y=f;y<=i;y++)for(l=y*k,_=h;_<=r;_++)s<(b=e[l+_])&&(n=_,o=y,s=b);if(u=-1===n?ZRa(p):yRa(n-v,o-g)+90|0,rRa.failed())return null;rRa.pop(8),rRa.pushFloat(u)}function RRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(l=rRa.stackObjectValue(0),e=rRa.stackObjectValue(1),u=rRa.stackObjectValue(2),rRa.failed())return null;if(rRa.success(rRa.isWords(e)),rRa.success(rRa.isWords(u)),rRa.success(rRa.isWords(l)),rRa.failed())return null;if(o=nRa(e),rRa.success(o===nRa(u)),rRa.success(o===nRa(l)),rRa.failed())return null;if(s=rRa.isMemberOf(e,"WordArray"),n=rRa.isMemberOf(u,"WordArray"),s&&n){if(!rRa.isMemberOf(l,"WordArray"))return rRa.primitiveFail(),null}else if(!rRa.isMemberOf(l,"KedamaFloatArray"))return rRa.primitiveFail(),null;if(n)if(s)for(h=u.words,c=e.words,f=l.words,a=0;a<=o-1;a++)f[a]=h[a]+c[a];else for(h=u.words,t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=h[a]+t[a];else if(s)for(r=u.wordsAsFloat32Array(),c=e.words,i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]+c[a];else for(r=u.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]+t[a];rRa.pop(4),rRa.push(l)}function SRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(c=rRa.stackObjectValue(0),e=rRa.stackValue(1),l=rRa.stackObjectValue(2),rRa.failed())return null;if(rRa.success(rRa.isWords(l)),rRa.success(rRa.isWords(c)),rRa.failed())return null;if(u=nRa(l),rRa.success(u===nRa(c)),rRa.failed())return null;if(n="number"==typeof e,o=rRa.isMemberOf(l,"WordArray"),n&&o){if(!rRa.isMemberOf(c,"WordArray"))return rRa.primitiveFail(),null}else if(!rRa.isMemberOf(c,"KedamaFloatArray"))return rRa.primitiveFail(),null;if(o)if(n)for(h=l.words,s=e,f=c.words,a=0;a<=u-1;a++)f[a]=h[a]+s;else for(h=l.words,t=rRa.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=h[a]+t;else if(n)for(r=l.wordsAsFloat32Array(),s=e,i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]+s;else for(r=l.wordsAsFloat32Array(),t=rRa.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]+t;rRa.pop(4),rRa.push(c)}function TRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(l=rRa.stackObjectValue(0),e=rRa.stackObjectValue(1),u=rRa.stackObjectValue(2),rRa.failed())return null;if(rRa.success(rRa.isWords(e)),rRa.success(rRa.isWords(u)),rRa.success(rRa.isWords(l)),rRa.failed())return null;if(o=nRa(e),rRa.success(o===nRa(u)),rRa.success(o===nRa(l)),rRa.failed())return null;if(s=rRa.isMemberOf(e,"WordArray"),n=rRa.isMemberOf(u,"WordArray"),s&&n){if(!rRa.isMemberOf(l,"WordArray"))return rRa.primitiveFail(),null}else if(!rRa.isMemberOf(l,"KedamaFloatArray"))return rRa.primitiveFail(),null;if(n)if(s)for(h=u.words,c=e.words,f=l.words,a=0;a<=o-1;a++)f[a]=h[a]/c[a];else for(h=u.words,t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=h[a]/t[a];else if(s)for(r=u.wordsAsFloat32Array(),c=e.words,i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]/c[a];else for(r=u.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]/t[a];rRa.pop(4),rRa.push(l)}function URa(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(c=rRa.stackObjectValue(0),e=rRa.stackValue(1),l=rRa.stackObjectValue(2),rRa.failed())return null;if(rRa.success(rRa.isWords(l)),rRa.success(rRa.isWords(c)),rRa.failed())return null;if(u=nRa(l),rRa.success(u===nRa(c)),rRa.failed())return null;if(n="number"==typeof e,o=rRa.isMemberOf(l,"WordArray"),n&&o){if(!rRa.isMemberOf(c,"WordArray"))return rRa.primitiveFail(),null}else if(!rRa.isMemberOf(c,"KedamaFloatArray"))return rRa.primitiveFail(),null;if(o)if(n)for(h=l.words,s=e,f=c.words,a=0;a<=u-1;a++)f[a]=oRa(h[a],s);else for(h=l.words,t=rRa.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=h[a]/t;else if(n)for(r=l.wordsAsFloat32Array(),s=e,i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]/s;else for(r=l.wordsAsFloat32Array(),t=rRa.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]/t;rRa.pop(4),rRa.push(c)}function VRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(l=rRa.stackObjectValue(0),e=rRa.stackObjectValue(1),u=rRa.stackObjectValue(2),rRa.failed())return null;if(rRa.success(rRa.isWords(e)),rRa.success(rRa.isWords(u)),rRa.success(rRa.isWords(l)),rRa.failed())return null;if(o=nRa(e),rRa.success(o===nRa(u)),rRa.success(o===nRa(l)),rRa.failed())return null;if(s=rRa.isMemberOf(e,"WordArray"),n=rRa.isMemberOf(u,"WordArray"),s&&n){if(!rRa.isMemberOf(l,"WordArray"))return rRa.primitiveFail(),null}else if(!rRa.isMemberOf(l,"KedamaFloatArray"))return rRa.primitiveFail(),null;if(n)if(s)for(h=u.words,c=e.words,f=l.words,a=0;a<=o-1;a++)f[a]=h[a]*c[a];else for(h=u.words,t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=h[a]*t[a];else if(s)for(r=u.wordsAsFloat32Array(),c=e.words,i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]*c[a];else for(r=u.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]*t[a];rRa.pop(4),rRa.push(l)}function WRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(c=rRa.stackObjectValue(0),e=rRa.stackValue(1),l=rRa.stackObjectValue(2),rRa.failed())return null;if(rRa.success(rRa.isWords(l)),rRa.success(rRa.isWords(c)),rRa.failed())return null;if(u=nRa(l),rRa.success(u===nRa(c)),rRa.failed())return null;if(n="number"==typeof e,o=rRa.isMemberOf(l,"WordArray"),n&&o){if(!rRa.isMemberOf(c,"WordArray"))return rRa.primitiveFail(),null}else if(!rRa.isMemberOf(c,"KedamaFloatArray"))return rRa.primitiveFail(),null;if(o)if(n)for(h=l.words,s=e,f=c.words,a=0;a<=u-1;a++)f[a]=h[a]*s;else for(h=l.words,t=rRa.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=h[a]*t;else if(n)for(r=l.wordsAsFloat32Array(),s=e,i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]*s;else for(r=l.wordsAsFloat32Array(),t=rRa.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]*t;rRa.pop(4),rRa.push(c)}function XRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(l=rRa.stackObjectValue(0),e=rRa.stackObjectValue(1),u=rRa.stackObjectValue(2),rRa.failed())return null;if(rRa.success(rRa.isWords(e)),rRa.success(rRa.isWords(u)),rRa.success(rRa.isWords(l)),rRa.failed())return null;if(o=nRa(e),rRa.success(o===nRa(u)),rRa.success(o===nRa(l)),rRa.failed())return null;if(s=rRa.isMemberOf(e,"WordArray"),n=rRa.isMemberOf(u,"WordArray"),s&&n){if(!rRa.isMemberOf(l,"WordArray"))return rRa.primitiveFail(),null}else if(!rRa.isMemberOf(l,"KedamaFloatArray"))return rRa.primitiveFail(),null;if(n)if(s)for(h=u.words,c=e.words,f=l.words,a=0;a<=o-1;a++)f[a]=h[a]-c[a];else for(h=u.words,t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=h[a]-t[a];else if(s)for(r=u.wordsAsFloat32Array(),c=e.words,i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]-c[a];else for(r=u.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]-t[a];rRa.pop(4),rRa.push(l)}function YRa(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(c=rRa.stackObjectValue(0),e=rRa.stackValue(1),l=rRa.stackObjectValue(2),rRa.failed())return null;if(rRa.success(rRa.isWords(l)),rRa.success(rRa.isWords(c)),rRa.failed())return null;if(u=nRa(l),rRa.success(u===nRa(c)),rRa.failed())return null;if(n="number"==typeof e,o=rRa.isMemberOf(l,"WordArray"),n&&o){if(!rRa.isMemberOf(c,"WordArray"))return rRa.primitiveFail(),null}else if(!rRa.isMemberOf(c,"KedamaFloatArray"))return rRa.primitiveFail(),null;if(o)if(n)for(h=l.words,s=e,f=c.words,a=0;a<=u-1;a++)f[a]=h[a]-s;else for(h=l.words,t=rRa.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=h[a]-t;else if(n)for(r=l.wordsAsFloat32Array(),s=e,i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]-s;else for(r=l.wordsAsFloat32Array(),t=rRa.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]-t;rRa.pop(4),rRa.push(c)}function ZRa(e){var t;return 0<(t=90-e/.0174532925199433)||(t+=360),t}function $Ra(){var e,t,r,i,a,s,n;if(e=rRa.stackFloatValue(0),r=rRa.stackValue(1),n=rRa.stackIntegerValue(2),i=rRa.stackIntegerValue(3),s=rRa.stackIntegerValue(4),rRa.failed())return null;if(!rRa.isWords(r))return rRa.primitiveFail(),null;if(!(n<=nRa(r)&&1<=i&&i<=n))return rRa.primitiveFail(),null;if(t=r.wordsAsFloat32Array(),rRa.failed())return null;for(a=i;a<=n;a++)t[a-1]=FRa(s)*e;rRa.pop(5)}function _Ra(){var e,t,r,i,a,s,n;if(e=rRa.stackFloatValue(0),a=rRa.stackValue(1),n=rRa.stackIntegerValue(2),t=rRa.stackIntegerValue(3),s=rRa.stackIntegerValue(4),rRa.failed())return null;if(!rRa.isWords(a))return rRa.primitiveFail(),null;if(!(n<=nRa(a)&&1<=t&&t<=n))return rRa.primitiveFail(),null;if(i=a.words,rRa.failed())return null;for(r=t;r<=n;r++)i[r-1]=FRa(s)*e|0;rRa.pop(5)}function aSa(){var e,t;return e=rRa.stackIntegerValue(0),rRa.failed()?null:(t=FRa(e),rRa.failed()?null:(rRa.pop(2),void rRa.pushInteger(t)))}function bSa(){var e,t,r,i,a;return t=rRa.stackFloatValue(0),e=rRa.stackFloatValue(1),a=rRa.stackFloatValue(2),i=rRa.stackFloatValue(3),rRa.failed()?null:(r=yRa(i-e,a-t),360<(r+=90)&&(r-=360),rRa.failed()?null:(rRa.pop(5),void rRa.pushFloat(r)))}function cSa(){var e,t,r,i,a,s,n;return t=rRa.stackFloatValue(0),e=rRa.stackFloatValue(1),a=rRa.stackFloatValue(2),i=rRa.stackFloatValue(3),rRa.failed()?null:(s=e-i,n=t-a,r=Math.sqrt(s*s+n*n),rRa.failed()?null:(rRa.pop(5),void rRa.pushFloat(r)))}function dSa(e,t,r,i,a,s,n){var o,u;(u=i)<0&&(1===s&&(u+=a),2===s&&(u=0),3===s&&(u=0-u,o=r[e],r[e]=o<3.141592653589793?3.141592653589793-o:9.42477796076938-o)),a<=u&&(1===n&&(u-=a),2===n&&(u=a-1e-6),3===n&&(u=a-1e-6-(u-a),o=r[e],r[e]=o<3.141592653589793?3.141592653589793-o:9.42477796076938-o)),t[e]=u}function eSa(e,t,r,i,a,s,n){var o;(o=i)<0&&(1===s&&(o+=a),2===s&&(o=0),3===s&&(o=0-o,r[e]=6.283185307179586-r[e])),a<=o&&(1===n&&(o-=a),2===n&&(o=a-1e-6),3===n&&(o=a-1e-6-(o-a),r[e]=6.283185307179586-r[e])),t[e]=o}function fSa(){var e,t,r,i,a,s,n,o;if(n=rRa.stackValue(0),r=rRa.stackValue(1),rRa.failed())return null;if(!rRa.isWords(r))return rRa.primitiveFail(),null;if(o=nRa(r),n.isFloat)a=!1;else{if(!rRa.isWords(n))return rRa.primitiveFail(),null;if(nRa(n)!==o)return rRa.primitiveFail(),null;a=!0}for(t=r.wordsAsFloat32Array(),a?s=n.wordsAsFloat32Array():e=zRa(e=rRa.floatValueOf(n)),i=0;i<=o-1;i++)a&&(e=zRa(e=s[i])),t[i]=e;if(rRa.failed())return null;rRa.pop(2)}function gSa(e){return!1!=((rRa=e).majorVersion()==lRa)&&rRa.minorVersion()>=mRa}function hSa(){var e,t,r;return e=rRa.stackFloatValue(0),t=rRa.stackValue(1),r=rRa.stackIntegerValue(2),rRa.failed()?null:!rRa.isWords(t)||nRa(t)<r?(rRa.primitiveFail(),null):(t.wordsAsFloat32Array()[r-1]=zRa(e),rRa.failed()?null:void rRa.pop(3))}function iSa(){return!0}function jSa(){var e,t,r,i,a,s,n,o;return i=rRa.stackIntegerValue(0),r=rRa.stackIntegerValue(1),e=rRa.stackFloatValue(2),s=rRa.stackFloatValue(3),t=rRa.stackValue(4),n=rRa.stackIntegerValue(5),o=rRa.stackValue(6),rRa.failed()?null:rRa.isWords(o)&&rRa.isWords(t)?(a=nRa(o),nRa(t)!==a?(rRa.primitiveFail(),null):(dSa(n-1,o.wordsAsFloat32Array(),t.wordsAsFloat32Array(),s,e,r,i),rRa.failed()?null:void rRa.pop(7))):(rRa.primitiveFail(),null)}function kSa(){var e,t,r,i,a,s,n,o;return e=rRa.stackIntegerValue(0),a=rRa.stackIntegerValue(1),t=rRa.stackFloatValue(2),s=rRa.stackFloatValue(3),r=rRa.stackValue(4),n=rRa.stackIntegerValue(5),o=rRa.stackValue(6),rRa.failed()?null:rRa.isWords(o)&&rRa.isWords(r)?(i=nRa(o),nRa(r)!==i?(rRa.primitiveFail(),null):(eSa(n-1,o.wordsAsFloat32Array(),r.wordsAsFloat32Array(),s,t,a,e),rRa.failed()?null:void rRa.pop(7))):(rRa.primitiveFail(),null)}function lSa(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(n=rRa.stackIntegerValue(0),s=rRa.stackIntegerValue(1),e=rRa.stackFloatValue(2),c=rRa.stackValue(3),r=rRa.stackValue(4),f=rRa.stackValue(5),rRa.failed())return null;if(!rRa.isWords(f))return rRa.primitiveFail(),null;if(!rRa.isWords(r))return rRa.primitiveFail(),null;if(c.isFloat)a=!1;else{if(!rRa.isWords(c))return rRa.primitiveFail(),null;a=!0}if(o=nRa(f),nRa(r)!==o)return rRa.primitiveFail(),null;if(a&&nRa(c)!==o)return rRa.primitiveFail(),null;for(h=f.wordsAsFloat32Array(),t=r.wordsAsFloat32Array(),a?l=c.wordsAsFloat32Array():u=rRa.floatValueOf(c),i=0;i<=o-1;i++)dSa(i,h,t,a?l[i]:u,e,s,n);if(rRa.failed())return null;rRa.pop(6)}function mSa(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(e=rRa.stackIntegerValue(0),o=rRa.stackIntegerValue(1),t=rRa.stackFloatValue(2),c=rRa.stackValue(3),i=rRa.stackValue(4),f=rRa.stackValue(5),rRa.failed())return null;if(!rRa.isWords(f))return rRa.primitiveFail(),null;if(!rRa.isWords(i))return rRa.primitiveFail(),null;if(c.isFloat)s=!1;else{if(!rRa.isWords(c))return rRa.primitiveFail(),null;s=!0}if(n=nRa(f),nRa(i)!==n)return rRa.primitiveFail(),null;if(s&&nRa(c)!==n)return rRa.primitiveFail(),null;for(h=f.wordsAsFloat32Array(),r=i.wordsAsFloat32Array(),s?l=c.wordsAsFloat32Array():u=rRa.floatValueOf(c),a=0;a<=n-1;a++)eSa(a,h,r,s?l[a]:u,t,o,e);if(rRa.failed())return null;rRa.pop(6)}function nSa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m;if(c=rRa.stackValue(0),m=rRa.stackValue(1),p=rRa.stackValue(2),s=rRa.stackValue(3),i=rRa.stackValue(4),rRa.failed())return null;if(!rRa.isWords(c))return rRa.primitiveFail(),null;if(!rRa.isWords(p))return rRa.primitiveFail(),null;if(!rRa.isWords(m))return rRa.primitiveFail(),null;if((h=nRa(c))<0)return rRa.primitiveFail(),null;if(nRa(p)!==h)return rRa.primitiveFail(),null;if(nRa(m)!==h)return rRa.primitiveFail(),null;if(i.isFloat){if(!s.isFloat)return rRa.primitiveFail(),null;t=!1}else{if(s.isFloat)return rRa.primitiveFail(),null;t=!0}if(t){if(nRa(i)!==h)return rRa.primitiveFail(),null;if(nRa(s)!==h)return rRa.primitiveFail(),null}for(l=c.wordsAsFloat32Array(),f=p.wordsAsFloat32Array(),d=m.wordsAsFloat32Array(),t&&(r=i.wordsAsFloat32Array(),a=s.wordsAsFloat32Array()),t||(n=rRa.floatValueOf(i),o=rRa.floatValueOf(s)),e=0;e<=h-1;e++)t&&(n=r[e],o=a[e]),u=yRa(n-f[e],o-d[e]),360<(u+=90)&&(u-=360),l[e]=u;if(rRa.failed())return null;rRa.pop(6),rRa.push(c)}function oSa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b;if(l=rRa.stackValue(0),b=rRa.stackValue(1),p=rRa.stackValue(2),s=rRa.stackValue(3),i=rRa.stackValue(4),rRa.failed())return null;if(!rRa.isWords(l))return rRa.primitiveFail(),null;if(!rRa.isWords(p))return rRa.primitiveFail(),null;if(!rRa.isWords(b))return rRa.primitiveFail(),null;if((c=nRa(l))<0)return rRa.primitiveFail(),null;if(nRa(p)!==c)return rRa.primitiveFail(),null;if(nRa(b)!==c)return rRa.primitiveFail(),null;if(i.isFloat){if(!s.isFloat)return rRa.primitiveFail(),null;t=!1}else{if(s.isFloat)return rRa.primitiveFail(),null;t=!0}if(t){if(nRa(i)!==c)return rRa.primitiveFail(),null;if(nRa(s)!==c)return rRa.primitiveFail(),null}for(u=l.wordsAsFloat32Array(),f=p.wordsAsFloat32Array(),m=b.wordsAsFloat32Array(),t&&(r=i.wordsAsFloat32Array(),a=s.wordsAsFloat32Array()),t||(n=rRa.floatValueOf(i),o=rRa.floatValueOf(s)),e=0;e<=c-1;e++)t&&(n=r[e],o=a[e]),h=n-f[e],d=o-m[e],u[e]=Math.sqrt(h*h+d*d);if(rRa.failed())return null;rRa.pop(6),rRa.push(l)}function pSa(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v;if(v=rRa.stackIntegerValue(0),m=rRa.stackIntegerValue(1),n=rRa.stackIntegerValue(2),u=rRa.stackIntegerValue(3),r=rRa.stackValue(4),l=rRa.stackValue(5),rRa.failed())return null;if(f=nRa(l),a=nRa(r),u*n!==f)return rRa.primitiveFail(),null;if(f*m*v!==a)return rRa.primitiveFail(),null;for(o=l.words,t=r.words,d=i=h=c=0;d<=n-1;d++){for(b=0;b<=v-1;b++){for(p=0;p<=u-1;p++)for(e=o[c],++c,s=0;s<=m-1;s++)t[i]=e,++i;c=h}c=h+=u}rRa.pop(6)}function o_a(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function p_a(e,t){return 0|Math.floor(e/t)}function q_a(e,t){return e-p_a(e,t)*t|0}function z_a(e,t){var r,i;return 0===e?0<=t?90:270:(r=t/e,i=Math.atan(r),0<=e?0<=t?i/.0174532925199433:360+i/.0174532925199433:180+i/.0174532925199433)}function A_a(e){var t,r;return r=(t=90-e)/360|0,t<0&&--r,.0174532925199433*(t-360*r)}function B_a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m;if(l=s_a.stackValue(0),t=s_a.stackValue(1),m=s_a.stackValue(2),f=s_a.stackValue(3),i=s_a.stackIntegerValue(4),s=s_a.stackIntegerValue(5),a=s_a.stackValue(6),s_a.failed())return null;if(!s_a.isWords(a))return s_a.primitiveFail(),null;if(!s_a.isWords(f))return s_a.primitiveFail(),null;if(!s_a.isWords(m))return s_a.primitiveFail(),null;if(!s_a.isWords(t))return s_a.primitiveFail(),null;if(!s_a.isBytes(l))return s_a.primitiveFail(),null;if(i*s!==o_a(a))return s_a.primitiveFail(),null;if(o=o_a(f),o_a(m)!==o)return s_a.primitiveFail(),null;if(o_a(t)!==o)return s_a.primitiveFail(),null;if(o_a(l)!==o)return s_a.primitiveFail(),null;for(h=f.wordsAsFloat32Array(),d=m.wordsAsFloat32Array(),e=t.words,u=l.bytes,r=a.words,n=0;n<=o-1;n++)c=0|h[n],p=0|d[n],0!==u[n]&&0<=c&&0<=p&&c<s&&p<i&&(r[p*s+c]=e[n]);if(s_a.failed())return null;s_a.pop(7)}function C_a(){var e,t,r,i,a,s,n;if(s=s_a.stackValue(0),r=s_a.stackValue(1),s_a.failed())return null;if(!s_a.isWords(r))return s_a.primitiveFail(),null;if(!s_a.isWords(s))return s_a.primitiveFail(),null;if(n=o_a(r),o_a(s)!==n)return s_a.primitiveFail(),null;for(t=r.wordsAsFloat32Array(),a=s.wordsAsFloat32Array(),i=0;i<=n-1;i++)e=t[i],0<(e=90-(e/=.0174532925199433))||(e+=360),a[i]=e;if(s_a.failed())return null;s_a.pop(2)}function D_a(){return u_a}function E_a(){var e,t,r;return t=s_a.stackValue(0),r=s_a.stackIntegerValue(1),s_a.failed()?null:!s_a.isWords(t)||o_a(t)<r?(s_a.primitiveFail(),null):(e=v0a(e=t.wordsAsFloat32Array()[r-1]),s_a.failed()?null:(s_a.pop(3),void s_a.pushFloat(e)))}function F_a(){t_a=17,x_a=p_a(w_a=2147483647,v_a=16807),y_a=q_a(w_a,v_a)}function G_a(e){var t,r,i,a;return i=e<0?0-e:e,t=p_a(t_a,x_a),r=q_a(t_a,x_a),a=(65535&(t_a=v_a*r-y_a*t))*(i+1)>>>16,e<0?0-a:a}function H_a(){var e;if(e=s_a.stackIntegerValue(0),s_a.failed())return null;t_a=65536&e,s_a.pop(1)}function I_a(){var e,t,r,i,a,s,n,o,u,l,c,h;if(l=s_a.stackIntegerValue(0),u=s_a.stackIntegerValue(1),o=s_a.stackValue(2),i=s_a.stackValue(3),s_a.failed())return null;if((a=o_a(i))!==o_a(o))return s_a.primitiveFail(),null;if(l<-32)return s_a.primitiveFail(),null;if(8<l)return s_a.primitiveFail(),null;for(t=i.words,n=o.words,s=0;s<=a-1;s++)r=t[s],c=r,255<(e=(h=l)<0?h<-31?0:c>>>0-h:31<h?0:c<<h)&&(e=255),e<0&&(e=0),n[s]=e<<24&4278190080|u;s_a.pop(4)}function J_a(){var e,t,r,i,a,s,n,o,u,l,c,h;if(c=s_a.stackValue(0),h=s_a.stackIntegerValue(1),o=s_a.stackValue(2),i=s_a.stackValue(3),s_a.failed())return null;if(u=c.words[0],s_a.failed())return null;if(l=Math.log(u),(a=o_a(i))!==o_a(o))return s_a.primitiveFail(),null;for(t=i.words,n=o.words,s=0;s<=a-1;s++)255<(e=0===(r=t[s])?0:255/l*Math.log(r)|0)&&(e=255),n[s]=e<<24&4278190080|h;s_a.pop(4)}function K_a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p;if(e=s_a.stackIntegerValue(0),u=s_a.stackIntegerValue(1),p=s_a.stackValue(2),h=s_a.stackValue(3),o=s_a.stackValue(4),a=s_a.stackValue(5),!s_a.isWords(p))return s_a.primitiveFail(),null;if(!s_a.isWords(h))return s_a.primitiveFail(),null;if(!s_a.isWords(o))return s_a.primitiveFail(),null;if(!s_a.isWords(a))return s_a.primitiveFail(),null;if(s=o_a(o),o_a(h)!==s)return s_a.primitiveFail(),null;if(o_a(p)!==s)return s_a.primitiveFail(),null;if(o_a(a)!==e*u)return s_a.primitiveFail(),null;for(c=h.wordsAsFloat32Array(),f=p.wordsAsFloat32Array(),n=o.words,r=a.words,t=0;t<=e*u-1;t++)r[t]=0;for(t=0;t<=s-1;t++)l=c[t],0<=(i=u*f[t]+l)&&i<e*u&&(r[i]=n[t]);if(s_a.failed())return null;s_a.pop(6)}function L_a(){var e,t,r,i,a,s,n,o,u;return r=s_a.stackIntegerValue(0),a=s_a.stackIntegerValue(1),u=s_a.stackFloatValue(2),n=s_a.stackFloatValue(3),t=s_a.stackValue(4),s_a.failed()?null:!s_a.isWords(t)||o_a(t)!==r*a?(s_a.primitiveFail(),null):(s=0|n,o=0|u,e=t.words,i=0<=s&&s<a&&0<=o&&o<r?e[o*a+s]:0,s_a.failed()?null:(s_a.pop(6),void s_a.pushInteger(i)))}function M_a(){var e,t,r,i,a,s,n,o,u,l;return r=s_a.stackIntegerValue(0),s=s_a.stackIntegerValue(1),a=s_a.stackIntegerValue(2),l=s_a.stackFloatValue(3),o=s_a.stackFloatValue(4),t=s_a.stackValue(5),s_a.failed()?null:!s_a.isWords(t)||o_a(t)!==r*s?(s_a.primitiveFail(),null):(n=0|o,u=0|l,1073741823<(i=a)&&(i=1073741823),i<0&&(i=0),e=t.words,0<=n&&n<s&&0<=u&&u<r&&(e[u*s+n]=i),s_a.failed()?null:void s_a.pop(6))}function N_a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d;if(n=s_a.stackValue(0),t=s_a.stackIntegerValue(1),a=s_a.stackIntegerValue(2),i=s_a.stackValue(3),d=s_a.stackValue(4),h=s_a.stackValue(5),s_a.failed())return null;if(!s_a.isWords(n))return s_a.primitiveFail(),null;if(!s_a.isWords(h))return s_a.primitiveFail(),null;if(!s_a.isWords(d))return s_a.primitiveFail(),null;if(!s_a.isWords(i))return s_a.primitiveFail(),null;if(t*a!==o_a(i))return s_a.primitiveFail(),null;if(u=o_a(h),o_a(d)!==u)return s_a.primitiveFail(),null;if(o_a(n)!==u)return s_a.primitiveFail(),null;for(c=h.wordsAsFloat32Array(),p=d.wordsAsFloat32Array(),s=n.words,e=i.words,o=0;o<=u-1;o++)l=0|c[o],f=0|p[o],0<=l&&0<=f&&l<a&&f<t&&(r=f*a+l,s[o]=e[r]);if(s_a.failed())return null;s_a.pop(6)}function O_a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g;return e=s_a.stackIntegerValue(0),p=s_a.stackIntegerValue(1),h=s_a.stackIntegerValue(2),u=s_a.stackIntegerValue(3),t=s_a.stackFloatValue(4),r=s_a.stackFloatValue(5),d=s_a.stackFloatValue(6),s=s_a.stackValue(7),g=s_a.stackValue(8),b=s_a.stackValue(9),o=s_a.stackIntegerValue(10),s_a.failed()?null:s_a.isWords(b)&&s_a.isWords(g)&&s_a.isWords(s)?(f=o_a(b),o_a(g)!==f||o_a(s)!==f?(s_a.primitiveFail(),null):(m=b.wordsAsFloat32Array(),v=g.wordsAsFloat32Array(),a=s.wordsAsFloat32Array(),i=d,l=m[n=o-1]+i*Math.cos(a[n]),c=v[n]-i*Math.sin(a[n]),B0a(n,m,a,l,r,u,h),C0a(n,v,a,c,t,p,e),s_a.failed()?null:void s_a.pop(11))):(s_a.primitiveFail(),null)}function P_a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y;if(d=s_a.stackValue(0),t=s_a.stackIntegerValue(1),a=s_a.stackIntegerValue(2),i=s_a.stackValue(3),y=s_a.stackValue(4),g=s_a.stackValue(5),h=s_a.stackValue(6),s_a.failed())return null;if(!s_a.isBytes(h))return s_a.primitiveFail(),null;if(!s_a.isWords(g))return s_a.primitiveFail(),null;if(!s_a.isWords(y))return s_a.primitiveFail(),null;if(!s_a.isWords(i))return s_a.primitiveFail(),null;if(t*a!==o_a(i))return s_a.primitiveFail(),null;if(f=o_a(g),o_a(h)!==f)return s_a.primitiveFail(),null;if(o_a(y)!==f)return s_a.primitiveFail(),null;if(c=h.bytes,v=g.wordsAsFloat32Array(),_=y.wordsAsFloat32Array(),u="number"==typeof d)p=d;else{if(o_a(d)!==f)return s_a.primitiveFail(),null;(l=s_a.isMemberOf(d,"WordArray"))?m=d.words:s=d.wordsAsFloat32Array()}for(e=i.words,o=0;o<=f-1;o++)1===c[o]&&(b=0|v[o],k=0|_[o],0<=b&&0<=k&&b<a&&k<t&&(r=k*a+b,u?e[r]=p:l?e[r]=m[o]:(n=s[o],e[r]=n)));if(s_a.failed())return null;s_a.pop(7)}function Q_a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S;if(e=s_a.stackIntegerValue(0),m=s_a.stackIntegerValue(1),p=s_a.stackIntegerValue(2),u=s_a.stackIntegerValue(3),t=s_a.stackFloatValue(4),r=s_a.stackFloatValue(5),g=s_a.stackValue(6),s=s_a.stackValue(7),S=s_a.stackValue(8),_=s_a.stackValue(9),f=s_a.stackValue(10),s_a.failed())return null;if(!s_a.isBytes(f))return s_a.primitiveFail(),null;if(!s_a.isWords(_))return s_a.primitiveFail(),null;if(!s_a.isWords(S))return s_a.primitiveFail(),null;if(!s_a.isWords(s))return s_a.primitiveFail(),null;if(g.isFloat)o=!1;else{if(!s_a.isWords(g))return s_a.primitiveFail(),null;o=!0}if(d=o_a(_),o_a(S)!==d)return s_a.primitiveFail(),null;if(o_a(s)!==d)return s_a.primitiveFail(),null;if(o_a(f)!==d)return s_a.primitiveFail(),null;if(o&&o_a(g)!==d)return s_a.primitiveFail(),null;for(h=f.bytes,k=_.wordsAsFloat32Array(),y=S.wordsAsFloat32Array(),a=s.wordsAsFloat32Array(),o?v=g.wordsAsFloat32Array():b=s_a.floatValueOf(g),n=0;n<=d-1;n++)1===h[n]&&(i=o?v[n]:b,l=k[n]+i*Math.cos(a[n]),c=y[n]-i*Math.sin(a[n]),B0a(n,k,a,l,r,u,p),C0a(n,y,a,c,t,m,e));if(s_a.failed())return null;s_a.pop(11)}function R_a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y;if(c=s_a.stackIntegerValue(0),a=s_a.stackIntegerValue(1),k=s_a.stackIntegerValue(2),t=s_a.stackValue(3),p=s_a.stackFloatValue(4),m=s_a.stackFloatValue(5),d=s_a.stackFloatValue(6),s_a.failed())return null;if(!s_a.isWords(t))return s_a.primitiveFail(),null;if(o_a(t)!==a*k)return s_a.primitiveFail(),null;for(e=t.words,v=d,g=m,v=Math.max(v,0),g=Math.max(g,0),v=Math.min(v,k-1),g=Math.min(g,a-1),h=Math.max(v-c,0),r=Math.min(v+c,k-1),f=Math.max(g-c,0),i=Math.min(g+c,a-1),s=e[g*k+v],n=-1,y=f;y<=i;y++)for(l=y*k,_=h;_<=r;_++)s<(b=e[l+_])&&(n=_,o=y,s=b);if(u=-1===n?v0a(p):z_a(n-v,o-g)+90|0,s_a.failed())return null;s_a.pop(8),s_a.pushFloat(u)}function S_a(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(l=s_a.stackObjectValue(0),e=s_a.stackObjectValue(1),u=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(e)),s_a.success(s_a.isWords(u)),s_a.success(s_a.isWords(l)),s_a.failed())return null;if(o=o_a(e),s_a.success(o===o_a(u)),s_a.success(o===o_a(l)),s_a.failed())return null;if(s=s_a.isMemberOf(e,"WordArray"),n=s_a.isMemberOf(u,"WordArray"),s&&n){if(!s_a.isMemberOf(l,"WordArray"))return s_a.primitiveFail(),null}else if(!s_a.isMemberOf(l,"KedamaFloatArray"))return s_a.primitiveFail(),null;if(n)if(s)for(h=u.words,c=e.words,f=l.words,a=0;a<=o-1;a++)f[a]=h[a]+c[a];else for(h=u.words,t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=h[a]+t[a];else if(s)for(r=u.wordsAsFloat32Array(),c=e.words,i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]+c[a];else for(r=u.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]+t[a];s_a.pop(4),s_a.push(l)}function T_a(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(c=s_a.stackObjectValue(0),e=s_a.stackValue(1),l=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(l)),s_a.success(s_a.isWords(c)),s_a.failed())return null;if(u=o_a(l),s_a.success(u===o_a(c)),s_a.failed())return null;if(n="number"==typeof e,o=s_a.isMemberOf(l,"WordArray"),n&&o){if(!s_a.isMemberOf(c,"WordArray"))return s_a.primitiveFail(),null}else if(!s_a.isMemberOf(c,"KedamaFloatArray"))return s_a.primitiveFail(),null;if(o)if(n)for(h=l.words,s=e,f=c.words,a=0;a<=u-1;a++)f[a]=h[a]+s;else for(h=l.words,t=s_a.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=h[a]+t;else if(n)for(r=l.wordsAsFloat32Array(),s=e,i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]+s;else for(r=l.wordsAsFloat32Array(),t=s_a.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]+t;s_a.pop(4),s_a.push(c)}function U_a(){var e,t,r,i,a,s,n,o;if(s=s_a.stackObjectValue(0),o=s_a.stackValue(1),s_a.failed())return null;if(s_a.success(s_a.isBytes(o)),s_a.success(s_a.isBytes(s)),s_a.failed())return null;if(r=o_a(o),i=o_a(s),s_a.failed())return null;for(i<(t=r)&&(t=i),a=s.bytes,n=o.bytes,e=0;e<=t-1;e++)n[e]=n[e]+a[e]===2;s_a.pop(1)}function V_a(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(l=s_a.stackObjectValue(0),e=s_a.stackObjectValue(1),u=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(e)),s_a.success(s_a.isWords(u)),s_a.success(s_a.isWords(l)),s_a.failed())return null;if(o=o_a(e),s_a.success(o===o_a(u)),s_a.success(o===o_a(l)),s_a.failed())return null;if(s=s_a.isMemberOf(e,"WordArray"),n=s_a.isMemberOf(u,"WordArray"),s&&n){if(!s_a.isMemberOf(l,"WordArray"))return s_a.primitiveFail(),null}else if(!s_a.isMemberOf(l,"KedamaFloatArray"))return s_a.primitiveFail(),null;if(n)if(s)for(h=u.words,c=e.words,f=l.words,a=0;a<=o-1;a++)f[a]=h[a]/c[a];else for(h=u.words,t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=h[a]/t[a];else if(s)for(r=u.wordsAsFloat32Array(),c=e.words,i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]/c[a];else for(r=u.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]/t[a];s_a.pop(4),s_a.push(l)}function W_a(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(c=s_a.stackObjectValue(0),e=s_a.stackValue(1),l=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(l)),s_a.success(s_a.isWords(c)),s_a.failed())return null;if(u=o_a(l),s_a.success(u===o_a(c)),s_a.failed())return null;if(n="number"==typeof e,o=s_a.isMemberOf(l,"WordArray"),n&&o){if(!s_a.isMemberOf(c,"WordArray"))return s_a.primitiveFail(),null}else if(!s_a.isMemberOf(c,"KedamaFloatArray"))return s_a.primitiveFail(),null;if(o)if(n)for(h=l.words,s=e,f=c.words,a=0;a<=u-1;a++)f[a]=p_a(h[a],s);else for(h=l.words,t=s_a.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=h[a]/t;else if(n)for(r=l.wordsAsFloat32Array(),s=e,i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]/s;else for(r=l.wordsAsFloat32Array(),t=s_a.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]/t;s_a.pop(4),s_a.push(c)}function X_a(){var e,t,r,i,a,s,n,o,u,l,c;if(u=s_a.stackObjectValue(0),e=s_a.stackObjectValue(1),o=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(e)),s_a.success(s_a.isWords(o)),s_a.success(s_a.isBytes(u)),s_a.failed())return null;if(n=o_a(e),s_a.success(n===o_a(o)),s_a.success(n===o_a(u)),s_a.failed())return null;if(s=s_a.isMemberOf(e,"WordArray"),s_a.isMemberOf(o,"WordArray"))if(s)for(c=o.words,l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]===l[a];else for(c=o.words,r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]===r[a];else if(s)for(i=o.wordsAsFloat32Array(),l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]===l[a];else for(i=o.wordsAsFloat32Array(),r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]===r[a];s_a.pop(4),s_a.push(u)}function Y_a(){var e,t,r,i,a,s,n,o,u,l,c;if(l=s_a.stackObjectValue(0),e=s_a.stackValue(1),u=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(u)),s_a.success(s_a.isBytes(l)),s_a.failed())return null;if(o=o_a(u),s_a.success(o===o_a(l)),s_a.failed())return null;if(n="number"==typeof e,s_a.isMemberOf(u,"WordArray"))if(n)for(c=u.words,s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]===s;else for(c=u.words,r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]===r;else if(n)for(i=u.wordsAsFloat32Array(),s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]===s;else for(i=u.wordsAsFloat32Array(),r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]===r;s_a.pop(4),s_a.push(l)}function Z_a(){var e,t,r,i,a,s,n,o,u,l,c;if(u=s_a.stackObjectValue(0),e=s_a.stackObjectValue(1),o=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(e)),s_a.success(s_a.isWords(o)),s_a.success(s_a.isBytes(u)),s_a.failed())return null;if(n=o_a(e),s_a.success(n===o_a(o)),s_a.success(n===o_a(u)),s_a.failed())return null;if(s=s_a.isMemberOf(e,"WordArray"),s_a.isMemberOf(o,"WordArray"))if(s)for(c=o.words,l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]>=l[a];else for(c=o.words,r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]>=r[a];else if(s)for(i=o.wordsAsFloat32Array(),l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]>=l[a];else for(i=o.wordsAsFloat32Array(),r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]>=r[a];s_a.pop(4),s_a.push(u)}function $_a(){var e,t,r,i,a,s,n,o,u,l,c;if(l=s_a.stackObjectValue(0),e=s_a.stackValue(1),u=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(u)),s_a.success(s_a.isBytes(l)),s_a.failed())return null;if(o=o_a(u),s_a.success(o===o_a(l)),s_a.failed())return null;if(n="number"==typeof e,s_a.isMemberOf(u,"WordArray"))if(n)for(c=u.words,s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]>=s;else for(c=u.words,r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]>=r;else if(n)for(i=u.wordsAsFloat32Array(),s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]>=s;else for(i=u.wordsAsFloat32Array(),r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]>=r;s_a.pop(4),s_a.push(l)}function __a(){var e,t,r,i,a,s,n,o,u,l,c;if(u=s_a.stackObjectValue(0),e=s_a.stackObjectValue(1),o=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(e)),s_a.success(s_a.isWords(o)),s_a.success(s_a.isBytes(u)),s_a.failed())return null;if(n=o_a(e),s_a.success(n===o_a(o)),s_a.success(n===o_a(u)),s_a.failed())return null;if(s=s_a.isMemberOf(e,"WordArray"),s_a.isMemberOf(o,"WordArray"))if(s)for(c=o.words,l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]>l[a];else for(c=o.words,r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]>r[a];else if(s)for(i=o.wordsAsFloat32Array(),l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]>l[a];else for(i=o.wordsAsFloat32Array(),r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]>r[a];s_a.pop(4),s_a.push(u)}function a0a(){var e,t,r,i,a,s,n,o,u,l,c;if(l=s_a.stackObjectValue(0),e=s_a.stackValue(1),u=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(u)),s_a.success(s_a.isBytes(l)),s_a.failed())return null;if(o=o_a(u),s_a.success(o===o_a(l)),s_a.failed())return null;if(n="number"==typeof e,s_a.isMemberOf(u,"WordArray"))if(n)for(c=u.words,s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]>s;else for(c=u.words,r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]>r;else if(n)for(i=u.wordsAsFloat32Array(),s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]>s;else for(i=u.wordsAsFloat32Array(),r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]>r;s_a.pop(4),s_a.push(l)}function b0a(){var e,t,r,i,a,s,n,o,u,l,c;if(u=s_a.stackObjectValue(0),e=s_a.stackObjectValue(1),o=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(e)),s_a.success(s_a.isWords(o)),s_a.success(s_a.isBytes(u)),s_a.failed())return null;if(n=o_a(e),s_a.success(n===o_a(o)),s_a.success(n===o_a(u)),s_a.failed())return null;if(s=s_a.isMemberOf(e,"WordArray"),s_a.isMemberOf(o,"WordArray"))if(s)for(c=o.words,l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]<=l[a];else for(c=o.words,r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]<=r[a];else if(s)for(i=o.wordsAsFloat32Array(),l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]<=l[a];else for(i=o.wordsAsFloat32Array(),r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]<=r[a];s_a.pop(4),s_a.push(u)}function c0a(){var e,t,r,i,a,s,n,o,u,l,c;if(l=s_a.stackObjectValue(0),e=s_a.stackValue(1),u=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(u)),s_a.success(s_a.isBytes(l)),s_a.failed())return null;if(o=o_a(u),s_a.success(o===o_a(l)),s_a.failed())return null;if(n="number"==typeof e,s_a.isMemberOf(u,"WordArray"))if(n)for(c=u.words,s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]<=s;else for(c=u.words,r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]<=r;else if(n)for(i=u.wordsAsFloat32Array(),s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]<=s;else for(i=u.wordsAsFloat32Array(),r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]<=r;s_a.pop(4),s_a.push(l)}function d0a(){var e,t,r,i,a,s,n,o,u,l,c;if(u=s_a.stackObjectValue(0),e=s_a.stackObjectValue(1),o=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(e)),s_a.success(s_a.isWords(o)),s_a.success(s_a.isBytes(u)),s_a.failed())return null;if(n=o_a(e),s_a.success(n===o_a(o)),s_a.success(n===o_a(u)),s_a.failed())return null;if(s=s_a.isMemberOf(e,"WordArray"),s_a.isMemberOf(o,"WordArray"))if(s)for(c=o.words,l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]<l[a];else for(c=o.words,r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]<r[a];else if(s)for(i=o.wordsAsFloat32Array(),l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]<l[a];else for(i=o.wordsAsFloat32Array(),r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]<r[a];s_a.pop(4),s_a.push(u)}function e0a(){var e,t,r,i,a,s,n,o,u,l,c;if(l=s_a.stackObjectValue(0),e=s_a.stackValue(1),u=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(u)),s_a.success(s_a.isBytes(l)),s_a.failed())return null;if(o=o_a(u),s_a.success(o===o_a(l)),s_a.failed())return null;if(n="number"==typeof e,s_a.isMemberOf(u,"WordArray"))if(n)for(c=u.words,s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]<s;else for(c=u.words,r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]<r;else if(n)for(i=u.wordsAsFloat32Array(),s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]<s;else for(i=u.wordsAsFloat32Array(),r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]<r;s_a.pop(4),s_a.push(l)}function f0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(l=s_a.stackObjectValue(0),e=s_a.stackObjectValue(1),u=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(e)),s_a.success(s_a.isWords(u)),s_a.success(s_a.isWords(l)),s_a.failed())return null;if(o=o_a(e),s_a.success(o===o_a(u)),s_a.success(o===o_a(l)),s_a.failed())return null;if(s=s_a.isMemberOf(e,"WordArray"),n=s_a.isMemberOf(u,"WordArray"),s&&n){if(!s_a.isMemberOf(l,"WordArray"))return s_a.primitiveFail(),null}else if(!s_a.isMemberOf(l,"KedamaFloatArray"))return s_a.primitiveFail(),null;if(n)if(s)for(h=u.words,c=e.words,f=l.words,a=0;a<=o-1;a++)f[a]=h[a]*c[a];else for(h=u.words,t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=h[a]*t[a];else if(s)for(r=u.wordsAsFloat32Array(),c=e.words,i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]*c[a];else for(r=u.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]*t[a];s_a.pop(4),s_a.push(l)}function g0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(c=s_a.stackObjectValue(0),e=s_a.stackValue(1),l=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(l)),s_a.success(s_a.isWords(c)),s_a.failed())return null;if(u=o_a(l),s_a.success(u===o_a(c)),s_a.failed())return null;if(n="number"==typeof e,o=s_a.isMemberOf(l,"WordArray"),n&&o){if(!s_a.isMemberOf(c,"WordArray"))return s_a.primitiveFail(),null}else if(!s_a.isMemberOf(c,"KedamaFloatArray"))return s_a.primitiveFail(),null;if(o)if(n)for(h=l.words,s=e,f=c.words,a=0;a<=u-1;a++)f[a]=h[a]*s;else for(h=l.words,t=s_a.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=h[a]*t;else if(n)for(r=l.wordsAsFloat32Array(),s=e,i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]*s;else for(r=l.wordsAsFloat32Array(),t=s_a.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]*t;s_a.pop(4),s_a.push(c)}function h0a(){var e,t,r,i,a,s,n,o,u,l,c;if(u=s_a.stackObjectValue(0),e=s_a.stackObjectValue(1),o=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(e)),s_a.success(s_a.isWords(o)),s_a.success(s_a.isBytes(u)),s_a.failed())return null;if(n=o_a(e),s_a.success(n===o_a(o)),s_a.success(n===o_a(u)),s_a.failed())return null;if(s=s_a.isMemberOf(e,"WordArray"),s_a.isMemberOf(o,"WordArray"))if(s)for(c=o.words,l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]!==l[a];else for(c=o.words,r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=c[a]!==r[a];else if(s)for(i=o.wordsAsFloat32Array(),l=e.words,t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]!==l[a];else for(i=o.wordsAsFloat32Array(),r=e.wordsAsFloat32Array(),t=u.bytes,a=0;a<=n-1;a++)t[a]=i[a]!==r[a];s_a.pop(4),s_a.push(u)}function i0a(){var e,t,r,i,a,s,n,o,u,l,c;if(l=s_a.stackObjectValue(0),e=s_a.stackValue(1),u=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(u)),s_a.success(s_a.isBytes(l)),s_a.failed())return null;if(o=o_a(u),s_a.success(o===o_a(l)),s_a.failed())return null;if(n="number"==typeof e,s_a.isMemberOf(u,"WordArray"))if(n)for(c=u.words,s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]!==s;else for(c=u.words,r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=c[a]!==r;else if(n)for(i=u.wordsAsFloat32Array(),s=e,t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]!==s;else for(i=u.wordsAsFloat32Array(),r=s_a.floatValueOf(e),t=l.bytes,a=0;a<=o-1;a++)t[a]=i[a]!==r;s_a.pop(4),s_a.push(l)}function j0a(){var e,t,r,i;if(i=s_a.stackValue(0),s_a.failed())return null;if(s_a.success(s_a.isBytes(i)),s_a.failed())return null;if(t=o_a(i),s_a.failed())return null;for(r=i.bytes,e=0;e<=t-1;e++)0===r[e]?r[e]=1:r[e]=0}function k0a(){var e,t,r,i,a,s,n,o;if(s=s_a.stackObjectValue(0),o=s_a.stackValue(1),s_a.failed())return null;if(s_a.success(s_a.isBytes(o)),s_a.success(s_a.isBytes(s)),s_a.failed())return null;if(r=o_a(o),i=o_a(s),s_a.failed())return null;for(i<(t=r)&&(t=i),a=s.bytes,n=o.bytes,e=0;e<=t-1;e++)n[e]=0<n[e]+a[e];s_a.pop(1)}function l0a(){var e,t,r,i,a,s,n,o;if(s=s_a.stackValue(0),i=s_a.stackObjectValue(1),s_a.failed())return null;if(a=s_a.isIntegerValue(s)?s:s_a.booleanValueOf(s),o=s_a.fetchPointerofObject(1,i),r=s_a.fetchPointerofObject(0,i),s_a.failed())return null;if(!s_a.isBytes(r))return s_a.primitiveFail(),null;if(!s_a.isBytes(o))return s_a.primitiveFail(),null;for(n=o.bytes,t=r.bytes,e=0;e<=o_a(o)-1;e++)1===t[e]&&(n[e]=a);s_a.pop(1)}function m0a(){var e,t,r,i,a,s,n;if(a=s_a.stackIntegerValue(0),i=s_a.stackObjectValue(1),s_a.failed())return null;if(a|=4278190080,n=s_a.fetchPointerofObject(1,i),r=s_a.fetchPointerofObject(0,i),s_a.failed())return null;if(!s_a.isBytes(r))return s_a.primitiveFail(),null;if(!s_a.isWords(n))return s_a.primitiveFail(),null;for(s=n.words,t=r.bytes,e=0;e<=o_a(n)-1;e++)1===t[e]&&(s[e]=a);s_a.pop(1)}function n0a(){var e,t,r,i,a,s,n;if(a=s_a.stackFloatValue(0),i=s_a.stackObjectValue(1),s_a.failed())return null;if(n=s_a.fetchPointerofObject(1,i),r=s_a.fetchPointerofObject(0,i),s_a.failed())return null;if(!s_a.isBytes(r))return s_a.primitiveFail(),null;if(!s_a.isWords(n))return s_a.primitiveFail(),null;for(s=n.wordsAsFloat32Array(),t=r.bytes,e=0;e<=o_a(n)-1;e++)1===t[e]&&(s[e]=a);s_a.pop(1)}function o0a(){var e,t,r,i,a,s,n;if(a=s_a.stackValue(0),i=s_a.stackObjectValue(1),s_a.failed())return null;if(n=s_a.fetchPointerofObject(1,i),r=s_a.fetchPointerofObject(0,i),s_a.failed())return null;if(!s_a.isBytes(r))return s_a.primitiveFail(),null;if(!s_a.isPointers(n))return s_a.primitiveFail(),null;for(s=n.wordsAsInt32Array(),t=r.bytes,e=0;e<=o_a(n)-1;e++)1===t[e]&&(s[e]=a);s_a.pop(1)}function p0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p;if(n=s_a.stackIntegerValue(0),s=s_a.stackObjectValue(1),c=s_a.stackIntegerValue(2),l=s_a.stackIntegerValue(3),a=s_a.stackObjectValue(4),s_a.failed())return null;if(f=s_a.fetchPointerofObject(1,a),r=s_a.fetchPointerofObject(0,a),s_a.failed())return null;if(!s_a.isBytes(r))return s_a.primitiveFail(),null;if(!s_a.isBytes(f)||!s_a.isBytes(s))return s_a.primitiveFail(),null;if(h=f.bytes,t=r.bytes,o=s.bytes,p=o_a(f),i=o_a(r),u=o_a(s),c<l)return s_a.primitiveFail(),null;if(l<1)return s_a.primitiveFail(),null;if(p<l)return s_a.primitiveFail(),null;if(i<l)return s_a.primitiveFail(),null;if(p<c)return s_a.primitiveFail(),null;if(i<c)return s_a.primitiveFail(),null;if(n<1)return s_a.primitiveFail(),null;if(u<n)return s_a.primitiveFail(),null;if(u-n+1<c-l+1)return s_a.primitiveFail(),null;for(e=l-1;e<=c-1;e++)1===t[e]&&(h[e]=o[n+e-l]);s_a.pop(4)}function q0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g;if(c=s_a.stackIntegerValue(0),l=s_a.stackObjectValue(1),d=s_a.stackIntegerValue(2),p=s_a.stackIntegerValue(3),u=s_a.stackObjectValue(4),s_a.failed())return null;if(v=s_a.fetchPointerofObject(1,u),s=s_a.fetchPointerofObject(0,u),s_a.failed())return null;if(!s_a.isBytes(s))return s_a.primitiveFail(),null;if(!(s_a.isWords(v)&&s_a.isWords(l)||s_a.isPointers(v)&&s_a.isPointers(l)))return s_a.primitiveFail(),null;if(a=s.bytes,g=o_a(v),n=o_a(s),f=o_a(l),d<p)return s_a.primitiveFail(),null;if(p<1)return s_a.primitiveFail(),null;if(g<p)return s_a.primitiveFail(),null;if(n<p)return s_a.primitiveFail(),null;if(g<d)return s_a.primitiveFail(),null;if(n<d)return s_a.primitiveFail(),null;if(c<1)return s_a.primitiveFail(),null;if(f<c)return s_a.primitiveFail(),null;if(f-c+1<d-p+1)return s_a.primitiveFail(),null;if(m=s_a.isMemberOf(v,"KedamaFloatArray"),o=s_a.isMemberOf(l,"KedamaFloatArray"),m&&o)for(t=v.wordsAsFloat32Array(),e=l.wordsAsFloat32Array(),i=p-1;i<=d-1;i++)1===a[i]&&(t[i]=e[c+i-p]);if(m&&!o)for(t=v.wordsAsFloat32Array(),h=l.words,i=p-1;i<=d-1;i++)1===a[i]&&(t[i]=h[c+i-p]);if(!m&&o)for(b=v.words,e=l.wordsAsFloat32Array(),i=p-1;i<=d-1;i++)1===a[i]&&(r=e[c+i-p]>>>0,b[i]=r);if(!m&&!o)for(b=v.words,h=l.words,i=p-1;i<=d-1;i++)1===a[i]&&(b[i]=h[c+i-p]);s_a.pop(4)}function r0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g;if(f=s_a.stackObjectValue(0),e=s_a.stackObjectValue(1),h=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(e)),s_a.success(s_a.isWords(h)),s_a.success(s_a.isWords(f)),s_a.failed())return null;if(c=o_a(e),s_a.success(c===o_a(h)),s_a.success(c===o_a(f)),s_a.failed())return null;if(u=s_a.isMemberOf(e,"WordArray"),l=s_a.isMemberOf(h,"WordArray"),u&&l){if(!s_a.isMemberOf(f,"WordArray"))return s_a.primitiveFail(),null}else if(!s_a.isMemberOf(f,"KedamaFloatArray"))return s_a.primitiveFail(),null;if(l)if(u)for(v=h.words,b=e.words,g=f.words,o=0;o<=c-1;o++)m=q_a(d=v[o],p=b[o]),g[o]=m;else for(v=h.words,a=e.wordsAsFloat32Array(),n=f.wordsAsFloat32Array(),o=0;o<=c-1;o++)i=(d=v[o])/(t=a[o]),i=Math.floor(i),n[o]=d-i*t;else if(u)for(s=h.wordsAsFloat32Array(),b=e.words,n=f.wordsAsFloat32Array(),o=0;o<=c-1;o++)i=(r=s[o])/(p=b[o]),i=Math.floor(i),n[o]=r-i*p;else for(s=h.wordsAsFloat32Array(),a=e.wordsAsFloat32Array(),n=f.wordsAsFloat32Array(),o=0;o<=c-1;o++)i=(r=s[o])/(t=a[o]),i=Math.floor(i),n[o]=r-i*t;s_a.pop(4),s_a.push(f)}function s0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m;if(f=s_a.stackObjectValue(0),e=s_a.stackValue(1),h=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(h)),s_a.success(s_a.isWords(f)),s_a.failed())return null;if(c=o_a(h),s_a.success(c===o_a(f)),s_a.failed())return null;if(u="number"==typeof e,l=s_a.isMemberOf(h,"WordArray"),u&&l){if(!s_a.isMemberOf(f,"WordArray"))return s_a.primitiveFail(),null}else if(!s_a.isMemberOf(f,"KedamaFloatArray"))return s_a.primitiveFail(),null;if(l)if(u)for(d=h.words,o=e,m=f.words,n=0;n<=c-1;n++)m[n]=q_a(d[n],o);else for(d=h.words,t=s_a.floatValueOf(e),s=f.wordsAsFloat32Array(),n=0;n<=c-1;n++)i=(p=d[n])/t,i=Math.floor(i),s[n]=p-i*t;else if(u)for(a=h.wordsAsFloat32Array(),o=e,s=f.wordsAsFloat32Array(),n=0;n<=c-1;n++)i=(r=a[n])/o,i=Math.floor(i),s[n]=r-i*o;else for(a=h.wordsAsFloat32Array(),t=s_a.floatValueOf(e),s=f.wordsAsFloat32Array(),n=0;n<=c-1;n++)i=(r=a[n])/t,i=Math.floor(i),s[n]=r-i*t;s_a.pop(4),s_a.push(f)}function t0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(l=s_a.stackObjectValue(0),e=s_a.stackObjectValue(1),u=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(e)),s_a.success(s_a.isWords(u)),s_a.success(s_a.isWords(l)),s_a.failed())return null;if(o=o_a(e),s_a.success(o===o_a(u)),s_a.success(o===o_a(l)),s_a.failed())return null;if(s=s_a.isMemberOf(e,"WordArray"),n=s_a.isMemberOf(u,"WordArray"),s&&n){if(!s_a.isMemberOf(l,"WordArray"))return s_a.primitiveFail(),null}else if(!s_a.isMemberOf(l,"KedamaFloatArray"))return s_a.primitiveFail(),null;if(n)if(s)for(h=u.words,c=e.words,f=l.words,a=0;a<=o-1;a++)f[a]=h[a]-c[a];else for(h=u.words,t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=h[a]-t[a];else if(s)for(r=u.wordsAsFloat32Array(),c=e.words,i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]-c[a];else for(r=u.wordsAsFloat32Array(),t=e.wordsAsFloat32Array(),i=l.wordsAsFloat32Array(),a=0;a<=o-1;a++)i[a]=r[a]-t[a];s_a.pop(4),s_a.push(l)}function u0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f;if(c=s_a.stackObjectValue(0),e=s_a.stackValue(1),l=s_a.stackObjectValue(2),s_a.failed())return null;if(s_a.success(s_a.isWords(l)),s_a.success(s_a.isWords(c)),s_a.failed())return null;if(u=o_a(l),s_a.success(u===o_a(c)),s_a.failed())return null;if(n="number"==typeof e,o=s_a.isMemberOf(l,"WordArray"),n&&o){if(!s_a.isMemberOf(c,"WordArray"))return s_a.primitiveFail(),null}else if(!s_a.isMemberOf(c,"KedamaFloatArray"))return s_a.primitiveFail(),null;if(o)if(n)for(h=l.words,s=e,f=c.words,a=0;a<=u-1;a++)f[a]=h[a]-s;else for(h=l.words,t=s_a.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=h[a]-t;else if(n)for(r=l.wordsAsFloat32Array(),s=e,i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]-s;else for(r=l.wordsAsFloat32Array(),t=s_a.floatValueOf(e),i=c.wordsAsFloat32Array(),a=0;a<=u-1;a++)i[a]=r[a]-t;s_a.pop(4),s_a.push(c)}function v0a(e){var t;return 0<(t=90-e/.0174532925199433)||(t+=360),t}function w0a(){var e,t,r,i,a,s,n;if(e=s_a.stackFloatValue(0),r=s_a.stackValue(1),n=s_a.stackIntegerValue(2),i=s_a.stackIntegerValue(3),s=s_a.stackIntegerValue(4),s_a.failed())return null;if(!s_a.isWords(r))return s_a.primitiveFail(),null;if(!(n<=o_a(r)&&1<=i&&i<=n))return s_a.primitiveFail(),null;if(t=r.wordsAsFloat32Array(),s_a.failed())return null;for(a=i;a<=n;a++)t[a-1]=G_a(s)*e;s_a.pop(5)}function x0a(){var e,t,r,i,a,s,n;if(e=s_a.stackFloatValue(0),a=s_a.stackValue(1),n=s_a.stackIntegerValue(2),t=s_a.stackIntegerValue(3),s=s_a.stackIntegerValue(4),s_a.failed())return null;if(!s_a.isWords(a))return s_a.primitiveFail(),null;if(!(n<=o_a(a)&&1<=t&&t<=n))return s_a.primitiveFail(),null;if(i=a.words,s_a.failed())return null;for(r=t;r<=n;r++)i[r-1]=G_a(s)*e|0;s_a.pop(5)}function y0a(){var e,t;return e=s_a.stackIntegerValue(0),s_a.failed()?null:(t=G_a(e),s_a.failed()?null:(s_a.pop(2),void s_a.pushInteger(t)))}function z0a(){var e,t,r,i,a;return t=s_a.stackFloatValue(0),e=s_a.stackFloatValue(1),a=s_a.stackFloatValue(2),i=s_a.stackFloatValue(3),s_a.failed()?null:(r=z_a(i-e,a-t),360<(r+=90)&&(r-=360),s_a.failed()?null:(s_a.pop(5),void s_a.pushFloat(r)))}function A0a(){var e,t,r,i,a,s,n;return t=s_a.stackFloatValue(0),e=s_a.stackFloatValue(1),a=s_a.stackFloatValue(2),i=s_a.stackFloatValue(3),s_a.failed()?null:(s=e-i,n=t-a,r=Math.sqrt(s*s+n*n),s_a.failed()?null:(s_a.pop(5),void s_a.pushFloat(r)))}function B0a(e,t,r,i,a,s,n){var o,u;(u=i)<0&&(1===s&&(u+=a),2===s&&(u=0),3===s&&(u=0-u,o=r[e],r[e]=o<3.141592653589793?3.141592653589793-o:9.42477796076938-o)),a<=u&&(1===n&&(u-=a),2===n&&(u=a-1e-6),3===n&&(u=a-1e-6-(u-a),o=r[e],r[e]=o<3.141592653589793?3.141592653589793-o:9.42477796076938-o)),t[e]=u}function C0a(e,t,r,i,a,s,n){var o;(o=i)<0&&(1===s&&(o+=a),2===s&&(o=0),3===s&&(o=0-o,r[e]=6.283185307179586-r[e])),a<=o&&(1===n&&(o-=a),2===n&&(o=a-1e-6),3===n&&(o=a-1e-6-(o-a),r[e]=6.283185307179586-r[e])),t[e]=o}function D0a(){var e,t,r,i,a,s,n,o,u,l;if(u=s_a.stackValue(0),r=s_a.stackValue(1),n=s_a.stackValue(2),s_a.failed())return null;if(!s_a.isBytes(n))return s_a.primitiveFail(),null;if(!s_a.isWords(r))return s_a.primitiveFail(),null;if(l=o_a(r),u.isFloat)a=!1;else{if(!s_a.isWords(u))return s_a.primitiveFail(),null;if(o_a(u)!==l)return s_a.primitiveFail(),null;a=!0}for(s=n.bytes,t=r.wordsAsFloat32Array(),a?o=u.wordsAsFloat32Array():e=A_a(e=s_a.floatValueOf(u)),i=0;i<=l-1;i++)1===s[i]&&(a&&(e=A_a(e=o[i])),t[i]=e);if(s_a.failed())return null;s_a.pop(3)}function E0a(e){return!1!=((s_a=e).majorVersion()==m_a)&&s_a.minorVersion()>=n_a}function F0a(){var e,t,r;return e=s_a.stackFloatValue(0),t=s_a.stackValue(1),r=s_a.stackIntegerValue(2),s_a.failed()?null:!s_a.isWords(t)||o_a(t)<r?(s_a.primitiveFail(),null):(t.wordsAsFloat32Array()[r-1]=A_a(e),s_a.failed()?null:void s_a.pop(3))}function G0a(){return!0}function H0a(){var e,t,r,i,a,s,n,o;return i=s_a.stackIntegerValue(0),r=s_a.stackIntegerValue(1),e=s_a.stackFloatValue(2),s=s_a.stackFloatValue(3),t=s_a.stackValue(4),n=s_a.stackIntegerValue(5),o=s_a.stackValue(6),s_a.failed()?null:s_a.isWords(o)&&s_a.isWords(t)?(a=o_a(o),o_a(t)!==a?(s_a.primitiveFail(),null):(B0a(n-1,o.wordsAsFloat32Array(),t.wordsAsFloat32Array(),s,e,r,i),s_a.failed()?null:void s_a.pop(7))):(s_a.primitiveFail(),null)}function I0a(){var e,t,r,i,a,s,n,o;return e=s_a.stackIntegerValue(0),a=s_a.stackIntegerValue(1),t=s_a.stackFloatValue(2),s=s_a.stackFloatValue(3),r=s_a.stackValue(4),n=s_a.stackIntegerValue(5),o=s_a.stackValue(6),s_a.failed()?null:s_a.isWords(o)&&s_a.isWords(r)?(i=o_a(o),o_a(r)!==i?(s_a.primitiveFail(),null):(C0a(n-1,o.wordsAsFloat32Array(),r.wordsAsFloat32Array(),s,t,a,e),s_a.failed()?null:void s_a.pop(7))):(s_a.primitiveFail(),null)}function J0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b;if(l=s_a.stackIntegerValue(0),n=s_a.stackIntegerValue(1),e=s_a.stackFloatValue(2),p=s_a.stackValue(3),r=s_a.stackValue(4),b=s_a.stackValue(5),u=s_a.stackValue(6),s_a.failed())return null;if(!s_a.isBytes(u))return s_a.primitiveFail(),null;if(!s_a.isWords(b))return s_a.primitiveFail(),null;if(!s_a.isWords(r))return s_a.primitiveFail(),null;if(p.isFloat)a=!1;else{if(!s_a.isWords(p))return s_a.primitiveFail(),null;a=!0,s=s_a.isMemberOf(p,"WordArray")}if(c=o_a(b),o_a(u)!==c)return s_a.primitiveFail(),null;if(o_a(r)!==c)return s_a.primitiveFail(),null;if(a&&o_a(p)!==c)return s_a.primitiveFail(),null;for(o=u.bytes,m=b.wordsAsFloat32Array(),t=r.wordsAsFloat32Array(),a?s?d=p.words:f=p.wordsAsFloat32Array():h=s_a.floatValueOf(p),i=0;i<=c-1;i++)1===o[i]&&B0a(i,m,t,a?s?d[i]:f[i]:h,e,n,l);if(s_a.failed())return null;s_a.pop(7)}function K0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b;if(e=s_a.stackIntegerValue(0),c=s_a.stackIntegerValue(1),t=s_a.stackFloatValue(2),p=s_a.stackValue(3),i=s_a.stackValue(4),b=s_a.stackValue(5),u=s_a.stackValue(6),s_a.failed())return null;if(!s_a.isBytes(u))return s_a.primitiveFail(),null;if(!s_a.isWords(b))return s_a.primitiveFail(),null;if(!s_a.isWords(i))return s_a.primitiveFail(),null;if(p.isFloat)s=!1;else{if(!s_a.isWords(p))return s_a.primitiveFail(),null;s=!0,n=s_a.isMemberOf(p,"WordArray")}if(l=o_a(b),o_a(u)!==l)return s_a.primitiveFail(),null;if(o_a(i)!==l)return s_a.primitiveFail(),null;if(s&&o_a(p)!==l)return s_a.primitiveFail(),null;for(o=u.bytes,m=b.wordsAsFloat32Array(),r=i.wordsAsFloat32Array(),s?n?d=p.words:f=p.wordsAsFloat32Array():h=s_a.floatValueOf(p),a=0;a<=l-1;a++)1===o[a]&&C0a(a,m,r,s?n?d[a]:f[a]:h,t,c,e);if(s_a.failed())return null;s_a.pop(7)}function L0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m;if(c=s_a.stackValue(0),m=s_a.stackValue(1),p=s_a.stackValue(2),s=s_a.stackValue(3),i=s_a.stackValue(4),s_a.failed())return null;if(!s_a.isWords(c))return s_a.primitiveFail(),null;if(!s_a.isWords(p))return s_a.primitiveFail(),null;if(!s_a.isWords(m))return s_a.primitiveFail(),null;if((h=o_a(c))<0)return s_a.primitiveFail(),null;if(o_a(p)!==h)return s_a.primitiveFail(),null;if(o_a(m)!==h)return s_a.primitiveFail(),null;if(i.isFloat){if(!s.isFloat)return s_a.primitiveFail(),null;t=!1}else{if(s.isFloat)return s_a.primitiveFail(),null;t=!0}if(t){if(o_a(i)!==h)return s_a.primitiveFail(),null;if(o_a(s)!==h)return s_a.primitiveFail(),null}for(l=c.wordsAsFloat32Array(),f=p.wordsAsFloat32Array(),d=m.wordsAsFloat32Array(),t&&(r=i.wordsAsFloat32Array(),a=s.wordsAsFloat32Array()),t||(n=s_a.floatValueOf(i),o=s_a.floatValueOf(s)),e=0;e<=h-1;e++)t&&(n=r[e],o=a[e]),u=z_a(n-f[e],o-d[e]),360<(u+=90)&&(u-=360),l[e]=u;if(s_a.failed())return null;s_a.pop(6),s_a.push(c)}function M0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b;if(l=s_a.stackValue(0),b=s_a.stackValue(1),p=s_a.stackValue(2),s=s_a.stackValue(3),i=s_a.stackValue(4),s_a.failed())return null;if(!s_a.isWords(l))return s_a.primitiveFail(),null;if(!s_a.isWords(p))return s_a.primitiveFail(),null;if(!s_a.isWords(b))return s_a.primitiveFail(),null;if((c=o_a(l))<0)return s_a.primitiveFail(),null;if(o_a(p)!==c)return s_a.primitiveFail(),null;if(o_a(b)!==c)return s_a.primitiveFail(),null;if(i.isFloat){if(!s.isFloat)return s_a.primitiveFail(),null;t=!1}else{if(s.isFloat)return s_a.primitiveFail(),null;t=!0}if(t){if(o_a(i)!==c)return s_a.primitiveFail(),null;if(o_a(s)!==c)return s_a.primitiveFail(),null}for(u=l.wordsAsFloat32Array(),f=p.wordsAsFloat32Array(),m=b.wordsAsFloat32Array(),t&&(r=i.wordsAsFloat32Array(),a=s.wordsAsFloat32Array()),t||(n=s_a.floatValueOf(i),o=s_a.floatValueOf(s)),e=0;e<=c-1;e++)t&&(n=r[e],o=a[e]),h=n-f[e],d=o-m[e],u[e]=Math.sqrt(h*h+d*d);if(s_a.failed())return null;s_a.pop(6),s_a.push(l)}function N0a(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v;if(v=s_a.stackIntegerValue(0),m=s_a.stackIntegerValue(1),n=s_a.stackIntegerValue(2),u=s_a.stackIntegerValue(3),r=s_a.stackValue(4),l=s_a.stackValue(5),s_a.failed())return null;if(f=o_a(l),a=o_a(r),u*n!==f)return s_a.primitiveFail(),null;if(f*m*v!==a)return s_a.primitiveFail(),null;for(o=l.words,t=r.words,d=i=h=c=0;d<=n-1;d++){for(b=0;b<=v-1;b++){for(p=0;p<=u-1;p++)for(e=o[c],++c,s=0;s<=m-1;s++)t[i]=e,++i;c=h}c=h+=u}s_a.pop(6)}function Ueb(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function Web(e,t){return e-(r=e,i=t,(0|Math.floor(r/i))*t)|0;var r,i}function Ugb(e,t,r){var i,a,s,n,o;a=(0-Ofb)/Jgb*r,n=0-(o=Math.exp(a))*o,a=2*Ofb/Jgb*t,s=(0-(s=o*Math.cos(a)*2))*(i=1/(i=1-s-n)),n=(0-n)*i,mhb(e,i),ohb(e,s),qhb(e,n)}function Vgb(e,t){var r,i;return r=lhb(e)*t+nhb(e)*(i=rhb(e))+phb(e)*thb(e),uhb(e,i),shb(e,t),r}function Xgb(e){return ygb.success(ygb.isWords(e)),ygb.failed()?0:e.wordsAsFloat32Array()}function Zgb(){return zgb}function $gb(){var e;return 0===Lgb?0:(Ngb=Dgb<Cgb?(e=rgb*Ngb+sgb*Ogb,Ogb=Ngb,e):e=tgb*Ngb-ugb,Lgb<=Dgb&&((Dgb=0)<wgb[zfb]?(function(){Fgb=wgb[zfb],function(){var e,t,r,i,a;a=Hgb/Jgb,e=Math.sin(2*Ofb*12.7*a),t=Math.sin(2*Ofb*7.1*a),r=Math.sin(2*Ofb*4.7*a),i=2*wgb[Gfb]*wgb[zfb]/100*(e+t+r),Fgb+=i}(),Fgb+=(bhb()-32767)*wgb[Nfb]/32768*wgb[zfb],0===Web(Egb,2)?Fgb+=wgb[xfb]*wgb[zfb]*(1-wgb[jgb]):Fgb-=wgb[xfb]*wgb[zfb]*(1-wgb[jgb]),Fgb<0&&(Fgb=0);Bgb=Lgb=Jgb/Fgb|0,0<wgb[qgb]&&(Bgb>>=1);Cgb=Lgb*wgb[jgb]|0,function(e,t,r){var i,a,s,n,o,u,l,c,h,f,p,d,m,b;f=(d=Lgb*e|0)/Lgb,h=r,a=(l=t)<=0?1:1-(u=(1-f)/l)/(Math.exp(u)-1);o=Ofb*(h+1),i=Math.cos(o),p=Math.sin(o),b=function(e,t,r,i){var a,s,n,o,u,l,c;if(0<(o=hhb(0,e,t,r,i)))for(u=0,a=o,s=hhb(l=1,e,t,r,i);0<s;)u=l,a=s,s=hhb(l*=2,e,t,r,i);else for(l=0,a=hhb(u=-1,e,t,r,i),s=o;a<0;)l=u,s=a,a=hhb(u*=2,e,t,r,i);for(;yfb<l-u;)0<(n=hhb(c=(l+u)/2,e,t,r,i))?(u=c,a=n):(l=c,s=n);return(l+u)/2}(o,i,p,l/f*o*a),m=o/d,c=Math.exp(b*m),rgb=2*Math.cos(m)*c,sgb=0-c*c,Ogb=0,Ngb=c*Math.sin(m),s=Math.exp(-1/(l*Lgb)),n=Math.pow(s,Lgb-d),ugb=(1-(tgb=s))*n/(1-n),function(){var e,t,r,i;for(t=0,r=Ngb,i=Ogb,e=1;e<=Cgb;e++)t=rgb*r+sgb*i,i=r,r=t;0!==t&&(Ngb=Ngb/t*1e4)}()}(wgb[jgb],wgb[egb],wgb[fgb]),0<(Ngb+=(bhb()-32767)*wgb[ogb]/32768*Ngb)&&(Ngb=0),0!==Web(Egb,2)&&0<(Ngb*=1-wgb[xfb])&&(Ngb=0)}(),Egb=Web(Egb+1,65535)):Bgb=Lgb=1),++Dgb,e)}function _gb(e){return 32.767*Math.pow(2,(e-87)/6)}function bhb(){return Kgb=1309*Kgb+13849&65535}function ghb(){var e,t,r,i,a,s,n,o;return e=Xgb(ygb.stackValue(2)),s=r=ygb.stackValue(1),ygb.success(ygb.isWords(s)),t=ygb.failed()?0:s.wordsAsInt16Array(),a=ygb.stackIntegerValue(0),ygb.failed()?null:(i=ygb.stackObjectValue(3),n=i,ygb.success(22===Ueb(n)),ygb.failed()||(o=ygb.fetchPointerofObject(0,n),Ggb=Xgb(o),Fgb=ygb.fetchFloatofObject(2,n),Lgb=ygb.fetchIntegerofObject(3,n),Dgb=ygb.fetchIntegerofObject(4,n),Cgb=ygb.fetchIntegerofObject(5,n),Bgb=ygb.fetchIntegerofObject(6,n),rgb=ygb.fetchFloatofObject(7,n),sgb=ygb.fetchFloatofObject(8,n),Ngb=ygb.fetchFloatofObject(9,n),Ogb=ygb.fetchFloatofObject(10,n),tgb=ygb.fetchFloatofObject(11,n),ugb=ygb.fetchFloatofObject(12,n),xgb=ygb.fetchFloatofObject(13,n),Mgb=ygb.fetchFloatofObject(14,n),Agb=ygb.fetchFloatofObject(15,n),Egb=ygb.fetchIntegerofObject(16,n),Hgb=ygb.fetchIntegerofObject(17,n),Kgb=ygb.fetchIntegerofObject(18,n),vgb=ygb.fetchIntegerofObject(19,n),Igb=ygb.fetchIntegerofObject(20,n),Jgb=ygb.fetchIntegerofObject(21,n),!1!==ygb.failed())?null:(ygb.success(2*Ueb(r)>=Igb),ygb.failed()?null:(function(e,t,r){var i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y;(function(e){var t,r,i,a,s,n,o,u,l,c,h;c=.6*_gb((wgb=e)[efb]),h=.6*_gb(wgb[gfb]),t=.4*_gb(wgb[Xeb]),i=.15*_gb(wgb[Zeb]),s=.06*_gb(wgb[_eb]),o=.04*_gb(wgb[bfb]),r=.15*_gb(wgb[Yeb]),a=.06*_gb(wgb[$eb]),n=.04*_gb(wgb[afb]),u=.022*_gb(wgb[cfb]),l=.03*_gb(wgb[dfb]),8<=vgb&&(16e3<=Jgb?ihb(dgb,7500,600):vgb=6);7<=vgb&&(16e3<=Jgb?ihb(cgb,6500,500):vgb=6);6<=vgb&&ihb(agb,wgb[Ffb],wgb[qfb]);5<=vgb&&ihb($fb,wgb[Efb],wgb[ofb]);ihb(Xfb,wgb[Dfb],wgb[mfb]),ihb(Ufb,wgb[Cfb],wgb[kfb]),ihb(Rfb,wgb[Bfb],wgb[ifb]),ihb(Pfb,wgb[Afb],wgb[hfb]),ihb(ggb,wgb[Hfb],wgb[sfb]),ihb(lgb,wgb[Kfb],wgb[ufb]),Ugb(igb,wgb[Ifb],wgb[tfb]),Ugb(ngb,wgb[Lfb],wgb[vfb]),jhb(hgb,wgb[Hfb],wgb[sfb],c),jhb(mgb,wgb[Kfb],wgb[ufb],h),jhb(Qfb,wgb[Afb],wgb[hfb],t),jhb(Tfb,wgb[Bfb],wgb[ifb],i),jhb(Wfb,wgb[Cfb],wgb[kfb],s),jhb(Zfb,wgb[Dfb],wgb[mfb],o),jhb(Sfb,wgb[Bfb],wgb[jfb],r),jhb(Vfb,wgb[Cfb],wgb[lfb],a),jhb(Yfb,wgb[Dfb],wgb[nfb],n),jhb(_fb,wgb[Efb],wgb[pfb],u),jhb(bgb,wgb[Ffb],wgb[rfb],l)})(e),0<Fgb?(y=_gb(wgb[qgb]-7),m=_gb(wgb[qgb]),k=.1*_gb(wgb[pgb])):y=m=k=0;o=.25*_gb(wgb[Jfb]),a=.05*_gb(wgb[ffb]),n=.05*_gb(wgb[wfb]),(l=wgb[Mfb]-3)<=0&&(l=57);i=_gb(l),jhb(kgb,0,Jgb,i),f=Agb,g=Igb+(h=r)-1;for(;h<=g;)f=(bhb()-32768)/4,Agb=f+=.75*Agb,Bgb<Dgb&&(f*=.5),u=o*f,_=$gb(),Mgb=_,Dgb<Cgb&&(_+=k*(bhb()-32768)/4),c=y*_,d=m*_,d+=s=a*f,w=c+=s,I=void 0,p=0<vgb?(I=Vgb(igb,w),I=khb(ggb,I),I=Vgb(ngb,I),I=khb(lgb,I),8<=vgb&&(I=khb(dgb,I)),7<=vgb&&(I=khb(cgb,I)),6<=vgb&&(I=khb(agb,I)),5<=vgb&&(I=khb($fb,I)),4<=vgb&&(I=khb(Xfb,I)),3<=vgb&&(I=khb(Ufb,I)),2<=vgb&&(I=khb(Rfb,I)),1<=vgb&&(I=khb(Pfb,I)),I):0,p+=khb(Qfb,O=b=d)+khb(Tfb,O)+khb(Wfb,O)+khb(Zfb,O)+khb(hgb,O)+khb(mgb,O),b=u+d-xgb,xgb=d,p=khb(Sfb,S=b)-khb(Vfb,S)+khb(Yfb,S)-khb(_fb,S)+khb(bgb,S)-p,p=khb(kgb,p=n*b-p),(v=p*i|0)<-32768&&(v=-32768),32767<v&&(v=32767),t[h-1]=v,++h,++Hgb;var S;var O;var w,I}(e,t,a),function(e){var t,r,i,a,s,n,o,u,l,c,h;if(ygb.pushRemappableOop(e),ygb.pushRemappableOop(ygb.floatObjectOf(Fgb)),ygb.pushRemappableOop(ygb.floatObjectOf(rgb)),ygb.pushRemappableOop(ygb.floatObjectOf(sgb)),ygb.pushRemappableOop(ygb.floatObjectOf(Ngb)),ygb.pushRemappableOop(ygb.floatObjectOf(Ogb)),ygb.pushRemappableOop(ygb.floatObjectOf(tgb)),ygb.pushRemappableOop(ygb.floatObjectOf(ugb)),ygb.pushRemappableOop(ygb.floatObjectOf(xgb)),ygb.pushRemappableOop(ygb.floatObjectOf(Mgb)),o=ygb.floatObjectOf(Agb),l=ygb.popRemappableOop(),s=ygb.popRemappableOop(),a=ygb.popRemappableOop(),i=ygb.popRemappableOop(),h=ygb.popRemappableOop(),c=ygb.popRemappableOop(),r=ygb.popRemappableOop(),t=ygb.popRemappableOop(),u=ygb.popRemappableOop(),n=ygb.popRemappableOop(),ygb.failed())return;return ygb.storePointerofObjectwithValue(2,n,u),ygb.storeIntegerofObjectwithValue(3,n,Lgb),ygb.storeIntegerofObjectwithValue(4,n,Dgb),ygb.storeIntegerofObjectwithValue(5,n,Cgb),ygb.storeIntegerofObjectwithValue(6,n,Bgb),ygb.storePointerofObjectwithValue(7,n,t),ygb.storePointerofObjectwithValue(8,n,r),ygb.storePointerofObjectwithValue(9,n,c),ygb.storePointerofObjectwithValue(10,n,h),ygb.storePointerofObjectwithValue(11,n,i),ygb.storePointerofObjectwithValue(12,n,a),ygb.storePointerofObjectwithValue(13,n,s),ygb.storePointerofObjectwithValue(14,n,l),ygb.storePointerofObjectwithValue(15,n,o),ygb.storeIntegerofObjectwithValue(16,n,Egb),ygb.storeIntegerofObjectwithValue(17,n,Hgb),ygb.storeIntegerofObjectwithValue(18,n,Kgb),!1===ygb.failed()}(i)?void ygb.pop(3):null)))}function hhb(e,t,r,i,a){return Math.exp(e*t)*((a*(e*e+1)+e)*i-r)+1}function ihb(e,t,r){var i,a,s,n;i=(0-Ofb)/Jgb*r,s=0-(n=Math.exp(i))*n,i=2*Ofb/Jgb*t,mhb(e,1-(a=n*Math.cos(i)*2)-s),ohb(e,a),qhb(e,s)}function jhb(e,t,r,i){ihb(e,t,r),mhb(e,lhb(e)*i)}function khb(e,t){var r,i;return r=lhb(e)*t+nhb(e)*(i=rhb(e))+phb(e)*thb(e),uhb(e,i),shb(e,r),r}function lhb(e){return Ggb[5*e-5]}function mhb(e,t){Ggb[5*e-5]=t}function nhb(e){return Ggb[5*e-4]}function ohb(e,t){Ggb[5*e-4]=t}function phb(e){return Ggb[5*e-3]}function qhb(e,t){Ggb[5*e-3]=t}function rhb(e){return Ggb[5*e-2]}function shb(e,t){Ggb[5*e-2]=t}function thb(e){return Ggb[5*e-1]}function uhb(e,t){Ggb[5*e-1]=t}function yhb(e){return!1!=((ygb=e).majorVersion()==Seb)&&ygb.minorVersion()>=Teb}function zkb(e){return"number"==typeof e?Gkb.classSmallInteger():e.sqClass}function Akb(e){return e.bytes?e.bytes.length:e.words?4*e.words.length:0}function Bkb(e,t){return 0|Math.floor(e/t)}function Ckb(e,t){return e-Bkb(e,t)*t|0}function Dkb(e,t){return 31<t?0:e<<t}function Ekb(e,t){return 31<t?0:e>>>t}function Kkb(e,t,r){var i,a,s,n,o,u,l,c,h;if(t<1||r<1)return Gkb.primitiveFail();if(a=e,!((u=Math.min(r,Skb((h=a).bytes,Akb(h))))<t)){if(o=1+(t-1>>3),i=1+(u-1>>3),n=Ckb(t-1,8),s=7-Ckb(u-1,8),o==i)return l=Dkb(255,n)&Ekb(255,s),0!=(llb(a,o)&l);if(0!==Ekb(llb(a,o),n))return 1;for(c=1+o;c<=i-1;c++)if(0!==llb(a,c))return 1;return 0!=(255&Dkb(llb(a,i),s))}}function Lkb(e,t){var r,i,a;return a=Gkb.instantiateClassindexableSize(zkb(e),t),i=(r=Akb(e))<t?r:t,Qkb(e.bytes,a.bytes,i),a}function Mkb(e,t){var r,i,a;return"number"==typeof e?(r=(i=e)<0?Gkb.classLargeNegativeInteger():Gkb.classLargePositiveInteger(),function(e,t){var r,i,a;for(r=t.bytes,i=1,a=Tkb(e);i<=a;i++)r[i-1]=Xkb(e,i)}(i,a=Gkb.instantiateClassindexableSize(r,t))):a=Lkb(e,t),a}function Pkb(e,t,r){var i,a,s;for(s=r-1;0<=s;){if((a=t[s])!==(i=e[s]))return a<i?1:-1;--s}return 0}function Qkb(e,t,r){var i,a;for(i=r-1,a=0;a<=i;a++)t[a]=e[a]}function Skb(e,t){var r,i;for(i=t;0===(r=e[i-1]);)if(0==--i)return 0;return alb(r)+8*(i-1)}function Tkb(e){return e<256&&-256<e?1:e<65536&&-65536<e?2:e<16777216&&-16777216<e?3:4}function Xkb(e,t){return t<1&&Gkb.primitiveFail(),4<t?0:e<0?255&Ekb(0-e,8*(t-1)):255&Ekb(e,8*(t-1))}function Zkb(r,i,a,s,n){return function(){for(var e=a-i+1,t=0;t<e;t++)r[t+i]=s[t+n];return 0}()}function alb(e){var t,r;return r=0,(t=e)<65536||(t>>>=16,r+=16),t<256||(t>>>=8,r+=8),t<16||(t>>>=4,r+=4),t<4||(t>>>=2,r+=2),t<2||(t>>>=1,++r),r+t}function blb(e){var t,r,i,a,s,n;for(s=(n=e)<0?Gkb.classLargeNegativeInteger():Gkb.classLargePositiveInteger(),t=Tkb(n),i=(r=Gkb.instantiateClassindexableSize(s,t)).bytes,a=1;a<=t;a++)i[a-1]=Xkb(n,a);return r}function clb(e,t){var r,i,a,s;return i=Akb(e),0===(s=Skb(e.bytes,i))?0:(r=s+t+7>>3,a=Gkb.instantiateClassindexableSize(zkb(e),r),function(e,t,r,i,a){var s,n,o,u,l,c,h;for(s=e>>3,l=Ckb(e,8),h=s-1,u=0;u<=h;u++)i[u]=0;if(0===l)return Zkb(i,s,a-1,t,0);for(c=8-l,h=r-1,u=n=0;u<=h;u++)o=t[u],i[u+s]=255&(n|Dkb(o,l)),n=Ekb(o,c);0!==n&&(i[a-1]=n)}(t,e.bytes,i,a.bytes,r),a)}function dlb(e,t,r){var i,a,s,n,o;return a=(o=Skb(e.bytes,r))+7>>3,(n=o-t)<=0?Gkb.instantiateClassindexableSize(zkb(e),0):(s=7+n>>3,i=Gkb.instantiateClassindexableSize(zkb(e),s),function(e,t,r,i,a){var s,n,o,u,l,c,h,f;if(n=e>>3,0===(l=Ckb(e,8)))return Zkb(i,0,a-1,t,n);for(c=8-l,o=Ekb(t[n],l),h=r-1,s=f=1+n;s<=h;s++)u=t[s],i[s-f]=255&(o|Dkb(u,c)),o=Ekb(u,l);0!==o&&(i[a-1]=o)}(t,e.bytes,a,i.bytes,s),i)}function elb(e,t){var r,i,a,s,n,o,u,l,c,h;return l=Akb(e),c=Akb(t),n=zkb(e),u=l<=c?(s=e,i=l,h=t,c):(s=t,i=c,h=e,l),r=Gkb.instantiateClassindexableSize(n,u),0<(a=function(e,t,r,i,a){var s,n,o;for(n=t-1,s=o=0;s<=n;s++)o=(o>>>8)+e[s]+r[s],a[s]=255&o;for(n=i-1,s=t;s<=n;s++)o=(o>>>8)+r[s],a[s]=255&o;return o>>>8}(s.bytes,i,h.bytes,u,r.bytes))&&(o=Gkb.instantiateClassindexableSize(n,u+1),Qkb(r.bytes,o.bytes,u),(r=o).bytes[u]=a),r}function flb(e,t,r){var i,a,s,n,o,u,l,c,h;if("number"==typeof e){if(e<0)return Gkb.primitiveFail();s=blb(e)}else{if(zkb(e)===Gkb.classLargeNegativeInteger())return Gkb.primitiveFail();s=e}if("number"==typeof t){if(t<0)return Gkb.primitiveFail();n=blb(t)}else{if(zkb(t)===Gkb.classLargeNegativeInteger())return Gkb.primitiveFail();n=t}return u=(l=Akb(s))<(c=Akb(n))?(i=l,a=s,o=c,n):(i=c,a=n,o=l,s),h=Gkb.instantiateClassindexableSize(Gkb.classLargePositiveInteger(),o),function(e,t,r,i,a,s){var n,o;if(o=r-1,e!==Fkb)if(e!==Ikb){if(e!==Jkb)return Gkb.primitiveFail();for(n=0;n<=o;n++)s[n]=t[n]^i[n];for(o=a-1,n=r;n<=o;n++)s[n]=i[n]}else{for(n=0;n<=o;n++)s[n]=t[n]|i[n];for(o=a-1,n=r;n<=o;n++)s[n]=i[n]}else{for(n=0;n<=o;n++)s[n]=t[n]&i[n];for(o=a-1,n=r;n<=o;n++)s[n]=0}}(r,a.bytes,i,u.bytes,o,h.bytes),Gkb.failed()?0:slb(h)}function glb(e,t){var r,i;return i=Akb(e),(r=Akb(t))!==i?i<r?-1:1:Pkb(e.bytes,t.bytes,i)}function hlb(e,t,r){var i,a,s,n,o,u,l,c,h;return h=Akb(e),c=Akb(t),i=r?Gkb.classLargeNegativeInteger():Gkb.classLargePositiveInteger(),(l=h-c+1)<=0?(a=Gkb.instantiateClassindexableSize(Gkb.classArray(),2),Gkb.stObjectatput(a,1,0),Gkb.stObjectatput(a,2,e)):(n=Mkb(n=clb(t,u=8-alb(Tlb(t,c))),ilb(n)+1),ilb(s=clb(e,u))===h&&(s=Mkb(s,h+1)),o=Gkb.instantiateClassindexableSize(i,l),function(e,t,r,i,a,s){var n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S;for(k=s,y=e[(g=t-1)-1],l=1==g?0:e[g-2],m=1;m<=k;m++){if(r[(b=i+1-m)-1]===y)o=255;else for(S=Ckb(_=((_=r[b-1])<<8)+r[b-2],y),h=(p=(o=Bkb(_,y))*l)>>>8,c=255&p,f=b<3?0:r[b-3];(S<h||S===h&&f<c)&&(--o,c<l?(--h,c=c+256-l):c-=l,y<=h);)h-=y;for(d=b-g,u=0,v=1;v<=t;v++)h=e[v-1]*(o>>>8),c=e[v-1]*(255&o),n=r[d-1]-u-(255&c),r[d-1]=255&n,u=h+(c>>>8)-(n>>=8),++d;if(0<u)for(--o,d=b-g,u=0,v=1;v<=t;v++)u=(u>>>8)+r[d-1]+e[v-1],r[d-1]=255&u,++d;a[s-m]=o}}(n.bytes,ilb(n),s.bytes,ilb(s),o.bytes,ilb(o)),s=dlb(s,u,ilb(n)-1),a=Gkb.instantiateClassindexableSize(Gkb.classArray(),2),Gkb.stObjectatput(a,1,o),Gkb.stObjectatput(a,2,s)),a}function ilb(e){return("number"==typeof e?Tkb:Akb)(e)}function jlb(e,t,r,i){var a,s,n,o;return n=Akb(e),o=Akb(t),n<=(s=Akb(r))&&o<=s&&0<=i&&i<=255?(a=Gkb.instantiateClassindexableSize(Gkb.classLargePositiveInteger(),s),function(e,t,r,i,a,s,n,o){var u,l,c,h,f,p,d,m;for(p=t-1,f=i-1,h=s-1,l=c=0;l<=p;l++){for(m=o[0]+e[l]*r[0],m+=(d=m*n&255)*a[0],u=1;u<=f;u++)m=(m>>>8)+o[u]+e[l]*r[u]+d*a[u],o[u-1]=255&m;for(u=i;u<=h;u++)m=(m>>>8)+o[u]+d*a[u],o[u-1]=255&m;m=(m>>>8)+c,o[h]=255&m,c=m>>>8}for(l=t;l<=h;l++){for(m=o[0],m+=(d=m*n&255)*a[0],u=1;u<=h;u++)m=(m>>>8)+o[u]+d*a[u],o[u-1]=255&m;m=(m>>>8)+c,o[h]=255&m,c=m>>>8}if(0!==c||1!==Pkb(a,o,s))for(l=m=0;l<=h;l++)m=m+o[l]-a[l],o[l]=255&m,m>>=8}(e.bytes,n,t.bytes,o,r.bytes,s,i,a.bytes),slb(a)):Gkb.primitiveFail()}function klb(e,t,r){var i,a,s,n,o,u,l,c;return o=(c=Akb(e))<=(l=Akb(t))?(n=e,s=c,i=t,l):(n=t,s=l,i=e,c),a=r?Gkb.classLargeNegativeInteger():Gkb.classLargePositiveInteger(),u=Gkb.instantiateClassindexableSize(a,o+s),function(e,t,r,i,a){var s,n,o,u,l,c,h,f;if(!(1===t&&0===e[0]||1===i&&0===r[0]))for(f=t-1,c=i-1,l=0;l<=f;l++)if(0!==(o=e[l])){for(h=l,n=u=0;n<=c;n++)u=(s=(s=r[n])*o+u+a[h])>>>8,a[h]=255&s,++h;a[h]=u}}(n.bytes,s,i.bytes,o,u.bytes),qlb(u)}function llb(e,t){return t>Akb(e)?0:Tlb(e,t)}function mlb(e,t){var r,i,a,s,n,o,u,l,c,h;if(u=zkb(e)===Gkb.classLargeNegativeInteger(),(l=Akb(e))===(c=Akb(t))){for(;1<l&&llb(e,l)===llb(t,l);)--l;c=l}return h=l<c||l===c&&llb(e,l)<llb(t,l)?(i=t,o=c,s=e,r=l,!1==u):(i=e,o=l,s=t,r=c,u),n=o,a=Gkb.instantiateClassindexableSize(h?Gkb.classLargeNegativeInteger():Gkb.classLargePositiveInteger(),n),function(e,t,r,i,a){var s,n;for(s=n=0;s<=t-1;s++)n=n+r[s]-e[s],a[s]=255&n,n>>=8;for(s=t;s<=i-1;s++)n+=r[s],a[s]=255&n,n>>=8}(s.bytes,r,i.bytes,o,a.bytes),(h?rlb:slb)(a)}function nlb(){return Hkb}function plb(e){var t,r;if("number"==typeof e)return 1;if(0!==(r=ilb(e))&&0!==Tlb(e,r)){if(4<r)return 1;if(!(r<4)){if(zkb(e)===Gkb.classLargePositiveInteger())return Tlb(e,4)>Xkb(1073741823,4);if(!(Tlb(e,4)<Xkb(-1073741824,4)))for(t=1;t<=4;t++)if(Tlb(e,t)!==Xkb(-1073741824,t))return 1}}}function qlb(e){return(zkb(e)===Gkb.classLargePositiveInteger()?slb:rlb)(e)}function rlb(e){var t,r,i,a,s;for(r=a=ilb(e);0!==r&&0===Tlb(e,r);)--r;if(0===r)return 0;if(r<=4){if(i=-1073741824,r<4||llb(e,4)<Xkb(i,4)){for(s=0,t=r;1<=t;t+=-1)s=256*s-Tlb(e,t);return s}for(t=1;t<=4;t++)if(llb(e,t)!==Xkb(i,t))return r<a?Lkb(e,r):e;return i}return r<a?Lkb(e,r):e}function slb(e){var t,r,i,a;for(r=a=ilb(e);0!==r&&0===Tlb(e,r);)--r;if(0===r)return 0;if(r<=4&&llb(e,4)<=Xkb(1073741823,4)){for(i=0,t=r;1<=t;t+=-1)i=256*i+Tlb(e,t);return i}return r<a?Lkb(e,r):e}function tlb(){var e,t,r,i;return t=Gkb.stackIntegerValue(1),r=Gkb.stackIntegerValue(0),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(2))),e=Gkb.stackValue(2),Gkb.failed()?null:(i=Kkb("number"==typeof e?blb(e):e,t,r)?Gkb.trueObject():Gkb.falseObject(),Gkb.failed()||Gkb.popthenPush(3,i),null)}function ulb(){var e,t;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(0))),e=Gkb.stackValue(0),Gkb.failed()?null:"number"==typeof e?(t=blb(e),Gkb.failed()||Gkb.popthenPush(2,t),null):(Gkb.failed()||Gkb.popthenPush(2,e),null)}function vlb(){var e;return e=Gkb.trueObject(),Gkb.failed()||Gkb.popthenPush(1,e),null}function wlb(){var e,t,r,i;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),t=Gkb.stackValue(1),r=Gkb.stackIntegerValue(0),Gkb.failed()||(e="number"==typeof t?blb(t):t,i=0<=r?clb(e,r):qlb(dlb(e,0-r,Akb(e))),Gkb.failed()||Gkb.popthenPush(3,i)),null}function xlb(){var e,t,r;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(0))),t=Gkb.stackValue(0),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),e=Gkb.stackValue(1),Gkb.failed()?null:(r=elb("number"==typeof e?blb(e):e,"number"==typeof t?blb(t):t),Gkb.failed()||Gkb.popthenPush(2,r),null)}function ylb(){var e,t,r;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),e=Gkb.stackValue(1),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(0))),t=Gkb.stackValue(0),Gkb.failed()?null:(r=elb("number"==typeof e?blb(e):e,"number"==typeof t?blb(t):t),Gkb.failed()||Gkb.popthenPush(3,r),null)}function zlb(){var e,t,r;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(0))),t=Gkb.stackValue(0),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),e=Gkb.stackValue(1),Gkb.failed()?null:(r=flb(e,t,Fkb),Gkb.failed()||Gkb.popthenPush(2,r),null)}function Alb(){var e,t,r,i;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(2))),e=Gkb.stackValue(2),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),t=Gkb.stackValue(1),r=Gkb.stackIntegerValue(0),Gkb.failed()?null:(i=flb(e,t,r),Gkb.failed()||Gkb.popthenPush(4,i),null)}function Blb(){var e,t,r;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(0))),t=Gkb.stackValue(0),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),e=Gkb.stackValue(1),Gkb.failed()?null:(r=flb(e,t,Ikb),Gkb.failed()||Gkb.popthenPush(2,r),null)}function Clb(){var e,t,r,i;return r=Gkb.stackIntegerValue(0),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),t=Gkb.stackValue(1),Gkb.failed()||(e="number"==typeof t?blb(t):t,i=0<=r?clb(e,r):qlb(dlb(e,0-r,Akb(e))),Gkb.failed()||Gkb.popthenPush(2,i)),null}function Dlb(){var e,t,r,i;return r=Gkb.stackIntegerValue(0),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),t=Gkb.stackValue(1),Gkb.failed()||(e="number"==typeof t?blb(t):t,i=0<=r?clb(e,r):qlb(dlb(e,0-r,Akb(e))),Gkb.failed()||Gkb.popthenPush(2,i)),null}function Elb(){var e,t,r;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(0))),t=Gkb.stackValue(0),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),e=Gkb.stackValue(1),Gkb.failed()?null:(r=flb(e,t,Jkb),Gkb.failed()||Gkb.popthenPush(2,r),null)}function Flb(){var e,t,r,i,a;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(0))),i=Gkb.stackValue(0),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),t=Gkb.stackValue(1),Gkb.failed()?null:"number"==typeof t?"number"==typeof i?(e=t)>(r=i)?(a=1,Gkb.failed()||Gkb.popthenPush(2,a),null):(a=e<r?-1:0,Gkb.failed()||Gkb.popthenPush(2,a),null):(a=-1,Gkb.failed()||Gkb.popthenPush(2,a),null):(a="number"==typeof i?1:glb(t,i),Gkb.failed()||Gkb.popthenPush(2,a),null)}function Glb(){var e,t,r,i,a;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),r=Gkb.stackValue(1),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(0))),i=Gkb.stackValue(0),Gkb.failed()?null:"number"==typeof r?"number"==typeof i?(e=r)>(t=i)?(a=1,Gkb.failed()||Gkb.popthenPush(3,a),null):(a=e<t?-1:0,Gkb.failed()||Gkb.popthenPush(3,a),null):(a=-1,Gkb.failed()||Gkb.popthenPush(3,a),null):(a="number"==typeof i?1:glb(r,i),Gkb.failed()||Gkb.popthenPush(3,a),null)}function Hlb(){var e,t,r,i,a,s;if(Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),i=Gkb.stackValue(1),a=Gkb.booleanValueOf(Gkb.stackValue(0)),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(2))),t=Gkb.stackValue(2),Gkb.failed())return null;if(!plb(t))return Gkb.primitiveFail(),null;if(!plb(i))return Gkb.primitiveFail(),null;if(e="number"==typeof t?blb(t):t,"number"==typeof i){if(0===i)return Gkb.primitiveFail(),null;r=blb(i)}else r=i;return s=hlb(e,r,a),Gkb.failed()||Gkb.popthenPush(3,s),null}function Ilb(){var e,t,r,i,a,s;if(Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(2))),r=Gkb.stackValue(2),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),i=Gkb.stackValue(1),a=Gkb.booleanValueOf(Gkb.stackValue(0)),Gkb.failed())return null;if(e="number"==typeof r?blb(r):r,"number"==typeof i){if(0===i)return Gkb.primitiveFail(),null;t=blb(i)}else t=i;return s=hlb(e,t,a),Gkb.failed()||Gkb.popthenPush(4,s),null}function Jlb(){var e,t,r,i;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),t=Gkb.stackValue(1),r=Gkb.booleanValueOf(Gkb.stackValue(0)),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(2))),e=Gkb.stackValue(2),Gkb.failed()?null:(i=klb("number"==typeof e?blb(e):e,"number"==typeof t?blb(t):t,r),Gkb.failed()||Gkb.popthenPush(3,i),null)}function Klb(){var e,t,r,i;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(2))),e=Gkb.stackValue(2),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),t=Gkb.stackValue(1),r=Gkb.booleanValueOf(Gkb.stackValue(0)),Gkb.failed()?null:(i=klb("number"==typeof e?blb(e):e,"number"==typeof t?blb(t):t,r),Gkb.failed()||Gkb.popthenPush(4,i),null)}function Llb(){var e,t,r;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(0))),t=Gkb.stackValue(0),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),e=Gkb.stackValue(1),Gkb.failed()?null:(r=mlb("number"==typeof e?blb(e):e,"number"==typeof t?blb(t):t),Gkb.failed()||Gkb.popthenPush(2,r),null)}function Mlb(){var e,t,r;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),e=Gkb.stackValue(1),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(0))),t=Gkb.stackValue(0),Gkb.failed()?null:(r=mlb("number"==typeof e?blb(e):e,"number"==typeof t?blb(t):t),Gkb.failed()||Gkb.popthenPush(3,r),null)}function Nlb(){var e,t,r,i;for(t=nlb().length,e=(i=Gkb.instantiateClassindexableSize(Gkb.classString(),t)).bytes,r=0;r<=t-1;r++)e[r]=nlb()[r];return Gkb.failed()||Gkb.popthenPush(1,i),null}function Olb(){var e,t,r,i,a;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(2))),t=Gkb.stackValue(2),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(1))),r=Gkb.stackValue(1),i=Gkb.stackIntegerValue(0),Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(3))),e=Gkb.stackValue(3),Gkb.failed()?null:(a=jlb("number"==typeof e?blb(e):e,"number"==typeof t?blb(t):t,"number"==typeof r?blb(r):r,i),Gkb.failed()||Gkb.popthenPush(4,a),null)}function Plb(){var e,t;return Gkb.success(Gkb.isKindOfInteger(Gkb.stackValue(0))),e=Gkb.stackValue(0),Gkb.failed()?null:"number"==typeof e?(Gkb.failed()||Gkb.popthenPush(2,e),null):(t=qlb(e),Gkb.failed()||Gkb.popthenPush(2,t),null)}function Qlb(){var e,t;return Gkb.success(Gkb.stackValue(0).sqClass===Gkb.classLargeNegativeInteger()),e=Gkb.stackValue(0),Gkb.failed()?null:(t=rlb(e),Gkb.failed()||Gkb.popthenPush(1,t),null)}function Rlb(){var e,t;return Gkb.success(Gkb.stackValue(0).sqClass===Gkb.classLargePositiveInteger()),e=Gkb.stackValue(0),Gkb.failed()?null:(t=slb(e),Gkb.failed()||Gkb.popthenPush(1,t),null)}function Slb(e){return!1!=((Gkb=e).majorVersion()==xkb)&&Gkb.minorVersion()>=ykb}function Tlb(e,t){return e.bytes[t-1]}function ntb(e){return"number"==typeof e?ptb.classSmallInteger():e.sqClass}function otb(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function vtb(){return utb}function wtb(e){return ptb.failed()?null:ptb.isWords(e)&&6===otb(e)?e.wordsAsFloat32Array():(ptb.primitiveFail(),null)}function xtb(e){var t,r;if(!ptb.failed()){if(ntb(e)!==ptb.classPoint())return ptb.primitiveFail();if(!(t="number"==typeof(r=ptb.fetchPointerofObject(0,e)))&&!r.isFloat)return ptb.primitiveFail();if(qtb=t?r:ptb.floatValueOf(r),!(t="number"==typeof(r=ptb.fetchPointerofObject(1,e)))&&!r.isFloat)return ptb.primitiveFail();rtb=t?r:ptb.floatValueOf(r)}}function ztb(e){var t,r,i,a,s;if(a=qtb-e[2],s=rtb-e[5],0===(t=e[0]*e[4]-e[1]*e[3]))return ptb.primitiveFail();t=1/t,r=a*e[4]-e[1]*s,i=e[0]*s-a*e[3],stb=r*t,ttb=i*t}function Atb(e){stb=qtb*e[0]+rtb*e[1]+e[2],ttb=qtb*e[3]+rtb*e[4]+e[5]}function Btb(e){return-1073741824<=e&&stb<=1073741823}function Ctb(e){var t,r,i,a,s,n,o,u,l,c,h,f,p;if(i=wtb(a=ptb.stackObjectValue(0)),r=wtb(ptb.stackObjectValue(1)),t=wtb(ptb.stackObjectValue(2)),ptb.failed())return null;n=r,o=i,u=(s=t)[0]*n[0]+s[1]*n[3],l=s[0]*n[1]+s[1]*n[4],c=s[0]*n[2]+s[1]*n[5]+s[2],h=s[3]*n[0]+s[4]*n[3],f=s[3]*n[1]+s[4]*n[4],p=s[3]*n[2]+s[4]*n[5]+s[5],o[0]=u,o[1]=l,o[2]=c,o[3]=h,o[4]=f,o[5]=p,ptb.popthenPush(e+1,a)}function Dtb(e){var t;if(xtb(ptb.stackObjectValue(0)),t=wtb(ptb.stackObjectValue(1)),ptb.failed())return null;ztb(t),ptb.failed()||Jtb(e)}function Etb(e){var t,r,i,a,s,n,o,u,l,c,h;return i=ptb.stackObjectValue(0),h=ptb.stackObjectValue(1),a=wtb(ptb.stackObjectValue(2)),ptb.failed()?null:ntb(h)!==ntb(i)||!ptb.isPointers(h)||2!==otb(h)?ptb.primitiveFail():(xtb(ptb.fetchPointerofObject(0,h)),ptb.failed()?null:(l=qtb,c=rtb,ztb(a),o=s=stb,u=n=ttb,xtb(ptb.fetchPointerofObject(1,h)),ptb.failed()?null:(t=qtb,r=rtb,ztb(a),o=Math.min(o,stb),s=Math.max(s,stb),u=Math.min(u,ttb),n=Math.max(n,ttb),qtb=t,rtb=c,ztb(a),o=Math.min(o,stb),s=Math.max(s,stb),u=Math.min(u,ttb),n=Math.max(n,ttb),qtb=l,rtb=r,ztb(a),o=Math.min(o,stb),s=Math.max(s,stb),u=Math.min(u,ttb),n=Math.max(n,ttb),ptb.failed()||(i=Ktb(i,o,u,s,n)),void(ptb.failed()||ptb.popthenPush(e+1,i)))))}function Ftb(e){var t;if(t=wtb(ptb.stackObjectValue(0)),ptb.failed())return null;ptb.pop(1),ptb.pushBool(1===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&1===t[4]&&0===t[5])}function Gtb(e){var t;if(t=wtb(ptb.stackObjectValue(0)),ptb.failed())return null;ptb.pop(1),ptb.pushBool(1===t[0]&&0===t[1]&&0===t[3]&&1===t[4])}function Htb(e){var t;if(xtb(ptb.stackObjectValue(0)),t=wtb(ptb.stackObjectValue(1)),ptb.failed())return null;Atb(t),Jtb(e)}function Itb(e){var t,r,i,a,s,n,o,u,l,c,h;return i=ptb.stackObjectValue(0),h=ptb.stackObjectValue(1),a=wtb(ptb.stackObjectValue(2)),ptb.failed()?null:ntb(h)!==ntb(i)||!ptb.isPointers(h)||2!==otb(h)?ptb.primitiveFail():(xtb(ptb.fetchPointerofObject(0,h)),ptb.failed()?null:(l=qtb,c=rtb,Atb(a),o=s=stb,u=n=ttb,xtb(ptb.fetchPointerofObject(1,h)),ptb.failed()?null:(t=qtb,r=rtb,Atb(a),o=Math.min(o,stb),s=Math.max(s,stb),u=Math.min(u,ttb),n=Math.max(n,ttb),qtb=t,rtb=c,Atb(a),o=Math.min(o,stb),s=Math.max(s,stb),u=Math.min(u,ttb),n=Math.max(n,ttb),qtb=l,rtb=r,Atb(a),o=Math.min(o,stb),s=Math.max(s,stb),i=Ktb(i,o,u=Math.min(u,ttb),s,n=Math.max(n,ttb)),void(ptb.failed()||ptb.popthenPush(e+1,i)))))}function Jtb(e){return ttb+=.5,Btb(stb+=.5)&&Btb(ttb)?void ptb.popthenPush(e+1,ptb.makePointwithxValueyValue(0|stb,0|ttb)):ptb.primitiveFail()}function Ktb(e,t,r,i,a){var s,n,o,u,l,c,h;return Btb(u=t+.5)&&Btb(n=i+.5)&&Btb(l=r+.5)&&Btb(o=a+.5)?(ptb.pushRemappableOop(e),c=ptb.makePointwithxValueyValue(0|u,0|l),ptb.pushRemappableOop(c),s=ptb.makePointwithxValueyValue(0|n,0|o),c=ptb.popRemappableOop(),h=ptb.popRemappableOop(),ptb.storePointerofObjectwithValue(0,h,c),ptb.storePointerofObjectwithValue(1,h,s),h):ptb.primitiveFail()}function Ltb(e){return!1!=((ptb=e).majorVersion()==ltb)&&ptb.minorVersion()>=mtb}function kvb(e,t){return e-(r=e,i=t,(0|Math.floor(r/i))*t)|0;var r,i}function ovb(e,t,r){var i,a,s;for(i=0;i<=3;i++)t[r+i-1]=255&(a=e,31<(s=8*(3-i))?0:a>>>s);return r+4}function pvb(e,t,r){return e<=223?(t[r-1]=e,r+1):e<=7935?(t[r-1]=224+(e>>8),t[r]=kvb(e,256),r+2):(t[r-1]=255,ovb(e,t,r+1))}function qvb(){return nvb}function rvb(e){var t,r,i,a,s,n,o,u;if(mvb.stackValue(3),t=mvb.stackBytes(2),r=mvb.stackBytes(1),i=mvb.stackBytes(0),mvb.failed())return null;for(o=t.length,u=r.length,n=1;n<=Math.min(o,u);n++)if((a=i[t[n-1]])!==(s=i[r[n-1]]))return a<s?mvb.failed()||mvb.popthenPush(e+1,1):mvb.failed()||mvb.popthenPush(e+1,3),null;return o===u?mvb.failed()||mvb.popthenPush(e+1,2):o<u?mvb.failed()||mvb.popthenPush(e+1,1):mvb.failed()||mvb.popthenPush(e+1,3),null}function svb(e){var t,r,i,a,s,n,o,u,l,c;if(mvb.stackValue(2),t=mvb.stackInt32Array(1),r=mvb.stackBytes(0),mvb.failed())return null;for(a=pvb(l=t.length,r,1),n=1;n<=l;){for(i=((c=t[n-1])>>>8&255)==(o=255&c)&&(c>>>16&255)==o&&(c>>>24&255)==o,s=n;s<l&&c===t[s];)++s;if(n<s)i?(r[(a=pvb(4*(s-n+1)+1,r,a))-1]=o,++a):a=ovb(c,r,a=pvb(4*(s-n+1)+2,r,a)),n=s+1;else if(i)r[(a=pvb(5,r,a))-1]=o,++a,++n;else{for(;s<l&&t[s-1]!==t[s];)++s;for(s===l&&++s,a=pvb(4*(s-n)+3,r,a),u=n;u<=s-1;u++)a=ovb(t[u-1],r,a);n=s}}return mvb.failed()||mvb.popthenPush(e+1,a-1),null}function tvb(e){var t,r,i,a,s;if(mvb.stackValue(2),t=mvb.stackBytes(1),r=mvb.stackUint16Array(0),mvb.failed())return null;for(a=t.length,i=1;i<=a;i++)s=t[i-1],r[i-1]=127<s?s-256<<8:s<<8;if(mvb.failed())return null;mvb.pop(e)}function uvb(e){var t,r,i,a,s,n,o,u,l,c,h,f,p;if(mvb.stackValue(3),t=mvb.stackInt32Array(2),r=mvb.stackBytes(1),i=mvb.stackIntegerValue(0),mvb.failed())return null;for(u=i,o=r.length,c=1,p=t.length+1;u<=o;){if(a=r[u-1],++u,!(a<=223))if(a<=254)a=256*(a-224)+r[u-1],++u;else for(a=0,l=1;l<=4;l++)a=(a<<8)+r[u-1],++u;if(p<c+(f=a>>>2))return mvb.primitiveFail(),null;if(1==(s=3&a))for(n=r[u-1],++u,n|=n<<8,n|=n<<16,l=1;l<=f;l++)t[c-1]=n,++c;if(2==s){for(n=0,l=1;l<=4;l++)n=n<<8|r[u-1],++u;for(l=1;l<=f;l++)t[c-1]=n,++c}if(3==s)for(h=1;h<=f;h++){for(n=0,l=1;l<=4;l++)n=n<<8|r[u-1],++u;t[c-1]=n,++c}}if(mvb.failed())return null;mvb.pop(e)}function vvb(e){var t,r,i,a,s;if(mvb.stackValue(3),t=mvb.stackBytes(2),r=mvb.stackBytes(1),i=mvb.stackIntegerValue(0),mvb.failed())return null;if(256!==r.length)return mvb.failed()||mvb.popthenPush(e+1,0),null;for(a=i,s=t.length;a<=s&&0===r[t[a-1]];)++a;return s<a?mvb.failed()||mvb.popthenPush(e+1,0):mvb.failed()||mvb.popthenPush(e+1,a),null}function wvb(e){var t,r,i,a,s,n;if(mvb.stackValue(4),t=mvb.stackBytes(3),r=mvb.stackBytes(2),i=mvb.stackIntegerValue(1),a=mvb.stackBytes(0),mvb.failed())return null;if(0===t.length)return mvb.failed()||mvb.popthenPush(e+1,0),null;for(n=i;n<=r.length-t.length+1;n++)for(s=1;a[r[n+s-1-1]]===a[t[s-1]];){if(s===t.length)return mvb.failed()||mvb.popthenPush(e+1,n),null;++s}return mvb.failed()||mvb.popthenPush(e+1,0),null}function xvb(e){var t,r,i,a,s;if(mvb.stackValue(3),t=mvb.stackIntegerValue(2),r=mvb.stackBytes(1),i=mvb.stackIntegerValue(0),mvb.failed())return null;for(s=r.length,a=i;a<=s;a++)if(r[a-1]===t)return mvb.failed()||mvb.popthenPush(e+1,a),null;return mvb.failed()||mvb.popthenPush(e+1,0),null}function yvb(e){var t,r,i,a,s,n;if(mvb.stackValue(2),t=mvb.stackBytes(1),r=mvb.stackIntegerValue(0),mvb.failed())return null;for(i=t.length,a=268435455&r,n=1;n<=i;n++)a=9741*(s=16383&(a+=t[n-1]))+16384*(9741*(a>>>14)+101*s&16383)&268435455;return mvb.failed()||mvb.popthenPush(e+1,a),null}function zvb(e){var t,r,i,a,s;if(mvb.stackValue(4),t=mvb.stackBytes(3),r=mvb.stackIntegerValue(2),i=mvb.stackIntegerValue(1),a=mvb.stackBytes(0),mvb.failed())return null;for(s=r;s<=i;s++)t[s-1]=a[t[s-1]];if(mvb.failed())return null;mvb.pop(e)}function Avb(e){return!1!=((mvb=e).majorVersion()==hvb)&&mvb.minorVersion()>=ivb}function txb(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function uxb(e,t){return 0|Math.floor(e/t)}function vxb(e,t){return e-uxb(e,t)*t|0}function yxb(e,t,r,i,a){var s,n,o,u,l,c,h;n=uxb(r,60),u=(1e3-i)*a,l=(1e3-uxb(i*(s=vxb(r,60)),60))*a,c=(1e3-uxb(i*(60-s),60))*a,h=uxb(1e3*a,3922),u=uxb(u,3922),l=uxb(l,3922),c=uxb(c,3922),0===n&&(o=(h<<16)+(c<<8)+u),1===n&&(o=(l<<16)+(h<<8)+u),2===n&&(o=(u<<16)+(h<<8)+c),3===n&&(o=(u<<16)+(l<<8)+h),4===n&&(o=(c<<16)+(u<<8)+h),5===n&&(o=(h<<16)+(u<<8)+l),0===o&&(o=1),e[t]=o}function zxb(e){return wxb.success(wxb.isWordsOrBytes(e)),wxb.failed()?0:e.wordsAsFloat64Array()}function Axb(e){return wxb.success(wxb.isWords(e)),wxb.failed()?0:e.words}function Bxb(){return xxb}function Cxb(e,t,r,i,a){var s,n;return 0==(n=a-i)?0:(s=e===a?uxb(60*(t-r),n):t===a?120+uxb(60*(r-e),n):240+uxb(60*(e-t),n))<0?s+360:s}function Dxb(e,t,r){var i,a;return 0===e?t:0===t?e:(0===(a=((i=1024-r)*(e>>>16&255)+r*(t>>>16&255)>>10<<16)+(i*(e>>>8&255)+r*(t>>>8&255)>>10<<8)+(i*(255&e)+r*(255&t)>>10))&&(a=1),a)}function Exb(e,t,r,i,a){var s,n,o,u,l,c,h;return(u=t>>>10)<-1||i<=u||(c=r>>>10)<-1||a<=c?0:(l=1023&t,-1===u&&(l=u=0),u===i-1&&(l=0),h=1023&r,-1===c&&(h=c=0),c===a-1&&(h=0),o=16777215&e[n=c*i+u],0<l&&(o=Dxb(o,16777215&e[n+1],l)),0===h?o:(s=16777215&e[n=(c+1)*i+u],0<l&&(s=Dxb(s,16777215&e[n+1],l)),Dxb(o,s,h)))}function Fxb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b;if(n=wxb.stackValue(2),l=wxb.stackValue(1),d=wxb.stackIntegerValue(0),s=Axb(n),u=Axb(l),p=txb(n),wxb.success(txb(l)===p),wxb.failed())return null;for(a=uxb(p,d),b=1;b<=a-2;b++)for(m=1;m<=d-2;m++){for(o=f=i=e=0,r=-1;r<=1;r++)for(t=-1;t<=1;t++)0!=(h=16777215&s[(b+r)*d+(m+t)])&&(f+=h>>>16&255,i+=h>>>8&255,e+=255&h,++o);c=0===o?0:(uxb(f,o)<<16)+(uxb(i,o)<<8)+uxb(e,o),u[b*d+m]=c}return wxb.pop(3),0}function Gxb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m;if(n=wxb.stackValue(2),c=wxb.stackValue(1),d=wxb.stackIntegerValue(0),s=Axb(n),m=txb(n),l=Axb(c),wxb.success(txb(c)===m),wxb.failed())return null;for(a=0;a<=m-1;a++)0!=(h=16777215&s[a])&&((o=u=f=h>>>16&255)<(r=h>>>8&255)&&(o=r),o<(e=255&h)&&(o=e),r<u&&(u=r),e<u&&(u=e),i=Cxb(f,r,e,u,o),p=0===o?0:uxb(1e3*(o-u),o),t=uxb(1e3*o,255),1e3<(t+=10*d)&&(t=1e3),t<0&&(t=0),yxb(l,a,i,p,t));return wxb.pop(3),0}function Hxb(){var e,t,r,i,a,s,n,o,u,l,c,h=0,f=0;if(u=wxb.stackValue(2),r=wxb.stackValue(1),i=wxb.stackIntegerValue(0),wxb.success(wxb.isWords(u)),wxb.success(wxb.isWords(r)),e=uxb(2*txb(u),i),l=2*txb(r),wxb.success(e<=l),wxb.failed())return null;for(o=u.wordsAsInt16Array(),t=r.wordsAsInt16Array(),a=1;a<=e;a++){for(n=0,s=1;s<=i;s++)(c=o[h++])<0&&(c=0-c),n<c&&(n=c);t[f++]=n}return wxb.pop(3),0}function Ixb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d;if(n=wxb.stackValue(7),o=wxb.stackIntegerValue(6),s=wxb.stackIntegerValue(5),c=wxb.stackValue(4),h=wxb.stackIntegerValue(3),l=wxb.stackIntegerValue(2),t=wxb.stackIntegerValue(1),r=wxb.stackIntegerValue(0),a=Axb(n),u=Axb(c),wxb.success(t+2*o<h),wxb.success(r+2*s<l),wxb.failed())return null;for(d=0;d<=s-1;d++)for(e=(r+2*d)*h+t,p=0;p<=o-1;p++)f=a[p+d*o],u[i=e+2*p]=f,u[i+1]=f,u[i+h]=f,u[i+h+1]=f;return wxb.pop(8),0}function Jxb(){var e,t,r,i,a,s,n,o=0,u=0;if(s=wxb.stackValue(2),t=wxb.stackValue(1),i=wxb.booleanValueOf(wxb.stackValue(0)),wxb.success(wxb.isWords(s)),wxb.success(wxb.isWords(t)),n=txb(s),wxb.success(txb(t)>=n>>1),wxb.failed())return null;for(a=s.wordsAsInt16Array(),e=t.wordsAsInt16Array(),i&&o++,r=1;r<=n;r++)e[u++]=a[o],o+=2;return wxb.pop(3),0}function Kxb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k;if(o=wxb.stackValue(3),l=wxb.stackValue(2),v=wxb.stackIntegerValue(1),h=wxb.stackIntegerValue(0),n=Axb(o),u=Axb(l),b=txb(o),wxb.success(txb(l)===b),wxb.failed())return null;for(s=uxb(b,v),t=v>>1,r=(s=uxb(b,v))>>1,p=h/100,g=0;g<=v-1;g++)for(k=0;k<=s-1;k++)i=(g-t)/t,a=(k-r)/r,m=(f=Math.pow(Math.sqrt(i*i+a*a),p))<=1?(e=Math.atan2(a,i),d=1024*(t+f*Math.cos(e)*t)|0,1024*(r+f*Math.sin(e)*r)|0):(d=1024*g,1024*k),c=Exb(n,d,m,v,s),u[k*v+g]=c;return wxb.pop(4),0}function Lxb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k;if(o=Axb(wxb.stackValue(11)),l=wxb.stackIntegerValue(10),u=wxb.stackIntegerValue(9),c=Axb(wxb.stackValue(8)),f=wxb.stackIntegerValue(7),h=wxb.stackIntegerValue(6),b=wxb.stackIntegerValue(5),v=wxb.stackIntegerValue(4),a=wxb.stackIntegerValue(3),s=wxb.stackIntegerValue(2),i=wxb.stackIntegerValue(1),t=wxb.stackIntegerValue(0),wxb.success(0<=b&&0<=v),wxb.success(b+2*i<=l),wxb.success(v+2*t<=u),wxb.success(0<=a&&0<=s),wxb.success(a+i<=f),wxb.success(s+t<=h),wxb.failed())return null;for(k=0;k<=t-1;k++)for(m=l*(v+2*k)+b,r=f*(s+k)+a,g=0;g<=i-1;g++)d=16711680&(p=o[m]),n=65280&p,e=255&p,d+=16711680&(p=o[m+1]),n+=65280&p,e+=255&p,d+=16711680&(p=o[m+l]),n+=65280&p,e+=255&p,d+=16711680&(p=o[m+l+1]),n+=65280&p,e+=255&p,c[r]=d>>>2&16711680|n>>>2&65280|e>>>2,m+=2,++r;return wxb.pop(12),0}function Mxb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_;if(o=Axb(wxb.stackValue(11)),l=wxb.stackIntegerValue(10),u=wxb.stackIntegerValue(9),c=Axb(wxb.stackValue(8)),f=wxb.stackIntegerValue(7),h=wxb.stackIntegerValue(6),v=wxb.stackIntegerValue(5),g=wxb.stackIntegerValue(4),a=wxb.stackIntegerValue(3),s=wxb.stackIntegerValue(2),i=wxb.stackIntegerValue(1),t=wxb.stackIntegerValue(0),wxb.success(0<=v&&0<=g),wxb.success(v+2*i<=l),wxb.success(g+2*t<=u),wxb.success(0<=a&&0<=s),wxb.success(a+i<=f),wxb.success(s+t<=h),wxb.failed())return null;for(_=0;_<=t-1;_++)for(b=l*(g+2*_)+v,r=f*(s+_)+a,k=0;k<=i-1;k++)m=(16711680&(p=o[b]))+(16711680&(d=o[b+l+1]))>>>1&16711680,n=(65280&p)+(65280&d)>>>1&65280,e=(255&p)+(255&d)>>>1,c[r]=n|e|m,b+=2,++r;return wxb.pop(12),0}function Nxb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d;if(s=wxb.stackValue(2),l=wxb.stackValue(1),p=wxb.stackIntegerValue(0),a=Axb(s),d=txb(s),u=Axb(l),wxb.success(txb(l)===d),wxb.failed())return null;for(i=0;i<=d-1;i++)0!=(c=16777215&a[i])&&((n=o=h=c>>>16&255)<(r=c>>>8&255)&&(n=r),n<(e=255&c)&&(n=e),r<o&&(o=r),e<o&&(o=e),t=uxb(1e3*n,255),f=0===n?0:uxb(1e3*(n-o),n),t<110&&(t=110,f=1e3),f<90&&(f=90),yxb(u,i,vxb((110===t||90===f?0:Cxb(h,r,e,o,n))+p+36e7,360),f,t));return wxb.pop(3),0}function Oxb(){var e,t,r,i,a,s,n;return t=wxb.stackValue(3),a=wxb.stackIntegerValue(2),s=wxb.stackIntegerValue(1),n=wxb.stackIntegerValue(0),e=Axb(t),i=txb(t),wxb.failed()?null:(r=Exb(e,s,n,a,uxb(i,a)),wxb.pop(5),wxb.pushInteger(r),0)}function Pxb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d;if(s=wxb.stackValue(2),l=wxb.stackValue(1),p=wxb.stackIntegerValue(0),a=Axb(s),d=txb(s),u=Axb(l),wxb.success(txb(l)===d),wxb.failed())return null;for(i=0;i<=d-1;i++)(c=16777215&a[i])<2||((n=o=h=c>>>16&255)<(r=c>>>8&255)&&(n=r),n<(e=255&c)&&(n=e),r<o&&(o=r),e<o&&(o=e),t=uxb(1e3*n,255),0<(f=0===n?0:uxb(1e3*(n-o),n))&&(1e3<(f+=10*p)&&(f=1e3),f<0&&(f=0),yxb(u,i,Cxb(h,r,e,o,n),f,t)));return wxb.pop(3),0}function Qxb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O,w;if(r=wxb.stackValue(5),i=wxb.stackIntegerValue(4),t=wxb.stackIntegerValue(3),u=wxb.stackValue(2),c=wxb.stackIntegerValue(1),o=wxb.stackIntegerValue(0),wxb.success(txb(r)===i*t),wxb.success(txb(u)===c*o),e=Axb(r),n=Axb(u),wxb.failed())return null;for(a=s=0,O=uxb(1024*i,c),w=uxb(1024*t,o),f=0;f<=o-1;f++){for(h=a=0;h<=c-1;h++)k=(1024-(1023&a))*(1024-(1023&s)),_=(1023&a)*(1024-(1023&s)),y=(1024-(1023&a))*(1023&s),S=(1023&a)*(1023&s),p=e[v=(s>>>10)*i+(a>>>10)],d=a>>>10<i-1?e[v+1]:p,s>>>10<t-1&&(v+=i),m=e[v],b=a>>>10<i-1?e[v+1]:m,(g=0)===p&&(p=d,g+=k),0===d&&(d=p,g+=_),0===m&&(m=b,g+=y),0===b&&(b=m,g+=S),0===p&&(p=m,d=b),0===m&&(m=p,b=d),l=0,g<5e5&&(l=((v=k*(p>>>16&255)+_*(d>>>16&255)+y*(m>>>16&255)+S*(b>>>16&255))>>>20&255)<<16,l|=((v=k*(p>>>8&255)+_*(d>>>8&255)+y*(m>>>8&255)+S*(b>>>8&255))>>>20&255)<<8,0===(l|=(v=k*(255&p)+_*(255&d)+y*(255&m)+S*(255&b))>>>20&255)&&(l=1)),n[f*c+h]=l,a+=O;s+=w}return wxb.pop(6),0}function Rxb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O,w,I,F,P,A,x,C,V,M,R;if(g=wxb.stackValue(5),S=wxb.stackValue(4),V=wxb.stackIntegerValue(3),v=Axb(g),y=Axb(S),r=txb(g),F=wxb.stackIntegerValue(2),e=wxb.stackValue(1),i=wxb.stackValue(0),t=zxb(e),a=zxb(i),wxb.success(txb(S)===r),wxb.failed())return null;for(m=uxb(r,V),s=vxb(Math.random(),F)-1,P=0;P<=s/2-1;P++)for(M=vxb(Math.random(),V),R=vxb(Math.random(),m),w=vxb(Math.random(),8),p=-4;p<=4;p++)for(d=-4;d<=4;d++)(o=p*p+d*d)<25&&0<o&&(c=R+d|0,0<(u=M+p|0)&&0<c&&c<m&&u<V&&(t[c*V+u]=w*(1-o/25)));for(f=1;f<=V-2;f++)for(n=1;n<=m-2;n++)t[x=n*V+f]=(a[x+1]+a[x-1]+a[x+V]+a[x-V]+a[x-1-V]/2+a[x-1+V]/2+a[x+1-V]/2+a[x+1+V]/2)/4-t[x],t[x]=.9*t[x];for(I=0;I<=V*m;I++)A=a[I],a[I]=t[I],t[I]=A;for(k=0;k<=m-1;k++)for(b=0;b<=V-1;b++)O=1<b&&b<V-1&&1<k&&k<m-1?((l=64*(t[C=k*V+b]-t[C-1]+(t[C+1]-t[C])))<2&&(l=-2),2<l&&(l=2),(h=(t[C]-t[C-V]+(t[C+V]-t[C]))/64)<2&&(h=-2),2<h&&(h=2),(_=(k+h)*V+(b+l)|0)<V*m&&0<=_?v[_]:v[b+k*V]):v[b+k*V],y[b+k*V]=O;return wxb.pop(6),0}function Sxb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O,w;if(h=wxb.stackValue(3),p=wxb.stackValue(2),S=wxb.stackIntegerValue(1),s=wxb.stackIntegerValue(0),c=Axb(h),f=Axb(p),_=txb(h),wxb.success(txb(p)===_),wxb.failed())return null;for(g=(t=S>>1)<(r=(l=uxb(_,S))>>1)?(v=r/(m=t),1):(v=1,(m=r)<t?t/r:1),y=-3.141592653589793*s/180,b=m*m,O=0;O<=S-1;O++)for(w=0;w<=l-1;w++)(a=(n=v*(O-t))*n+(o=g*(w-r))*o)<b&&(e=(u=1-Math.sqrt(a)/m)*u*y,k=Math.sin(e),d=Exb(c,1024*(((i=Math.cos(e))*n-k*o)/v+t)|0,1024*((k*n+i*o)/g+r)|0,S,l),f[S*w+O]=d);return wxb.pop(4),0}function Txb(e){return!1!=((wxb=e).majorVersion()==rxb)&&wxb.minorVersion()>=sxb}function SocketPlugin(){return{getModuleName:function(){return"SocketPlugin (http-only)"},interpreterProxy:null,primHandler:null,handleCounter:0,needProxy:new Set,status:0,lookupCache:{localhost:{address:[127,0,0,1],validUntil:Number.MAX_SAFE_INTEGER}},lastLookup:null,lookupSemaIdx:0,TCP_Socket_Type:0,Resolver_Uninitialized:0,Resolver_Ready:1,Resolver_Busy:2,Resolver_Error:3,Socket_InvalidSocket:-1,Socket_Unconnected:0,Socket_WaitingForConnection:1,Socket_Connected:2,Socket_OtherEndClosed:3,Socket_ThisEndClosed:4,setInterpreter:function(e){return this.interpreterProxy=e,this.primHandler=this.interpreterProxy.vm.primHandler,!0},_signalSemaphore:function(e){e<=0||this.primHandler.signalSemaphoreWithIndex(e)},_signalLookupSemaphore:function(){this._signalSemaphore(this.lookupSemaIdx)},_getAddressFromLookupCache:function(e,t){if(e){if(e.match(/^\d+\.\d+\.\d+\.\d+$/)){var r=e.split(".").map(function(e){return+e});if(r.every(function(e){return e<=255}))return new Uint8Array(r)}var i=this.lookupCache[e];if(i&&(t||i.validUntil>=Date.now()))return new Uint8Array(i.address)}return null},_addAddressFromResponseToLookupCache:function(e){if(e&&0===e.Status&&e.Question&&e.Answer){var t=function(e,t){e[t]&&e[t].replace&&(e[t]=e[t].replace(/\.$/,""))},r=e.Question[0];t(r,"name"),e.Answer.forEach(function(e){t(e,"name"),t(e,"data")});var i=r.name,a=null,s=86400;e.Answer.some(function(e){if(e.name===i){if(e.TTL&&(s=Math.min(s,e.TTL)),1===e.type)return a=e.data.split(".").map(function(e){return+e}),!0;5===e.type&&(i=e.data)}return!1})&&(this.lookupCache[r.name]={address:a,validUntil:Date.now()+1e3*s})}},_compareAddresses:function(e,r){return e.every(function(e,t){return r[t]===e})},_reverseLookupNameForAddress:function(t){var r=this,i=null;return Object.keys(this.lookupCache).some(function(e){return!!r._compareAddresses(t,r.lookupCache[e].address)&&(i=e,!0)}),i||t.join(".")},_newSocketHandle:function(e,t,r,i){var c=this;return{hostAddress:null,host:null,port:null,connSemaIndex:t,readSemaIndex:r,writeSemaIndex:i,webSocket:null,sendBuffer:null,sendTimeout:null,response:null,responseReadUntil:0,responseReceived:!1,status:c.Socket_Unconnected,_signalConnSemaphore:function(){c._signalSemaphore(this.connSemaIndex)},_signalReadSemaphore:function(){c._signalSemaphore(this.readSemaIndex)},_signalWriteSemaphore:function(){c._signalSemaphore(this.writeSemaIndex)},_otherEndClosed:function(){this.status=c.Socket_OtherEndClosed,this.webSocket=null,this._signalConnSemaphore()},_hostAndPort:function(){return this.host+":"+this.port},_requestNeedsProxy:function(){return c.needProxy.has(this._hostAndPort())},_getURL:function(e,t){var r="";(t||this._requestNeedsProxy())&&(r="object"==typeof SqueakJS&&SqueakJS.options.proxy||"https://corsproxy.io/?");return 443!==this.port?r+="http://"+this._hostAndPort()+e:r+="https://"+this.host+e,r},_performRequest:function(){if(this.webSocket)this._performWebSocketSend();else{var e=new TextDecoder("utf-8").decode(this.sendBuffer),t=this.sendBuffer.findIndex(function(e,t,r){return"\r"===r[t]&&"\r"===r[t+2]&&"\n"===r[t+1]&&"\n"===r[t+3]});this.sendBuffer=0<=t?this.sendBuffer.subarray(t+4):null;var r=e.split("\r\n\r\n")[0].split("\n"),i=r[0].split(" "),a=i[0];if("GET"!==a&&"PUT"!==a&&"POST"!==a)return this._otherEndClosed(),-1;for(var s=i[1],n=!1,o=!1,u=null,l=1;l<r.length;l++){var c=r[l];if(c.match(/Content-Length:/i)){var h=parseInt(c.substr(16)),f=this.sendBuffer.byteLength;u=this.sendBuffer.subarray(f-h,f)}else if(c.match(/Host:/i)){var p=c.substr(6).trim();this.host!==p&&(console.warn("Host for "+this.hostAddress+" was "+this.host+" but from HTTP request now "+p),this.host=p)}c.match(/Connection: Upgrade/i)?n=!0:c.match(/Upgrade: WebSocket/i)&&(o=!0)}"GET"===a&&n&&o?this._performWebSocketRequest(s,a,u,r):self.fetch?this._performFetchAPIRequest(s,a,u,r):this._performXMLHTTPRequest(s,a,u,r)}},_performFetchAPIRequest:function(r,i,a,s){for(var n=this,e={},t=1;t<s.length;t++){var o=s[t].split(":");2===o.length&&(e[o[0]]=o[1].trim())}"object"==typeof SqueakJS&&SqueakJS.options.ajax&&(e["X-Requested-With"]="XMLHttpRequest");var u={method:i,headers:e,body:a,mode:"cors"};fetch(this._getURL(r),u).then(n._handleFetchAPIResponse.bind(n)).catch(function(e){var t=n._getURL(r,!0);console.warn("Retrying with CORS proxy: "+t),fetch(t,u).then(function(e){console.log("Success: "+t),n._handleFetchAPIResponse(e),c.needProxy.add(n._hostAndPort())}).catch(function(e){console.warn("Fetch API failed, retrying with XMLHttpRequest"),n._performXMLHTTPRequest(r,i,a,s)})})},_handleFetchAPIResponse:function(e){if(null===this.response){var i=["HTTP/1.0 ",e.status," ",e.statusText,"\r\n"];e.headers.forEach(function(e,t,r){i=i.concat([t,": ",e,"\r\n"])}),i.push("\r\n"),this.response=[new TextEncoder("utf-8").encode(i.join(""))]}this._readIncremental(e.body.getReader())},_readIncremental:function(t){var r=this;return t.read().then(function(e){if(!e.done)return r.response.push(e.value),r._signalReadSemaphore(),r._readIncremental(t);r.responseReceived=!0})},_performXMLHTTPRequest:function(i,a,s,e){for(var t,n=this,r=1;r<e.length;r++){var o=e[r];if(o.match(/Content-Type:/i)){t=encodeURIComponent(o.substr(14));break}}var u=new XMLHttpRequest;u.open(a,this._getURL(i)),void 0!==t&&u.setRequestHeader("Content-type",t),"object"==typeof SqueakJS&&SqueakJS.options.ajax&&u.setRequestHeader("X-Requested-With","XMLHttpRequest"),u.responseType="arraybuffer",u.onload=function(e){n._handleXMLHTTPResponse(this)},u.onerror=function(e){var t=n._getURL(i,!0);console.warn("Retrying with CORS proxy: "+t);var r=new XMLHttpRequest;r.open(a,t),r.responseType=u.responseType,"object"==typeof SqueakJS&&SqueakJS.options.ajaxx&&r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.onload=function(e){console.log("Success: "+t),n._handleXMLHTTPResponse(this),c.needProxy.add(n._hostAndPort())},r.onerror=function(){n._otherEndClosed(),console.error("Failed to download:\n"+t)},r.send(s)},u.send(s)},_handleXMLHTTPResponse:function(e){this.responseReceived=!0;var t=e.response;if(t){var r=new TextEncoder("utf-8").encode("HTTP/1.0 "+e.status+" "+e.statusText+"\r\n"+e.getAllResponseHeaders()+"\r\n"),i=new Uint8Array(r.byteLength+t.byteLength);i.set(r,0),i.set(new Uint8Array(t),r.byteLength),this.response=[i],this._signalReadSemaphore()}else this._otherEndClosed()},_performWebSocketRequest:function(e,t,r,i){for(var a,s,n=this._getURL(e),o=1;o<i.length;o++){var u=i[o].split(":");if("Sec-WebSocket-Protocol"===u[0]){if(a=u[1].trim(),s)break}else if("Sec-WebSocket-Key"===u[0]&&(s=u[1].trim(),a))break}this.webSocket=new WebSocket(n.replace(/^http/,"ws"),a);var l=this;this.webSocket.onopen=function(){l.status!==c.Socket_Connected&&(l.status=c.Socket_Connected,l._signalConnSemaphore(),l._signalWriteSemaphore());var e=new Uint8Array(sha1.array(s+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11")),t=Squeak.bytesAsString(e);l._performWebSocketReceive("HTTP/1.1 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Accept: "+btoa(t)+"\r\n\r\n",!0)},this.webSocket.onmessage=function(e){l._performWebSocketReceive(e.data)},this.webSocket.onerror=function(e){l._otherEndClosed(),console.error("Error in WebSocket:",e)},this.webSocket.onclose=function(){l._otherEndClosed()}},_performWebSocketReceive:function(e,t){var r=!e.substr;if(r||(e=new TextEncoder("utf-8").encode(e)),!t){var i,a=2+e.length+4;i=e.byteLength<126?e.length:e.byteLength<65535?(a+=2,126):(a+=8,127);var s,n=new Uint8Array(a);n[0]=r?130:129,n[1]=128|i,s=126===i?(n[2]=e.length>>>8,n[3]=255&e.length,4):127===i?(n[2]=e.length>>>56,n[3]=e.length>>>48&255,n[4]=e.length>>>40&255,n[5]=e.length>>>32&255,n[6]=e.length>>>24&255,n[7]=e.length>>>16&255,n[8]=e.length>>>8&255,n[9]=255&e.length,10):2;var o=new Uint8Array(4);n.set(o,s),s+=4;var u=e;n.set(u,s),e=n}this.response&&this.response.length?this.response.push(e):this.response=[e],this.responseReceived=!0,this._signalReadSemaphore()},_performWebSocketSend:function(){var e,t=15&this.sendBuffer[0];if(0==t)return console.error("No support for WebSocket frame continuation yet!"),!0;if(1==t)e=!1;else{if(2!=t)return 8==t?(this.webSocket.close(),void(this.webSocket=null)):9==t||10==t?void 0:void console.error("Unsupported WebSocket frame opcode "+t);e=!0}var r,i,a=this.sendBuffer[1],s=a>>>7,n=127&a;r=126===n?(n=this.sendBuffer[2]<<8|this.sendBuffer[3],4):127===n?(n=this.sendBuffer[2]<<56|this.sendBuffer[3]<<48|this.sendBuffer[4]<<40|this.sendBuffer[5]<<32|this.sendBuffer[6]<<24|this.sendBuffer[7]<<16|this.sendBuffer[8]<<8|this.sendBuffer[9],10):2,s&&(i=this.sendBuffer.subarray(r,r+4),r+=4);var o,u=this.sendBuffer.subarray(r,r+n);r+=n,s&&(u=u.map(function(e,t){return e^i[3&t]})),o=e?u:Squeak.bytesAsString(u),this.sendBuffer=this.sendBuffer.subarray(r),this.webSocket.send(o),0<this.sendBuffer.byteLength&&this._performWebSocketSend()},connect:function(e,t){this.hostAddress=e,this.host=c._reverseLookupNameForAddress(e),this.port=t,this.status=c.Socket_Connected,this._signalConnSemaphore(),this._signalWriteSemaphore()},close:function(){this.status!=c.Socket_Connected&&this.status!=c.Socket_OtherEndClosed&&this.status!=c.Socket_WaitingForConnection||(this.webSocket&&(this.webSocket.close(),this.webSocket=null),this.status=c.Socket_Unconnected,this._signalConnSemaphore())},destroy:function(){this.status=c.Socket_InvalidSocket},dataAvailable:function(){if(this.status==c.Socket_InvalidSocket)return!1;if(this.status==c.Socket_Connected){if(this.webSocket)return this.response&&0<this.response.length;if(this.response&&0<this.response.length)return this._signalReadSemaphore(),!0;this.responseSentCompletly&&(this.status=c.Socket_OtherEndClosed,this._signalConnSemaphore())}return!1},recv:function(e){if(null===this.response)return[];var t=this.response[0];if(t.length>e){var r=t.subarray(e);r?this.response[0]=r:this.response.shift(),t=t.subarray(0,e)}else this.response.shift();return this.responseReceived&&0===this.response.length&&!this.webSocket&&(this.responseSentCompletly=!0),t},send:function(e,t,r){null!==this.sendTimeout&&self.clearTimeout(this.sendTimeout),this.lastSend=Date.now();var i=e.bytes.subarray(t,r);if(null===this.sendBuffer)this.sendBuffer=i.slice();else{var a=this.sendBuffer.byteLength+i.byteLength,s=new Uint8Array(a);s.set(this.sendBuffer,0),s.set(i,this.sendBuffer.byteLength),this.sendBuffer=s}return this.sendTimeout=self.setTimeout(this._performRequest.bind(this),50),i.byteLength}}},primitiveHasSocketAccess:function(e){return this.interpreterProxy.popthenPush(e+1,this.interpreterProxy.trueObject()),!0},primitiveInitializeNetwork:function(e){return 1===e&&(this.lookupSemaIdx=this.interpreterProxy.stackIntegerValue(0),this.status=this.Resolver_Ready,this.interpreterProxy.pop(e),!0)},primitiveResolverNameLookupResult:function(e){if(0!==e)return!1;if(!this.lastLookup||!this.lastLookup.substr)return this.interpreterProxy.popthenPush(e+1,this.interpreterProxy.nilObject()),!0;var t=this._getAddressFromLookupCache(this.lastLookup,!0);return this.interpreterProxy.popthenPush(e+1,t?this.primHandler.makeStByteArray(t):this.interpreterProxy.nilObject()),!0},primitiveResolverStartNameLookup:function(e){if(1!==e)return!1;var t=this.lastLookup=this.interpreterProxy.stackValue(0).bytesAsString();if(this._getAddressFromLookupCache(t,!1))this.status=this.Resolver_Ready,this._signalLookupSemaphore();else{var r="https://9.9.9.9:5053/dns-query?name="+encodeURIComponent(this.lastLookup)+"&type=A",i=!1;if(self.fetch){var a=this;self.fetch(r,{method:"GET",mode:"cors",credentials:"omit",cache:"no-store",referrer:"no-referrer",referrerPolicy:"no-referrer"}).then(function(e){return e.json()}).then(function(e){a._addAddressFromResponseToLookupCache(e)}).catch(function(e){console.error("Name lookup failed",e)}).then(function(){t===a.lastLookup&&(a.status=a.Resolver_Ready,a._signalLookupSemaphore())}),i=!0}else{a=this;var s=function(){t===a.lastLookup&&(a.status=a.Resolver_Ready,a._signalLookupSemaphore())},n=new XMLHttpRequest;n.open("GET",r,!0),n.timeout=2e3,n.responseType="json",n.onload=function(e){a._addAddressFromResponseToLookupCache(this.response),s()},n.onerror=function(){console.error("Name lookup failed",n.statusText),s()},n.send(),i=!0}i&&(this.status=this.Resolver_Busy,this._signalLookupSemaphore())}return this.interpreterProxy.popthenPush(e+1,this.interpreterProxy.nilObject()),!0},primitiveResolverAddressLookupResult:function(e){if(0!==e)return!1;if(!this.lastLookup||!this.lastLookup.every)return this.interpreterProxy.popthenPush(e+1,this.interpreterProxy.nilObject()),!0;var t=this._reverseLookupNameForAddress(this.lastLookup),r=this.primHandler.makeStString(t);return this.interpreterProxy.popthenPush(e+1,r),!0},primitiveResolverStartAddressLookup:function(e){return 1===e&&(this.lastLookup=this.interpreterProxy.stackBytes(0),this.interpreterProxy.popthenPush(e+1,this.interpreterProxy.nilObject()),this.status=this.Resolver_Ready,this._signalLookupSemaphore(),!0)},primitiveResolverStatus:function(e){return 0===e&&(this.interpreterProxy.popthenPush(e+1,this.status),!0)},primitiveResolverAbortLookup:function(e){return 0===e&&(this.lastLookup=null,this.status=this.Resolver_Ready,this._signalLookupSemaphore(),this.interpreterProxy.popthenPush(e+1,this.interpreterProxy.nilObject()),!0)},primitiveSocketRemoteAddress:function(e){if(1!==e)return!1;var t=this.interpreterProxy.stackObjectValue(0).handle;return void 0!==t&&(this.interpreterProxy.popthenPush(e+1,t.hostAddress?this.primHandler.makeStByteArray(t.hostAddress):this.interpreterProxy.nilObject()),!0)},primitiveSocketRemotePort:function(e){if(1!==e)return!1;var t=this.interpreterProxy.stackObjectValue(0).handle;return void 0!==t&&(this.interpreterProxy.popthenPush(e+1,t.port),!0)},primitiveSocketConnectionStatus:function(e){if(1!==e)return!1;var t=this.interpreterProxy.stackObjectValue(0).handle;if(void 0===t)return!1;var r=t.status;return void 0===r&&(r=this.Socket_InvalidSocket),this.interpreterProxy.popthenPush(e+1,r),!0},primitiveSocketConnectToPort:function(e){if(3!==e)return!1;var t=this.interpreterProxy.stackObjectValue(2).handle;if(void 0===t)return!1;var r=this.interpreterProxy.stackBytes(1),i=this.interpreterProxy.stackIntegerValue(0);return t.connect(r,i),this.interpreterProxy.popthenPush(e+1,this.interpreterProxy.nilObject()),!0},primitiveSocketCloseConnection:function(e){if(1!==e)return!1;var t=this.interpreterProxy.stackObjectValue(0).handle;return void 0!==t&&(t.close(),this.interpreterProxy.popthenPush(e+1,this.interpreterProxy.nilObject()),!0)},primitiveSocketCreate3Semaphores:function(e){if(7!==e)return!1;var t=this.interpreterProxy.stackIntegerValue(0),r=this.interpreterProxy.stackIntegerValue(1),i=this.interpreterProxy.stackIntegerValue(2),a=this.interpreterProxy.stackIntegerValue(3);if(this.interpreterProxy.stackIntegerValue(5)!==this.TCP_Socket_Type)return!1;var s="{SqueakJS Socket #"+ ++this.handleCounter+"}",n=this.primHandler.makeStString(s);return n.handle=this._newSocketHandle(a,i,r,t),this.interpreterProxy.popthenPush(e+1,n),!0},primitiveSocketDestroy:function(e){if(1!==e)return!1;var t=this.interpreterProxy.stackObjectValue(0).handle;return void 0!==t&&(t.destroy(),this.interpreterProxy.popthenPush(e+1,t.status),!0)},primitiveSocketReceiveDataAvailable:function(e){if(1!==e)return!1;var t=this.interpreterProxy.stackObjectValue(0).handle;if(void 0===t)return!1;var r=this.interpreterProxy.falseObject();return t.dataAvailable()&&(r=this.interpreterProxy.trueObject()),this.interpreterProxy.popthenPush(e+1,r),!0},primitiveSocketReceiveDataBufCount:function(e){if(4!==e)return!1;var t=this.interpreterProxy.stackObjectValue(3).handle;if(void 0===t)return!1;var r=this.interpreterProxy.stackObjectValue(2),i=this.interpreterProxy.stackIntegerValue(1)-1,a=this.interpreterProxy.stackIntegerValue(0);if(i+a>r.bytes.length)return!1;var s=t.recv(a);return r.bytes.set(s,i),this.interpreterProxy.popthenPush(e+1,s.length),!0},primitiveSocketSendDataBufCount:function(e){if(4!==e)return!1;var t=this.interpreterProxy.stackObjectValue(3).handle;if(void 0===t)return!1;var r=this.interpreterProxy.stackObjectValue(2),i=this.interpreterProxy.stackIntegerValue(1)-1;if(i<0)return!1;var a=i+this.interpreterProxy.stackIntegerValue(0);if(a>r.length)return!1;var s=t.send(r,i,a);return this.interpreterProxy.popthenPush(e+1,s),!0},primitiveSocketSendDone:function(e){return 1===e&&(this.interpreterProxy.popthenPush(e+1,this.interpreterProxy.trueObject()),!0)},primitiveSocketListenWithOrWithoutBacklog:function(e){return!(e<2)&&(this.interpreterProxy.popthenPush(e+1,this.interpreterProxy.nilObject()),!0)}}}function registerSocketPlugin(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("SocketPlugin",SocketPlugin()):self.setTimeout(registerSocketPlugin,100)}function SpeechPlugin(){return{getModuleName:function(){return"SpeechPlugin"},interpreterProxy:null,primHandler:null,voiceInput:null,semaphoreIndex:null,shouldListen:!1,recognition:null,synth:self.speechSynthesis,setInterpreter:function(e){return this.interpreterProxy=e,this.primHandler=this.interpreterProxy.vm.primHandler,!0},primitiveSpeak:function(e){var t,r;if(1===e)t=this.interpreterProxy.stackValue(0).bytesAsString();else{if(2!==e)return!1;t=this.interpreterProxy.stackValue(1).bytesAsString();var i=this.interpreterProxy.stackValue(0).bytesAsString();r=this.synth.getVoices().filter(function(e){return e.name===i})}var a=new SpeechSynthesisUtterance(t);return r&&0<r.length&&(a.voice=r[0]),this.synth.speak(a),this.interpreterProxy.pop(e),!0},primitiveRegisterSemaphore:function(e){return 1===e&&(this.semaphoreIndex=this.interpreterProxy.stackIntegerValue(0),this.interpreterProxy.pop(e),!0)},primitiveUnregisterSemaphore:function(e){return 0===e&&!(this.semaphoreIndex=null)},primitiveGetLastRecognitionResult:function(e){if(0!==e)return!1;if(null===this.semaphoreIndex)return!1;if(null===this.voiceInput)return!1;var t=this.primHandler.makeStArray(this.voiceInput);return this.voiceInput=[],this.interpreterProxy.popthenPush(1,t),!0},primitiveStartListening:function(e){return 0===e&&(this.recognition=new webkitSpeechRecognition,this.recognition.lang="en-US",this.recognition.interimResults=!0,this.recognition.onresult=this._onRecognitionResult.bind(this),this.recognition.onerror=function(e){console.log(e)},this.recognition.onend=function(e){this.shouldListen&&this.recognition.start()}.bind(this),this.shouldListen=!0,this.recognition.start(),!0)},_onRecognitionResult:function(e){this.voiceInput=[];for(var t=e.resultIndex;t<e.results.length;t++){for(var r=e.results[t],i=[r.isFinal,[]],a=0;a<r.length;a++){var s=r[a].transcript;i[1].push([s,r[a].confidence])}0<i[1].length&&this.voiceInput.push(i)}null!==this.semaphoreIndex&&0<this.voiceInput.length&&this.primHandler.signalSemaphoreWithIndex(this.semaphoreIndex)},primitiveStopListening:function(e){return 0===e&&(this.voiceInput=[],this.recognition.stop(),!(this.shouldListen=!1))}}}function registerSpeechPlugin(){"object"==typeof Squeak&&Squeak.registerExternalModule?"webkitSpeechRecognition"in self?Squeak.registerExternalModule("SpeechPlugin",SpeechPlugin()):console.warn("SpeechPlugin: Web Speech API is not supported by this browser."):self.setTimeout(registerSpeechPlugin,100)}function SqueakSSL(){return{getModuleName:function(){return"SqueakSSL (fake)"},interpreterProxy:null,primHandler:null,handleCounter:0,SQSSL_OK:0,SQSSL_NEED_MORE_DATA:-1,SQSSL_INVALID_STATE:-2,SQSSL_BUFFER_TOO_SMALL:-3,SQSSL_INPUT_TOO_LARGE:-4,SQSSL_GENERIC_ERROR:-5,SQSSL_OUT_OF_MEMORY:-6,SQSSL_PROP_VERSION:0,SQSSL_PROP_LOGLEVEL:1,SQSSL_PROP_SSLSTATE:2,SQSSL_PROP_CERTSTATE:3,SQSSL_PROP_PEERNAME:0,SQSSL_PROP_CERTNAME:1,SQSSL_PROP_SERVERNAME:2,setInterpreter:function(e){return this.interpreterProxy=e,this.primHandler=this.interpreterProxy.vm.primHandler,!0},primitiveCreate:function(e){var t="{SqueakJS SSL #"+ ++this.handleCounter+"}",r=this.primHandler.makeStString(t);return r.handle=!0,this.interpreterProxy.popthenPush(e+1,r),!0},primitiveConnect:function(e){return 5===e&&(this.interpreterProxy.popthenPush(e+1,0),!0)},primitiveDestroy:function(e){return 1===e&&(this.interpreterProxy.popthenPush(e+1,1),!0)},primitiveGetIntProperty:function(e){return 2===e&&(void 0!==this.interpreterProxy.stackObjectValue(1).handle&&(t=this.interpreterProxy.stackIntegerValue(0)===this.SQSSL_PROP_CERTSTATE?this.SQSSL_OK:0,this.interpreterProxy.popthenPush(e+1,t),!0));var t},primitiveSetStringProperty:function(e){return 3===e&&(void 0!==this.interpreterProxy.stackObjectValue(2).handle&&(this.interpreterProxy.pop(e),!0))},primitiveGetStringProperty:function(e){return 2===e&&(void 0!==this.interpreterProxy.stackObjectValue(1).handle&&(t=this.interpreterProxy.stackIntegerValue(0)===this.SQSSL_PROP_PEERNAME?this.primHandler.makeStString("*"):this.interpreterProxy.nilObject(),this.interpreterProxy.popthenPush(e+1,t),!0));var t},primitiveEncrypt:function(e){if(5!==e)return!1;if(void 0===this.interpreterProxy.stackObjectValue(4).handle)return!1;var t=this.interpreterProxy.stackObjectValue(3),r=(this.interpreterProxy.stackIntegerValue(2),this.interpreterProxy.stackIntegerValue(1));return this.interpreterProxy.stackObjectValue(0).bytes=t.bytes,this.interpreterProxy.popthenPush(e+1,r),!0},primitiveDecrypt:function(e){if(5!==e)return!1;if(void 0===this.interpreterProxy.stackObjectValue(4).handle)return!1;var t=this.interpreterProxy.stackObjectValue(3),r=(this.interpreterProxy.stackIntegerValue(2),this.interpreterProxy.stackIntegerValue(1));return this.interpreterProxy.stackObjectValue(0).bytes=t.bytes,this.interpreterProxy.popthenPush(e+1,r),!0}}}function registerSqueakSSL(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("SqueakSSL",SqueakSSL()):self.setTimeout(registerSqueakSSL,100)}function nIb(e,t){return e-(r=e,i=t,(0|Math.floor(r/i))*t)|0;var r,i}function uIb(){return tIb}function vIb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g;if(e=sIb.stackValue(3),t=sIb.stackInt16Array(2),r=sIb.stackIntegerValue(1),i=sIb.stackIntegerValue(0),v=sIb.fetchInt32ArrayofObject(7,e),g=sIb.fetchInt32ArrayofObject(8,e),b=sIb.fetchIntegerofObject(9,e),p=sIb.fetchIntegerofObject(10,e),f=sIb.fetchIntegerofObject(11,e),d=sIb.fetchInt16ArrayofObject(12,e),m=sIb.fetchInt16ArrayofObject(13,e),sIb.failed())return null;for(l=r;l<=r+i-1;l++){for(a=s=0,h=1;h<=b;h++)(n=f-v[h-1])<1&&(n+=p),a+=(c=g[h-1])*d[n-1],s+=c*m[n-1];32767<(u=t[(o=2*l-1)-1]+(a>>15))&&(u=32767),u<-32767&&(u=-32767),t[o-1]=u,d[f-1]=u,32767<(u=t[++o-1]+(s>>15))&&(u=32767),u<-32767&&(u=-32767),t[o-1]=u,m[f-1]=u,f=nIb(f,p)+1}if(sIb.failed())return null;sIb.storeIntegerofObjectwithValue(11,e,f),sIb.pop(3)}function wIb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O;if(e=sIb.stackValue(5),t=sIb.stackIntegerValue(4),r=sIb.stackInt16Array(3),i=sIb.stackIntegerValue(2),a=sIb.stackIntegerValue(1),s=sIb.stackIntegerValue(0),k=sIb.fetchIntegerofObject(3,e),_=sIb.fetchIntegerofObject(4,e),y=sIb.fetchIntegerofObject(5,e),p=sIb.fetchIntegerofObject(7,e),O=sIb.fetchInt16ArrayofObject(8,e),S=sIb.fetchIntegerofObject(9,e),m=sIb.fetchIntegerofObject(10,e),b=sIb.fetchIntegerofObject(11,e),d=sIb.fetchIntegerofObject(14,e),v=sIb.fetchIntegerofObject(15,e),g=sIb.fetchIntegerofObject(16,e),sIb.failed())return null;for(n=0!==d&&0!==g,u=i+t-1,f=i;f<=u;f++)h=k*O[m>>15]>>15,n?(l=d*O[v>>15],(v=nIb(v+g,S))<0&&(v+=S),(m=nIb(m+b+l,S))<0&&(m+=S)):m=nIb(m+b,S),0<a&&(32767<(c=r[(o=2*f-1)-1]+(h*a>>15))&&(c=32767),c<-32767&&(c=-32767),r[o-1]=c),0<s&&(32767<(c=r[(o=2*f)-1]+(h*s>>15))&&(c=32767),c<-32767&&(c=-32767),r[o-1]=c),0!==_&&(k+=_,(0<_&&y<=k||_<0&&k<=y)&&(k=y,_=0));if(p-=t,sIb.failed())return null;sIb.storeIntegerofObjectwithValue(3,e,k),sIb.storeIntegerofObjectwithValue(4,e,_),sIb.storeIntegerofObjectwithValue(7,e,p),sIb.storeIntegerofObjectwithValue(10,e,m),sIb.storeIntegerofObjectwithValue(15,e,v),sIb.pop(5)}function xIb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O,w,I,F,P,A,x;if(e=sIb.stackValue(5),t=sIb.stackIntegerValue(4),r=sIb.stackInt16Array(3),i=sIb.stackIntegerValue(2),a=sIb.stackIntegerValue(1),s=sIb.stackIntegerValue(0),P=sIb.fetchIntegerofObject(3,e),A=sIb.fetchIntegerofObject(4,e),x=sIb.fetchIntegerofObject(5,e),g=sIb.fetchIntegerofObject(7,e),S=sIb.fetchIntegerofObject(8,e),_=sIb.fetchInt16ArrayofObject(10,e),O=sIb.fetchInt16ArrayofObject(11,e),k=sIb.fetchIntegerofObject(16,e),y=sIb.fetchIntegerofObject(17,e),F=sIb.fetchIntegerofObject(18,e),w=sIb.fetchIntegerofObject(19,e),I=sIb.fetchIntegerofObject(20,e),sIb.failed())return null;for(l=_!==O,n=a*P>>15,o=s*P>>15,u=2*i-1,c=i+t-1,v=i;v<=c;v++){if(y<(b=(w+=I)>>9)&&S<g&&(b=(w-=F)>>9),(p=b+1)>k){if(k<b)return g=0,sIb.failed()||(sIb.storeIntegerofObjectwithValue(3,e,P),sIb.storeIntegerofObjectwithValue(4,e,A),sIb.storeIntegerofObjectwithValue(7,e,g),sIb.storeIntegerofObjectwithValue(19,e,w),sIb.popthenPush(6,null)),null;p=0===F?b:1+(w-F>>9)}f=w&oIb,d=h=_[b-1]*(pIb-f)+_[p-1]*f>>9,l&&(d=O[b-1]*(pIb-f)+O[p-1]*f>>9),0<a&&(32767<(m=r[u-1]+(n*h>>15))&&(m=32767),m<-32767&&(m=-32767),r[u-1]=m),++u,0<s&&(32767<(m=r[u-1]+(o*d>>15))&&(m=32767),m<-32767&&(m=-32767),r[u-1]=m),++u,0!==A&&(P+=A,(0<A&&x<=P||A<0&&P<=x)&&(P=x,A=0),n=a*P>>15,o=s*P>>15)}if(g-=t,sIb.failed())return null;sIb.storeIntegerofObjectwithValue(3,e,P),sIb.storeIntegerofObjectwithValue(4,e,A),sIb.storeIntegerofObjectwithValue(7,e,g),sIb.storeIntegerofObjectwithValue(19,e,w),sIb.pop(5)}function yIb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y;if(e=sIb.stackValue(5),t=sIb.stackIntegerValue(4),r=sIb.stackInt16Array(3),i=sIb.stackIntegerValue(2),a=sIb.stackIntegerValue(1),s=sIb.stackIntegerValue(0),k=sIb.fetchIntegerofObject(3,e),_=sIb.fetchIntegerofObject(4,e),y=sIb.fetchIntegerofObject(5,e),d=sIb.fetchIntegerofObject(7,e),m=sIb.fetchInt16ArrayofObject(8,e),b=sIb.fetchIntegerofObject(9,e),v=sIb.fetchIntegerofObject(10,e),g=sIb.fetchIntegerofObject(11,e),sIb.failed())return null;for(u=i+t-1,f=h=b,p=i;p<=u;p++)g<=(h=f+v)&&(h=qIb+(h-g)),n=m[(f>>15)-1]+m[(h>>15)-1]>>1,c=(m[(f>>15)-1]=n)*k>>15,f=h,0<a&&(32767<(l=r[(o=2*p-1)-1]+(c*a>>15))&&(l=32767),l<-32767&&(l=-32767),r[o-1]=l),0<s&&(32767<(l=r[(o=2*p)-1]+(c*s>>15))&&(l=32767),l<-32767&&(l=-32767),r[o-1]=l),0!==_&&(k+=_,(0<_&&y<=k||_<0&&k<=y)&&(k=y,_=0));if(b=h,d-=t,sIb.failed())return null;sIb.storeIntegerofObjectwithValue(3,e,k),sIb.storeIntegerofObjectwithValue(4,e,_),sIb.storeIntegerofObjectwithValue(7,e,d),sIb.storeIntegerofObjectwithValue(9,e,b),sIb.pop(5)}function zIb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y;if(e=sIb.stackValue(5),t=sIb.stackIntegerValue(4),r=sIb.stackInt16Array(3),i=sIb.stackIntegerValue(2),a=sIb.stackIntegerValue(1),s=sIb.stackIntegerValue(0),k=sIb.fetchIntegerofObject(3,e),_=sIb.fetchIntegerofObject(4,e),y=sIb.fetchIntegerofObject(5,e),p=sIb.fetchIntegerofObject(7,e),m=sIb.fetchInt16ArrayofObject(8,e),b=sIb.fetchIntegerofObject(10,e),g=sIb.fetchIntegerofObject(11,e),d=sIb.fetchIntegerofObject(12,e),v=sIb.fetchIntegerofObject(13,e),sIb.failed())return null;for(o=i+t-1,u=i,f=d+(g>>>16);f<=b&&u<=o;)h=m[f-1]*k>>15,0<a&&(32767<(c=r[(n=2*u-1)-1]+(h*a>>15))&&(c=32767),c<-32767&&(c=-32767),r[n-1]=c),0<s&&(32767<(c=r[(n=2*u)-1]+(h*s>>15))&&(c=32767),c<-32767&&(c=-32767),r[n-1]=c),0!==_&&(k+=_,(0<_&&y<=k||_<0&&k<=y)&&(k=y,_=0)),rIb<=(g+=v)&&(d+=l=g>>>16,g-=l<<16),f=d+(g>>>16),++u;if(p-=t,sIb.failed())return null;sIb.storeIntegerofObjectwithValue(3,e,k),sIb.storeIntegerofObjectwithValue(4,e,_),sIb.storeIntegerofObjectwithValue(7,e,p),sIb.storeIntegerofObjectwithValue(11,e,g),sIb.storeIntegerofObjectwithValue(12,e,d),sIb.pop(5)}function AIb(e){return!1!=((sIb=e).majorVersion()==kIb)&&sIb.minorVersion()>=lIb}function UKb(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function VKb(e,t){return 0|Math.floor(e/t)}function ZKb(e){return XKb.success(XKb.isWords(e)),XKb.failed()?0:e.words}function $Kb(){return YKb}function _Kb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v;if(l=XKb.stackValue(4),i=XKb.stackValue(3),p=XKb.stackIntegerValue(2),n=XKb.stackIntegerValue(1),t=XKb.stackIntegerValue(0),u=ZKb(l),r=ZKb(i),XKb.success(UKb(l)===UKb(i)),XKb.success(UKb(l)===p*n),XKb.failed())return null;for(e=(2*t+1)*(2*t+1),b=0;b<=n-1;b++)for((h=b-t)<0&&(h=0),n<=(s=b+t)&&(s=n-1),d=0;d<=p-1;d++){for((c=d-t)<0&&(c=0),p<=(a=d+t)&&(a=p-1),f=0,v=h;v<=s;v++)for(o=v*p,m=c;m<=a;m++)f+=u[o+m];r[b*p+d]=VKb(f,e)}XKb.pop(5)}function aLb(){var e,t,r,i,a;if(r=XKb.stackValue(1),i=XKb.stackIntegerValue(0),t=ZKb(r),a=UKb(r),XKb.failed())return null;for(e=0;e<=a-1;e++)t[e]=t[e]*i>>>10;XKb.pop(2)}function bLb(){var e,t,r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k;if(d=XKb.stackValue(6),r=XKb.stackValue(5),m=XKb.stackIntegerValue(4),i=XKb.stackIntegerValue(3),n=XKb.stackIntegerValue(2),u=XKb.stackIntegerValue(1),h=XKb.stackIntegerValue(0),f=ZKb(d),e=ZKb(r),XKb.success(UKb(r)===m*i),XKb.success(UKb(r)===UKb(d)*n*n),XKb.failed())return null;for((l=0)<(4&u)&&(l+=65536),0<(2&u)&&(l+=256),0<(1&u)&&++l,p=-1,v=0;v<=VKb(i,n)-1;v++)for(b=0;b<=VKb(m,n)-1;b++)for(g=f[++p],255<(a=(k=h)<0?k<-31?0:g>>>0-k:31<k?0:g<<k)&&(a=255),o=a<=0?1:a*l,c=s=(v*m+b)*n;c<=s+(n-1)*m;c+=m)for(t=c;t<=c+n-1;t++)e[t]=o;XKb.pop(7)}function cLb(e){return!1!=((XKb=e).majorVersion()==SKb)&&XKb.minorVersion()>=TKb}function cMb(e){return"number"==typeof e?uMb.classSmallInteger():e.sqClass}function dMb(e){return e.pointers?e.pointers.length:e.words?e.words.length:e.bytes?e.bytes.length:0}function eMb(e){return e.bytes?e.bytes.length:e.words?4*e.words.length:0}function gMb(e,t){return e-(r=e,i=t,(0|Math.floor(r/i))*t)|0;var r,i}function hMb(e,t){return 31<t?0:e<<t}function cNb(e,t,r){var i;if(DMb[e+r]!==DMb[t+r])return 0;if(DMb[e+r-1]!==DMb[t+r-1])return 0;if(DMb[e]!==DMb[t])return 0;if(DMb[e+1]!==DMb[t+1])return 1;for(i=2;i<oMb&&DMb[e+i]===DMb[t+i];)++i;return i}function fNb(e){var t;for(t=cMb(e);!t.isNil&&7<=t.classInstSize();)t=t.superclass();return!t.isNil&&(xMb=t.classInstSize(),1)}function gNb(e){return VMb[SMb]=e,KMb[SMb]=0,TMb[e]++,++SMb===UMb||0==(4095&SMb)&&wNb()}function hNb(e,t){var r,i;return VMb[SMb]=e-pMb,KMb[SMb]=t,i=XMb[e-pMb],TMb[i]++,r=t<257?IMb[t-1]:IMb[256+(t-1>>>7)],JMb[r]++,++WMb,++SMb===UMb||0==(4095&SMb)&&wNb()}function iNb(e,t,r,i,a){var s,n,o,u,l,c,h;if(h=t<<16|r,oMb<=t)return h;if(!(0<(o=e-(c=NMb[yNb(e+pMb-1)]))&&o<lMb))return h;for(n=i,l=lMb<e?e-lMb:0,s=t;;){if(u=cNb(e,c,s),YMb<e+u&&(u=YMb-e),u===pMb&&lMb>>2<e-c&&(u=pMb-1),s<u){if(h=u<<16|c,oMb<=(s=u))return h;if(a<s)return h}if(!(0<--n))return h;if((c=OMb[c&qMb])<=l)return h}}function jNb(){return vMb}function kNb(e){var t;PMb=yNb(e+pMb-1),t=NMb[PMb],NMb[PMb]=e,OMb[e&qMb]=t}function nNb(e,t){if(!(0<=t&&hMb(1,e)>t))return uMb.primitiveFail();for(AMb|=hMb(t,BMb),BMb+=e;8<=BMb&&YMb<EMb;)DMb[YMb]=255&AMb,++YMb,AMb>>>=8,BMb-=8}function oNb(){var e,t,r,i,a;return 3!==uMb.methodArgumentCount()?uMb.primitiveFail():(t=uMb.stackIntegerValue(0),e=uMb.stackIntegerValue(1),r=uMb.stackIntegerValue(2),i=uMb.stackObjectValue(3),uMb.failed()?null:function(e){var t;if(uMb.isPointers(e)&&15<=dMb(e)&&(t=uMb.fetchPointerofObject(0,e),uMb.isBytes(t))){if(0===xMb){if(!fNb(e))return;if(dMb(e)<xMb+5)return void(xMb=0)}if(DMb=t.bytes,EMb=eMb(t),YMb=uMb.fetchIntegerofObject(1,e),ZMb=uMb.fetchIntegerofObject(2,e),t=uMb.fetchPointerofObject(xMb+0,e),uMb.isWords(t)&&dMb(t)===kMb&&(NMb=t.words,t=uMb.fetchPointerofObject(xMb+1,e),uMb.isWords(t)&&dMb(t)===rMb&&(OMb=t.words,PMb=uMb.fetchIntegerofObject(xMb+2,e),CMb=uMb.fetchIntegerofObject(xMb+3,e),t=uMb.fetchPointerofObject(xMb+5,e),uMb.isBytes(t)&&(UMb=dMb(t),VMb=t.bytes,t=uMb.fetchPointerofObject(xMb+6,e),uMb.isWords(t)&&dMb(t)>=UMb&&(KMb=t.words,t=uMb.fetchPointerofObject(xMb+7,e),uMb.isWords(t)&&dMb(t)===nMb&&(TMb=t.words,t=uMb.fetchPointerofObject(xMb+8,e),uMb.isWords(t)&&dMb(t)===mMb))))))return JMb=t.words,SMb=uMb.fetchIntegerofObject(xMb+9,e),WMb=uMb.fetchIntegerofObject(xMb+10,e),!uMb.failed()}}(i)?(a=function(e,t,r){var i,a,s,n,o,u,l,c,h;if(e<CMb)return!1;if(UMb<=SMb)return!0;for(a=!1,s=CMb;s<=e;){if(a||(l=iNb(s,pMb-1,s,t,r),kNb(s),o=65535&l,n=l>>>16),h=65535&(l=iNb(s+1,n,o,t,r)),(c=l>>>16)<=n&&pMb<=n){for(i=hNb(n,s-o),u=1;u<=n-1;u++)kNb(++s);a=!1,++s}else i=gNb(DMb[s]),++s<=e&&!i&&(kNb(s),a=!0,o=h,n=c);if(i)return CMb=s,!0}return CMb=s,!1}(r,e,t),uMb.failed()||(uMb.storeIntegerofObjectwithValue(xMb+2,i,PMb),uMb.storeIntegerofObjectwithValue(xMb+3,i,CMb),uMb.storeIntegerofObjectwithValue(xMb+9,i,SMb),uMb.storeIntegerofObjectwithValue(xMb+10,i,WMb)),void(uMb.failed()||(uMb.pop(4),uMb.pushBool(a)))):uMb.primitiveFail())}function pNb(){var e,t,r,i,a,s;if(2!==uMb.methodArgumentCount())return uMb.primitiveFail();if(e=uMb.stackIntegerValue(0),i=uMb.stackObjectValue(1),uMb.failed())return null;if(!uMb.isWords(i))return uMb.primitiveFail();for(s=dMb(i),a=i.wordsAsInt32Array(),r=0;r<=s-1;r++)t=a[r],a[r]=e<=t?t-e:0;uMb.pop(2)}function qNb(){var e,t;if(2!==uMb.methodArgumentCount())return uMb.primitiveFail();if(e=uMb.stackValue(0),!uMb.isWords(e))return uMb.primitiveFail();if(GMb=e.words,HMb=dMb(e),e=uMb.stackValue(1),!uMb.isWords(e))return uMb.primitiveFail();if(QMb=e.words,RMb=dMb(e),t=uMb.stackValue(2),!uMb.isPointers(t))return uMb.primitiveFail();if(0===wMb){if(!function(e){var t;for(t=cMb(e);!t.isNil&&13<=t.classInstSize();)t=t.superclass();return!t.isNil&&(wMb=t.classInstSize(),1)}(t))return uMb.primitiveFail();if(dMb(t)<wMb+8)return wMb=0,uMb.primitiveFail()}return dMb(t)<wMb+8?uMb.primitiveFail():(ZMb=uMb.fetchIntegerofObject(2,t),bNb=uMb.fetchIntegerofObject(wMb+0,t),AMb=uMb.fetchIntegerofObject(wMb+1,t),BMb=uMb.fetchIntegerofObject(wMb+2,t),aNb=uMb.fetchIntegerofObject(wMb+4,t),_Mb=uMb.fetchIntegerofObject(wMb+5,t),uMb.failed()?null:(--ZMb,--aNb,--_Mb,e=uMb.fetchPointerofObject(0,t),uMb.isBytes(e)?(DMb=e.bytes,EMb=eMb(e),e=uMb.fetchPointerofObject(wMb+3,t),uMb.isBytes(e)?($Mb=e.bytes,function(){var e,t,r,i,a,s,n,o,u,l,c;s=EMb-1;for(;ZMb<s&&aNb<=_Mb;)if(o=AMb,n=BMb,u=aNb,(c=zNb(QMb,RMb))<256)DMb[++ZMb]=c;else{if(256===c)return bNb&=tMb;if(a=65535&c,0<(r=(c>>>16)-1)&&(a+=BNb(r)),c=zNb(GMb,HMb),e=65535&c,0<(r=c>>>16)&&(e+=BNb(r)),s<=ZMb+a)return AMb=o,BMb=n,aNb=u;for(l=(t=ZMb)-e,i=1;i<=a;i++)DMb[t+i]=DMb[l+i];ZMb+=a}}(),void(uMb.failed()||(uMb.storeIntegerofObjectwithValue(2,t,ZMb+1),uMb.storeIntegerofObjectwithValue(wMb+0,t,bNb),uMb.storeIntegerofObjectwithValue(wMb+1,t,AMb),uMb.storeIntegerofObjectwithValue(wMb+2,t,BMb),uMb.storeIntegerofObjectwithValue(wMb+4,t,aNb+1),uMb.pop(2)))):uMb.primitiveFail()):uMb.primitiveFail()))}function rNb(){var e,t,r,i,a,s,n,o;if(4!==uMb.methodArgumentCount())return uMb.primitiveFail();if(r=uMb.stackObjectValue(0),o=uMb.stackIntegerValue(1),n=uMb.stackIntegerValue(2),e=uMb.positive32BitValueOf(uMb.stackValue(3)),uMb.failed())return 0;if(!(uMb.isBytes(r)&&n<=o&&0<n))return uMb.primitiveFail();if(!(o<=eMb(r)))return uMb.primitiveFail();for(t=r.bytes,--o,a=65535&e,s=e>>>16&65535,i=--n;i<=o;i++)a=gMb(a+t[i],65521),s=gMb(s+a,65521);e=(s<<16)+a,uMb.popthenPush(5,uMb.positive32BitIntegerFor(e))}function sNb(){var e,t,r,i,a,s;if(4!==uMb.methodArgumentCount())return uMb.primitiveFail();if(t=uMb.stackObjectValue(0),s=uMb.stackIntegerValue(1),a=uMb.stackIntegerValue(2),r=uMb.positive32BitValueOf(uMb.stackValue(3)),uMb.failed())return 0;if(!(uMb.isBytes(t)&&a<=s&&0<a))return uMb.primitiveFail();if(!(s<=eMb(t)))return uMb.primitiveFail();for(e=t.bytes,--s,i=--a;i<=s;i++)r=FMb[255&(r^e[i])]^r>>>8;uMb.popthenPush(5,uMb.positive32BitIntegerFor(r))}function tNb(){var e,t,r,i,a,s;return 4!==uMb.methodArgumentCount()?uMb.primitiveFail():(t=uMb.stackObjectValue(0),i=uMb.stackObjectValue(1),e=uMb.stackObjectValue(2),r=uMb.stackObjectValue(3),a=uMb.stackObjectValue(4),uMb.failed()?null:function(e){var t;if(0===xMb){if(!fNb(e))return;if(dMb(e)<xMb+3)return void(xMb=0)}return uMb.isPointers(e)&&dMb(e)>=xMb+3&&(t=uMb.fetchPointerofObject(0,e),uMb.isBytes(t)?(DMb=t.bytes,EMb=eMb(t),YMb=uMb.fetchIntegerofObject(1,e),ZMb=uMb.fetchIntegerofObject(2,e),AMb=uMb.fetchIntegerofObject(xMb+0,e),BMb=uMb.fetchIntegerofObject(xMb+1,e),!uMb.failed()):uMb.primitiveFail())}(a)&&uMb.isPointers(t)&&2<=dMb(t)&&uMb.isPointers(i)&&2<=dMb(i)&&uMb.isPointers(r)&&3<=dMb(r)&&uMb.isPointers(e)&&3<=dMb(e)?(s=function(e,t,r,i){var a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k;if(g=uMb.fetchPointerofObject(0,e),m=uMb.fetchIntegerofObject(1,e),d=uMb.fetchIntegerofObject(2,e),!(m<=d&&uMb.isBytes(g)&&d<=eMb(g)))return uMb.primitiveFail();if(f=g.bytes,g=uMb.fetchPointerofObject(0,t),!(uMb.isWords(g)&&d<=dMb(g)&&uMb.fetchIntegerofObject(1,t)===m&&uMb.fetchIntegerofObject(2,t)===d))return uMb.primitiveFail();if(n=g.words,g=uMb.fetchPointerofObject(0,r),!uMb.isWords(g))return uMb.primitiveFail();if(p=dMb(g),b=g.words,g=uMb.fetchPointerofObject(1,r),!uMb.isWords(g)||p!==dMb(g))return uMb.primitiveFail();if(v=g.words,g=uMb.fetchPointerofObject(0,i),!uMb.isWords(g))return uMb.primitiveFail();if(u=dMb(g),o=g.words,g=uMb.fetchPointerofObject(1,i),!uMb.isWords(g)||u!==dMb(g))return uMb.primitiveFail();l=g.words,nNb(0,0),k=0;for(;m<d&&YMb+4<EMb;)if(h=f[m],s=n[m],++m,0===s){if(++k,!(h<p))return uMb.primitiveFail();nNb(b[h],v[h])}else{if(k=k+h+pMb,!(h<256))return uMb.primitiveFail();if(!((a=XMb[h])<p))return uMb.primitiveFail();if(nNb(b[a],v[a]),0!==(c=MMb[a-257])&&(h-=zMb[a-257],nNb(c,h)),!(--s<32768))return uMb.primitiveFail();if(!((a=s<256?IMb[s]:IMb[256+(s>>>7)])<u))return uMb.primitiveFail();nNb(o[a],l[a]),0!==(c=LMb[a])&&(s-=yMb[a],nNb(c,s))}if(uMb.failed())return null;return uMb.storeIntegerofObjectwithValue(1,e,m),uMb.storeIntegerofObjectwithValue(1,t,m),k}(r,e,i,t),uMb.failed()||(uMb.storeIntegerofObjectwithValue(1,a,YMb),uMb.storeIntegerofObjectwithValue(xMb+0,a,AMb),uMb.storeIntegerofObjectwithValue(xMb+1,a,BMb)),void(uMb.failed()||(uMb.pop(5),uMb.pushInteger(s)))):uMb.primitiveFail())}function vNb(e){return!1!=((uMb=e).majorVersion()==aMb)&&uMb.minorVersion()>=bMb}function wNb(){var e;return SMb===UMb||0==(4095&SMb)&&(!(10*WMb<=SMb)&&(!((e=SMb-WMb)<=WMb)&&4*e<=WMb))}function yNb(e){return t=DMb[e],(PMb<<5^t)&jMb;var t}function zNb(e,t){var r,i,a,s;if(r=e[0]>>>24,sMb<r)return uMb.primitiveFail(),0;for(a=2;;){if(t<=(i=a+BNb(r)-1))return uMb.primitiveFail(),0;if(0==(1056964608&(s=e[i])))return s;if(a=65535&s,sMb<(r=s>>>24&255))return uMb.primitiveFail(),0}return 0}function BNb(e){for(var t,r,i,a;BMb<e;)r=$Mb[++aNb],AMb+=hMb(r,BMb),BMb+=8;return t=AMb&hMb(1,e)-1,i=AMb,AMb=31<(a=e)?0:i>>>a,BMb-=e,t}Object.extend||(Object.extend=function(e){for(var t=1;t<arguments.length;t++)if("object"==typeof arguments[t])for(var r in arguments[t])e[r]=arguments[t][r]}),Function.prototype.subclass||(Function.prototype.subclass=function(e){function t(){if(this.initialize){var e=this.initialize.apply(this,arguments);if(void 0!==e)return e}return this}function r(){}r.prototype=this.prototype,t.prototype=new r;for(var i=1;i<arguments.length;i++)Object.extend(t.prototype,arguments[i]);var a=e.split("."),s=a.pop();return a.reduce(function(e,t){return e[t]||(e[t]={}),e[t]},self)[s]=t}),Object.extend(Squeak,"version",{vmVersion:"SqueakJS 1.1.2",vmDate:"2023-12-15",vmBuild:"unknown",vmPath:"unknown",vmFile:"vm.js",vmMakerVersion:"[VMMakerJS-bf.17 VMMaker-bf.353]",vmInterpreterVersion:"JSInterpreter VMMaker.js-codefrau.1",platformName:"JS",platformSubtype:"unknown",osVersion:"unknown",windowSystem:"unknown"},"object header",{HeaderTypeMask:3,HeaderTypeSizeAndClass:0,HeaderTypeClass:1,HeaderTypeFree:2,HeaderTypeShort:3},"special objects",{splOb_NilObject:0,splOb_FalseObject:1,splOb_TrueObject:2,splOb_SchedulerAssociation:3,splOb_ClassBitmap:4,splOb_ClassInteger:5,splOb_ClassString:6,splOb_ClassArray:7,splOb_SmalltalkDictionary:8,splOb_ClassFloat:9,splOb_ClassMethodContext:10,splOb_ClassBlockContext:11,splOb_ClassPoint:12,splOb_ClassLargePositiveInteger:13,splOb_TheDisplay:14,splOb_ClassMessage:15,splOb_ClassCompiledMethod:16,splOb_TheLowSpaceSemaphore:17,splOb_ClassSemaphore:18,splOb_ClassCharacter:19,splOb_SelectorDoesNotUnderstand:20,splOb_SelectorCannotReturn:21,splOb_ProcessSignalingLowSpace:22,splOb_SpecialSelectors:23,splOb_CharacterTable:24,splOb_SelectorMustBeBoolean:25,splOb_ClassByteArray:26,splOb_ClassProcess:27,splOb_CompactClasses:28,splOb_TheTimerSemaphore:29,splOb_TheInterruptSemaphore:30,splOb_FloatProto:31,splOb_SelectorCannotInterpret:34,splOb_MethodContextProto:35,splOb_ClassBlockClosure:36,splOb_ClassFullBlockClosure:37,splOb_ExternalObjectsArray:38,splOb_ClassPseudoContext:39,splOb_ClassTranslatedMethod:40,splOb_TheFinalizationSemaphore:41,splOb_ClassLargeNegativeInteger:42,splOb_ClassExternalAddress:43,splOb_ClassExternalStructure:44,splOb_ClassExternalData:45,splOb_ClassExternalFunction:46,splOb_ClassExternalLibrary:47,splOb_SelectorAboutToReturn:48,splOb_SelectorRunWithIn:49,splOb_SelectorAttemptToAssign:50,splOb_PrimErrTableIndex:51,splOb_ClassAlien:52,splOb_InvokeCallbackSelector:53,splOb_ClassUnsafeAlien:54,splOb_ClassWeakFinalizer:55},"known classes",{AdditionalMethodState_selector:1,Class_superclass:0,Class_mdict:1,Class_format:2,Class_instVars:null,Class_name:6,ClassBinding_value:1,Context_sender:0,Context_instructionPointer:1,Context_stackPointer:2,Context_method:3,Context_closure:4,Context_receiver:5,Context_tempFrameStart:6,Context_smallFrameSize:16,Context_largeFrameSize:56,BlockContext_caller:0,BlockContext_argumentCount:3,BlockContext_initialIP:4,BlockContext_home:5,Closure_outerContext:0,Closure_startpc:1,Closure_numArgs:2,Closure_firstCopiedValue:3,ClosureFull_method:1,ClosureFull_receiver:3,ClosureFull_firstCopiedValue:4,Stream_array:0,Stream_position:1,Stream_limit:2,ProcSched_processLists:0,ProcSched_activeProcess:1,Link_nextLink:0,LinkedList_firstLink:0,LinkedList_lastLink:1,Semaphore_excessSignals:2,Mutex_owner:2,Proc_suspendedContext:1,Proc_priority:2,Proc_myList:3,Assn_key:0,Assn_value:1,MethodDict_array:1,MethodDict_selectorStart:2,Message_selector:0,Message_arguments:1,Message_lookupClass:2,Point_x:0,Point_y:1,LargeInteger_bytes:0,LargeInteger_neg:1,WeakFinalizationList_first:0,WeakFinalizerItem_list:0,WeakFinalizerItem_next:1},"constants",{MinSmallInt:-1073741824,MaxSmallInt:1073741823,NonSmallInt:-1342177280,MillisecondClockMask:536870911},"error codes",{PrimNoErr:0,PrimErrGenericFailure:1,PrimErrBadReceiver:2,PrimErrBadArgument:3,PrimErrBadIndex:4,PrimErrBadNumArgs:5,PrimErrInappropriate:6,PrimErrUnsupported:7,PrimErrNoModification:8,PrimErrNoMemory:9,PrimErrNoCMemory:10,PrimErrNotFound:11,PrimErrBadMethod:12,PrimErrNamedInternal:13,PrimErrObjectMayMove:14,PrimErrLimitExceeded:15,PrimErrObjectIsPinned:16,PrimErrWritePastObject:17},"modules",{externalModules:Squeak.externalModules||{},registerExternalModule:function(e,t){this.externalModules[e]=t}},"time",{Epoch:Date.UTC(1901,0,1)+6e4*(new Date).getTimezoneOffset(),EpochUTC:Date.UTC(1901,0,1),totalSeconds:function(){return Math.floor((Date.now()-Squeak.Epoch)/1e3)}},"utils",{bytesAsString:function(e){for(var t=[],r=0;r<e.length;)t.push(String.fromCharCode.apply(null,e.subarray(r,r+=16348)));return t.join("")},word64FromUint32:function(e,t){return e<2097152?4294967296*e+t:4292870144<e?4294967296*(e>>0)+t:[e,t]}}),Object.subclass("Squeak.Object","initialization",{initInstanceOf:function(e,t,r,i){this.sqClass=e,this.hash=r;var a=e.pointers[Squeak.Class_format],s=(a>>1&63)+(a>>10&192)-1;this._format=a>>7&15,this._format<8?6!=this._format?0<s+t&&(this.pointers=this.fillArray(s+t,i)):0<t&&(e.isFloatClass?(this.isFloat=!0,this.float=0):this.words=new Uint32Array(t)):0<t&&(this.bytes=new Uint8Array(t))},initAsClone:function(e,t){this.sqClass=e.sqClass,this.hash=t,this._format=e._format,e.isFloat?(this.isFloat=e.isFloat,this.float=e.float):(e.pointers&&(this.pointers=e.pointers.slice(0)),e.words&&(this.words=new Uint32Array(e.words)),e.bytes&&(this.bytes=new Uint8Array(e.bytes)))},initFromImage:function(e,t,r,i){this.oop=e,this.sqClass=t,this._format=r,this.hash=i},classNameFromImage:function(e,t){var r=e[t[this.oop][Squeak.Class_name]];if(r&&8<=r._format&&r._format<12){var i=t[r.oop],a=r.decodeBytes(i.length,i,0,3&r._format);return Squeak.bytesAsString(a)}return"Class"},renameFromImage:function(e,t,r){var i=this.sqClass<32?e[r[this.sqClass-1]]:e[this.sqClass];if(!i)return this;var a=i.instProto||i.classInstProto(i.classNameFromImage(e,t));if(!a)return this;var s=new a;return s.oop=this.oop,s.sqClass=this.sqClass,s._format=this._format,s.hash=this.hash,s},installFromImage:function(e,t,r,i,a,s){var n=this.sqClass;this.sqClass=0<n&&n<32?e[r[n-1]]:e[n];var o=t[this.oop],u=o.length;if(this._format<5){if(0<u){var l=o;this.pointers=this.decodePointers(u,l,e)}}else if(12<=this._format){var c=this.decodeWords(1,o,a)[0]>>10&255;l=this.decodeWords(1+c,o,a);this.pointers=this.decodePointers(1+c,l,e),this.bytes=this.decodeBytes(u-(1+c),o,1+c,3&this._format)}else 8<=this._format?0<u&&(this.bytes=this.decodeBytes(u,o,0,3&this._format)):this.sqClass==i?(this.isFloat=!0,this.float=this.decodeFloat(o,a,s)):0<u&&(this.words=this.decodeWords(u,o,a));this.mark=!1},decodePointers:function(e,t,r){for(var i=new Array(e),a=0;a<e;a++){var s=t[a];i[a]=1==(1&s)?s>>1:r[s]||42424242}return i},decodeWords:function(e,t,r){for(var i=new DataView(t.buffer,t.byteOffset),a=new Uint32Array(e),s=0;s<e;s++)a[s]=i.getUint32(4*s,r);return a},decodeBytes:function(e,t,r,i){var a=4*e-i,s=new Uint8Array(t.buffer,t.byteOffset+4*r,a),n=new Uint8Array(a);return n.set(s),n},decodeFloat:function(e,t,r){var i=new DataView(e.buffer,e.byteOffset);if(!t)return i.getFloat64(0,!1);if(r)return i.getFloat64(0,!0);var a=new ArrayBuffer(8),s=new DataView(a);return s.setUint32(0,i.getUint32(4)),s.setUint32(4,i.getUint32(0)),s.getFloat64(0,!0)},fillArray:function(e,t){for(var r=[],i=0;i<e;i++)r[i]=t;return r}},"testing",{isWords:function(){return 6===this._format},isBytes:function(){var e=this._format;return 8<=e&&e<=11},isWordsOrBytes:function(){var e=this._format;return 6==e||8<=e&&e<=11},isPointers:function(){return this._format<=4},isWeak:function(){return 4===this._format},isMethod:function(){return 12<=this._format},sameFormats:function(e,t){return e<8?e===t:(12&e)==(12&t)},sameFormatAs:function(e){return this.sameFormats(this._format,e._format)}},"printing",{toString:function(){return this.sqInstName()},bytesAsString:function(){return this.bytes?Squeak.bytesAsString(this.bytes):""},bytesAsNumberString:function(e){if(!this.bytes)return"";for(var t="0123456789ABCDEF",r=[],i=0,a=this.bytes.length-1;0<=a;a--)r.push(t[this.bytes[a]>>4]),r.push(t[15&this.bytes[a]]),i=256*i+this.bytes[a];var s=e?"-":"",n=9007199254740991<i?"":"";return s+"16r"+r.join("")+" ("+n+s+i+"L)"},assnKeyAsString:function(){return this.pointers[Squeak.Assn_key].bytesAsString()},slotNameAt:function(e){var t=this.instSize();return e<=t?this.sqClass.allInstVarNames()[e-1]||"ivar"+(e-1):(e-t).toString()},sqInstName:function(){if(this.isNil)return"nil";if(this.isTrue)return"true";if(this.isFalse)return"false";if(this.isFloat){var e=this.float.toString();return/\./.test(e)||(e+=".0"),e}var t=this.sqClass.className();if(/ /.test(t))return"the "+t;switch(t){case"String":case"ByteString":return"'"+this.bytesAsString()+"'";case"Symbol":case"ByteSymbol":return"#"+this.bytesAsString();case"Point":return this.pointers.join("@");case"Rectangle":return this.pointers.join(" corner: ");case"Association":case"ReadOnlyVariableBinding":return this.pointers.join("->");case"LargePositiveInteger":return this.bytesAsNumberString(!1);case"LargeNegativeInteger":return this.bytesAsNumberString(!0);case"Character":var r=this.pointers?this.pointers[0]:this.hash;return"$"+String.fromCharCode(r)+" ("+r.toString()+")";case"CompiledMethod":return this.methodAsString();case"CompiledBlock":return"[] in "+this.blockOuterCode().sqInstName()}return/^[aeiou]/i.test(t)?"an"+t:"a"+t}},"accessing",{pointersSize:function(){return this.pointers?this.pointers.length:0},bytesSize:function(){return this.bytes?this.bytes.length:0},wordsSize:function(){return this.isFloat?2:this.words?this.words.length:0},instSize:function(){var e=this._format;return 4<e||2===e?0:e<2?this.pointersSize():this.sqClass.classInstSize()},indexableSize:function(e){var t=this._format;return t<2?-1:3===t&&e.vm.isContext(this)&&!e.allowAccessBeyondSP?this.pointers[Squeak.Context_stackPointer]:t<6?this.pointersSize()-this.instSize():t<8?this.wordsSize():t<12?this.bytesSize():this.bytesSize()+4*this.pointersSize()},floatData:function(){var e=new ArrayBuffer(8),t=new DataView(e);return t.setFloat64(0,this.float,!1),t},wordsAsFloat32Array:function(){return this.float32Array||this.words&&(this.float32Array=new Float32Array(this.words.buffer))},wordsAsFloat64Array:function(){return this.float64Array||this.words&&(this.float64Array=new Float64Array(this.words.buffer))},wordsAsInt32Array:function(){return this.int32Array||this.words&&(this.int32Array=new Int32Array(this.words.buffer))},wordsAsInt16Array:function(){return this.int16Array||this.words&&(this.int16Array=new Int16Array(this.words.buffer))},wordsAsUint16Array:function(){return this.uint16Array||this.words&&(this.uint16Array=new Uint16Array(this.words.buffer))},wordsAsUint8Array:function(){return this.uint8Array||this.words&&(this.uint8Array=new Uint8Array(this.words.buffer))},wordsOrBytes:function(){return this.words?this.words:this.uint32Array?this.uint32Array:this.bytes?this.uint32Array=new Uint32Array(this.bytes.buffer,0,this.bytes.length>>>2):null},setAddr:function(e){var t=this.snapshotSize();return this.oop=e+4*t.header,e+4*(t.header+t.body)},snapshotSize:function(){var e=this.isFloat?2:this.words?this.words.length:this.pointers?this.pointers.length:0;return this.bytes&&(e+=this.bytes.length+3>>>2),{header:63<++e?2:this.sqClass.isCompact?0:1,body:e}},addr:function(){return this.oop-4*this.snapshotSize().header},totalBytes:function(){var e=this.snapshotSize();return 4*(e.header+e.body)},writeTo:function(e,t,r){this.bytes&&(this._format|=3&-this.bytes.length);var i=t,a=this.snapshotSize(),s=(15&this._format)<<8|(4095&this.hash)<<17;switch(a.header){case 2:e.setUint32(t,a.body<<2|Squeak.HeaderTypeSizeAndClass),t+=4,e.setUint32(t,this.sqClass.oop|Squeak.HeaderTypeSizeAndClass),t+=4,e.setUint32(t,s|Squeak.HeaderTypeSizeAndClass),t+=4;break;case 1:e.setUint32(t,this.sqClass.oop|Squeak.HeaderTypeClass),t+=4,e.setUint32(t,s|a.body<<2|Squeak.HeaderTypeClass),t+=4;break;case 0:var n=r.compactClasses.indexOf(this.sqClass)+1;e.setUint32(t,s|n<<12|a.body<<2|Squeak.HeaderTypeShort),t+=4}if(this.isFloat)e.setFloat64(t,this.float),t+=8;else if(this.words)for(var o=0;o<this.words.length;o++)e.setUint32(t,this.words[o]),t+=4;else if(this.pointers)for(o=0;o<this.pointers.length;o++)e.setUint32(t,r.objectToOop(this.pointers[o])),t+=4;if(this.bytes){for(o=0;o<this.bytes.length;o++)e.setUint8(t++,this.bytes[o]);t+=3&-this.bytes.length}if(t!==i+this.totalBytes())throw Error("written size does not match");return t}},"as class",{classInstFormat:function(){return this.pointers[Squeak.Class_format]>>7&15},classInstSize:function(){var e=this.pointers[Squeak.Class_format];return(e>>10&192)+(e>>1&63)-1},classInstIsBytes:function(){var e=this.classInstFormat();return 8<=e&&e<=11},classInstIsPointers:function(){return this.classInstFormat()<=4},instVarNames:function(){for(var e=3;e<=4;e++){var t=this.pointers[e].pointers;if(t&&t.length&&t[0].bytes)return t.map(function(e){return e.bytesAsString()})}return[]},allInstVarNames:function(){var e=this.superclass();return e.isNil?this.instVarNames():e.allInstVarNames().concat(this.instVarNames())},superclass:function(){return this.pointers[0]},className:function(){if(!this.pointers)return"_NOTACLASS_";for(var e=6;e<=7;e++){if((i=this.pointers[e])&&i.bytes)return i.bytesAsString()}for(var t=5;t<=6;t++){var r=this.pointers[t];if(r&&r.pointers)for(e=6;e<=7;e++){var i;if((i=r.pointers[e])&&i.bytes)return i.bytesAsString()+" class"}}return"_SOMECLASS_"},defaultInst:function(){return Squeak.Object},classInstProto:function(e){if(this.instProto)return this.instProto;var t=this.defaultInst();try{var r=(e=e||this.className()).replace(/[^A-Za-z0-9]/g,"_");r="UndefinedObject"===r?"nil":"True"===r?"true_":"False"===r?"false_":(/^[AEIOU]/.test(r)?"an":"a")+r,(t=new Function("return function "+r+"() {};")()).prototype=this.defaultInst().prototype}catch(e){}return Object.defineProperty(this,"instProto",{value:t}),t}},"as method",{methodSignFlag:function(){return!1},methodNumLits:function(){return this.pointers[0]>>9&255},methodNumArgs:function(){return this.pointers[0]>>24&15},methodPrimitiveIndex:function(){var e=805306879&this.pointers[0];return 511<e?(511&e)+(e>>19):e},methodClassForSuper:function(){return this.pointers[this.methodNumLits()].pointers[Squeak.Assn_value]},methodNeedsLargeFrame:function(){return 0<(131072&this.pointers[0])},methodAddPointers:function(e){this.pointers=e},methodTempCount:function(){return this.pointers[0]>>18&63},methodGetLiteral:function(e){return this.pointers[1+e]},methodGetSelector:function(e){return this.pointers[1+e]},methodAsString:function(){return"aCompiledMethod"}},"as context",{contextHome:function(){return this.contextIsBlock()?this.pointers[Squeak.BlockContext_home]:this},contextIsBlock:function(){return"number"==typeof this.pointers[Squeak.BlockContext_argumentCount]},contextMethod:function(){return this.contextHome().pointers[Squeak.Context_method]},contextSender:function(){return this.pointers[Squeak.Context_sender]},contextSizeWithStack:function(e){if(e&&e.activeContext===this)return e.sp+1;var t=this.pointers[Squeak.Context_stackPointer];return Squeak.Context_tempFrameStart+("number"==typeof t?t:0)}}),Squeak.Object.subclass("Squeak.ObjectSpur","initialization",{initInstanceOf:function(e,t,r,i){this.sqClass=e,this.hash=r;var a=e.pointers[Squeak.Class_format],s=65535&a,n=a>>16&31;(this._format=n)<12?n<10?0<s+t&&(this.pointers=this.fillArray(s+t,i)):0<t&&(e.isFloatClass?(this.isFloat=!0,this.float=0):this.words=new Uint32Array(t)):0<t&&(this.bytes=new Uint8Array(t))},installFromImage:function(e,t,r,i,a,s,n){var o=this.sqClass;if(o<32)throw Error("Invalid class ID: "+o);if(this.sqClass=r[o],!this.sqClass)throw Error("Class ID not in class table: "+o);var u=t[this.oop],l=u.length;switch(this._format){case 0:case 1:case 2:case 3:case 4:case 5:if(0<l){var c=u;this.pointers=this.decodePointers(l,c,e,s,n)}break;case 11:l--,this._format=10;case 10:this.sqClass===i?(this.isFloat=!0,this.float=this.decodeFloat(u,a,!0)):0<l&&(this.words=this.decodeWords(l,u,a));break;case 12:case 13:throw Error("16 bit arrays not supported yet");case 20:case 21:case 22:case 23:l--,this._format-=4;case 16:case 17:case 18:case 19:0<l&&(this.bytes=this.decodeBytes(l,u,0,3&this._format));break;case 28:case 29:case 30:case 31:l--,this._format-=4;case 24:case 25:case 26:case 27:var h=this.decodeWords(1,u,a)[0]>>(n?3:1),f=32767&h,p=(c=n?this.decodeWords64(1+f,u,a):this.decodeWords(1+f,u,a),n?2*(1+f):1+f);this.pointers=this.decodePointers(1+f,c,e,s,n),this.bytes=this.decodeBytes(l-p,u,p,3&this._format),n&&(this.pointers[0]=2147483648&u[1]|h);break;default:throw Error("Unknown object format: "+this._format)}this.mark=!1},decodeWords64:function(e,t,r){for(var i=new Array(e),a=0;a<e;a++){var s=t[2*a],n=t[2*a+1];i[a]=Squeak.word64FromUint32(n,s)}return i},decodePointers:function(e,t,r,i,a){for(var s=new Array(e),n=0;n<e;n++){var o=t[n];if("number"!=typeof o)if(4==(7&o[1]))s[n]=this.decodeSmallFloat(o[0],o[1],a);else{if(1!=(7&o[1]))throw 2==(7&o[1])?Error("Large Immediate Characters not implemented yet"):Error("Large OOPs not implemented yet");s[n]=a.makeLargeFromSmall(o[0],o[1])}else if(1==(1&o))s[n]=a?(0<=o?o<=8589934591:-8589934592<=o)?o/4>>1:a.makeLargeFromSmall((o-(o>>>0))/4294967296>>>0,o>>>0):o>>1;else if(2==(3&o)){if(o<0||8589934591<o)throw Error("Large Immediate Characters not implemented yet");s[n]=i(o>>>(a?3:2))}else a&&4==(7&o)?s[n]=this.decodeSmallFloat((o-(o>>>0))/4294967296>>>0,o>>>0,a):(s[n]=r[o]||42424242,s[n])}return s},decodeSmallFloat:function(e,t,r){var i=0,a=0,s=(8&t)<<28;return 0==(e|4294967280&t)?i=s:(i=939524096+(e>>>4)|s,a=t>>>4|(15&e)<<28),r.makeFloat(new Uint32Array([a,i]))},overhead64:function(e){var t=0,r=0,i=0;if(this._format<=5)t=-2&e.length;else if(24<=this._format){var a=1==(1&(t=1+(e[0]>>3&32767))),s=28<=this._format;a&&(t+=s?1:-1),i=e.length/2,r=e.length-t}else i=(r=e.length)/2;return{bytes:4*t,sizeHeader:255<=r&&i<255}},initInstanceOfChar:function(e,t){this.oop=t<<2|2,this.sqClass=e,this.hash=t,this._format=7,this.mark=!0},initInstanceOfFloat:function(e,t){this.sqClass=e,this.hash=0,this._format=10,this.isFloat=!0,this.float=this.decodeFloat(t,!0,!0)},initInstanceOfLargeInt:function(e,t){this.sqClass=e,this.hash=0,this._format=16,this.bytes=new Uint8Array(t)},classNameFromImage:function(e,t){var r=e[t[this.oop][Squeak.Class_name]];if(r&&16<=r._format&&r._format<24){var i=t[r.oop],a=r.decodeBytes(i.length,i,0,7&r._format);return Squeak.bytesAsString(a)}return"Class"},renameFromImage:function(e,t,r){var i=r[this.sqClass];if(!i)return this;var a=i.instProto||i.classInstProto(i.classNameFromImage(e,t));if(!a)return this;var s=new a;return s.oop=this.oop,s.sqClass=this.sqClass,s._format=this._format,s.hash=this.hash,s}},"accessing",{instSize:function(){return this._format<2?this.pointersSize():this.sqClass.classInstSize()},indexableSize:function(e){var t=this._format;return t<2?-1:3===t&&e.vm.isContext(this)?this.pointers[Squeak.Context_stackPointer]:t<6?this.pointersSize()-this.instSize():t<12?this.wordsSize():t<16?this.shortsSize():t<24?this.bytesSize():4*this.pointersSize()+this.bytesSize()},snapshotSize:function(){var e=this.isFloat?2:this.words?this.words.length:this.pointers?this.pointers.length:0;this.bytes&&(e+=this.bytes.length+3>>>2);var t=255<=e?2:0;return e+=1&e,(e+=2)<4&&(e=4),{header:t,body:e}},writeTo:function(e,t,r,i){var a=this.isFloat?2:this.words?this.words.length:this.pointers?this.pointers.length:0;this.bytes&&(a+=this.bytes.length+3>>>2,this._format|=3&-this.bytes.length);var s=t,n=this._format<<24|4194303&this.sqClass.hash,o=a<<24|4194303&this.hash;if(255<=a&&(e.setUint32(t,a,r),t+=4,o=255<<24|4194303&this.hash,e.setUint32(t,o,r),t+=4),e.setUint32(t,n,r),t+=4,e.setUint32(t,o,r),t+=4,this.isFloat)e.setFloat64(t,this.float,r),t+=8;else if(this.words)for(var u=0;u<this.words.length;u++)e.setUint32(t,this.words[u],r),t+=4;else if(this.pointers){var l=0;if(24<=this._format){var c=this.methodSignFlag()?2147483648:0,h=this.pointers[0]<<1|1|c;e.setUint32(t,h,r),t+=4,l=1}for(u=l;u<this.pointers.length;u++)e.setUint32(t,i(this.pointers[u]),r),t+=4}if(this.bytes){for(u=0;u<this.bytes.length;u++)e.setUint8(t++,this.bytes[u]);t+=3&-this.bytes.length}if((t+=0===a?8:4*(1&a))!==s+this.totalBytes())throw Error("written size does not match");return t}},"testing",{isBytes:function(){var e=this._format;return 16<=e&&e<=23},isPointers:function(){return this._format<=6},isWords:function(){return 10===this._format},isWordsOrBytes:function(){var e=this._format;return 10===e||16<=e&&e<=23},isWeak:function(){return 4===this._format},isMethod:function(){return 24<=this._format},sameFormats:function(e,t){return e<16?e===t:(248&e)==(248&t)}},"as class",{defaultInst:function(){return Squeak.ObjectSpur},classInstFormat:function(){return this.pointers[Squeak.Class_format]>>16&31},classInstSize:function(){return 65535&this.pointers[Squeak.Class_format]},classInstIsBytes:function(){var e=this.classInstFormat();return 16<=e&&e<=23},classInstIsPointers:function(){return this.classInstFormat()<=6},classByteSizeOfInstance:function(e){var t=this.classInstFormat(),r=this.classInstSize();return r+=t<9?e:16<=t?(e+3)/4|0:12<=t?(e+1)/2|0:10<=t?e:2*e,r+=1&r,(r+=255<=r?4:2)<4&&(r=4),4*r}},"as compiled block",{blockOuterCode:function(){return this.pointers[this.pointers.length-1]}},"as method",{methodSignFlag:function(){return this.pointers[0]<0},methodNumLits:function(){return 32767&this.pointers[0]},methodPrimitiveIndex:function(){return 0==(65536&this.pointers[0])?0:this.bytes[1]+256*this.bytes[2]},methodAsString:function(){var e=this.pointers[this.pointers.length-1].pointers[Squeak.ClassBinding_value],t=this.pointers[this.pointers.length-2];return t.pointers&&(t=t.pointers[Squeak.AdditionalMethodState_selector]),e.className()+">>"+t.bytesAsString()}}),Object.subclass("Squeak.Image","about",{about:function(){}},"initializing",{initialize:function(e){this.headRoom=1e8,this.totalMemory=0,this.name=e,this.gcCount=0,this.gcMilliseconds=0,this.pgcCount=0,this.pgcMilliseconds=0,this.gcTenured=0,this.allocationCount=0,this.oldSpaceCount=0,this.youngSpaceCount=0,this.newSpaceCount=0,this.hasNewInstances={}},readFromBuffer:function(a,t,r){console.log("squeak: reading "+this.name+" ("+a.byteLength+" bytes)"),this.startupTime=Date.now();for(var i=new DataView(a),s=!1,n=0,e=function(){var e=i.getUint32(n,s);return n+=4,e},o=e,u=4,l=function(e,t){if(t){for(var r=[];r.length<e;)r.push(o());return r}var i=new Uint32Array(a,n,e*u/4);return n+=e*u,i},c=[6501,6502,6504,68e3,68002,68004],h=0,f=0;s=!s,n=f,h=o(),!(0<=c.indexOf(72174&h));)if(s||(f+=512),512<f)throw Error("bad image version");var p=0!=(1&(this.version=h));this.hasClosures=!(0<=[6501,6502,68e3].indexOf(h)),this.isSpur=0!=(16&h);var d=68e3<=h;if(d&&!this.isSpur)throw Error("64 bit non-spur images not supported yet");d&&(o=function(){var e=i.getUint32(n,!0),t=i.getUint32(n+4,!0);return n+=8,Squeak.word64FromUint32(t,e)},u=8);var m=e(),b=o(),v=o(),g=o();this.savedHeaderWords=[];for(var k=0;k<7;k++)this.savedHeaderWords.push(e()),d&&k<3&&e();var _,y=o(),S={},O={},w=f+m;if(n=w,this.isSpur){this.oldSpaceBytes=y-16;for(var I=n+y,F=0,P=null,A=0,x={};n<I;){for(;n<I-16;){var C=n,V=e(),M=e(),R=M>>>24;255===R&&(R=V,V=e(),M=e());D=F+n-8-w;var j=4194303&V;G=4194303&M,U=l(R,(L=V>>>24&31)<10&&0<j);if(n+=d?8*(R<1?1-R:0):4*(R<2?2-R:1&R),32<=j){if((z=new Squeak.ObjectSpur).initFromImage(D,j,L,G),_&&(_.nextObject=z),this.oldSpaceCount++,_=z,S[v+D]=z,O[D]=U,x[D]=A,d){var q=z.overhead64(U);A+=q.bytes,q.sizeHeader&&(x[D]-=8,A-=8)}}else A+=n-C,16!=j||P||(P=U),j&&(S[v+D]=U)}if(n!==I-16)throw Error("invalid segment");var Y=e(),N=e(),B=e();e();if(0!==B){var W=4278190080&N?4*(16777215&Y):0;I+=B,F+=W,A+=16+W,this.oldSpaceBytes+=W+B}}this.oldSpaceBytes-=A,this.firstOldObject=S[v],this.lastOldObject=z,this.lastOldObject.nextObject=null}else{for(;n<w+b;){var T=0,Z=0,E=o();switch(E&Squeak.HeaderTypeMask){case Squeak.HeaderTypeSizeAndClass:T=E>>>2,Z=o(),E=o();break;case Squeak.HeaderTypeClass:Z=E-Squeak.HeaderTypeClass,T=(E=o())>>>2&63;break;case Squeak.HeaderTypeShort:T=E>>>2&63,Z=E>>>12&31;break;case Squeak.HeaderTypeFree:throw Error("Unexpected free block")}var L,z,D=n-4-w,G=E>>>17&4095,U=l(--T,(L=E>>>8&15)<5);(z=new Squeak.Object).initFromImage(D,Z,L,G),Z<32&&(z.hash|=268435456),_&&(_.nextObject=z),this.oldSpaceCount++,_=z,S[v+D]=z,O[D]=U}this.firstOldObject=S[v+4],this.lastOldObject=z,this.lastOldObject.nextObject=null,this.oldSpaceBytes=b}this.totalMemory=this.oldSpaceBytes+this.headRoom,this.totalMemory=1e6*Math.ceil(this.totalMemory/1e6);var X=S[g],K=this.isSpur?this.spurClassTable(S,O,P,X):O[S[O[X.oop][Squeak.splOb_CompactClasses]].oop],H=null;for(z=this.firstOldObject,_=null;z;)_=H,H=z.renameFromImage(S,O,K),_?_.nextObject=H:this.firstOldObject=H,S[v+z.oop]=H,z=z.nextObject;this.lastOldObject=H,this.lastOldObject.nextObject=null;var J=S[g],$=O[S[O[J.oop][Squeak.splOb_CompactClasses]].oop],Q=S[O[J.oop][Squeak.splOb_ClassFloat]];this.isSpur&&(this.initImmediateClasses(S,O,J),$=this.spurClassTable(S,O,P,J),p=this.getCharacter.bind(this),this.initSpurOverrides());var ee=this.firstOldObject,te=0,re=function(){if(ee){for(var e=te+(this.oldSpaceCount/20|0);ee&&te<e;)ee.installFromImage(S,O,$,Q,s,p,d&&{makeFloat:function(e){return this.instantiateFloat(e)}.bind(this),makeLargeFromSmall:function(e,t){return this.instantiateLargeFromSmall(e,t)}.bind(this)}),ee=ee.nextObject,te++;return r&&r(te/this.oldSpaceCount),!0}return this.specialObjectsArray=J,this.decorateKnownObjects(),this.isSpur?(this.fixSkippedOops(x),d&&this.fixPCs(),this.ensureFullBlockClosureClass(this.specialObjectsArray,$)):(this.fixCompiledMethods(),this.fixCompactOops()),!1}.bind(this);if(r)self.setTimeout(function e(){re()?self.setTimeout(e,0):t&&t()},0);else{for(;re(););t&&t()}},decorateKnownObjects:function(){var e=this.specialObjectsArray.pointers;if(e[Squeak.splOb_NilObject].isNil=!0,e[Squeak.splOb_TrueObject].isTrue=!0,e[Squeak.splOb_FalseObject].isFalse=!0,e[Squeak.splOb_ClassFloat].isFloatClass=!0,!this.isSpur){this.compactClasses=this.specialObjectsArray.pointers[Squeak.splOb_CompactClasses].pointers;for(var t=0;t<this.compactClasses.length;t++)this.compactClasses[t].isNil||(this.compactClasses[t].isCompact=!0)}Number.prototype.sqInstName||Object.defineProperty(Number.prototype,"sqInstName",{enumerable:!1,value:function(){return this.toString()}})},fixCompactOops:function(){if(!this.isSpur){for(var e=this.firstOldObject,t=0;e;){var r=268435455<e.hash;if(r!=!!e.sqClass.isCompact){var i=0===e.snapshotSize().header;r!=i&&(t+=i?-4:4)}e.hash&=268435455,e.oop+=t,e=e.nextObject}this.oldSpaceBytes+=t}},fixCompiledMethods:function(){if(!(6502<=this.version))for(var e=this.firstOldObject,t=this.specialObjectsArray.pointers[Squeak.splOb_ClassCompiledMethod];e;)e.isMethod()&&(e.sqClass=t),e=e.nextObject},fixSkippedOops:function(e){for(var t=this.firstOldObject;t;)t.oop-=e[t.oop],t=t.nextObject;if((t=this.lastOldObject).addr()+t.totalBytes()!==this.oldSpaceBytes)throw Error("image size doesn't match object sizes")},fixPCs:function(){for(var e=this.specialObjectsArray.pointers[Squeak.splOb_ClassMethodContext],t=Squeak.Context_instructionPointer,r=Squeak.Context_method,i=this.specialObjectsArray.pointers[Squeak.splOb_ClassBlockClosure],a=Squeak.Closure_startpc,s=Squeak.Closure_outerContext,n=this.firstOldObject;n;)n.sqClass===e?n.pointers[t]-=4*n.pointers[r].pointers.length:n.sqClass===i&&(n.pointers[a]-=4*n.pointers[s].pointers[r].pointers.length),n=n.nextObject},ensureFullBlockClosureClass:function(e,t){e.pointers[Squeak.splOb_ClassFullBlockClosure].isNil&&t[38]&&(e.pointers[Squeak.splOb_ClassFullBlockClosure]=t[38])}},"garbage collection - full",{fullGC:function(e){this.vm.addMessage("fullGC: "+e);var t=Date.now(),r=this.markReachableObjects();return this.removeUnmarkedOldObjects(),this.appendToOldObjects(r),this.finalizeWeakReferences(),this.allocationCount+=this.newSpaceCount,this.newSpaceCount=0,this.youngSpaceCount=0,this.hasNewInstances={},this.gcCount++,this.gcMilliseconds+=Date.now()-t,console.log("Full GC ("+e+"): "+(Date.now()-t)+" ms"),"primitive"===e&&console.log("  surviving objects: "+this.oldSpaceCount+" ("+this.oldSpaceBytes+" bytes)"),0<r.length?r[0]:null},gcRoots:function(){return this.vm.storeContextRegisters(),[this.specialObjectsArray,this.vm.activeContext]},markReachableObjects:function(){var e=this.gcRoots(),t=[];for(this.weakObjects=[];0<e.length;){var r=e.pop();if(!r.mark){r.oop<0&&t.push(r),r.mark=!0,r.sqClass.mark||e.push(r.sqClass);var i=r.pointers;if(i){var a=i.length;if(r.isWeak()&&(a=r.sqClass.classInstSize(),this.weakObjects.push(r)),this.vm.isContext(r))for(var s=a=r.contextSizeWithStack();s<i.length;s++)i[s]=this.vm.nilObj;for(s=0;s<a;s++)"object"!=typeof i[s]||i[s].mark||e.push(i[s])}}}return this.isSpur?t:t.sort(function(e,t){return t.oop-e.oop})},removeUnmarkedOldObjects:function(){var e=0,t=0,r=this.firstOldObject;for(r.mark=!1;;){var i=r.nextObject;if(!i)return this.lastOldObject=r,this.lastOldObject.nextObject=null,this.oldSpaceBytes-=t,void(this.oldSpaceCount-=e);if(i.dirty&&(i.dirty=!1),i.mark)(r=i).mark=!1,r.oop-=t;else{var a=i;r.nextObject=a.nextObject,a.oop=-++this.newSpaceCount,t+=a.totalBytes(),e++}}},appendToOldObjects:function(e){for(var t=this.lastOldObject,r=0;r<e.length;r++){var i=e[r];i.mark=!1,this.oldSpaceBytes=i.setAddr(this.oldSpaceBytes),t.nextObject=i,t=i}t.nextObject=null,this.lastOldObject=t,this.lastOldObject.nextObject=null,this.oldSpaceCount+=e.length,this.gcTenured+=e.length,this.vm.signalLowSpaceIfNecessary(this.bytesLeft())},tenureIfYoung:function(e){e.oop<0&&this.appendToOldObjects([e])},finalizeWeakReferences:function(){var e=this.weakObjects;this.weakObjects=null;for(var t=0;t<e.length;t++){for(var r=e[t],i=r.pointers,a=r.sqClass.classInstSize(),s=!1,n=a;n<i.length;n++)i[n].oop<0&&(i[n]=this.vm.nilObj,s=!0);if(s&&(this.vm.pendingFinalizationSignals++,2<=a)){var o=r.pointers[Squeak.WeakFinalizerItem_list];if(o.sqClass==this.vm.specialObjects[Squeak.splOb_ClassWeakFinalizer]){var u=o.pointers[Squeak.WeakFinalizationList_first];r.pointers[Squeak.WeakFinalizerItem_next]=u,o.pointers[Squeak.WeakFinalizationList_first]=r}}}0<this.vm.pendingFinalizationSignals&&this.vm.forceInterruptCheck()}},"garbage collection - partial",{partialGC:function(e){this.vm.addMessage("partialGC: "+e);var t=Date.now(),r=this.findYoungObjects();return this.appendToYoungSpace(r),this.finalizeWeakReferences(),this.cleanupYoungSpace(r),this.allocationCount+=this.newSpaceCount-r.length,this.youngSpaceCount=r.length,this.newSpaceCount=this.youngSpaceCount,this.pgcCount++,this.pgcMilliseconds+=Date.now()-t,console.log("Partial GC ("+e+"): "+(Date.now()-t)+" ms"),r[0]},youngRoots:function(){for(var e=this.gcRoots().filter(function(e){return e.oop<0}),t=this.firstOldObject;t;){if(t.dirty){for(var r=t.pointers,i=!1,a=0;a<r.length;a++){var s=r[a];"object"==typeof s&&s.oop<0&&(e.push(s),i=!0)}t.dirty=i}t=t.nextObject}return e},findYoungObjects:function(){var e=this.youngRoots(),t=[];for(this.weakObjects=[];0<e.length;){var r=e.pop();if(!r.mark){t.push(r),r.mark=!0,r.sqClass.oop<0&&e.push(r.sqClass);var i=r.pointers;if(i){var a=i.length;if(r.isWeak()&&(a=r.sqClass.classInstSize(),this.weakObjects.push(r)),this.vm.isContext(r))for(var s=a=r.contextSizeWithStack();s<i.length;s++)i[s]=this.vm.nilObj;for(s=0;s<a;s++){var n=i[s];"object"==typeof n&&n.oop<0&&e.push(n)}}}}return this.isSpur?t:t.sort(function(e,t){return t.oop-e.oop})},appendToYoungSpace:function(e){for(var t=this.lastOldObject.oop+1,r=0;r<e.length;r++){var i=e[r];this.hasNewInstances[i.oop]&&(delete this.hasNewInstances[i.oop],this.hasNewInstances[t]=!0),i.oop=t,i.nextObject=e[r+1],t++}},cleanupYoungSpace:function(e){for(var t=e[0],r=-1;t;)this.hasNewInstances[t.oop]&&(delete this.hasNewInstances[t.oop],this.hasNewInstances[r]=!0),t.oop=r,t.mark=!1,t=t.nextObject,r--}},"creating",{registerObject:function(e){return e.oop=-++this.newSpaceCount,this.lastHash=13849+27181*this.lastHash&4294967295,4095&this.lastHash},registerObjectSpur:function(e){return e.oop=-++this.newSpaceCount,0},instantiateClass:function(e,t,r){var i=new(e.classInstProto()),a=this.registerObject(i);return i.initInstanceOf(e,t,a,r),this.hasNewInstances[e.oop]=!0,i},clone:function(e){var t=new(e.sqClass.classInstProto()),r=this.registerObject(t);return t.initAsClone(e,r),this.hasNewInstances[t.sqClass.oop]=!0,t}},"operations",{bulkBecome:function(e,t,r,i){if(!e)return!t;var a=e.length;if(a!==t.length)return!1;var s=null;0<this.newSpaceCount?s=this.partialGC("become"):this.vm.storeContextRegisters();for(var n={},o=0;o<a;o++){if(!(l=e[o]).sqClass)return!1;if(n[l.oop])return!1;n[l.oop]=t[o]}if(r)for(o=0;o<a;o++){if(!(l=t[o]).sqClass)return!1;if(n[l.oop])return!1;n[l.oop]=e[o]}if(i)for(o=0;o<a;o++){if(!t[o].sqClass)return!1;var u=e[o].hash;e[o].hash=t[o].hash,t[o].hash=u,this.isSpur&&this.classTable[u]===e[o]&&(this.classTable[u]=t[o])}this.lastOldObject.nextObject=s;for(var l=this.firstOldObject;l;){var c=n[l.sqClass.oop];c&&(l.sqClass=c).oop<0&&(l.dirty=!0);var h=l.pointers;if(h)for(var f=0;f<h.length;f++)(c=n[h[f].oop])&&(h[f]=c).oop<0&&(l.dirty=!0);l=l.nextObject}return this.lastOldObject.nextObject=null,this.vm.flushMethodCacheAfterBecome(n),!0},objectAfter:function(e){return e.nextObject||this.nextObjectWithGC("nextObject",e)},someInstanceOf:function(e){for(var t=this.firstOldObject;t;){if(t.sqClass===e)return t;t=t.nextObject||this.nextObjectWithGCFor(t,e)}return null},nextInstanceAfter:function(e){for(var t=e.sqClass;;){if(!(e=e.nextObject||this.nextObjectWithGCFor(e,t)))return null;if(e.sqClass===t)return e}},nextObjectWithGC:function(e,t){var r=0<t.oop?0:this.youngSpaceCount;return this.newSpaceCount<=r?null:(t.oop<0&&this.fullGC(e),this.partialGC(e))},nextObjectWithGCFor:function(e,t){return this.hasNewInstances[t.oop]?this.nextObjectWithGC("instance of "+t.className(),e):null},allInstancesOf:function(e){for(var t=this.firstOldObject,r=[];t;)t.sqClass===e&&r.push(t),t=t.nextObject||this.nextObjectWithGCFor(t,e);return r},writeToBuffer:function(){function e(e){t.setUint32(r,e),r+=4}var t=new DataView(new ArrayBuffer(64+this.oldSpaceBytes)),r=0;for(e(this.formatVersion()),e(64),e(this.oldSpaceBytes),e(this.firstOldObject.addr()),e(this.objectToOop(this.specialObjectsArray)),e(this.lastHash),e(52429400);r<64;)e(0);for(var i=this.firstOldObject,a=0;i;)r=i.writeTo(t,r,this),i=i.nextObject,a++;if(r!==t.byteLength)throw Error("wrong image size");if(a!==this.oldSpaceCount)throw Error("wrong object count");return t.buffer},objectToOop:function(e){if("number"==typeof e)return e<<1|1;if(e.oop<0)throw Error("temporary oop");return e.oop},bytesLeft:function(){return this.totalMemory-this.oldSpaceBytes},formatVersion:function(){return this.isSpur?6521:this.hasClosures?6504:6502},segmentVersion:function(){var e=this.isSpur?"seod":"does";return this.formatVersion()|e.charCodeAt(0)<<24},storeImageSegment:function(e,t,r){var i=new DataView(e.words.buffer),a=0,s=t.pointers,n=0;i.setUint32(a,this.segmentVersion()),a+=4,this.fullGC("storeImageSegment"),r.mark=!0;for(var o=0;o<r.pointers.length;o++)"object"==typeof r.pointers[o]&&(r.pointers[o].mark=!0);this.markReachableObjects(),r.mark=!1;for(o=0;o<r.pointers.length;o++)"object"==typeof r.pointers[o]&&(r.pointers[o].mark=!1);var u={},l=[];function c(e){var t=u[e.oop];if(!t){if(e.mark){if(n>=s.length)return 0;t=2147483652+4*n,s[n++]=e}else{if(a+e.totalBytes()>i.byteLength)return 0;t=a+4*(e.snapshotSize().header+1),a=e.writeTo(i,a,this),l.push(e)}u[e.oop]=t}return t}function h(){for(var e=this.firstOldObject;e;)e.mark=!1,e=e.nextObject;return this.weakObjects=null,!1}for(c=c.bind(this),h=h.bind(this),c(r);0<l.length;){var f=l.shift(),p=u[f.oop],d=f.snapshotSize().header,m=f.pointers;if(0<d){var b=c(f.sqClass);if(!b)return h();var v=1===d?Squeak.HeaderTypeClass:Squeak.HeaderTypeSizeAndClass;i.setUint32(p-8,b|v)}if(m)for(o=0;o<m.length;o++){var g=m[o];if("object"==typeof g){var k=c(g);if(!k)return h();i.setUint32(p+4*o,k)}}}f=e.oop<t.oop?e:t;for(var _=0;f;)f.oop-=_,f===e?(_+=4*f.words.length-a,f.words=new Uint32Array(f.words.buffer.slice(0,a))):f===t&&(_+=4*(f.pointers.length-n),f.pointers.length=n),f=f.nextObject;return this.oldSpaceBytes-=_,h(),!0},loadImageSegment:function(e,t){function a(){var e=s.getUint32(n,i);return n+=4,e}function r(e,t){if(t<5){for(var r=[];r.length<e;)r.push(a());return r}var i=new Uint32Array(s.buffer,n,e);return n+=4*e,i}var s=new DataView(e.words.buffer),i=!1,n=0,o=a();if(!0&o&&(i=!0,!(n=0)&(o=a())))return console.error("image segment format not supported"),null;this.tenureIfYoung(e);for(var u=e,l=u.nextObject,c=e.oop,h={},f={};n<s.byteLength;){var p=0,d=0,m=a();switch(m&Squeak.HeaderTypeMask){case Squeak.HeaderTypeSizeAndClass:p=m>>>2,d=a(),m=a();break;case Squeak.HeaderTypeClass:d=m-Squeak.HeaderTypeClass,p=(m=a())>>>2&63;break;case Squeak.HeaderTypeShort:p=m>>>2&63,d=m>>>12&31;break;case Squeak.HeaderTypeFree:throw Error("Unexpected free block")}var b=n,v=m>>>8&15,g=m>>>17&4095,k=r(--p,v),_=new Squeak.Object;_.initFromImage(b+c,d,v,g),u.nextObject=_,this.oldSpaceCount++,u=_,h[b]=_,f[b+c]=k}_.nextObject=l;for(var y=0;y<t.pointers.length;y++)h[2147483652+4*y]=t.pointers[y];var S=this.specialObjectsArray.pointers[Squeak.splOb_CompactClasses].pointers,O=0,w=S.map(function(e){return h[--O]=e,O});e.words=new Uint32Array([e.words[0]]);for(var I=e.nextObject,F=this.specialObjectsArray.pointers[Squeak.splOb_ClassFloat],P=I;P.installFromImage(h,f,w,F,i,!1),(P=P.nextObject)!==l;);return I}},"spur support",{initSpurOverrides:function(){this.registerObject=this.registerObjectSpur,this.writeToBuffer=this.writeToBufferSpur,this.storeImageSegment=this.storeImageSegmentSpur,this.loadImageSegment=this.loadImageSegmentSpur},spurClassTable:function(e,t,r,i){for(var a={},s=this.firstOldObject,n=0;n<4096;n++){var o=e[r[n]];if(o.oop&&(o=t[o.oop]),1024===o.length)for(var u=0;u<1024;u++){var l=e[o[u]];if(!l)throw Error("Invalid class table entry (oop "+o[u]+")");if(l!==s)a[h=1024*n+u]=l}}for(var c in Squeak)if(/^splOb_Class/.test(c)){var h,f=e[t[i.oop][Squeak[c]]];if(f!==s)0<(h=f.hash)&&h<1024&&(a[h]=f)}return a[3]=a[1],this.classTable=a,this.classTableIndex=1024,a},enterIntoClassTable:function(e){for(var t=this.classTableIndex,r=this.classTable;t<=4194303;){if(!r[t])return(r[t]=e).hash=t,this.classTableIndex=t;t++}return console.error("class table full?"),null},initImmediateClasses:function(e,t,r){var i=t[r.oop];this.characterClass=e[i[Squeak.splOb_ClassCharacter]],this.floatClass=e[i[Squeak.splOb_ClassFloat]],this.largePosIntClass=e[i[Squeak.splOb_ClassLargePositiveInteger]],this.largeNegIntClass=e[i[Squeak.splOb_ClassLargeNegativeInteger]],this.characterClass.classInstProto("Character"),this.floatClass.classInstProto("BoxedFloat64"),this.largePosIntClass.classInstProto("LargePositiveInteger"),this.largeNegIntClass.classInstProto("LargeNegativeInteger"),this.characterTable={}},getCharacter:function(e){var t=this.characterTable[e];return t||((t=new this.characterClass.instProto).initInstanceOfChar(this.characterClass,e),this.characterTable[e]=t),t},instantiateFloat:function(e){var t=new this.floatClass.instProto;return this.registerObjectSpur(t),this.hasNewInstances[this.floatClass.oop]=!0,t.initInstanceOfFloat(this.floatClass,e),t},instantiateLargeFromSmall:function(e,t){t=e<<29|t>>>3;var r=(e>>=3)<0;r&&(e=-e,0!==(t=-t)&&e--);var i=0===e?4:e<=255?5:e<=65535?6:e<=16777215?7:8,a=r?this.largeNegIntClass:this.largePosIntClass,s=new a.instProto;this.registerObjectSpur(s),this.hasNewInstances[a.oop]=!0,s.initInstanceOfLargeInt(a,i);for(var n=s.bytes,o=0;o<4;o++)n[o]=255&t,t>>=8;for(o=4;o<i;o++)n[o]=255&e,e>>=8;return s},ensureClassesInTable:function(){for(var e=this.firstOldObject,t=1024;e;){var r=e.sqClass;if(0===r.hash&&this.enterIntoClassTable(r),r.hash>t&&(t=r.hash),this.classTable[r.hash]!==r)throw Error("Class not in class table");e=e.nextObject}return 1+(t>>10)},classTableBytes:function(e){return 4*(4108+1028*e)},writeFreeLists:function(e,t,r,i){return e.setUint32(t,167772178,r),t+=4,e.setUint32(t,536870912,r),t+=4,t+=128},writeClassTable:function(e,t,r,i,a){e.setUint32(t,4104,r),t+=4,e.setUint32(t,4278190080,r),t+=4,e.setUint32(t,33554448,r),t+=4,e.setUint32(t,4278190080,r),t+=4;for(var s=0;s<a;s++)e.setUint32(t,16624+4112*s,r),t+=4;t+=4*(4104-a);var n=0;for(s=0;s<a;s++){e.setUint32(t,1024,r),t+=4,e.setUint32(t,4278190080,r),t+=4,e.setUint32(t,33554448,r),t+=4,e.setUint32(t,4278190080,r),t+=4;for(var o=0;o<1024;o++){var u=this.classTable[n];if(u&&u.pointers){if(!u.hash)throw Error("class without id");(u.hash!==n&&32<=n||u.oop<0)&&(console.warn("freeing class index "+n+" "+u.className()),u=null,delete this.classTable[n])}u&&e.setUint32(t,i(u),r),t+=4,n++}}return t},writeToBufferSpur:function(){var e=this.ensureClassesInTable(),t=136+this.classTableBytes(e),r=new DataView(new ArrayBuffer(64+t+this.oldSpaceBytes+16)),i=!0,a=Date.now(),s=0;function n(e){r.setUint32(s,e,i),s+=4}function o(e){if("number"==typeof e)return e<<1|1;if(7===e._format){if(e.hash!==e.oop>>2||2!=(3&e.oop))throw Error("Bad immediate char");return e.oop}if(e.oop<0)throw Error("temporary oop");return e.oop<48?e.oop:e.oop+t}for(n(this.formatVersion()),n(64),n(t+this.oldSpaceBytes+16),n(this.firstOldObject.addr()),n(o(this.specialObjectsArray)),this.savedHeaderWords.forEach(n),n(t+this.oldSpaceBytes+16);s<64;)n(0);var u=this.firstOldObject,l=0;for(s=u.writeTo(r,s,i,o),u=u.nextObject,l++,s=u.writeTo(r,s,i,o),u=u.nextObject,l++,s=u.writeTo(r,s,i,o),u=u.nextObject,l++,s=this.writeFreeLists(r,s,i,o),s=this.writeClassTable(r,s,i,o,e);u;)s=u.writeTo(r,s,i,o),u=u.nextObject,l++;if(n(1241513987),n(8388608),n(0),n(0),s!==r.byteLength)throw Error("wrong image size");if(l!==this.oldSpaceCount)throw Error("wrong object count");var c=Date.now()-a;return console.log("Wrote "+l+" objects in "+c+" ms, image size "+s+" bytes"),r.buffer},storeImageSegmentSpur:function(e,t,r){return this.vm.warnOnce("not implemented for Spur yet: primitive 98 (primitiveStoreImageSegment)"),!1},loadImageSegmentSpur:function(e,t){return this.vm.warnOnce("not implemented for Spur yet: primitive 99 (primitiveLoadImageSegment)"),null}}),Object.subclass("Squeak.Interpreter","initialization",{initialize:function(e,t){console.log("squeak: initializing interpreter "+Squeak.vmVersion),this.Squeak=Squeak,this.image=e,(this.image.vm=this).primHandler=new Squeak.Primitives(this,t),this.loadImageState(),this.hackImage(),this.initVMState(),this.loadInitialContext(),this.initCompiler(),console.log("squeak: ready")},loadImageState:function(){this.specialObjects=this.image.specialObjectsArray.pointers,this.specialSelectors=this.specialObjects[Squeak.splOb_SpecialSelectors].pointers,this.nilObj=this.specialObjects[Squeak.splOb_NilObject],this.falseObj=this.specialObjects[Squeak.splOb_FalseObject],this.trueObj=this.specialObjects[Squeak.splOb_TrueObject],this.hasClosures=this.image.hasClosures,this.getGlobals=this.globalsGetter(),this.hasClosures||this.findMethod("UnixFileDirectory class>>pathNameDelimiter")||(this.primHandler.emulateMac=!0),6501==this.image.version&&(this.primHandler.reverseDisplay=!0)},initVMState:function(){this.byteCodeCount=0,this.sendCount=0,this.interruptCheckCounter=0,this.interruptCheckCounterFeedBackReset=1e3,this.interruptChecksEveryNms=3,this.lowSpaceThreshold=1e6,this.signalLowSpace=!1,this.nextPollTick=0,this.nextWakeupTick=0,this.lastTick=0,this.interruptKeycode=2094,this.interruptPending=!1,this.pendingFinalizationSignals=0,this.freeContexts=this.nilObj,this.freeLargeContexts=this.nilObj,this.reclaimableContextCount=0,this.nRecycledContexts=0,this.nAllocatedContexts=0,this.methodCacheSize=1024,this.methodCacheMask=this.methodCacheSize-1,this.methodCacheRandomish=0,this.methodCache=[];for(var e=0;e<this.methodCacheSize;e++)this.methodCache[e]={lkupClass:null,selector:null,method:null,primIndex:0,argCount:0,mClass:null};this.breakOutOfInterpreter=!1,this.breakOutTick=0,this.breakOnMethod=null,this.breakOnNewMethod=!1,this.breakOnContextChanged=!1,this.breakOnContextReturned=null,this.messages={},this.startupTime=Date.now()},loadInitialContext:function(){var e=this.specialObjects[Squeak.splOb_SchedulerAssociation].pointers[Squeak.Assn_value].pointers[Squeak.ProcSched_activeProcess];this.activeContext=e.pointers[Squeak.Proc_suspendedContext],this.activeContext.dirty=!0,this.fetchContextRegisters(this.activeContext),this.reclaimableContextCount=0},globalsGetter:function(){var e=this.specialObjects[Squeak.splOb_SmalltalkDictionary],t=e.sqClass.className();if("Association"===t&&(t=(e=e.pointers[1]).sqClass.className()),"SystemDictionary"===t)return function(){return e.pointers[1].pointers};if("SmalltalkImage"===t){var r=e.pointers[0],i=r.sqClass.className();if("SystemDictionary"===i)return function(){return r.pointers[1].pointers};if("Environment"===i)return function(){return r.pointers[2].pointers[1].pointers}}return console.warn("cannot find global dict"),function(){return[]}},initCompiler:function(){if(!Squeak.Compiler)return console.warn("Squeak.Compiler not loaded, using interpreter only");try{if(42!==new Function("return 42")())return console.warn("function constructor not working, disabling JIT")}catch(e){return console.warn("disabling JIT: "+e)}var e=this.image.oldSpaceCount/(this.startupTime-this.image.startupTime);if(e<10)return console.warn("Slow machine detected (loaded "+(1e3*e|0)+" objects/sec), using interpreter only");try{console.log("squeak: initializing JIT compiler");var t=new Squeak.Compiler(this);t.compile&&(this.compiler=t)}catch(e){console.warn("Compiler: "+e)}this.compiler||console.warn("SqueakJS will be running in interpreter mode only (slow)")},hackImage:function(){[{method:"SmalltalkImage>>wordSize",literal:{index:1,old:8,hack:4},enabled:!0},{method:"ReleaseBuilder class>>prepareEnvironment",bytecode:{pc:28,old:216,hack:135},enabled:("object"==typeof location?location.hash:"").includes("wizard=false")}].forEach(function(t){try{var e=t.enabled&&this.findMethod(t.method);if(e){var r=t.primitive,i=t.bytecode,a=t.literal,s=!0;r?e.pointers[0]|=r:i&&e.bytes[i.pc]===i.old?e.bytes[i.pc]=i.hack:i&&e.bytes[i.pc]===i.hack?s=!1:a&&e.pointers[a.index].pointers[1]===a.old?e.pointers[a.index].pointers[1]=a.hack:a&&e.pointers[a.index].pointers[1]===a.hack?s=!1:(s=!1,console.warn("Not hacking "+t.method)),s&&console.warn("Hacking "+t.method)}}catch(e){console.error("Failed to hack "+t.method+" with error "+e)}},this)}},"interpreting",{interpretOne:function(e){if(this.method.methodSignFlag())return this.interpretOneSistaWithExtensions(e,0,0);if(!this.method.compiled){var t,r,i=this.Squeak;switch(this.byteCodeCount++,t=this.nextByte()){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return void this.push(this.receiver.pointers[15&t]);case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:return void this.push(this.homeContext.pointers[i.Context_tempFrameStart+(15&t)]);case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:case 61:case 62:case 63:return void this.push(this.method.methodGetLiteral(31&t));case 64:case 65:case 66:case 67:case 68:case 69:case 70:case 71:case 72:case 73:case 74:case 75:case 76:case 77:case 78:case 79:case 80:case 81:case 82:case 83:case 84:case 85:case 86:case 87:case 88:case 89:case 90:case 91:case 92:case 93:case 94:case 95:return void this.push(this.method.methodGetLiteral(31&t).pointers[i.Assn_value]);case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:return this.receiver.dirty=!0,void(this.receiver.pointers[7&t]=this.pop());case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:return void(this.homeContext.pointers[i.Context_tempFrameStart+(7&t)]=this.pop());case 112:return void this.push(this.receiver);case 113:return void this.push(this.trueObj);case 114:return void this.push(this.falseObj);case 115:return void this.push(this.nilObj);case 116:return void this.push(-1);case 117:return void this.push(0);case 118:return void this.push(1);case 119:return void this.push(2);case 120:return void this.doReturn(this.receiver);case 121:return void this.doReturn(this.trueObj);case 122:return void this.doReturn(this.falseObj);case 123:return void this.doReturn(this.nilObj);case 124:return void this.doReturn(this.pop());case 125:return void this.doReturn(this.pop(),this.activeContext.pointers[i.BlockContext_caller]);case 126:case 127:return void this.nono();case 128:return void this.extendedPush(this.nextByte());case 129:return void this.extendedStore(this.nextByte());case 130:return void this.extendedStorePop(this.nextByte());case 131:return r=this.nextByte(),void this.send(this.method.methodGetSelector(31&r),r>>5,!1);case 132:return void this.doubleExtendedDoAnything(this.nextByte());case 133:return r=this.nextByte(),void this.send(this.method.methodGetSelector(31&r),r>>5,!0);case 134:return r=this.nextByte(),void this.send(this.method.methodGetSelector(63&r),r>>6,!1);case 135:return void this.pop();case 136:return void this.push(this.top());case 137:return void this.push(this.exportThisContext());case 138:return void this.pushNewArray(this.nextByte());case 139:return void this.callPrimBytecode(129);case 140:return r=this.nextByte(),void this.push(this.homeContext.pointers[i.Context_tempFrameStart+this.nextByte()].pointers[r]);case 141:return r=this.nextByte(),void(this.homeContext.pointers[i.Context_tempFrameStart+this.nextByte()].pointers[r]=this.top());case 142:return r=this.nextByte(),void(this.homeContext.pointers[i.Context_tempFrameStart+this.nextByte()].pointers[r]=this.pop());case 143:return void this.pushClosureCopy();case 144:case 145:case 146:case 147:case 148:case 149:case 150:case 151:return void(this.pc+=1+(7&t));case 152:case 153:case 154:case 155:case 156:case 157:case 158:case 159:return void this.jumpIfFalse(1+(7&t));case 160:case 161:case 162:case 163:case 164:case 165:case 166:case 167:return r=this.nextByte(),this.pc+=256*((7&t)-4)+r,void((7&t)<4&&this.interruptCheckCounter--<=0&&this.checkForInterrupts());case 168:case 169:case 170:case 171:return void this.jumpIfTrue(256*(3&t)+this.nextByte());case 172:case 173:case 174:case 175:return void this.jumpIfFalse(256*(3&t)+this.nextByte());case 176:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)+this.stackIntOrFloat(0))||this.sendSpecial(15&t));case 177:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)-this.stackIntOrFloat(0))||this.sendSpecial(15&t));case 178:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)<this.stackIntOrFloat(0))||this.sendSpecial(15&t));case 179:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)>this.stackIntOrFloat(0))||this.sendSpecial(15&t));case 180:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)<=this.stackIntOrFloat(0))||this.sendSpecial(15&t));case 181:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)>=this.stackIntOrFloat(0))||this.sendSpecial(15&t));case 182:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)===this.stackIntOrFloat(0))||this.sendSpecial(15&t));case 183:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)!==this.stackIntOrFloat(0))||this.sendSpecial(15&t));case 184:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)*this.stackIntOrFloat(0))||this.sendSpecial(15&t));case 185:return this.success=!0,void(this.pop2AndPushIntResult(this.quickDivide(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&t));case 186:return this.success=!0,void(this.pop2AndPushIntResult(this.mod(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&t));case 187:return this.success=!0,void(this.primHandler.primitiveMakePoint(1,!0)||this.sendSpecial(15&t));case 188:return this.success=!0,void(this.pop2AndPushIntResult(this.safeShift(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&t));case 189:return this.success=!0,void(this.pop2AndPushIntResult(this.div(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&t));case 190:return this.success=!0,void(this.pop2AndPushIntResult(this.stackInteger(1)&this.stackInteger(0))||this.sendSpecial(15&t));case 191:return this.success=!0,void(this.pop2AndPushIntResult(this.stackInteger(1)|this.stackInteger(0))||this.sendSpecial(15&t));case 192:case 193:case 194:case 195:case 196:case 197:case 198:case 199:case 200:case 201:case 202:case 203:case 204:case 205:case 206:case 207:return void(this.primHandler.quickSendOther(this.receiver,15&t)||this.sendSpecial(16+(15&t)));case 208:case 209:case 210:case 211:case 212:case 213:case 214:case 215:case 216:case 217:case 218:case 219:case 220:case 221:case 222:case 223:return void this.send(this.method.methodGetSelector(15&t),0,!1);case 224:case 225:case 226:case 227:case 228:case 229:case 230:case 231:case 232:case 233:case 234:case 235:case 236:case 237:case 238:case 239:return void this.send(this.method.methodGetSelector(15&t),1,!1);case 240:case 241:case 242:case 243:case 244:case 245:case 246:case 247:case 248:case 249:case 250:case 251:case 252:case 253:case 254:case 255:return void this.send(this.method.methodGetSelector(15&t),2,!1)}throw Error("not a bytecode: "+t)}if(e){if(!this.compiler.enableSingleStepping(this.method))return this.method.compiled=null,this.interpretOne(e);this.breakNow()}this.method.compiled(this)},interpretOneSistaWithExtensions:function(e,t,r){var i,a,s=this.Squeak;switch(this.byteCodeCount++,i=this.nextByte()){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return void this.push(this.receiver.pointers[15&i]);case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:return void this.push(this.method.methodGetLiteral(15&i).pointers[s.Assn_value]);case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:case 61:case 62:case 63:return void this.push(this.method.methodGetLiteral(31&i));case 64:case 65:case 66:case 67:case 68:case 69:case 70:case 71:return void this.push(this.homeContext.pointers[s.Context_tempFrameStart+(7&i)]);case 72:case 73:case 74:case 75:return void this.push(this.homeContext.pointers[s.Context_tempFrameStart+(3&i)+8]);case 76:return void this.push(this.receiver);case 77:return void this.push(this.trueObj);case 78:return void this.push(this.falseObj);case 79:return void this.push(this.nilObj);case 80:return void this.push(0);case 81:return void this.push(1);case 82:return 0==r?void this.push(this.exportThisContext()):void this.nono();case 83:return void this.push(this.top());case 84:case 85:case 86:case 87:return void this.nono();case 88:return void this.doReturn(this.receiver);case 89:return void this.doReturn(this.trueObj);case 90:return void this.doReturn(this.falseObj);case 91:return void this.doReturn(this.nilObj);case 92:return void this.doReturn(this.pop());case 93:return void this.doReturn(this.nilObj,this.activeContext.pointers[s.BlockContext_caller]);case 94:return 0==t?void this.doReturn(this.pop(),this.activeContext.pointers[s.BlockContext_caller]):void this.nono();case 95:return;case 96:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)+this.stackIntOrFloat(0))||this.sendSpecial(15&i));case 97:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)-this.stackIntOrFloat(0))||this.sendSpecial(15&i));case 98:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)<this.stackIntOrFloat(0))||this.sendSpecial(15&i));case 99:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)>this.stackIntOrFloat(0))||this.sendSpecial(15&i));case 100:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)<=this.stackIntOrFloat(0))||this.sendSpecial(15&i));case 101:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)>=this.stackIntOrFloat(0))||this.sendSpecial(15&i));case 102:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)===this.stackIntOrFloat(0))||this.sendSpecial(15&i));case 103:return this.success=!0,void(this.pop2AndPushBoolResult(this.stackIntOrFloat(1)!==this.stackIntOrFloat(0))||this.sendSpecial(15&i));case 104:return this.success=!0,this.resultIsFloat=!1,void(this.pop2AndPushNumResult(this.stackIntOrFloat(1)*this.stackIntOrFloat(0))||this.sendSpecial(15&i));case 105:return this.success=!0,void(this.pop2AndPushIntResult(this.quickDivide(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&i));case 106:return this.success=!0,void(this.pop2AndPushIntResult(this.mod(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&i));case 107:return this.success=!0,void(this.primHandler.primitiveMakePoint(1,!0)||this.sendSpecial(15&i));case 108:return this.success=!0,void(this.pop2AndPushIntResult(this.safeShift(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&i));case 109:return this.success=!0,void(this.pop2AndPushIntResult(this.div(this.stackInteger(1),this.stackInteger(0)))||this.sendSpecial(15&i));case 110:return this.success=!0,void(this.pop2AndPushIntResult(this.stackInteger(1)&this.stackInteger(0))||this.sendSpecial(15&i));case 111:return this.success=!0,void(this.pop2AndPushIntResult(this.stackInteger(1)|this.stackInteger(0))||this.sendSpecial(15&i));case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:case 124:case 125:case 126:case 127:return void(this.primHandler.quickSendOther(this.receiver,15&i)||this.sendSpecial(16+(15&i)));case 128:case 129:case 130:case 131:case 132:case 133:case 134:case 135:case 136:case 137:case 138:case 139:case 140:case 141:case 142:case 143:return void this.send(this.method.methodGetSelector(15&i),0,!1);case 144:case 145:case 146:case 147:case 148:case 149:case 150:case 151:case 152:case 153:case 154:case 155:case 156:case 157:case 158:case 159:return void this.send(this.method.methodGetSelector(15&i),1,!1);case 160:case 161:case 162:case 163:case 164:case 165:case 166:case 167:case 168:case 169:case 170:case 171:case 172:case 173:case 174:case 175:return void this.send(this.method.methodGetSelector(15&i),2,!1);case 176:case 177:case 178:case 179:case 180:case 181:case 182:case 183:return void(this.pc+=1+(7&i));case 184:case 185:case 186:case 187:case 188:case 189:case 190:case 191:return void this.jumpIfTrue(1+(7&i));case 192:case 193:case 194:case 195:case 196:case 197:case 198:case 199:return void this.jumpIfFalse(1+(7&i));case 200:case 201:case 202:case 203:case 204:case 205:case 206:case 207:return this.receiver.dirty=!0,void(this.receiver.pointers[7&i]=this.pop());case 208:case 209:case 210:case 211:case 212:case 213:case 214:case 215:return void(this.homeContext.pointers[s.Context_tempFrameStart+(7&i)]=this.pop());case 216:return void this.pop();case 217:return void this.nono();case 218:case 219:case 220:case 221:case 222:case 223:return void this.nono();case 224:return a=this.nextByte(),void this.interpretOneSistaWithExtensions(e,(t<<8)+a,r);case 225:return a=this.nextByte(),void this.interpretOneSistaWithExtensions(e,t,(r<<8)+(a<128?a:a-256));case 226:return a=this.nextByte(),void this.push(this.receiver.pointers[a+(t<<8)]);case 227:return a=this.nextByte(),void this.push(this.method.methodGetLiteral(a+(t<<8)).pointers[s.Assn_value]);case 228:return a=this.nextByte(),void this.push(this.method.methodGetLiteral(a+(t<<8)));case 229:return a=this.nextByte(),void this.push(this.homeContext.pointers[s.Context_tempFrameStart+a]);case 230:return void this.nono();case 231:return void this.pushNewArray(this.nextByte());case 232:return a=this.nextByte(),void this.push(a+(r<<8));case 233:return a=this.nextByte(),void this.push(this.image.getCharacter(a+(r<<8)));case 234:return a=this.nextByte(),void this.send(this.method.methodGetSelector((a>>3)+(t<<5)),(7&a)+(r<<3),!1);case 235:a=this.nextByte();var n=this.method.methodGetSelector((a>>3)+(t<<5));return 64<=r?void this.sendSuperDirected(n,(7&a)+((63&r)<<3)):void this.send(n,(7&a)+(r<<3),!0);case 236:return void this.nono();case 237:var o=this.nextByte()+(r<<8);return this.pc+=o,void(o<0&&this.interruptCheckCounter--<=0&&this.checkForInterrupts());case 238:return void this.jumpIfTrue(this.nextByte()+(r<<8));case 239:return void this.jumpIfFalse(this.nextByte()+(r<<8));case 240:return this.receiver.dirty=!0,void(this.receiver.pointers[this.nextByte()+(t<<8)]=this.pop());case 241:return(u=this.method.methodGetLiteral(this.nextByte()+(t<<8))).dirty=!0,void(u.pointers[s.Assn_value]=this.pop());case 242:return void(this.homeContext.pointers[s.Context_tempFrameStart+this.nextByte()]=this.pop());case 243:return this.receiver.dirty=!0,void(this.receiver.pointers[this.nextByte()+(t<<8)]=this.top());case 244:var u;return(u=this.method.methodGetLiteral(this.nextByte()+(t<<8))).dirty=!0,void(u.pointers[s.Assn_value]=this.top());case 245:return void(this.homeContext.pointers[s.Context_tempFrameStart+this.nextByte()]=this.top());case 246:case 247:return void this.nono();case 248:return void this.callPrimBytecode(245);case 249:return void this.pushFullClosure(t);case 250:return void this.pushClosureCopyExtended(t,r);case 251:return a=this.nextByte(),void this.push(this.homeContext.pointers[s.Context_tempFrameStart+this.nextByte()].pointers[a]);case 252:return a=this.nextByte(),void(this.homeContext.pointers[s.Context_tempFrameStart+this.nextByte()].pointers[a]=this.top());case 253:return a=this.nextByte(),void(this.homeContext.pointers[s.Context_tempFrameStart+this.nextByte()].pointers[a]=this.pop());case 254:case 255:return void this.nono()}throw Error("not a bytecode: "+i)},interpret:function(e,t){if(this.frozen)return"frozen";for(this.isIdle=!1,this.breakOutOfInterpreter=!1,this.breakAfter(e||500);!1===this.breakOutOfInterpreter;)this.method.compiled?this.method.compiled(this):this.interpretOne();if("function"==typeof this.breakOutOfInterpreter)return this.breakOutOfInterpreter(t);var r="break"==this.breakOutOfInterpreter?"break":this.isIdle?this.nextWakeupTick?Math.max(1,this.nextWakeupTick-this.primHandler.millisecondClockValue()):"sleep":0;return t&&t(r),r},goIdle:function(){var e=0!==this.nextWakeupTick;this.forceInterruptCheck(),this.checkForInterrupts();var t=0!==this.nextWakeupTick;this.isIdle=t||!e,this.breakOut()},freeze:function(e){var t;this.frozen=!0,this.breakOutOfInterpreter=function(e){if(!e)throw Error("need function to restart interpreter");return t=e,"frozen"}.bind(this);var r=function(){if(this.frozen=!1,!t)throw Error("no continue function");t(0)}.bind(this);return e&&self.setTimeout(function(){e(r)},0),r},breakOut:function(){this.breakOutOfInterpreter=this.breakOutOfInterpreter||!0},nextByte:function(){return this.method.bytes[this.pc++]},nono:function(){throw Error("Oh No!")},forceInterruptCheck:function(){this.interruptCheckCounter=-1e3},checkForInterrupts:function(){var e=this.primHandler.millisecondClockValue();e<this.lastTick&&(this.nextPollTick=e+(this.nextPollTick-this.lastTick),this.breakOutTick=e+(this.breakOutTick-this.lastTick),0!==this.nextWakeupTick&&(this.nextWakeupTick=e+(this.nextWakeupTick-this.lastTick))),-100<this.interruptCheckCounter&&(e-this.lastTick<this.interruptChecksEveryNms?this.interruptCheckCounterFeedBackReset+=10:this.interruptCheckCounterFeedBackReset<=1e3?this.interruptCheckCounterFeedBackReset=1e3:this.interruptCheckCounterFeedBackReset-=12),this.interruptCheckCounter=this.interruptCheckCounterFeedBackReset,this.lastTick=e,this.signalLowSpace&&(this.signalLowSpace=!1,(t=this.specialObjects[Squeak.splOb_TheLowSpaceSemaphore]).isNil||this.primHandler.synchronousSignal(t));this.interruptPending&&(this.interruptPending=!1,(t=this.specialObjects[Squeak.splOb_TheInterruptSemaphore]).isNil||this.primHandler.synchronousSignal(t));0!==this.nextWakeupTick&&e>=this.nextWakeupTick&&(this.nextWakeupTick=0,(t=this.specialObjects[Squeak.splOb_TheTimerSemaphore]).isNil||this.primHandler.synchronousSignal(t));if(0<this.pendingFinalizationSignals){var t=this.specialObjects[Squeak.splOb_TheFinalizationSemaphore];this.pendingFinalizationSignals=0,t.isNil||this.primHandler.synchronousSignal(t)}0<this.primHandler.semaphoresToSignal.length&&this.primHandler.signalExternalSemaphores(),!this.method.compiled&&this.compiler&&this.compiler.compile(this.method),e>=this.breakOutTick&&this.breakOut()},extendedPush:function(e){var t=63&e;switch(e>>6){case 0:this.push(this.receiver.pointers[t]);break;case 1:this.push(this.homeContext.pointers[Squeak.Context_tempFrameStart+t]);break;case 2:this.push(this.method.methodGetLiteral(t));break;case 3:this.push(this.method.methodGetLiteral(t).pointers[Squeak.Assn_value])}},extendedStore:function(e){var t=63&e;switch(e>>6){case 0:this.receiver.dirty=!0,this.receiver.pointers[t]=this.top();break;case 1:this.homeContext.pointers[Squeak.Context_tempFrameStart+t]=this.top();break;case 2:this.nono();break;case 3:var r=this.method.methodGetLiteral(t);r.dirty=!0,r.pointers[Squeak.Assn_value]=this.top()}},extendedStorePop:function(e){var t=63&e;switch(e>>6){case 0:this.receiver.dirty=!0,this.receiver.pointers[t]=this.pop();break;case 1:this.homeContext.pointers[Squeak.Context_tempFrameStart+t]=this.pop();break;case 2:this.nono();break;case 3:var r=this.method.methodGetLiteral(t);r.dirty=!0,r.pointers[Squeak.Assn_value]=this.pop()}},doubleExtendedDoAnything:function(e){var t=this.nextByte();switch(e>>5){case 0:this.send(this.method.methodGetSelector(t),31&e,!1);break;case 1:this.send(this.method.methodGetSelector(t),31&e,!0);break;case 2:this.push(this.receiver.pointers[t]);break;case 3:this.push(this.method.methodGetLiteral(t));break;case 4:this.push(this.method.methodGetLiteral(t).pointers[Squeak.Assn_value]);break;case 5:this.receiver.dirty=!0,this.receiver.pointers[t]=this.top();break;case 6:this.receiver.dirty=!0,this.receiver.pointers[t]=this.pop();break;case 7:var r=this.method.methodGetLiteral(t);r.dirty=!0,r.pointers[Squeak.Assn_value]=this.top()}},jumpIfTrue:function(e){var t=this.pop();t.isTrue?this.pc+=e:t.isFalse||(this.push(t),this.send(this.specialObjects[Squeak.splOb_SelectorMustBeBoolean],0,!1))},jumpIfFalse:function(e){var t=this.pop();t.isFalse?this.pc+=e:t.isTrue||(this.push(t),this.send(this.specialObjects[Squeak.splOb_SelectorMustBeBoolean],0,!1))},sendSpecial:function(e){this.send(this.specialSelectors[2*e],this.specialSelectors[2*e+1],!1)},callPrimBytecode:function(e){this.pc+=2,this.primFailCode&&(this.method.bytes[this.pc]===e&&this.stackTopPut(this.getErrorObjectFromPrimFailCode()),this.primFailCode=0)},getErrorObjectFromPrimFailCode:function(){var e=this.specialObjects[Squeak.splOb_PrimErrTableIndex];if(e&&e.pointers){var t=e.pointers[this.primFailCode-1];if(t)return t}return this.primFailCode}},"closures",{pushNewArray:function(e){var t=127<e,r=127&e,i=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassArray],r);if(t){for(var a=0;a<r;a++)i.pointers[a]=this.stackValue(r-a-1);this.popN(r)}this.push(i)},pushClosureCopy:function(){var e=this.nextByte(),t=15&e,r=e>>4,i=256*this.nextByte()+this.nextByte(),a=this.encodeSqueakPC(this.pc,this.method),s=this.newClosure(t,a,r);if(s.pointers[Squeak.Closure_outerContext]=this.activeContext,(this.reclaimableContextCount=0)<r){for(var n=0;n<r;n++)s.pointers[Squeak.Closure_firstCopiedValue+n]=this.stackValue(r-n-1);this.popN(r)}this.pc+=i,this.push(s)},pushClosureCopyExtended:function(e,t){var r=this.nextByte(),i=this.nextByte(),a=(7&r)+8*this.mod(e,16),s=(r>>3&7)+8*this.div(e,16),n=i+(t<<8),o=this.encodeSqueakPC(this.pc,this.method),u=this.newClosure(a,o,s);if(u.pointers[Squeak.Closure_outerContext]=this.activeContext,(this.reclaimableContextCount=0)<s){for(var l=0;l<s;l++)u.pointers[Squeak.Closure_firstCopiedValue+l]=this.stackValue(s-l-1);this.popN(s)}this.pc+=n,this.push(u)},pushFullClosure:function(e){var t,r=this.nextByte(),i=this.nextByte(),a=r+(e<<8),s=63&i;t=1==(i>>6&1)?this.vm.nilObj:this.activeContext;var n=this.method.methodGetLiteral(a),o=this.newFullClosure(t,s,n);if(1==(i>>7&1))throw Error("on-stack receiver not yet supported");if(o.pointers[Squeak.ClosureFull_receiver]=this.receiver,(this.reclaimableContextCount=0)<s){for(var u=0;u<s;u++)o.pointers[Squeak.ClosureFull_firstCopiedValue+u]=this.stackValue(s-u-1);this.popN(s)}this.push(o)},newClosure:function(e,t,r){var i=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassBlockClosure],r);return i.pointers[Squeak.Closure_startpc]=t,i.pointers[Squeak.Closure_numArgs]=e,i},newFullClosure:function(e,t,r){var i=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassFullBlockClosure],t);return i.pointers[Squeak.Closure_outerContext]=e,i.pointers[Squeak.ClosureFull_method]=r,i.pointers[Squeak.Closure_numArgs]=r.methodNumArgs(),i}},"sending",{send:function(e,t,r){var i,a=this.stackValue(t);i=r?(i=this.method.methodClassForSuper()).pointers[Squeak.Class_superclass]:this.getClass(a);var s=this.findSelectorInClass(e,t,i);s.primIndex&&(this.verifyAtSelector=e,this.verifyAtClass=i),this.executeNewMethod(a,s.method,s.argCount,s.primIndex,s.mClass,e)},sendSuperDirected:function(e,t){var r=this.pop().pointers[Squeak.Class_superclass],i=this.stackValue(t),a=this.findSelectorInClass(e,t,r);a.primIndex&&(this.verifyAtSelector=e,this.verifyAtClass=r),this.executeNewMethod(i,a.method,a.argCount,a.primIndex,a.mClass,e)},sendAsPrimitiveFailure:function(e,t,r){this.executeNewMethod(e,t,r,0)},findSelectorInClass:function(e,t,r){this.currentSelector=e;var i=this.findMethodCacheEntry(e,r);if(i.method)return i;for(var a,s=r;!s.isNil;){if((a=s.pointers[Squeak.Class_mdict]).isNil){var n=this.specialObjects[Squeak.splOb_SelectorCannotInterpret],o=this.createActualMessage(e,t,r);return this.popNandPush(t,o),this.findSelectorInClass(n,1,s.superclass())}var u=this.lookupSelectorInDict(a,e);if(!u.isNil)return i.method=u,i.primIndex=u.isMethod()?u.methodPrimitiveIndex():576,i.argCount=t,i.mClass=s,i;s=s.superclass()}var l=this.specialObjects[Squeak.splOb_SelectorDoesNotUnderstand];if(e===l)throw Error("Recursive not understood error encountered");var c=this.createActualMessage(e,t,r);return this.popNandPush(t,c),this.findSelectorInClass(l,1,r)},lookupSelectorInDict:function(e,t){for(var r=e.pointersSize(),i=(r-Squeak.MethodDict_selectorStart-1&t.hash)+Squeak.MethodDict_selectorStart,a=!1;;){var s=e.pointers[i];if(s===t)return e.pointers[Squeak.MethodDict_array].pointers[i-Squeak.MethodDict_selectorStart];if(s.isNil)return this.nilObj;if(++i===r){if(a)return this.nilObj;i=Squeak.MethodDict_selectorStart,a=!0}}},executeNewMethod:function(e,t,r,i,a,s){if(this.sendCount++,t===this.breakOnMethod&&this.breakNow("executing method "+this.printMethod(t,a,s)),this.logSends){for(var n=" ",o=this.activeContext;!o.isNil;)n+="| ",o=o.pointers[Squeak.Context_sender];var u=this.activeContext.pointers.slice(this.sp+1-r,this.sp+1);console.log(this.sendCount+n+this.printMethod(t,a,s,u))}if(this.breakOnContextChanged&&(this.breakOnContextChanged=!1,this.breakNow()),!(0<i&&this.tryPrimitive(i,r,t))){var l=this.allocateOrRecycleContext(t.methodNeedsLargeFrame()),c=t.methodTempCount(),h=Squeak.Context_tempFrameStart+c-1;if(l.pointers[Squeak.Context_method]=t,l.pointers[Squeak.BlockContext_initialIP]=this.nilObj,l.pointers[Squeak.Context_sender]=this.activeContext,this.arrayCopy(this.activeContext.pointers,this.sp-r,l.pointers,Squeak.Context_tempFrameStart-1,r+1),this.arrayFill(l.pointers,Squeak.Context_tempFrameStart+r,Squeak.Context_tempFrameStart+c,this.nilObj),this.popN(r+1),this.reclaimableContextCount++,this.storeContextRegisters(),this.activeContext=l,this.activeContext.dirty=!0,this.homeContext=l,this.method=t,this.pc=0,this.sp=h,this.receiver=l.pointers[Squeak.Context_receiver],this.receiver!==e)throw Error("receivers don't match");!t.compiled&&this.compiler&&this.compiler.compile(t,a,s),this.interruptCheckCounter--<=0&&this.checkForInterrupts()}},doReturn:function(e,t){if(!t){var r=this.homeContext;if(this.hasClosures)for(var i;!(i=r.pointers[Squeak.Context_closure]).isNil;)r=i.pointers[Squeak.Closure_outerContext];t=r.pointers[Squeak.Context_sender]}if(t.isNil||t.pointers[Squeak.Context_instructionPointer].isNil)return this.cannotReturn(e);for(var a,s=this.activeContext.pointers[Squeak.Context_sender];s!==t;){if(s.isNil)return this.cannotReturn(e);if(this.isUnwindMarked(s))return this.aboutToReturnThrough(e,s);s=s.pointers[Squeak.Context_sender]}for(s=this.activeContext;s!==t;)this.breakOnContextReturned===s&&(this.breakOnContextReturned=null,this.breakNow()),a=s.pointers[Squeak.Context_sender],s.pointers[Squeak.Context_sender]=this.nilObj,s.pointers[Squeak.Context_instructionPointer]=this.nilObj,0<this.reclaimableContextCount&&(this.reclaimableContextCount--,this.recycleIfPossible(s)),s=a;this.activeContext=s,this.activeContext.dirty=!0,this.fetchContextRegisters(this.activeContext),this.push(e),this.breakOnContextChanged&&(this.breakOnContextChanged=!1,this.breakNow())},aboutToReturnThrough:function(e,t){this.push(this.exportThisContext()),this.push(e),this.push(t);var r=this.specialObjects[Squeak.splOb_SelectorAboutToReturn];this.send(r,2)},cannotReturn:function(e){this.push(this.exportThisContext()),this.push(e);var t=this.specialObjects[Squeak.splOb_SelectorCannotReturn];this.send(t,1)},tryPrimitive:function(e,t,r){if(255<e&&e<520){if(264<=e)return this.popNandPush(1,this.top().pointers[e-264]),!0;switch(e){case 256:return!0;case 257:return this.popNandPush(1,this.trueObj),!0;case 258:return this.popNandPush(1,this.falseObj),!0;case 259:return this.popNandPush(1,this.nilObj),!0}return this.popNandPush(1,e-261),!0}var i=this.sp,a=this.activeContext,s=this.primHandler.doPrimitive(e,t,r);return s&&this.sp!==i-t&&a===this.activeContext&&117!==e&&!this.frozen&&this.warnOnce("stack unbalanced after primitive "+e,"error"),s},createActualMessage:function(e,t,r){var i=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassMessage],0),a=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassArray],t);return this.arrayCopy(this.activeContext.pointers,this.sp-t+1,a.pointers,0,t),i.pointers[Squeak.Message_selector]=e,i.pointers[Squeak.Message_arguments]=a,i.pointers.length>Squeak.Message_lookupClass&&(i.pointers[Squeak.Message_lookupClass]=r),i},primitivePerform:function(e){var t=this.stackValue(e-1),r=this.stackValue(e),i=e-1,a=this.sp-i,s=this.activeContext.pointers;this.arrayCopy(s,1+a,s,a,i),this.sp--;var n=this.findSelectorInClass(t,i,this.getClass(r));return this.executeNewMethod(r,n.method,n.argCount,n.primIndex,n.mClass,t),!0},primitivePerformWithArgs:function(e,t){var r=t?3:2,i=this.stackValue(r),a=this.stackValue(r-1),s=this.stackValue(r-2);if(s.sqClass!==this.specialObjects[Squeak.splOb_ClassArray])return!1;var n=t?this.top():this.getClass(i);if(t)for(var o=this.getClass(i);o!==n;)if((o=o.pointers[Squeak.Class_superclass]).isNil)return!1;var u=s.pointersSize(),l=this.sp-(r-1),c=this.activeContext.pointers;this.arrayCopy(s.pointers,0,c,l,u),this.sp+=u-e;var h=this.findSelectorInClass(a,u,n);return this.executeNewMethod(i,h.method,h.argCount,h.primIndex,h.mClass,a),!0},primitiveInvokeObjectAsMethod:function(e,t){for(var r=this.instantiateClass(this.specialObjects[Squeak.splOb_ClassArray],e),i=0;i<e;i++)r.pointers[e-i-1]=this.pop();var a=this.pop(),s=this.currentSelector,n=this.specialObjects[Squeak.splOb_SelectorRunWithIn];return this.push(t),this.push(s),this.push(r),this.push(a),this.send(n,3,!1),!0},findMethodCacheEntry:function(e,t){var r;this.methodCacheRandomish=this.methodCacheRandomish+1&3;for(var i=(e.hash^t.hash)&this.methodCacheMask,a=i,s=0;s<4;s++){if((r=this.methodCache[a]).selector===e&&r.lkupClass===t)return r;s===this.methodCacheRandomish&&(i=a),a=a+e.hash&this.methodCacheMask}return(r=this.methodCache[i]).lkupClass=t,r.selector=e,r.method=null,r},flushMethodCache:function(){for(var e=0;e<this.methodCacheSize;e++)this.methodCache[e].selector=null,this.methodCache[e].method=null;return!0},flushMethodCacheForSelector:function(e){for(var t=0;t<this.methodCacheSize;t++)this.methodCache[t].selector===e&&(this.methodCache[t].selector=null,this.methodCache[t].method=null);return!0},flushMethodCacheForMethod:function(e){for(var t=0;t<this.methodCacheSize;t++)this.methodCache[t].method===e&&(this.methodCache[t].selector=null,this.methodCache[t].method=null);return!0},flushMethodCacheAfterBecome:function(e){this.flushMethodCache()}},"contexts",{isUnwindMarked:function(e){return!!this.isMethodContext(e)&&198==e.pointers[Squeak.Context_method].methodPrimitiveIndex()},newActiveContext:function(e){this.storeContextRegisters(),this.activeContext=e,this.activeContext.dirty=!0,this.fetchContextRegisters(e),this.breakOnContextChanged&&(this.breakOnContextChanged=!1,this.breakNow())},exportThisContext:function(){return this.storeContextRegisters(),this.reclaimableContextCount=0,this.activeContext},fetchContextRegisters:function(e){var t=e.pointers[Squeak.Context_method];this.isSmallInt(t)?(this.homeContext=e.pointers[Squeak.BlockContext_home],t=this.homeContext.pointers[Squeak.Context_method]):this.homeContext=e,this.receiver=this.homeContext.pointers[Squeak.Context_receiver],this.method=t,this.pc=this.decodeSqueakPC(e.pointers[Squeak.Context_instructionPointer],t),this.sp=this.decodeSqueakSP(e.pointers[Squeak.Context_stackPointer])},storeContextRegisters:function(){this.activeContext.pointers[Squeak.Context_instructionPointer]=this.encodeSqueakPC(this.pc,this.method),this.activeContext.pointers[Squeak.Context_stackPointer]=this.encodeSqueakSP(this.sp)},encodeSqueakPC:function(e,t){return e+4*t.pointers.length+1},decodeSqueakPC:function(e,t){return e-4*t.pointers.length-1},encodeSqueakSP:function(e){return e-(Squeak.Context_tempFrameStart-1)},decodeSqueakSP:function(e){return e+(Squeak.Context_tempFrameStart-1)},recycleIfPossible:function(e){if(this.isMethodContext(e))if(e.pointersSize()===Squeak.Context_tempFrameStart+Squeak.Context_smallFrameSize)e.pointers[0]=this.freeContexts,this.freeContexts=e;else{if(e.pointersSize()!==Squeak.Context_tempFrameStart+Squeak.Context_largeFrameSize)return;e.pointers[0]=this.freeLargeContexts,this.freeLargeContexts=e}},allocateOrRecycleContext:function(e){var t;return e?this.freeLargeContexts.isNil?(this.nAllocatedContexts++,this.instantiateClass(this.specialObjects[Squeak.splOb_ClassMethodContext],Squeak.Context_largeFrameSize)):(t=this.freeLargeContexts,this.freeLargeContexts=t.pointers[0],this.nRecycledContexts++,t):this.freeContexts.isNil?(this.nAllocatedContexts++,this.instantiateClass(this.specialObjects[Squeak.splOb_ClassMethodContext],Squeak.Context_smallFrameSize)):(t=this.freeContexts,this.freeContexts=t.pointers[0],this.nRecycledContexts++,t)}},"stack access",{pop:function(){return this.activeContext.pointers[this.sp--]},popN:function(e){this.sp-=e},push:function(e){this.activeContext.pointers[++this.sp]=e},popNandPush:function(e,t){this.activeContext.pointers[this.sp-=e-1]=t},top:function(){return this.activeContext.pointers[this.sp]},stackTopPut:function(e){this.activeContext.pointers[this.sp]=e},stackValue:function(e){return this.activeContext.pointers[this.sp-e]},stackInteger:function(e){return this.checkSmallInt(this.stackValue(e))},stackIntOrFloat:function(e){var t=this.stackValue(e);if("number"==typeof t)return t;if(void 0===t)return this.success=!1,0;if(t.isFloat)return this.resultIsFloat=!0,t.float;var r=t.bytes;if(r&&4==r.length){for(var i=0,a=3;0<=a;a--)i=256*i+r[a];if(t.sqClass===this.specialObjects[Squeak.splOb_ClassLargePositiveInteger])return i;if(t.sqClass===this.specialObjects[Squeak.splOb_ClassLargeNegativeInteger])return-i}return this.success=!1,0},pop2AndPushIntResult:function(e){return!(!this.success||!this.canBeSmallInt(e))&&(this.popNandPush(2,e),!0)},pop2AndPushNumResult:function(e){if(this.success){if(this.resultIsFloat)return this.popNandPush(2,this.primHandler.makeFloat(e)),!0;if(e>=Squeak.MinSmallInt&&e<=Squeak.MaxSmallInt)return this.popNandPush(2,e),!0;if(-4294967295<=e&&e<=4294967295){var t=e<0,r=t?-e:e,i=t?Squeak.splOb_ClassLargeNegativeInteger:Squeak.splOb_ClassLargePositiveInteger,a=this.instantiateClass(this.specialObjects[i],4),s=a.bytes;return s[0]=255&r,s[1]=r>>8&255,s[2]=r>>16&255,s[3]=r>>24&255,this.popNandPush(2,a),!0}}return!1},pop2AndPushBoolResult:function(e){return!!this.success&&(this.popNandPush(2,e?this.trueObj:this.falseObj),!0)}},"numbers",{getClass:function(e){return this.isSmallInt(e)?this.specialObjects[Squeak.splOb_ClassInteger]:e.sqClass},canBeSmallInt:function(e){return e>=Squeak.MinSmallInt&&e<=Squeak.MaxSmallInt},isSmallInt:function(e){return"number"==typeof e},checkSmallInt:function(e){return"number"==typeof e?e:(this.success=!1,1)},quickDivide:function(e,t){if(0===t)return Squeak.NonSmallInt;var r=e/t|0;return r*t===e?r:Squeak.NonSmallInt},div:function(e,t){return 0===t?Squeak.NonSmallInt:Math.floor(e/t)},mod:function(e,t){return 0===t?Squeak.NonSmallInt:e-Math.floor(e/t)*t},safeShift:function(e,t){if(t<0)return t<-31?e<0?-1:0:e>>-t;if(31<t)return 0==e?0:Squeak.NonSmallInt;var r=e<<t;return r>>t===e?r:Squeak.NonSmallInt}},"utils",{isContext:function(e){return e.sqClass===this.specialObjects[Squeak.splOb_ClassMethodContext]||e.sqClass===this.specialObjects[Squeak.splOb_ClassBlockContext]},isMethodContext:function(e){return e.sqClass===this.specialObjects[Squeak.splOb_ClassMethodContext]},instantiateClass:function(e,t){return this.image.instantiateClass(e,t,this.nilObj)},arrayFill:function(e,t,r,i){for(var a=t;a<r;a++)e[a]=i},arrayCopy:function(e,t,r,i,a){if(e===r&&t<i)for(var s=a-1;0<=s;s--)r[i+s]=e[t+s];else for(s=0;s<a;s++)r[i+s]=e[t+s]},signalLowSpaceIfNecessary:function(e){if(e<this.lowSpaceThreshold&&0<this.lowSpaceThreshold){var t=prompt&&prompt("Out of memory, "+Math.ceil(this.image.totalMemory/1e6)+" MB used.\nEnter additional MB, or 0 to signal low space in image","0");if(t){var r=1e6*parseInt(t,10);this.image.totalMemory+=r,this.signalLowSpaceIfNecessary(this.image.bytesLeft())}else{console.warn("squeak: low memory ("+e+"/"+this.image.totalMemory+" bytes left), signaling low space"),this.signalLowSpace=!0,this.lowSpaceThreshold=0,this.specialObjects[Squeak.splOb_ProcessSignalingLowSpace].isNil&&(this.specialObjects[Squeak.splOb_ProcessSignalingLowSpace]=this.primHandler.activeProcess()),this.forceInterruptCheck()}}}},"debugging",{addMessage:function(e){return this.messages[e]?++this.messages[e]:this.messages[e]=1},warnOnce:function(e,t){if(1==this.addMessage(e))return console[t||"warn"](e),!0},printMethod:function(i,e,t,r){if(i.sqClass!=this.specialObjects[Squeak.splOb_ClassCompiledMethod])return this.printMethod(i.blockOuterCode(),e,t,r);var a;if(t){var s=e.className()+">>",n=t.bytesAsString();if(r&&r.length)for(var o=n.split(/(?<=:)/),u=0;u<r.length;u++)0<u&&(s+=" "),s+=o[u]+" "+r[u];else s+=n;return s}return i=i||this.activeContext.contextMethod(),this.allMethodsDo(function(e,t,r){if(t===i)return a=e.className()+">>"+r.bytesAsString()}),a||(e?"("+e.pointers[Squeak.Context_receiver]+")>>?":"?>>?")},allInstancesOf:function(e,t){"string"==typeof e&&(e=this.globalNamed(e));for(var r=[],i=this.image.someInstanceOf(e);i;)t?t(i):r.push(i),i=this.image.nextInstanceAfter(i);return r},globalNamed:function(r){return this.allGlobalsDo(function(e,t){if(e.bytesAsString()===r)return t})},allGlobalsDo:function(e){for(var t=this.getGlobals(),r=0;r<t.length;r++){var i=t[r];if(!i.isNil){var a=e(i.pointers[0],i.pointers[1]);if(a)return a}}},allMethodsDo:function(h){this.allGlobalsDo(function(e,t){if(t.pointers&&9<=t.pointers.length)for(var r=[t,t.sqClass],i=0;i<r.length;i++){var a=r[i],s=a.pointers[1];if(s.pointers&&s.pointers[1]){var n=s.pointers[1].pointers;if(n){var o=s.pointers;if(n.length+2===o.length)for(var u=0;u<n.length;u++){var l=n[u],c=o[2+u];if(l.isMethod&&l.isMethod())if(c.bytesSize&&c.bytesSize())if(h.call(null,a,l,c))return!0}}}}})},printStack:function(e,t,r){"number"==typeof e&&(t=e,e=null),e=e||this.activeContext,t=t||100;for(var i=[],a=Math.max(t,1e6);!e.isNil&&0<a--;)i.push(e),e=e.pointers[Squeak.Context_sender];i.length>t+200&&(e.isNil||i.push("..."),i=i.slice(0,t).concat(["..."]).concat(i.slice(-200)));var s=[],n=i.length,o="";for(r&&this.logSends&&(o=Array((""+this.sendCount).length+2).join(" "));0<n--;){if((e=i[n]).pointers){var u="",l=e.pointers[Squeak.Context_method];"number"==typeof l?(l=e.pointers[Squeak.BlockContext_home].pointers[Squeak.Context_method],u="[] in "):e.pointers[Squeak.Context_closure].isNil||(u="[] in ");var c=u+this.printMethod(l,e);r&&(c=o+c),s.push(c+"\n"),r&&(o+=r)}else s.push("...\n")}return s.join("")},findMethod:function(e){var i,a=e.split(">>")[0],s=e.split(">>")[1];return this.allMethodsDo(function(e,t,r){if(s.length==r.bytesSize()&&s==r.bytesAsString()&&a==e.className())return i=t}),i},breakAfter:function(e){this.breakOutTick=this.primHandler.millisecondClockValue()+e},breakNow:function(e){e&&console.log("Break: "+e),this.breakOutOfInterpreter="break"},breakOn:function(e){return this.breakOnMethod=e&&this.findMethod(e)},breakOnReturnFromThisContext:function(){this.breakOnContextChanged=!1,this.breakOnContextReturned=this.activeContext},breakOnSendOrReturn:function(){this.breakOnContextChanged=!0,this.breakOnContextReturned=null},printContext:function(e,r){if(!this.isContext(e))return"NOT A CONTEXT: "+t(e);function t(e){var t="number"==typeof e||"object"==typeof e?e.sqInstName():"<"+e+">";return(t=JSON.stringify(t).slice(1,-1)).length>r-3&&(t=t.slice(0,r-3)+"..."),t}r=r||72;for(var i="number"==typeof e.pointers[Squeak.BlockContext_argumentCount],a=e.pointers[Squeak.Context_closure],s=!i&&!a.isNil,n=i?e.pointers[Squeak.BlockContext_home]:e,o=s?a.pointers[Squeak.Closure_numArgs]:n.pointers[Squeak.Context_method].methodTempCount(),u=this.decodeSqueakSP(0),l=n.contextSizeWithStack(this)-1,c=u+1,h=c+o-1,f=c+n.pointers[Squeak.Context_method].methodNumArgs()-1,p="",d=u;d<=l;d++){var m="";d===u?m="=rcvr":(d<=h&&(m="=tmp"+(d-c)),d<=f&&(m+="/arg"+(d-c))),p+="\nctx["+d+"]"+m+": "+t(n.pointers[d])}if(i){p+="\n";var b=e.pointers[Squeak.BlockContext_argumentCount],v=this.decodeSqueakSP(1),g=(f=v+b,e===this.activeContext?this.sp:e.pointers[Squeak.Context_stackPointer]);g<v&&(p+="\nblk <stack empty>");for(d=v;d<=g;d++){m="";d<f&&(m="=arg"+(d-v)),p+="\nblk["+d+"]"+m+": "+t(e.pointers[d])}}return p},printActiveContext:function(e){return this.printContext(this.activeContext,e)},printAllProcesses:function(){for(var e=this.specialObjects[Squeak.splOb_SchedulerAssociation].pointers[Squeak.Assn_value],t=e.pointers[Squeak.ProcSched_activeProcess],r="Active: "+this.printProcess(t,!0),i=e.pointers[Squeak.ProcSched_processLists].pointers,a=i.length-1;0<=a;a--)for(var s=i[a].pointers[Squeak.LinkedList_firstLink];!s.isNil;)r+="\n------------------------------------------",r+="\nRunnable: "+this.printProcess(s),s=s.pointers[Squeak.Link_nextLink];for(var n=this.specialObjects[Squeak.splOb_ClassSemaphore],o=this.image.someInstanceOf(n),u=[];o;){for(s=o.pointers[Squeak.LinkedList_firstLink];!s.isNil;)u.push(s),s=s.pointers[Squeak.Link_nextLink];o=this.image.nextInstanceAfter(o)}u.sort(function(e,t){return t.pointers[Squeak.Proc_priority]-e.pointers[Squeak.Proc_priority]});for(var l=0;l<u.length;l++)r+="\n------------------------------------------",r+="\nWaiting: "+this.printProcess(u[l]);return r},printProcess:function(e,t,r){e||(e=this.specialObjects[Squeak.splOb_SchedulerAssociation].pointers[Squeak.Assn_value].pointers[Squeak.ProcSched_activeProcess],t=!0);var i=t?this.activeContext:e.pointers[Squeak.Proc_suspendedContext],a=e.pointers[Squeak.Proc_priority],s=this.printStack(i,20,r),n=r&&this.logSends?"":this.printContext(i)+"\n";return e.toString()+" at priority "+a+"\n"+s+n},printByteCodes:function(e,t,r,i){return e=e||this.method,new Squeak.InstructionPrinter(e,this).printInstructions(t,r,i)},logStack:function(){console.log(this.printStack()+this.printActiveContext()+"\n\n"+this.printByteCodes(this.method,"","=> ",this.pc),this.activeContext.pointers.slice(0,this.sp+1))},willSendOrReturn:function(){var e=this.method.bytes[this.pc];if(this.method.methodSignFlag()){if(96<=e&&e<=127)r=this.specialSelectors[2*(e-96)];else if(128<=e&&e<=175)r=this.method.methodGetSelector(15&e);else if(234==e||235==e)this.method.methodGetSelector(this.method.bytes[this.pc+1]>>3);else if(88<=e&&e<=94)return!0}else{if(120<=e&&e<=125)return!0;if(e<131||200==e)return!1;if(176<=e)return!0;if(e<=134){var t;if(132===e){if(1<this.method.bytes[this.pc+1]>>5)return!1;t=this.method.bytes[this.pc+2]}else t=this.method.bytes[this.pc+1]&(134===e?63:31);var r=this.method.methodGetLiteral(t);if("blockCopy:"!==r.bytesAsString())return!0}}return!1},nextSendSelector:function(){var e,t=this.method.bytes[this.pc];if(this.method.methodSignFlag())if(96<=t&&t<=127)e=this.specialSelectors[2*(t-96)];else if(128<=t&&t<=175)e=this.method.methodGetSelector(15&t);else{if(234!=t&&235!=t)return null;this.method.methodGetSelector(this.method.bytes[this.pc+1]>>3)}else{if(t<131||200==t)return null;if(208<=t)e=this.method.methodGetLiteral(15&t);else if(176<=t)e=this.specialSelectors[2*(t-176)];else if(t<=134){var r;if(132===t){if(1<this.method.bytes[this.pc+1]>>5)return null;r=this.method.bytes[this.pc+2]}else r=this.method.bytes[this.pc+1]&(134===t?63:31);e=this.method.methodGetLiteral(r)}}if(e){var i=e.bytesAsString();if("blockCopy:"!==i)return i}}}),Object.subclass("Squeak.InterpreterProxy","initialization",{VM_PROXY_MAJOR:1,VM_PROXY_MINOR:11,initialize:function(t){this.vm=t,this.remappableOops=[],Object.defineProperty(this,"successFlag",{get:function(){return t.primHandler.success},set:function(e){t.primHandler.success=e}})},majorVersion:function(){return this.VM_PROXY_MAJOR},minorVersion:function(){return this.VM_PROXY_MINOR}},"success",{failed:function(){return!this.successFlag},primitiveFail:function(){this.successFlag=!1},primitiveFailFor:function(e){this.successFlag=!1},success:function(e){e||(this.successFlag=!1)}},"stack access",{pop:function(e){this.vm.popN(e)},popthenPush:function(e,t){this.vm.popNandPush(e,t)},push:function(e){this.vm.push(e)},pushBool:function(e){this.vm.push(e?this.vm.trueObj:this.vm.falseObj)},pushInteger:function(e){this.vm.push(e)},pushFloat:function(e){this.vm.push(this.floatObjectOf(e))},stackValue:function(e){return this.vm.stackValue(e)},stackIntegerValue:function(e){var t=this.vm.stackValue(e);return"number"==typeof t?t:(this.successFlag=!1,0)},stackFloatValue:function(e){this.vm.success=!0;var t=this.vm.stackIntOrFloat(e);return this.vm.success?t:(this.successFlag=!1,0)},stackObjectValue:function(e){var t=this.vm.stackValue(e);return"number"!=typeof t?t:(this.successFlag=!1,this.vm.nilObj)},stackBytes:function(e){var t=this.vm.stackValue(e);return t.bytes?t.bytes:("number"!=typeof t&&t.isBytes()||(this.successFlag=!1),[])},stackWords:function(e){var t=this.vm.stackValue(e);return t.words?t.words:("number"!=typeof t&&t.isWords()||(this.successFlag=!1),[])},stackInt32Array:function(e){var t=this.vm.stackValue(e);return t.words?t.wordsAsInt32Array():("number"!=typeof t&&t.isWords()||(this.successFlag=!1),[])},stackInt16Array:function(e){var t=this.vm.stackValue(e);return t.words?t.wordsAsInt16Array():("number"!=typeof t&&t.isWords()||(this.successFlag=!1),[])},stackUint16Array:function(e){var t=this.vm.stackValue(e);return t.words?t.wordsAsUint16Array():("number"!=typeof t&&t.isWords()||(this.successFlag=!1),[])}},"object access",{isBytes:function(e){return"number"!=typeof e&&e.isBytes()},isWords:function(e){return"number"!=typeof e&&e.isWords()},isWordsOrBytes:function(e){return"number"!=typeof e&&e.isWordsOrBytes()},isPointers:function(e){return"number"!=typeof e&&e.isPointers()},isIntegerValue:function(e){return"number"==typeof e&&-1073741824<=e&&e<=1073741823},isArray:function(e){return e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassArray]},isMemberOf:function(e,t){var r=e.sqClass.pointers[Squeak.Class_name].bytes;if(t.length!==r.length)return!1;for(var i=0;i<t.length;i++)if(t.charCodeAt(i)!==r[i])return!1;return!0},booleanValueOf:function(e){return!!e.isTrue||!e.isFalse&&(this.successFlag=!1)},positive32BitValueOf:function(e){return this.vm.primHandler.positive32BitValueOf(e)},positive32BitIntegerFor:function(e){return this.vm.primHandler.pos32BitIntFor(e)},floatValueOf:function(e){return e.isFloat?e.float:(this.successFlag=!1,0)},floatObjectOf:function(e){return this.vm.primHandler.makeFloat(e)},fetchPointerofObject:function(e,t){return t.pointers[e]},fetchBytesofObject:function(e,t){var r=t.pointers[e];return r.bytes?r.bytes:r.words?r.wordsAsUint8Array():("number"!=typeof r&&r.isWordsOrBytes()||(this.successFlag=!1),[])},fetchWordsofObject:function(e,t){var r=t.pointers[e];return r.words?r.words:("number"!=typeof r&&r.isWords()||(this.successFlag=!1),[])},fetchInt32ArrayofObject:function(e,t){var r=t.pointers[e];return r.words?r.wordsAsInt32Array():("number"!=typeof r&&r.isWords()||(this.successFlag=!1),[])},fetchInt16ArrayofObject:function(e,t){var r=t.pointers[e];return r.words?r.wordsAsInt16Array():("number"!=typeof r&&r.isWords()||(this.successFlag=!1),[])},fetchUint16ArrayofObject:function(e,t){var r=t.pointers[e];return r.words?r.wordsAsUint16Array():("number"!=typeof r&&r.isWords()||(this.successFlag=!1),[])},fetchIntegerofObject:function(e,t){var r=t.pointers[e];return"number"==typeof r?r:(this.successFlag=!1,0)},fetchLong32ofObject:function(e,t){return t.words[e]},fetchFloatofObject:function(e,t){return this.floatValueOf(t.pointers[e])},storeIntegerofObjectwithValue:function(e,t,r){"number"==typeof r?t.pointers[e]=r:this.successFlag=!1},storePointerofObjectwithValue:function(e,t,r){t.pointers[e]=r},stObjectatput:function(e,t,r){if(e.sqClass!==this.classArray())throw Error("Array expected");if(t<1||t>=e.pointers.length)return this.successFlag=!1;e.pointers[t]=r}},"constant access",{isKindOfInteger:function(e){return"number"==typeof e||e.sqClass==this.classLargeNegativeInteger()||e.sqClass==this.classLargePositiveInteger()},classArray:function(){return this.vm.specialObjects[Squeak.splOb_ClassArray]},classBitmap:function(){return this.vm.specialObjects[Squeak.splOb_ClassBitmap]},classSmallInteger:function(){return this.vm.specialObjects[Squeak.splOb_ClassInteger]},classLargePositiveInteger:function(){return this.vm.specialObjects[Squeak.splOb_ClassLargePositiveInteger]},classLargeNegativeInteger:function(){return this.vm.specialObjects[Squeak.splOb_ClassLargeNegativeInteger]},classPoint:function(){return this.vm.specialObjects[Squeak.splOb_ClassPoint]},classString:function(){return this.vm.specialObjects[Squeak.splOb_ClassString]},nilObject:function(){return this.vm.nilObj},falseObject:function(){return this.vm.falseObj},trueObject:function(){return this.vm.trueObj}},"vm functions",{clone:function(e){return this.vm.image.clone(e)},instantiateClassindexableSize:function(e,t){return this.vm.instantiateClass(e,t)},methodArgumentCount:function(){return this.argCount},makePointwithxValueyValue:function(e,t){return this.vm.primHandler.makePointWithXandY(e,t)},pushRemappableOop:function(e){this.remappableOops.push(e)},popRemappableOop:function(){return this.remappableOops.pop()},showDisplayBitsLeftTopRightBottom:function(e,t,r,i,a){if(t<i&&r<a){var s={left:t,top:r,right:i,bottom:a};this.vm.primHandler.displayDirty(e,s)}},ioLoadFunctionFrom:function(e,t){return this.vm.primHandler.loadFunctionFrom(e,t)}}),Object.subclass("Squeak.InstructionStream","initialization",{initialize:function(e,t){this.vm=t,this.method=e,this.pc=0,this.specialConstants=[t.trueObj,t.falseObj,t.nilObj,-1,0,1,2]}},"decoding",{interpretNextInstructionFor:function(e){var t=this.method,r=t.bytes[this.pc++],i=r/16|0,a=r%16;if(0==i)return e.pushReceiverVariable(a);if(1==i)return e.pushTemporaryVariable(a);if(2==i)return e.pushConstant(t.methodGetLiteral(a));if(3==i)return e.pushConstant(t.methodGetLiteral(16+a));if(4==i)return e.pushLiteralVariable(t.methodGetLiteral(a));if(5==i)return e.pushLiteralVariable(t.methodGetLiteral(16+a));if(6==i)return a<8?e.popIntoReceiverVariable(a):e.popIntoTemporaryVariable(a-8);if(7==i){if(0==a)return e.pushReceiver();if(a<8)return e.pushConstant(this.specialConstants[a-1]);if(8==a)return e.methodReturnReceiver();if(a<12)return e.methodReturnConstant(this.specialConstants[a-9]);if(12==a)return e.methodReturnTop();if(13==a)return e.blockReturnTop();if(13<a)throw Error("unusedBytecode")}return 8==i?this.interpretExtension(a,t,e):9==i?a<8?e.jump(1+a):e.jumpIf(!1,a-8+1):10==i?(r=this.method.bytes[this.pc++],a<8?e.jump(256*(a-4)+r):e.jumpIf(a<12,256*(3&a)+r)):11==i?e.send(this.vm.specialSelectors[2*a],this.vm.specialSelectors[2*a+1],!1):12==i?e.send(this.vm.specialSelectors[2*(16+a)],this.vm.specialSelectors[2*(16+a)+1],!1):12<i?e.send(t.methodGetLiteral(a),i-13,!1):void 0},interpretExtension:function(e,t,r){if(e<=6){var i=this.method.bytes[this.pc++];if(e<=2){var a=i/64|0,s=i%64;if(0===e){if(0===a)return r.pushReceiverVariable(s);if(1===a)return r.pushTemporaryVariable(s);if(2===a)return r.pushConstant(this.method.methodGetLiteral(s));if(3===a)return r.pushLiteralVariable(this.method.methodGetLiteral(s))}if(1===e){if(0===a)return r.storeIntoReceiverVariable(s);if(1===a)return r.storeIntoTemporaryVariable(s);if(2===a)throw Error("illegalStore");if(3===a)return r.storeIntoLiteralVariable(this.method.methodGetLiteral(s))}if(2===e){if(0===a)return r.popIntoReceiverVariable(s);if(1===a)return r.popIntoTemporaryVariable(s);if(2===a)throw Error("illegalStore");if(3===a)return r.popIntoLiteralVariable(this.method.methodGetLiteral(s))}}if(3===e)return r.send(this.method.methodGetLiteral(i%32),i/32|0,!1);if(4===e){var n=this.method.bytes[this.pc++];if(0===(a=i/32|0))return r.send(this.method.methodGetLiteral(n),i%32,!1);if(1===a)return r.send(this.method.methodGetLiteral(n),i%32,!0);if(2===a)return r.pushReceiverVariable(n);if(3===a)return r.pushConstant(this.method.methodGetLiteral(n));if(4===a)return r.pushLiteralVariable(this.method.methodGetLiteral(n));if(5===a)return r.storeIntoReceiverVariable(n);if(6===a)return r.popIntoReceiverVariable(n);if(7===a)return r.storeIntoLiteralVariable(this.method.methodGetLiteral(n))}if(5===e)return r.send(this.method.methodGetLiteral(31&i),i>>5,!0);if(6===e)return r.send(this.method.methodGetLiteral(63&i),i>>6,!1)}if(7===e)return r.doPop();if(8===e)return r.doDup();if(9===e)return r.pushActiveContext();i=this.method.bytes[this.pc++];if(10===e)return i<128?r.pushNewArray(i):r.popIntoNewArray(i-128);n=this.method.bytes[this.pc++];if(11===e)return r.callPrimitive(i+256*n);if(12===e)return r.pushRemoteTemp(i,n);if(13===e)return r.storeIntoRemoteTemp(i,n);if(14===e)return r.popIntoRemoteTemp(i,n);var o=this.method.bytes[this.pc++];return r.pushClosureCopy(i>>4,15&i,256*n+o)}}),Squeak.InstructionStream.subclass("Squeak.InstructionStreamSista","decoding",{interpretNextInstructionFor:function(e){return this.interpretNextInstructionExtFor(e,0,0)},interpretNextInstructionExtFor:function(e,t,r){this.Squeak;var i=this.method.bytes[this.pc++];switch(i){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return e.pushReceiverVariable(15&i);case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:return e.pushLiteralVariable(this.method.methodGetLiteral(15&i));case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 58:case 59:case 60:case 61:case 62:case 63:return e.pushConstant(this.method.methodGetLiteral(31&i));case 64:case 65:case 66:case 67:case 68:case 69:case 70:case 71:return e.pushTemporaryVariable(15&i);case 72:case 73:case 74:case 75:return e.pushTemporaryVariable(8+(3&i));case 76:return e.pushReceiver();case 77:return e.pushConstant(this.vm.trueObj);case 78:return e.pushConstant(this.vm.falseObj);case 79:return e.pushConstant(this.vm.nilObj);case 80:return e.pushConstant(0);case 81:return e.pushConstant(1);case 82:return e.pushActiveContext();case 83:return e.doDup();case 88:return e.methodReturnReceiver();case 89:return e.methodReturnConstant(this.vm.trueObj);case 90:return e.methodReturnConstant(this.vm.falseObj);case 91:return e.methodReturnConstant(this.vm.nilObj);case 92:return e.methodReturnTop();case 93:return e.blockReturnConstant(this.vm.nilObj);case 94:if(0===t)return e.blockReturnTop();break;case 95:return e.nop();case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 106:case 107:case 108:case 109:case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:case 118:case 119:case 120:case 121:case 122:case 123:case 124:case 125:case 126:case 127:return e.send(this.vm.specialSelectors[2*(i-96)],this.vm.specialSelectors[2*(i-96)+1],!1);case 128:case 129:case 130:case 131:case 132:case 133:case 134:case 135:case 136:case 137:case 138:case 139:case 140:case 141:case 142:case 143:return e.send(this.method.methodGetLiteral(15&i),0,!1);case 144:case 145:case 146:case 147:case 148:case 149:case 150:case 151:case 152:case 153:case 154:case 155:case 156:case 157:case 158:case 159:return e.send(this.method.methodGetLiteral(15&i),1,!1);case 160:case 161:case 162:case 163:case 164:case 165:case 166:case 167:case 168:case 169:case 170:case 171:case 172:case 173:case 174:case 175:return e.send(this.method.methodGetLiteral(15&i),2,!1);case 176:case 177:case 178:case 179:case 180:case 181:case 182:case 183:return e.jump(1+(7&i));case 184:case 185:case 186:case 187:case 188:case 189:case 190:case 191:return e.jumpIf(!0,1+(7&i));case 192:case 193:case 194:case 195:case 196:case 197:case 198:case 199:return e.jumpIf(!1,1+(7&i));case 200:case 201:case 202:case 203:case 204:case 205:case 206:case 207:return e.popIntoReceiverVariable(7&i);case 208:case 209:case 210:case 211:case 212:case 213:case 214:case 215:return e.popIntoTemporaryVariable(i-208);case 216:return e.doPop()}var a=this.method.bytes[this.pc++];switch(i){case 224:return this.interpretNextInstructionExtFor(e,(t<<8)+a,r);case 225:return this.interpretNextInstructionExtFor(e,t,(r<<8)+(a<128?a:a-256));case 226:return e.pushReceiverVariable(a+(t<<8));case 227:return e.pushLiteralVariable(this.method.methodGetLiteral(a+(t<<8)));case 228:return e.pushConstant(this.method.methodGetLiteral(a+(t<<8)));case 229:return e.pushTemporaryVariable(a);case 231:return a<128?e.pushNewArray(a):e.popIntoNewArray(a-128);case 232:return e.pushConstant(a+(r<<8));case 233:return e.pushConstant("$"+a+(r<<8));case 234:return e.send(this.method.methodGetSelector((a>>3)+(t<<5)),(7&a)+(r<<3),!1);case 235:var s=this.method.methodGetSelector((a>>3)+(t<<5));return 64<=r?e.sendSuperDirected(s):e.send(s,(7&a)+(r<<3),!0);case 237:return e.jump(a+(r<<8));case 238:return e.jumpIf(!0,a+(r<<8));case 239:return e.jumpIf(!1,a+(r<<8));case 240:return e.popIntoReceiverVariable(a+(t<<8));case 241:return e.popIntoLiteralVariable(this.method.methodGetLiteral(a+(t<<8)));case 242:return e.popIntoTemporaryVariable(a);case 243:return e.storeIntoReceiverVariable(a+(t<<8));case 244:return e.storeIntoLiteralVariable(this.method.methodGetLiteral(a+(t<<8)));case 245:return e.storeIntoTemporaryVariable(a)}var n=this.method.bytes[this.pc++];switch(i){case 248:return e.callPrimitive(a+(n<<8));case 249:var o=a+(t<<8),u=63&n,l=this.method.methodGetLiteral(o);return e.pushFullClosure(o,u,l.methodNumArgs());case 250:var c=(7&a)+8*this.mod(t,16),h=(u=(a>>3&7)+8*this.div(t,16),n+(r<<8));return e.pushClosureCopy(u,c,h);case 251:return e.pushRemoteTemp(a,n);case 252:return e.storeIntoRemoteTemp(a,n);case 253:return e.popIntoRemoteTemp(a,n)}throw Error("Unknown bytecode: "+i)}}),Object.subclass("Squeak.InstructionPrinter","initialization",{initialize:function(e,t){this.method=e,this.vm=t}},"printing",{printInstructions:function(e,t,r){this.indent=e,this.highlight=t,this.highlightPC=r,this.innerIndents={},this.result="",this.scanner=this.method.methodSignFlag()?new Squeak.InstructionStreamSista(this.method,this.vm):new Squeak.InstructionStream(this.method,this.vm),this.oldPC=this.scanner.pc,this.endPC=0,this.done=!1;try{for(;!this.done;)this.scanner.interpretNextInstructionFor(this)}catch(e){this.print("!!! "+e.message)}return this.result},print:function(e){this.oldPC===this.highlightPC?this.highlight&&(this.result+=this.highlight):this.indent&&(this.result+=this.indent),this.result+=this.oldPC;for(var t=0;t<this.innerIndents[this.oldPC];t++)this.result+="   ";this.result+=" <";for(t=this.oldPC;t<this.scanner.pc;t++)t>this.oldPC&&(this.result+=" "),this.result+=(this.method.bytes[t]+256).toString(16).substr(-2).toUpperCase();this.result+="> "+e+"\n",this.oldPC=this.scanner.pc}},"decoding",{blockReturnConstant:function(e){this.print("blockReturn: "+e.toString())},blockReturnTop:function(){this.print("blockReturn")},doDup:function(){this.print("dup")},doPop:function(){this.print("pop")},jump:function(e){this.print("jumpTo: "+(this.scanner.pc+e)),this.scanner.pc+e>this.endPC&&(this.endPC=this.scanner.pc+e)},jumpIf:function(e,t){this.print((e?"jumpIfTrue: ":"jumpIfFalse: ")+(this.scanner.pc+t)),this.scanner.pc+t>this.endPC&&(this.endPC=this.scanner.pc+t)},methodReturnReceiver:function(){this.print("return: receiver"),this.done=this.scanner.pc>this.endPC},methodReturnTop:function(){this.print("return: topOfStack"),this.done=this.scanner.pc>this.endPC},methodReturnConstant:function(e){this.print("returnConst: "+e.toString()),this.done=this.scanner.pc>this.endPC},nop:function(){this.print("nop")},popIntoLiteralVariable:function(e){this.print("popIntoBinding: "+e.assnKeyAsString())},popIntoReceiverVariable:function(e){this.print("popIntoInstVar: "+e)},popIntoTemporaryVariable:function(e){this.print("popIntoTemp: "+e)},pushActiveContext:function(){this.print("push: thisContext")},pushConstant:function(e){var t=e.sqInstName?e.sqInstName():e.toString();this.print("pushConst: "+t)},pushLiteralVariable:function(e){this.print("pushBinding: "+e.assnKeyAsString())},pushReceiver:function(){this.print("push: self")},pushReceiverVariable:function(e){this.print("pushInstVar: "+e)},pushTemporaryVariable:function(e){this.print("pushTemp: "+e)},send:function(e,t,r){this.print((r?"superSend: #":"send: #")+(e.bytesAsString?e.bytesAsString():e))},sendSuperDirected:function(e){this.print("directedSuperSend: #"+(e.bytesAsString?e.bytesAsString():e))},storeIntoLiteralVariable:function(e){this.print("storeIntoBinding: "+e.assnKeyAsString())},storeIntoReceiverVariable:function(e){this.print("storeIntoInstVar: "+e)},storeIntoTemporaryVariable:function(e){this.print("storeIntoTemp: "+e)},pushNewArray:function(e){this.print("push: (Array new: "+e+")")},popIntoNewArray:function(e){this.print("pop: "+e+" into: (Array new: "+e+")")},pushRemoteTemp:function(e,t){this.print("push: "+e+" ofTemp: "+t)},storeIntoRemoteTemp:function(e,t){this.print("storeInto: "+e+" ofTemp: "+t)},popIntoRemoteTemp:function(e,t){this.print("popInto: "+e+" ofTemp: "+t)},pushClosureCopy:function(e,t,r){var i=this.scanner.pc,a=i+r;this.print("closure("+i+"-"+(a-1)+"): "+e+" copied, "+t+" args");for(var s=i;s<a;s++)this.innerIndents[s]=(this.innerIndents[s]||0)+1;a>this.endPC&&(this.endPC=a)},pushFullClosure:function(e,t,r){this.print("pushFullClosure: (self literalAt: "+e+") numCopied: "+t+" numArgs: "+r)},callPrimitive:function(e){this.print("primitive: "+e)}}),Object.subclass("Squeak.Primitives","initialization",{initialize:function(e,t){this.vm=e,this.oldPrims=!this.vm.image.hasClosures,this.allowAccessBeyondSP=this.oldPrims,this.deferDisplayUpdates=!1,this.semaphoresToSignal=[],this.initDisplay(t),this.initAtCache(),this.initModules(),this.initPlugins(),e.image.isSpur&&(this.charFromInt=this.charFromIntSpur,this.charToInt=this.charToIntSpur,this.identityHash=this.identityHashSpur)},initDisplay:function(e){this.display=e},initModules:function(){this.loadedModules={},this.builtinModules={},this.patchModules={},this.interpreterProxy=new Squeak.InterpreterProxy(this.vm)},initPlugins:function(){}},"dispatch",{quickSendOther:function(e,t){switch(this.success=!0,t){case 0:return this.popNandPushIfOK(2,this.objectAt(!0,!0,!1));case 1:return this.popNandPushIfOK(3,this.objectAtPut(!0,!0,!1));case 2:return this.popNandPushIfOK(1,this.objectSize(!0));case 6:return this.popNandPushBoolIfOK(2,this.vm.stackValue(1)===this.vm.stackValue(0));case 7:return this.popNandPushIfOK(1,this.vm.getClass(this.vm.top()));case 8:return this.popNandPushIfOK(2,this.doBlockCopy());case 9:return this.primitiveBlockValue(0);case 10:return this.primitiveBlockValue(1)}return!1},doPrimitive:function(e,t,r){switch(this.success=!0,e){case 1:return this.popNandPushIntIfOK(t+1,this.stackInteger(1)+this.stackInteger(0));case 2:return this.popNandPushIntIfOK(t+1,this.stackInteger(1)-this.stackInteger(0));case 3:return this.popNandPushBoolIfOK(t+1,this.stackInteger(1)<this.stackInteger(0));case 4:return this.popNandPushBoolIfOK(t+1,this.stackInteger(1)>this.stackInteger(0));case 5:return this.popNandPushBoolIfOK(t+1,this.stackInteger(1)<=this.stackInteger(0));case 6:return this.popNandPushBoolIfOK(t+1,this.stackInteger(1)>=this.stackInteger(0));case 7:return this.popNandPushBoolIfOK(t+1,this.stackInteger(1)===this.stackInteger(0));case 8:return this.popNandPushBoolIfOK(t+1,this.stackInteger(1)!==this.stackInteger(0));case 9:return this.popNandPushIntIfOK(t+1,this.stackInteger(1)*this.stackInteger(0));case 10:return this.popNandPushIntIfOK(t+1,this.vm.quickDivide(this.stackInteger(1),this.stackInteger(0)));case 11:return this.popNandPushIntIfOK(t+1,this.vm.mod(this.stackInteger(1),this.stackInteger(0)));case 12:return this.popNandPushIntIfOK(t+1,this.vm.div(this.stackInteger(1),this.stackInteger(0)));case 13:return this.popNandPushIntIfOK(t+1,this.stackInteger(1)/this.stackInteger(0)|0);case 14:return this.popNandPushIfOK(t+1,this.doBitAnd());case 15:return this.popNandPushIfOK(t+1,this.doBitOr());case 16:return this.popNandPushIfOK(t+1,this.doBitXor());case 17:return this.popNandPushIfOK(t+1,this.doBitShift());case 18:return this.primitiveMakePoint(t,!1);case 19:return!1;case 20:return this.vm.warnOnce("missing primitive: 20 (primitiveRemLargeIntegers)"),!1;case 21:return this.vm.warnOnce("missing primitive: 21 (primitiveAddLargeIntegers)"),!1;case 22:return this.vm.warnOnce("missing primitive: 22 (primitiveSubtractLargeIntegers)"),!1;case 23:return this.primitiveLessThanLargeIntegers(t);case 24:return this.primitiveGreaterThanLargeIntegers(t);case 25:return this.primitiveLessOrEqualLargeIntegers(t);case 26:return this.primitiveGreaterOrEqualLargeIntegers(t);case 27:return this.primitiveEqualLargeIntegers(t);case 28:return this.primitiveNotEqualLargeIntegers(t);case 29:return this.vm.warnOnce("missing primitive: 29 (primitiveMultiplyLargeIntegers)"),!1;case 30:return this.vm.warnOnce("missing primitive: 30 (primitiveDivideLargeIntegers)"),!1;case 31:return this.vm.warnOnce("missing primitive: 31 (primitiveModLargeIntegers)"),!1;case 32:return this.vm.warnOnce("missing primitive: 32 (primitiveDivLargeIntegers)"),!1;case 33:return this.vm.warnOnce("missing primitive: 33 (primitiveQuoLargeIntegers)"),!1;case 34:return this.vm.warnOnce("missing primitive: 34 (primitiveBitAndLargeIntegers)"),!1;case 35:return this.vm.warnOnce("missing primitive: 35 (primitiveBitOrLargeIntegers)"),!1;case 36:return this.vm.warnOnce("missing primitive: 36 (primitiveBitXorLargeIntegers)"),!1;case 37:return this.vm.warnOnce("missing primitive: 37 (primitiveBitShiftLargeIntegers)"),!1;case 38:return this.popNandPushIfOK(t+1,this.objectAt(!1,!1,!1));case 39:return this.popNandPushIfOK(t+1,this.objectAtPut(!1,!1,!1));case 40:return this.popNandPushFloatIfOK(t+1,this.stackInteger(0));case 41:return this.popNandPushFloatIfOK(t+1,this.stackFloat(1)+this.stackFloat(0));case 42:return this.popNandPushFloatIfOK(t+1,this.stackFloat(1)-this.stackFloat(0));case 43:return this.popNandPushBoolIfOK(t+1,this.stackFloat(1)<this.stackFloat(0));case 44:return this.popNandPushBoolIfOK(t+1,this.stackFloat(1)>this.stackFloat(0));case 45:return this.popNandPushBoolIfOK(t+1,this.stackFloat(1)<=this.stackFloat(0));case 46:return this.popNandPushBoolIfOK(t+1,this.stackFloat(1)>=this.stackFloat(0));case 47:return this.popNandPushBoolIfOK(t+1,this.stackFloat(1)===this.stackFloat(0));case 48:return this.popNandPushBoolIfOK(t+1,this.stackFloat(1)!==this.stackFloat(0));case 49:return this.popNandPushFloatIfOK(t+1,this.stackFloat(1)*this.stackFloat(0));case 50:return this.popNandPushFloatIfOK(t+1,this.safeFDiv(this.stackFloat(1),this.stackFloat(0)));case 51:return this.popNandPushIfOK(t+1,this.floatAsSmallInt(this.stackFloat(0)));case 52:return this.popNandPushFloatIfOK(t+1,this.floatFractionPart(this.stackFloat(0)));case 53:return this.popNandPushIntIfOK(t+1,this.frexp_exponent(this.stackFloat(0))-1);case 54:return this.popNandPushFloatIfOK(t+1,this.ldexp(this.stackFloat(1),this.stackFloat(0)));case 55:return this.popNandPushFloatIfOK(t+1,Math.sqrt(this.stackFloat(0)));case 56:return this.popNandPushFloatIfOK(t+1,Math.sin(this.stackFloat(0)));case 57:return this.popNandPushFloatIfOK(t+1,Math.atan(this.stackFloat(0)));case 58:return this.popNandPushFloatIfOK(t+1,Math.log(this.stackFloat(0)));case 59:return this.popNandPushFloatIfOK(t+1,Math.exp(this.stackFloat(0)));case 60:return this.popNandPushIfOK(t+1,this.objectAt(!1,!1,!1));case 61:return this.popNandPushIfOK(t+1,this.objectAtPut(!1,!1,!1));case 62:return this.popNandPushIfOK(t+1,this.objectSize(!1));case 63:return this.popNandPushIfOK(t+1,this.objectAt(!1,!0,!1));case 64:return this.popNandPushIfOK(t+1,this.objectAtPut(!1,!0,!1));case 65:return this.vm.warnOnce("missing primitive: 65 (primitiveNext)"),!1;case 66:return this.vm.warnOnce("missing primitive: 66 (primitiveNextPut)"),!1;case 67:return this.vm.warnOnce("missing primitive: 67 (primitiveAtEnd)"),!1;case 68:return this.popNandPushIfOK(t+1,this.objectAt(!1,!1,!0));case 69:return this.popNandPushIfOK(t+1,this.objectAtPut(!1,!1,!0));case 70:return this.popNandPushIfOK(t+1,this.instantiateClass(this.stackNonInteger(0),0));case 71:return this.popNandPushIfOK(t+1,this.instantiateClass(this.stackNonInteger(1),this.stackPos32BitInt(0)));case 72:return this.primitiveArrayBecome(t,!1,!0);case 73:return this.popNandPushIfOK(t+1,this.objectAt(!1,!1,!0));case 74:return this.popNandPushIfOK(t+1,this.objectAtPut(!1,!1,!0));case 75:return this.popNandPushIfOK(t+1,this.identityHash(this.stackNonInteger(0)));case 76:return this.primitiveStoreStackp(t);case 77:return this.popNandPushIfOK(t+1,this.someInstanceOf(this.stackNonInteger(0)));case 78:return this.popNandPushIfOK(t+1,this.nextInstanceAfter(this.stackNonInteger(0)));case 79:return this.primitiveNewMethod(t);case 80:return this.popNandPushIfOK(t+1,this.doBlockCopy());case 81:return this.primitiveBlockValue(t);case 82:return this.primitiveBlockValueWithArgs(t);case 83:return this.vm.primitivePerform(t);case 84:return this.vm.primitivePerformWithArgs(t,!1);case 85:return this.primitiveSignal();case 86:return this.primitiveWait();case 87:return this.primitiveResume();case 88:return this.primitiveSuspend();case 89:return this.vm.flushMethodCache();case 90:return this.primitiveMousePoint(t);case 91:return this.primitiveTestDisplayDepth(t);case 92:return this.vm.warnOnce("missing primitive: 92 (primitiveSetDisplayMode)"),!1;case 93:return this.primitiveInputSemaphore(t);case 94:return this.primitiveGetNextEvent(t);case 95:return this.primitiveInputWord(t);case 96:return this.namedPrimitive("BitBltPlugin","primitiveCopyBits",t);case 97:return this.primitiveSnapshot(t);case 98:return this.primitiveStoreImageSegment(t);case 99:return this.primitiveLoadImageSegment(t);case 100:return this.vm.primitivePerformWithArgs(t,!0);case 101:return this.primitiveBeCursor(t);case 102:return this.primitiveBeDisplay(t);case 103:return this.primitiveScanCharacters(t);case 104:return this.vm.warnOnce("missing primitive: 104 (primitiveDrawLoop)"),!1;case 105:return this.popNandPushIfOK(t+1,this.doStringReplace());case 106:return this.primitiveScreenSize(t);case 107:return this.primitiveMouseButtons(t);case 108:return this.primitiveKeyboardNext(t);case 109:return this.primitiveKeyboardPeek(t);case 110:return this.popNandPushBoolIfOK(t+1,this.vm.stackValue(1)===this.vm.stackValue(0));case 111:return this.popNandPushIfOK(t+1,this.vm.getClass(this.vm.top()));case 112:return this.popNandPushIfOK(t+1,this.vm.image.bytesLeft());case 113:return this.primitiveQuit(t);case 114:return this.primitiveExitToDebugger(t);case 115:return this.primitiveChangeClass(t);case 116:return this.vm.flushMethodCacheForMethod(this.vm.top());case 117:return this.doNamedPrimitive(t,r);case 118:return this.primitiveDoPrimitiveWithArgs(t);case 119:return this.vm.flushMethodCacheForSelector(this.vm.top());case 120:return this.primitiveCalloutToFFI(t,r);case 121:return this.primitiveImageName(t);case 122:return this.primitiveReverseDisplay(t);case 123:return this.vm.warnOnce("missing primitive: 123 (primitiveValueUninterruptably)"),!1;case 124:return this.popNandPushIfOK(t+1,this.registerSemaphore(Squeak.splOb_TheLowSpaceSemaphore));case 125:return this.popNandPushIfOK(t+1,this.setLowSpaceThreshold());case 126:return this.primitiveDeferDisplayUpdates(t);case 127:return this.primitiveShowDisplayRect(t);case 128:return this.primitiveArrayBecome(t,!0,!0);case 129:return this.popNandPushIfOK(t+1,this.vm.image.specialObjectsArray);case 130:return this.primitiveFullGC(t);case 131:return this.primitivePartialGC(t);case 132:return this.popNandPushBoolIfOK(t+1,this.pointsTo(this.stackNonInteger(1),this.vm.top()));case 133:return this.popNIfOK(t);case 134:return this.popNandPushIfOK(t+1,this.registerSemaphore(Squeak.splOb_TheInterruptSemaphore));case 135:return this.popNandPushIfOK(t+1,this.millisecondClockValue());case 136:return this.primitiveSignalAtMilliseconds(t);case 137:return this.popNandPushIfOK(t+1,this.secondClock());case 138:return this.popNandPushIfOK(t+1,this.someObject());case 139:return this.popNandPushIfOK(t+1,this.nextObject(this.vm.top()));case 140:return this.primitiveBeep(t);case 141:return this.primitiveClipboardText(t);case 142:return this.popNandPushIfOK(t+1,this.makeStString(this.filenameToSqueak(Squeak.vmPath)));case 143:case 144:return this.primitiveShortAtAndPut(t);case 145:return this.primitiveConstantFill(t);case 146:return this.namedPrimitive("JoystickTabletPlugin","primitiveReadJoystick",t);case 147:return this.namedPrimitive("BitBltPlugin","primitiveWarpBits",t);case 148:return this.popNandPushIfOK(t+1,this.vm.image.clone(this.vm.top()));case 149:return this.primitiveGetAttribute(t);case 150:if(this.oldPrims)return this.primitiveFileAtEnd(t);case 151:if(this.oldPrims)return this.primitiveFileClose(t);case 152:if(this.oldPrims)return this.primitiveFileGetPosition(t);case 153:if(this.oldPrims)return this.primitiveFileOpen(t);case 154:if(this.oldPrims)return this.primitiveFileRead(t);case 155:if(this.oldPrims)return this.primitiveFileSetPosition(t);case 156:if(this.oldPrims)return this.primitiveFileDelete(t);case 157:if(this.oldPrims)return this.primitiveFileSize(t);break;case 158:return this.oldPrims?this.primitiveFileWrite(t):(this.vm.warnOnce("missing primitive: 158 (primitiveCompareWith)"),!1);case 159:return this.oldPrims?this.primitiveFileRename(t):this.popNandPushIntIfOK(t+1,1664525*this.stackSigned53BitInt(0)&268435455);case 160:return this.oldPrims?this.primitiveDirectoryCreate(t):this.primitiveAdoptInstance(t);case 161:return this.oldPrims?this.primitiveDirectoryDelimitor(t):(this.vm.warnOnce("missing primitive: 161 (primitiveSetIdentityHash)"),!1);case 162:if(this.oldPrims)return this.primitiveDirectoryLookup(t);break;case 163:return this.oldPrims?this.primitiveDirectoryDelete(t):(this.vm.warnOnce("missing primitive: 163 (primitiveGetImmutability)"),!1);case 164:return this.popNandPushIfOK(t+1,this.vm.trueObj);case 165:case 166:return this.primitiveIntegerAtAndPut(t);case 167:return!1;case 168:return this.primitiveCopyObject(t);case 169:return this.oldPrims?this.primitiveDirectorySetMacTypeAndCreator(t):this.popNandPushBoolIfOK(t+1,this.vm.stackValue(1)!==this.vm.stackValue(0));case 170:return this.oldPrims?this.namedPrimitive("SoundPlugin","primitiveSoundStart",t):this.primitiveAsCharacter(t);case 171:return this.oldPrims?this.namedPrimitive("SoundPlugin","primitiveSoundStartWithSemaphore",t):this.popNandPushIfOK(t+1,this.stackNonInteger(0).hash);case 172:return this.oldPrims?this.namedPrimitive("SoundPlugin","primitiveSoundStop",t):(this.vm.warnOnce("missing primitive: 172 (primitiveFetchMourner)"),this.popNandPushIfOK(t,this.vm.nilObj));case 173:return this.oldPrims?this.namedPrimitive("SoundPlugin","primitiveSoundAvailableSpace",t):this.popNandPushIfOK(t+1,this.objectAt(!1,!1,!0));case 174:return this.oldPrims?this.namedPrimitive("SoundPlugin","primitiveSoundPlaySamples",t):this.popNandPushIfOK(t+1,this.objectAtPut(!1,!1,!0));case 175:return this.oldPrims?this.namedPrimitive("SoundPlugin","primitiveSoundPlaySilence",t):this.vm.image.isSpur?this.popNandPushIfOK(t+1,this.behaviorHash(this.stackNonInteger(0))):(this.vm.warnOnce("primitive 175 called in non-spur image"),this.popNandPushIfOK(t+1,this.identityHash(this.stackNonInteger(0))));case 176:return this.oldPrims?this.namedPrimitive("SoundGenerationPlugin","primWaveTableSoundmixSampleCountintostartingAtpan",t):this.popNandPushIfOK(t+1,this.vm.image.isSpur?4194303:4095);case 177:return this.oldPrims?this.namedPrimitive("SoundGenerationPlugin","primFMSoundmixSampleCountintostartingAtpan",t):this.popNandPushIfOK(t+1,this.allInstancesOf(this.stackNonInteger(0)));case 178:return this.oldPrims?this.namedPrimitive("SoundGenerationPlugin","primPluckedSoundmixSampleCountintostartingAtpan",t):!1;case 179:if(this.oldPrims)return this.namedPrimitive("SoundGenerationPlugin","primSampledSoundmixSampleCountintostartingAtpan",t);break;case 180:return this.oldPrims?this.namedPrimitive("SoundGenerationPlugin","primitiveMixFMSound",t):!1;case 181:return this.oldPrims?this.namedPrimitive("SoundGenerationPlugin","primitiveMixPluckedSound",t):this.primitiveSizeInBytesOfInstance(t);case 182:return this.oldPrims?this.namedPrimitive("SoundGenerationPlugin","oldprimSampledSoundmixSampleCountintostartingAtleftVolrightVol",t):this.primitiveSizeInBytes(t);case 183:return this.oldPrims?this.namedPrimitive("SoundGenerationPlugin","primitiveApplyReverb",t):this.primitiveIsPinned(t);case 184:return this.oldPrims?this.namedPrimitive("SoundGenerationPlugin","primitiveMixLoopedSampledSound",t):this.primitivePin(t);case 185:return this.oldPrims?this.namedPrimitive("SoundGenerationPlugin","primitiveMixSampledSound",t):this.primitiveExitCriticalSection(t);case 186:if(this.oldPrims)break;return this.primitiveEnterCriticalSection(t);case 187:if(this.oldPrims)break;return this.primitiveTestAndSetOwnershipOfCriticalSection(t);case 188:if(this.oldPrims)break;return this.primitiveExecuteMethodArgsArray(t);case 189:return this.oldPrims?this.namedPrimitive("SoundPlugin","primitiveSoundInsertSamples",t):!1;case 190:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStartRecording",t);case 191:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundStopRecording",t);case 192:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundGetRecordingSampleRate",t);case 193:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundRecordSamples",t);case 194:if(this.oldPrims)return this.namedPrimitive("SoundPlugin","primitiveSoundSetRecordLevel",t);break;case 195:case 196:case 197:case 198:case 199:return!1;case 200:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveInitializeNetwork",t):this.primitiveClosureCopyWithCopiedValues(t);case 201:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverStartNameLookup",t):this.primitiveClosureValue(t);case 202:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverNameLookupResult",t):this.primitiveClosureValue(t);case 203:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverStartAddressLookup",t):this.primitiveClosureValue(t);case 204:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverAddressLookupResult",t):this.primitiveClosureValue(t);case 205:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverAbortLookup",t):this.primitiveClosureValue(t);case 206:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverLocalAddress",t):this.primitiveClosureValueWithArgs(t);case 207:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverStatus",t):this.primitiveFullClosureValue(t);case 208:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveResolverError",t):this.primitiveFullClosureValueWithArgs(t);case 209:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketCreate",t):this.primitiveFullClosureValueNoContextSwitch(t);case 210:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketDestroy",t):this.popNandPushIfOK(t+1,this.objectAt(!1,!1,!1));case 211:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketConnectionStatus",t):this.popNandPushIfOK(t+1,this.objectAtPut(!1,!1,!1));case 212:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketError",t):this.popNandPushIfOK(t+1,this.objectSize(!1));case 213:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketLocalAddress",t);case 214:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketLocalPort",t);case 215:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketRemoteAddress",t);case 216:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketRemotePort",t);case 217:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketConnectToPort",t);case 218:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketListenOnPort",t):(this.vm.warnOnce("missing primitive: 218 (tryNamedPrimitiveInForWithArgs"),!1);case 219:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketCloseConnection",t);case 220:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketAbortConnection",t);break;case 221:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketReceiveDataBufCount",t):this.primitiveClosureValueNoContextSwitch(t);case 222:return this.oldPrims?this.namedPrimitive("SocketPlugin","primitiveSocketReceiveDataAvailable",t):this.primitiveClosureValueNoContextSwitch(t);case 223:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketSendDataBufCount",t);case 224:if(this.oldPrims)return this.namedPrimitive("SocketPlugin","primitiveSocketSendDone",t);break;case 230:return this.primitiveRelinquishProcessorForMicroseconds(t);case 231:return this.primitiveForceDisplayUpdate(t);case 232:return this.vm.warnOnce("missing primitive: 232 (primitiveFormPrint)"),!1;case 233:return this.primitiveSetFullScreen(t);case 234:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveDecompressFromByteArray",t);case 235:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveCompareString",t);case 236:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveConvert8BitSigned",t);case 237:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveCompressToByteArray",t);case 238:if(this.oldPrims)return this.namedPrimitive("SerialPlugin","primitiveSerialPortOpen",t);case 239:if(this.oldPrims)return this.namedPrimitive("SerialPlugin","primitiveSerialPortClose",t);break;case 240:return this.oldPrims?this.namedPrimitive("SerialPlugin","primitiveSerialPortWrite",t):this.popNandPushIfOK(t+1,this.microsecondClockUTC());case 241:return this.oldPrims?this.namedPrimitive("SerialPlugin","primitiveSerialPortRead",t):this.popNandPushIfOK(t+1,this.microsecondClockLocal());case 242:if(this.oldPrims)break;return this.primitiveSignalAtUTCMicroseconds(t);case 243:return this.oldPrims?this.namedPrimitive("MiscPrimitivePlugin","primitiveTranslateStringWithTable",t):(this.vm.warnOnce("missing primitive: 243 (primitiveUpdateTimeZone)"),!1);case 244:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveFindFirstInString",t);case 245:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveIndexOfAsciiInString",t);case 246:if(this.oldPrims)return this.namedPrimitive("MiscPrimitivePlugin","primitiveFindSubstring",t);break;case 248:return this.primitiveArrayBecome(t,!1,!1);case 249:return this.primitiveArrayBecome(t,!1,!0);case 254:return this.primitiveVMParameter(t);case 521:return this.namedPrimitive("MIDIPlugin","primitiveMIDIClosePort",t);case 522:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetClock",t);case 523:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetPortCount",t);case 524:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetPortDirectionality",t);case 525:return this.namedPrimitive("MIDIPlugin","primitiveMIDIGetPortName",t);case 526:return this.namedPrimitive("MIDIPlugin","primitiveMIDIOpenPort",t);case 527:return this.namedPrimitive("MIDIPlugin","primitiveMIDIParameterGetOrSet",t);case 528:return this.namedPrimitive("MIDIPlugin","primitiveMIDIRead",t);case 529:return this.namedPrimitive("MIDIPlugin","primitiveMIDIWrite",t);case 550:return this.namedPrimitive("ADPCMCodecPlugin","primitiveDecodeMono",t);case 551:return this.namedPrimitive("ADPCMCodecPlugin","primitiveDecodeStereo",t);case 552:return this.namedPrimitive("ADPCMCodecPlugin","primitiveEncodeMono",t);case 553:return this.namedPrimitive("ADPCMCodecPlugin","primitiveEncodeStereo",t);case 571:return this.primitiveUnloadModule(t);case 572:return this.primitiveListBuiltinModule(t);case 573:return this.primitiveListLoadedModule(t);case 575:return this.vm.warnOnce("missing primitive: 575 (primitiveHighBit)"),!1;case 576:return this.vm.primitiveInvokeObjectAsMethod(t,r);case 578:return this.vm.warnOnce("missing primitive: 578 (primitiveSuspendAndBackupPC)"),!1}return console.error("primitive "+e+" not implemented yet"),!1},namedPrimitive:function(e,t,r){var i=""===e?this:this.loadedModules[e];void 0===i&&(i=this.loadModule(e),this.loadedModules[e]=i);var a=!1,s=this.vm.sp;if(i){this.interpreterProxy.argCount=r;var n=i[t];"function"==typeof n?a=i[t](r):"string"==typeof n?a=this[n](r):this.vm.warnOnce("missing primitive: "+e+"."+t)}else this.vm.warnOnce("missing module: "+e+" ("+t+")");return(!0===a||!1!==a&&this.success)&&this.vm.sp!==s-r&&!this.vm.frozen&&this.vm.warnOnce("stack unbalanced after primitive "+e+"."+t,"error"),!0===a||!1===a?a:this.success},doNamedPrimitive:function(e,t){if(t.pointersSize()<2)return!1;var r=t.pointers[1];if(4!==r.pointersSize())return!1;this.primMethod=t;var i=r.pointers[0].bytesAsString(),a=r.pointers[1].bytesAsString();return this.namedPrimitive(i,a,e)},fakePrimitive:function(e,t,r){return this.vm.warnOnce("faking primitive: "+e),void 0===t?this.vm.popN(r):this.vm.popNandPush(r+1,this.makeStObject(t)),!0}},"modules",{loadModule:function(e){var t=Squeak.externalModules[e]||this.builtinModules[e]||this.loadModuleDynamically(e);if(!t)return null;if(this.patchModules[e]&&this.patchModule(t,e),t.setInterpreter&&!t.setInterpreter(this.interpreterProxy))return console.log("Wrong interpreter proxy version: "+e),null;var r=t.initialiseModule;return"function"==typeof r?t.initialiseModule():"string"==typeof r&&this[r](),this.interpreterProxy.failed()?(console.log("Module initialization failed: "+e),null):(console.log("Loaded module: "+e),t)},loadModuleDynamically:function(e){},patchModule:function(e,t){var r=this.patchModules[t];for(var i in r)e[i]=r[i]},unloadModule:function(e){var t=this.loadedModules[e];if(!e||!t||t===this)return null;delete this.loadedModules[e];var r=t.unloadModule;return"function"==typeof r?t.unloadModule(this):"string"==typeof r&&this[r](this),console.log("Unloaded module: "+e),t},loadFunctionFrom:function(e,t){var r=""===t?this:this.loadedModules[t];if(void 0===r&&(r=this.loadModule(t),this.loadedModules[t]=r),!r)return null;var i=r[e];return"function"==typeof i?i.bind(r):"string"==typeof i?this[i].bind(this):(this.vm.warnOnce("missing primitive: "+t+"."+e),null)},primitiveUnloadModule:function(e){var t=this.stackNonInteger(0).bytesAsString();return!!t&&(this.unloadModule(t),this.popNIfOK(e))},primitiveListBuiltinModule:function(e){var t=this.stackInteger(0)-1;if(!this.success)return!1;var r=Object.keys(this.builtinModules);return this.popNandPushIfOK(e+1,this.makeStObject(r[t]))},primitiveListLoadedModule:function(e){var t=this.stackInteger(0)-1;if(!this.success)return!1;var r=[];for(var i in this.loadedModules){var a=this.loadedModules[i];if(a){var s=a.getModuleName?a.getModuleName():i;r.push(s)}}return this.popNandPushIfOK(e+1,this.makeStObject(r[t]))}},"stack access",{popNIfOK:function(e){return!!this.success&&(this.vm.popN(e),!0)},pop2andPushBoolIfOK:function(e){return this.vm.success=this.success,this.vm.pop2AndPushBoolResult(e)},popNandPushBoolIfOK:function(e,t){return!!this.success&&(this.vm.popNandPush(e,t?this.vm.trueObj:this.vm.falseObj),!0)},popNandPushIfOK:function(e,t){return!(!this.success||null==t)&&(this.vm.popNandPush(e,t),!0)},popNandPushIntIfOK:function(e,t){return!(!this.success||!this.vm.canBeSmallInt(t))&&(this.vm.popNandPush(e,t),!0)},popNandPushFloatIfOK:function(e,t){return!!this.success&&(this.vm.popNandPush(e,this.makeFloat(t)),!0)},stackNonInteger:function(e){return this.checkNonInteger(this.vm.stackValue(e))},stackInteger:function(e){return this.checkSmallInt(this.vm.stackValue(e))},stackPos32BitInt:function(e){return this.positive32BitValueOf(this.vm.stackValue(e))},pos32BitIntFor:function(e){if(0<=e&&e<=Squeak.MaxSmallInt)return e;for(var t=this.vm.specialObjects[Squeak.splOb_ClassLargePositiveInteger],r=this.vm.instantiateClass(t,4),i=r.bytes,a=0;a<4;a++)i[a]=e>>>8*a&255;return r},pos53BitIntFor:function(e){if(e<=4294967295)return this.pos32BitIntFor(e);if(9007199254740991<e)return console.warn("Out of range: pos53BitIntFor("+e+")"),this.success=!1,0;for(var t=e<=0xffffffffff?5:e<=0xffffffffffff?6:7,r=this.vm.specialObjects[Squeak.splOb_ClassLargePositiveInteger],i=this.vm.instantiateClass(r,t),a=i.bytes,s=0;s<t;s++)a[s]=255&e,e/=256;return i},stackSigned32BitInt:function(e){var t=this.vm.stackValue(e);if("number"==typeof t)return t;if(4!==t.bytesSize())return this.success=!1,0;for(var r=t.bytes,i=0,a=0,s=1;a<4;a++,s*=256)i+=r[a]*s;return this.isA(t,Squeak.splOb_ClassLargePositiveInteger)&&i<=2147483647?i:this.isA(t,Squeak.splOb_ClassLargeNegativeInteger)&&-2147483648<=-i?-i:(this.success=!1,0)},signed32BitIntegerFor:function(e){if(e>=Squeak.MinSmallInt&&e<=Squeak.MaxSmallInt)return e;for(var t=e<0,r=t?-e:e,i=t?Squeak.splOb_ClassLargeNegativeInteger:Squeak.splOb_ClassLargePositiveInteger,a=this.vm.instantiateClass(this.vm.specialObjects[i],4),s=a.bytes,n=0;n<4;n++)s[n]=r>>>8*n&255;return a},stackFloat:function(e){return this.checkFloat(this.vm.stackValue(e))},stackBoolean:function(e){return this.checkBoolean(this.vm.stackValue(e))},stackSigned53BitInt:function(e){var t=this.vm.stackValue(e);if("number"==typeof t)return t;var r=t.bytesSize();if(r<=7){for(var i=t.bytes,a=0,s=0,n=1;s<r;s++,n*=256)a+=i[s]*n;if(a<=9007199254740991){if(this.isA(t,Squeak.splOb_ClassLargePositiveInteger))return a;if(this.isA(t,Squeak.splOb_ClassLargeNegativeInteger))return-a}}return this.success=!1,0}},"numbers",{doBitAnd:function(){var e=this.stackPos32BitInt(1),t=this.stackPos32BitInt(0);return this.success?this.pos32BitIntFor(e&t):0},doBitOr:function(){var e=this.stackPos32BitInt(1),t=this.stackPos32BitInt(0);return this.success?this.pos32BitIntFor(e|t):0},doBitXor:function(){var e=this.stackPos32BitInt(1),t=this.stackPos32BitInt(0);return this.success?this.pos32BitIntFor(e^t):0},doBitShift:function(){var e=this.stackPos32BitInt(1),t=this.stackInteger(0);return this.success?0<this.vm.safeShift(e,t)?this.pos32BitIntFor(this.vm.safeShift(e,t)):(this.success=!1,0):0},safeFDiv:function(e,t){return 0===t?(this.success=!1,1):e/t},floatAsSmallInt:function(e){var t=0<=e?Math.floor(e):Math.ceil(e);return this.ensureSmallInt(t)},floatFractionPart:function(e){return-9007199254740991<=e&&e<=9007199254740991?e-Math.floor(e):(this.success=!1,0)},frexp_exponent:function(e){if(0==e)return 0;var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,e);var r=t.getUint32(0)>>>20&2047;return 0===r&&(t.setFloat64(0,e*Math.pow(2,64)),r=(t.getUint32(0)>>>20&2047)-64),r-1022},ldexp:function(e,t){for(var r=Math.min(3,Math.ceil(Math.abs(t)/1023)),i=e,a=0;a<r;a++)i*=Math.pow(2,Math.floor((t+a)/r));return i},primitiveLessThanLargeIntegers:function(e){return this.popNandPushBoolIfOK(e+1,this.stackSigned53BitInt(1)<this.stackSigned53BitInt(0))},primitiveGreaterThanLargeIntegers:function(e){return this.popNandPushBoolIfOK(e+1,this.stackSigned53BitInt(1)>this.stackSigned53BitInt(0))},primitiveLessOrEqualLargeIntegers:function(e){return this.popNandPushBoolIfOK(e+1,this.stackSigned53BitInt(1)<=this.stackSigned53BitInt(0))},primitiveGreaterOrEqualLargeIntegers:function(e){return this.popNandPushBoolIfOK(e+1,this.stackSigned53BitInt(1)>=this.stackSigned53BitInt(0))},primitiveEqualLargeIntegers:function(e){return this.popNandPushBoolIfOK(e+1,this.stackSigned53BitInt(1)===this.stackSigned53BitInt(0))},primitiveNotEqualLargeIntegers:function(e){return this.popNandPushBoolIfOK(e+1,this.stackSigned53BitInt(1)!==this.stackSigned53BitInt(0))}},"utils",{floatOrInt:function(e){return e.isFloat?e.float:"number"==typeof e?e:0},positive32BitValueOf:function(e){if("number"==typeof e)return 0<=e?e:(this.success=!1,0);if(!this.isA(e,Squeak.splOb_ClassLargePositiveInteger)||4!==e.bytesSize())return this.success=!1,0;for(var t=e.bytes,r=0,i=0,a=1;i<4;i++,a*=256)r+=t[i]*a;return r},checkFloat:function(e){return e.isFloat?e.float:"number"==typeof e?e:(this.success=!1,0)},checkSmallInt:function(e){return"number"==typeof e?e:(this.success=!1,0)},checkNonInteger:function(e){return"number"!=typeof e?e:(this.success=!1,this.vm.nilObj)},checkBoolean:function(e){return!!e.isTrue||!e.isFalse&&(this.success=!1)},indexableSize:function(e){return"number"==typeof e?-1:e.indexableSize(this)},isA:function(e,t){return e.sqClass===this.vm.specialObjects[t]},isKindOf:function(e,t){for(var r=e.sqClass,i=this.vm.specialObjects[t];!r.isNil;){if(r===i)return!0;r=r.pointers[Squeak.Class_superclass]}return!1},isAssociation:function(e){return"number"!=typeof e&&2==e.pointersSize()},ensureSmallInt:function(e){return e===(0|e)&&this.vm.canBeSmallInt(e)?e:(this.success=!1,0)},charFromInt:function(e){var t=this.vm.specialObjects[Squeak.splOb_CharacterTable].pointers[e];if(t)return t;var r=this.vm.specialObjects[Squeak.splOb_ClassCharacter];return(t=this.vm.instantiateClass(r,0)).pointers[0]=e,t},charFromIntSpur:function(e){return this.vm.image.getCharacter(e)},charToInt:function(e){return e.pointers[0]},charToIntSpur:function(e){return e.hash},makeFloat:function(e){var t=this.vm.specialObjects[Squeak.splOb_ClassFloat],r=this.vm.instantiateClass(t,2);return r.float=e,r},makeLargeIfNeeded:function(e){return this.vm.canBeSmallInt(e)?e:this.makeLargeInt(e)},makeLargeInt:function(e){if(e<0)throw Error("negative large ints not implemented yet");if(4294967295<e)throw Error("large large ints not implemented yet");return this.pos32BitIntFor(e)},makePointWithXandY:function(e,t){var r=this.vm.specialObjects[Squeak.splOb_ClassPoint],i=this.vm.instantiateClass(r,0);return i.pointers[Squeak.Point_x]=e,i.pointers[Squeak.Point_y]=t,i},makeStArray:function(e,t){for(var r=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassArray],e.length),i=0;i<e.length;i++)r.pointers[i]=this.makeStObject(e[i],t);return r},makeStByteArray:function(e){for(var t=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassByteArray],e.length),r=0;r<e.length;r++)t.bytes[r]=255&e[r];return t},makeStString:function(e){for(var t=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassString],e.length),r=0;r<e.length;++r)t.bytes[r]=255&e.charCodeAt(r);return t},makeStObject:function(e,t){if(null==e)return this.vm.nilObj;if(!0===e)return this.vm.trueObj;if(!1===e)return this.vm.falseObj;if(e.sqClass)return e;if("number"==typeof e)return e===(0|e)?this.makeLargeIfNeeded(e):this.makeFloat(e);if(t){var r=this.vm.instantiateClass(t,0);return r.jsObject=e,r}if("string"==typeof e||"Uint8Array"===e.constructor.name)return this.makeStString(e);if("Array"===e.constructor.name)return this.makeStArray(e);throw Error("cannot make smalltalk object")},pointsTo:function(e,t){return!!e.pointers&&0<=e.pointers.indexOf(t)},asUint8Array:function(e){if("Uint8Array"===e.constructor.name)return e;if("ArrayBuffer"===e.constructor.name)return new Uint8Array(e);if("string"!=typeof e)throw Error("unknown buffer type");for(var t=new Uint8Array(e.length),r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t},filenameToSqueak:function(e){var t="/SqueakJS"+("/"!==e[0]?"/":"")+e;return this.emulateMac&&(t=("Macintosh HD"+t).replace(/\//g,"").replace(/:/g,"/").replace(//g,":")),t},filenameFromSqueak:function(e){var t=this.emulateMac?e.replace(/^[^:]*:/,":").replace(/\//g,"").replace(/:/g,"/").replace(//g,":"):e;return t=t.replace(/^\/*SqueakJS\/?/,"/")}},"indexing",{objectAt:function(e,t,r){var i,a=this.stackNonInteger(1),s=this.stackPos32BitInt(0);if(!this.success)return a;if(e){if((i=this.atCache[a.hash&this.atCacheMask]).array!==a)return this.success=!1,a}else{if(a.isFloat){var n=a.floatData();return 1==s?this.pos32BitIntFor(n.getUint32(0,!1)):2==s?this.pos32BitIntFor(n.getUint32(4,!1)):(this.success=!1,a)}i=this.makeAtCacheInfo(this.atCache,this.vm.specialSelectors[32],a,t,r)}if(s<1||s>i.size)return this.success=!1,a;if(r)return a.pointers[s-1];if(a.isPointers())return a.pointers[s-1+i.ivarOffset];if(a.isWords())return i.convertChars?this.charFromInt(1073741823&a.words[s-1]):this.pos32BitIntFor(a.words[s-1]);if(a.isBytes())return i.convertChars?this.charFromInt(255&a.bytes[s-1]):255&a.bytes[s-1];var o=4*a.pointersSize();return s-1-o<0?(this.success=!1,a):255&a.bytes[s-1-o]},objectAtPut:function(e,t,r){var i,a=this.stackNonInteger(2),s=this.stackPos32BitInt(1);if(!this.success)return a;if(e){if((i=this.atPutCache[a.hash&this.atCacheMask]).array!==a)return this.success=!1,a}else{if(a.isFloat){var n=this.stackPos32BitInt(0);if(!this.success||1!=s&&2!=s)this.success=!1;else{var o=a.floatData();o.setUint32(1==s?0:4,n,!1),a.float=o.getFloat64(0)}return this.vm.stackValue(0)}i=this.makeAtCacheInfo(this.atPutCache,this.vm.specialSelectors[34],a,t,r)}if(s<1||s>i.size)return this.success=!1,a;var u,l=this.vm.stackValue(0);if(r)return a.dirty=!0,a.pointers[s-1]=l;if(a.isPointers())return a.dirty=!0,a.pointers[s-1+i.ivarOffset]=l;if(a.isWords()){if(t){if(l.sqClass!==this.vm.specialObjects[Squeak.splOb_ClassCharacter])return this.success=!1,l;if("number"!=typeof(u=this.charToInt(l)))return this.success=!1,l}else u=this.stackPos32BitInt(0);return this.success&&(a.words[s-1]=u),l}if(t){if(l.sqClass!==this.vm.specialObjects[Squeak.splOb_ClassCharacter])return this.success=!1,l;if("number"!=typeof(u=this.charToInt(l)))return this.success=!1,l}else{if("number"!=typeof l)return this.success=!1,l;u=l}if(u<0||255<u)return this.success=!1,l;if(a.isBytes())return a.bytes[s-1]=u,l;var c=4*a.pointersSize();return s-1-c<0?(this.success=!1,a):(a.bytes[s-1-c]=u,l)},objectSize:function(e){var t=this.vm.stackValue(0),r=-1;return e?t.sqClass===this.vm.specialObjects[Squeak.splOb_ClassArray]?r=t.pointersSize():t.sqClass===this.vm.specialObjects[Squeak.splOb_ClassString]&&(r=t.bytesSize()):r=this.indexableSize(t),-1===r?(this.success=!1,-1):this.pos32BitIntFor(r)},initAtCache:function(){this.atCacheSize=32,this.atCacheMask=this.atCacheSize-1,this.atCache=[],this.atPutCache=[],this.nonCachedInfo={};for(var e=0;e<this.atCacheSize;e++)this.atCache.push({}),this.atPutCache.push({})},makeAtCacheInfo:function(e,t,r,i,a){var s;return(s=this.vm.verifyAtSelector===t&&this.vm.verifyAtClass===r.sqClass&&!this.vm.isContext(r)?e[r.hash&this.atCacheMask]:this.nonCachedInfo).array=r,s.convertChars=i,a?(s.size=r.instSize()+Math.max(0,r.indexableSize(this)),s.ivarOffset=0):(s.size=r.indexableSize(this),s.ivarOffset=r.isPointers()?r.instSize():0),s}},"basic",{instantiateClass:function(e,t){return 4*t>this.vm.image.bytesLeft()?(console.warn("squeak: out of memory, failing allocation"),this.success=!1,this.vm.primFailCode=Squeak.PrimErrNoMemory,null):this.vm.instantiateClass(e,t)},someObject:function(){return this.vm.image.firstOldObject},nextObject:function(e){return this.vm.image.objectAfter(e)||0},someInstanceOf:function(e){var t=this.vm.image.someInstanceOf(e);return t||(this.success=!1,0)},nextInstanceAfter:function(e){var t=this.vm.image.nextInstanceAfter(e);return t||(this.success=!1,0)},allInstancesOf:function(e){var t=this.vm.image.allInstancesOf(e),r=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassArray],t.length);return r.pointers=t,r},identityHash:function(e){return e.hash},identityHashSpur:function(e){var t=e.hash;return 0<t?t:e.hash=this.newObjectHash()},behaviorHash:function(e){var t=e.hash;return 0<t?t:this.vm.image.enterIntoClassTable(e)},newObjectHash:function(e){return Math.floor(4194302*Math.random())+1},primitivePin:function(e){var t=this.stackNonInteger(1),r=this.stackBoolean(0);if(!this.success)return!1;var i=t.pinned;return t.pinned=r,this.popNandPushIfOK(e+1,this.makeStObject(!!i))},primitiveIsPinned:function(e){var t=this.stackNonInteger(0);return!!this.success&&this.popNandPushIfOK(e+1,this.makeStObject(!!t.pinned))},primitiveSizeInBytesOfInstance:function(e){if(1<e)return!1;var t=this.stackNonInteger(e),r=e?this.stackInteger(0):0,i=t.classByteSizeOfInstance(r);return this.popNandPushIfOK(e+1,this.makeLargeIfNeeded(i))},primitiveSizeInBytes:function(e){var t=this.stackNonInteger(0).totalBytes();return this.popNandPushIfOK(e+1,this.makeLargeIfNeeded(t))},primitiveAsCharacter:function(e){var t=this.stackInteger(0);if(t<0||1073741823<t)return!1;var r=this.charFromInt(t);return!!r&&this.popNandPushIfOK(e+1,r)},primitiveFullGC:function(e){this.vm.image.fullGC("primitive");var t=this.vm.image.bytesLeft();return this.popNandPushIfOK(e+1,this.makeLargeIfNeeded(t))},primitivePartialGC:function(e){this.vm.image.partialGC("primitive");var t=this.vm.image.bytesLeft();return this.popNandPushIfOK(e+1,this.makeLargeIfNeeded(t))},primitiveMakePoint:function(e,t){var r=this.vm.stackValue(1),i=this.vm.stackValue(0);return!(t&&(this.checkFloat(r),this.checkFloat(i),!this.success))&&(this.vm.popNandPush(1+e,this.makePointWithXandY(r,i)),!0)},primitiveStoreStackp:function(e){var t=this.stackNonInteger(1),r=this.stackInteger(0);if(!this.success||r<0||this.vm.decodeSqueakSP(r)>=t.pointers.length)return!1;for(var i=t.pointers[Squeak.Context_stackPointer];i<r;)t.pointers[this.vm.decodeSqueakSP(++i)]=this.vm.nilObj;return t.pointers[Squeak.Context_stackPointer]=r,this.vm.popN(e),!0},primitiveChangeClass:function(e){if(2<e)return!1;var t=this.stackNonInteger(1),r=this.stackNonInteger(0);return!!this.changeClassTo(t,r.sqClass)&&this.popNIfOK(e)},primitiveAdoptInstance:function(e){if(2<e)return!1;var t=this.stackNonInteger(1),r=this.stackNonInteger(0);return!!this.changeClassTo(r,t)&&this.popNIfOK(e)},changeClassTo:function(e,t){if(e.sqClass.isCompact!==t.isCompact)return!1;var r=t.classInstIsPointers();if(e.isPointers()){if(!r)return!1;if(e.sqClass.classInstSize()!==t.classInstSize())return!1}else{if(r)return!1;var i=e.isBytes(),a=t.classInstIsBytes();if(i&&!a){if(e.bytes){if(3&e.bytes.length)return!1;e.words=new Uint32Array(e.bytes.buffer),delete e.bytes}}else!i&&a&&e.words&&(e.bytes=new Uint8Array(e.words.buffer),delete e.words)}return e._format=t.classInstFormat(),e.sqClass=t,!0},primitiveDoPrimitiveWithArgs:function(e){var t=this.stackNonInteger(0),r=this.stackInteger(1);if(!this.success)return!1;var i=t.pointersSize(),a=this.vm.activeContext.pointersSize();if(this.vm.sp+i>=a)return!1;this.vm.popN(2);for(var s=0;s<i;s++)this.vm.push(t.pointers[s]);return!!this.vm.tryPrimitive(r,i)||(this.vm.popN(i),this.vm.push(r),this.vm.push(t),!1)},primitiveShortAtAndPut:function(e){var t,r=this.stackNonInteger(e),i=this.stackInteger(e-1)-1,a=r.wordsAsInt16Array();if(!this.success||!a||i<0||i>=a.length)return!1;if(e<2)t=a[i];else{if((t=this.stackInteger(0))<-32768||32767<t)return!1;a[i]=t}return this.popNandPushIfOK(e+1,t),!0},primitiveIntegerAtAndPut:function(e){var t,r=this.stackNonInteger(e),i=this.stackInteger(e-1)-1,a=r.wordsAsInt32Array();if(!this.success||!a||i<0||i>=a.length)return!1;if(e<2)t=this.signed32BitIntegerFor(a[i]);else{if(t=this.stackSigned32BitInt(0),!this.success)return!1;a[i]=t}return this.popNandPushIfOK(e+1,t),!0},primitiveConstantFill:function(e){var t=this.stackNonInteger(1),r=this.stackPos32BitInt(0);if(!this.success||!t.isWordsOrBytes())return!1;var i=t.words||t.bytes;if(i){if(i===t.bytes&&255<r)return!1;for(var a=0;a<i.length;a++)i[a]=r}return this.vm.popN(e),!0},primitiveNewMethod:function(e){var t=this.stackInteger(0),r=this.stackInteger(1);if(!this.success)return 0;var i=this.vm.instantiateClass(this.vm.stackValue(2),r);i.pointers=[t];for(var a=i.methodNumLits(),s=0;s<a;s++)i.pointers.push(this.vm.nilObj);return this.vm.popNandPush(1+e,i),this.vm.breakOnNewMethod&&(this.vm.breakOnMethod=i),!0},primitiveExecuteMethodArgsArray:function(e){var t=this.stackNonInteger(0),r=this.stackNonInteger(1),i=this.vm.stackValue(2);if(!this.success||!t.isMethod()||4<e)return!1;var a=t.methodNumArgs();if(a!==r.pointersSize())return!1;this.vm.popNandPush(e+1,i);for(var s=0;s<a;s++)this.vm.push(r.pointers[s]);return this.vm.executeNewMethod(i,t,a,t.methodPrimitiveIndex(),null,null),!0},primitiveArrayBecome:function(e,t,r){var i=this.stackNonInteger(e),a=this.stackNonInteger(e-1);return 1<e&&(r=this.stackBoolean(e-2)),!!this.success&&(this.success=this.vm.image.bulkBecome(i.pointers,a.pointers,t,r),this.popNIfOK(e))},doStringReplace:function(){var e=this.stackNonInteger(4),t=this.stackInteger(3)-1,r=this.stackInteger(2)-t,i=this.stackNonInteger(1),a=this.stackInteger(0)-1;if(!this.success)return e;if(!i.sameFormatAs(e))return this.success=!1,e;if(i.isPointers()){var s=i.pointersSize();if((a+=i.instSize())<0||s<a+r)return this.success=!1,e;if(s=e.pointersSize(),(t+=e.instSize())<0||s<t+r)return this.success=!1,e;for(var n=0;n<r;n++)e.pointers[t+n]=i.pointers[a+n];return e}if(i.isWords()){s=i.wordsSize();if(a<0||s<a+r)return this.success=!1,e;if(s=e.wordsSize(),t<0||s<t+r)return this.success=!1,e;if(i.isFloat&&e.isFloat)e.float=i.float;else if(i.isFloat)e.wordsAsFloat64Array()[t]=i.float;else if(e.isFloat)e.float=i.wordsAsFloat64Array()[a];else for(n=0;n<r;n++)e.words[t+n]=i.words[a+n];return e}s=i.bytesSize();if(a<0||s<a+r)return this.success=!1,e;if(s=e.bytesSize(),t<0||s<t+r)return this.success=!1,e;for(n=0;n<r;n++)e.bytes[t+n]=i.bytes[a+n];return e},primitiveCopyObject:function(e){var t=this.stackNonInteger(1),r=this.stackNonInteger(0),i=t.pointersSize();if(!this.success||t.isWordsOrBytes()||t.sqClass!==r.sqClass||i!==r.pointersSize())return!1;for(var a=0;a<i;a++)t.pointers[a]=r.pointers[a];return t.dirty=r.dirty,this.vm.popN(e),!0},primitiveStoreImageSegment:function(e){var t=this.stackNonInteger(2),r=this.stackNonInteger(1),i=this.stackNonInteger(0);return!!(t.pointers&&r.words&&i.pointers)&&(!!this.vm.image.storeImageSegment(r,i,t)&&(this.vm.popN(e),!0))},primitiveLoadImageSegment:function(e){var t=this.stackNonInteger(1),r=this.stackNonInteger(0);if(!t.words||!r.pointers)return!1;var i=this.vm.image.loadImageSegment(t,r);return!!i&&this.popNandPushIfOK(e+1,i)}},"blocks/closures",{doBlockCopy:function(){var e=this.vm.stackValue(1),t=this.stackInteger(0),r=e;if(this.vm.isContext(r)||(this.success=!1),!this.success)return e;"number"==typeof r.pointers[Squeak.Context_method]&&(r=r.pointers[Squeak.BlockContext_home]);var i=r.pointersSize()-r.instSize(),a=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassBlockContext],i),s=this.vm.encodeSqueakPC(this.vm.pc+2,this.vm.method);return a.pointers[Squeak.BlockContext_initialIP]=s,a.pointers[Squeak.Context_instructionPointer]=s,a.pointers[Squeak.Context_stackPointer]=0,a.pointers[Squeak.BlockContext_argumentCount]=t,a.pointers[Squeak.BlockContext_home]=r,a.pointers[Squeak.Context_sender]=this.vm.nilObj,a},primitiveBlockValue:function(e){var t=this.vm.stackValue(e);if(!this.isA(t,Squeak.splOb_ClassBlockContext))return!1;var r=t,i=r.pointers[Squeak.BlockContext_argumentCount];if("number"!=typeof i)return!1;if(i!=e)return!1;if(!r.pointers[Squeak.BlockContext_caller].isNil)return!1;this.vm.arrayCopy(this.vm.activeContext.pointers,this.vm.sp-e+1,r.pointers,Squeak.Context_tempFrameStart,e);var a=r.pointers[Squeak.BlockContext_initialIP];return r.pointers[Squeak.Context_instructionPointer]=a,r.pointers[Squeak.Context_stackPointer]=e,r.pointers[Squeak.BlockContext_caller]=this.vm.activeContext,this.vm.popN(e+1),this.vm.newActiveContext(r),this.vm.interruptCheckCounter--<=0&&this.vm.checkForInterrupts(),!0},primitiveBlockValueWithArgs:function(e){var t=this.vm.stackValue(1),r=this.vm.stackValue(0);if(!this.isA(t,Squeak.splOb_ClassBlockContext))return!1;if(!this.isA(r,Squeak.splOb_ClassArray))return!1;var i=t.pointers[Squeak.BlockContext_argumentCount];if("number"!=typeof i)return!1;if(i!=r.pointersSize())return!1;if(!t.pointers[Squeak.BlockContext_caller].isNil)return!1;this.vm.arrayCopy(r.pointers,0,t.pointers,Squeak.Context_tempFrameStart,i);var a=t.pointers[Squeak.BlockContext_initialIP];return t.pointers[Squeak.Context_instructionPointer]=a,t.pointers[Squeak.Context_stackPointer]=i,t.pointers[Squeak.BlockContext_caller]=this.vm.activeContext,this.vm.popN(e+1),this.vm.newActiveContext(t),this.vm.interruptCheckCounter--<=0&&this.vm.checkForInterrupts(),!0},primitiveClosureCopyWithCopiedValues:function(e){return this.vm.breakNow("primitiveClosureCopyWithCopiedValues"),!1},primitiveClosureValue:function(e){var t=this.vm.stackValue(e);return e===t.pointers[Squeak.Closure_numArgs]&&(this.activateNewClosureMethod(t,e),this.vm.interruptCheckCounter--<=0&&this.vm.checkForInterrupts(),!0)},primitiveClosureValueWithArgs:function(e){var t=this.vm.top(),r=t.pointersSize(),i=this.vm.stackValue(e);if(r!==i.pointers[Squeak.Closure_numArgs])return!1;this.vm.pop();for(var a=0;a<r;a++)this.vm.push(t.pointers[a]);return this.activateNewClosureMethod(i,r),this.vm.interruptCheckCounter--<=0&&this.vm.checkForInterrupts(),!0},primitiveClosureValueNoContextSwitch:function(e){var t=this.vm.stackValue(e);return e===t.pointers[Squeak.Closure_numArgs]&&(this.activateNewClosureMethod(t,e),!0)},primitiveFullClosureValue:function(e){var t=this.vm.stackValue(e);return e===t.pointers[Squeak.Closure_numArgs]&&(this.activateNewFullClosure(t,e),this.vm.interruptCheckCounter--<=0&&this.vm.checkForInterrupts(),!0)},primitiveFullClosureValueWithArgs:function(e){var t=this.vm.top(),r=t.pointersSize(),i=this.vm.stackValue(e);if(r!==i.pointers[Squeak.Closure_numArgs])return!1;this.vm.pop();for(var a=0;a<r;a++)this.vm.push(t.pointers[a]);return this.activateNewFullClosure(i,r),this.vm.interruptCheckCounter--<=0&&this.vm.checkForInterrupts(),!0},primitiveFullClosureValueNoContextSwitch:function(e){var t=this.vm.stackValue(e);return e===t.pointers[Squeak.Closure_numArgs]&&(this.activateNewFullClosure(t,e),!0)},activateNewClosureMethod:function(e,t){var r=e.pointers[Squeak.Closure_outerContext],i=r.pointers[Squeak.Context_method],a=this.vm.allocateOrRecycleContext(i.methodNeedsLargeFrame()),s=e.pointers.length-Squeak.Closure_firstCopiedValue;a.pointers[Squeak.Context_sender]=this.vm.activeContext,a.pointers[Squeak.Context_instructionPointer]=e.pointers[Squeak.Closure_startpc],a.pointers[Squeak.Context_stackPointer]=t+s,a.pointers[Squeak.Context_method]=r.pointers[Squeak.Context_method],a.pointers[Squeak.Context_closure]=e,a.pointers[Squeak.Context_receiver]=r.pointers[Squeak.Context_receiver];for(var n=Squeak.Context_tempFrameStart,o=0;o<t;o++)a.pointers[n++]=this.vm.stackValue(t-o-1);for(o=0;o<s;o++)a.pointers[n++]=e.pointers[Squeak.Closure_firstCopiedValue+o];this.vm.popN(t+1),this.vm.newActiveContext(a)},activateNewFullClosure:function(e,t){var r=e.pointers[Squeak.ClosureFull_method],i=this.vm.allocateOrRecycleContext(r.methodNeedsLargeFrame()),a=e.pointers.length-Squeak.ClosureFull_firstCopiedValue;i.pointers[Squeak.Context_sender]=this.vm.activeContext,i.pointers[Squeak.Context_instructionPointer]=this.vm.encodeSqueakPC(0,r),i.pointers[Squeak.Context_stackPointer]=r.methodTempCount(),i.pointers[Squeak.Context_method]=r,i.pointers[Squeak.Context_closure]=e,i.pointers[Squeak.Context_receiver]=e.pointers[Squeak.ClosureFull_receiver];for(var s=Squeak.Context_tempFrameStart,n=0;n<t;n++)i.pointers[s++]=this.vm.stackValue(t-n-1);for(n=0;n<a;n++)i.pointers[s++]=e.pointers[Squeak.ClosureFull_firstCopiedValue+n];this.vm.popN(t+1),this.vm.newActiveContext(i)}},"scheduling",{primitiveResume:function(){return this.resume(this.vm.top()),!0},primitiveSuspend:function(){var e=this.vm.top();if(e===this.activeProcess())this.vm.popNandPush(1,this.vm.nilObj),this.transferTo(this.wakeHighestPriority());else{var t=e.pointers[Squeak.Proc_myList];if(t.isNil)return!1;if(this.removeProcessFromList(e,t),!this.success)return!1;e.pointers[Squeak.Proc_myList]=this.vm.nilObj,this.vm.popNandPush(1,t)}return!0},getScheduler:function(){return this.vm.specialObjects[Squeak.splOb_SchedulerAssociation].pointers[Squeak.Assn_value]},activeProcess:function(){return this.getScheduler().pointers[Squeak.ProcSched_activeProcess]},resume:function(e){var t=this.activeProcess();t.pointers[Squeak.Proc_priority]<e.pointers[Squeak.Proc_priority]?(this.putToSleep(t),this.transferTo(e)):this.putToSleep(e)},putToSleep:function(e){var t=e.pointers[Squeak.Proc_priority],r=this.getScheduler().pointers[Squeak.ProcSched_processLists].pointers[t-1];this.linkProcessToList(e,r)},transferTo:function(e){var t=this.getScheduler(),r=t.pointers[Squeak.ProcSched_activeProcess];t.pointers[Squeak.ProcSched_activeProcess]=e,t.dirty=!0,r.pointers[Squeak.Proc_suspendedContext]=this.vm.activeContext,r.dirty=!0,this.vm.newActiveContext(e.pointers[Squeak.Proc_suspendedContext]),e.pointers[Squeak.Proc_suspendedContext]=this.vm.nilObj,this.oldPrims||(e.pointers[Squeak.Proc_myList]=this.vm.nilObj),this.vm.reclaimableContextCount=0,this.vm.breakOnContextChanged&&(this.vm.breakOnContextChanged=!1,this.vm.breakNow()),this.vm.logProcess&&console.log("\n============= Process Switch ==================\n"+this.vm.printProcess(e,!0,this.vm.logSends?"| ":"")+"===============================================")},wakeHighestPriority:function(){var e,t=this.getScheduler().pointers[Squeak.ProcSched_processLists],r=t.pointersSize()-1;do{if(r<0)throw Error("scheduler could not find a runnable process");e=t.pointers[r--]}while(this.isEmptyList(e));return this.removeFirstLinkOfList(e)},linkProcessToList:function(e,t){if(this.isEmptyList(t))t.pointers[Squeak.LinkedList_firstLink]=e;else{var r=t.pointers[Squeak.LinkedList_lastLink];r.pointers[Squeak.Link_nextLink]=e,r.dirty=!0}t.pointers[Squeak.LinkedList_lastLink]=e,t.dirty=!0,e.pointers[Squeak.Proc_myList]=t,e.dirty=!0},isEmptyList:function(e){return e.pointers[Squeak.LinkedList_firstLink].isNil},removeFirstLinkOfList:function(e){var t=e.pointers[Squeak.LinkedList_firstLink];if(t===e.pointers[Squeak.LinkedList_lastLink])e.pointers[Squeak.LinkedList_firstLink]=this.vm.nilObj,e.pointers[Squeak.LinkedList_lastLink]=this.vm.nilObj;else{var r=t.pointers[Squeak.Link_nextLink];e.pointers[Squeak.LinkedList_firstLink]=r,e.dirty=!0}return t.pointers[Squeak.Link_nextLink]=this.vm.nilObj,t},removeProcessFromList:function(e,t){var r=t.pointers[Squeak.LinkedList_firstLink],i=t.pointers[Squeak.LinkedList_lastLink];if(e===r){var a=e.pointers[Squeak.Link_nextLink];t.pointers[Squeak.LinkedList_firstLink]=a,e===i&&(t.pointers[Squeak.LinkedList_lastLink]=this.vm.nilObj)}else{for(var s=r;;){if(s.isNil)return void(this.oldPrims&&(this.success=!1));if((a=s.pointers[Squeak.Link_nextLink])===e)break;s=a}a=e.pointers[Squeak.Link_nextLink],s.pointers[Squeak.Link_nextLink]=a,e===i&&(t.pointers[Squeak.LinkedList_lastLink]=s)}e.pointers[Squeak.Link_nextLink]=this.vm.nilObj},registerSemaphore:function(e){var t=this.vm.top();return this.isA(t,Squeak.splOb_ClassSemaphore)?this.vm.specialObjects[e]=t:this.vm.specialObjects[e]=this.vm.nilObj,this.vm.stackValue(1)},primitiveWait:function(){var e=this.vm.top();if(!this.isA(e,Squeak.splOb_ClassSemaphore))return!1;var t=e.pointers[Squeak.Semaphore_excessSignals];return 0<t?e.pointers[Squeak.Semaphore_excessSignals]=t-1:(this.linkProcessToList(this.activeProcess(),e),this.transferTo(this.wakeHighestPriority())),!0},primitiveSignal:function(){var e=this.vm.top();return!!this.isA(e,Squeak.splOb_ClassSemaphore)&&(this.synchronousSignal(e),!0)},synchronousSignal:function(e){this.isEmptyList(e)?e.pointers[Squeak.Semaphore_excessSignals]++:this.resume(this.removeFirstLinkOfList(e))},signalAtMilliseconds:function(e,t){this.isA(e,Squeak.splOb_ClassSemaphore)?(this.vm.specialObjects[Squeak.splOb_TheTimerSemaphore]=e,this.vm.nextWakeupTick=t):(this.vm.specialObjects[Squeak.splOb_TheTimerSemaphore]=this.vm.nilObj,this.vm.nextWakeupTick=0)},primitiveSignalAtMilliseconds:function(e){var t=this.stackInteger(0),r=this.stackNonInteger(1);return!!this.success&&(this.signalAtMilliseconds(r,t),this.vm.popN(e),!0)},primitiveSignalAtUTCMicroseconds:function(e){var t=this.stackSigned53BitInt(0),r=this.stackNonInteger(1);if(!this.success)return!1;var i=t/1e3+Squeak.EpochUTC-this.vm.startupTime&Squeak.MillisecondClockMask;return this.signalAtMilliseconds(r,i),this.vm.popN(e),!0},signalSemaphoreWithIndex:function(e){this.semaphoresToSignal.push(e)},signalExternalSemaphores:function(){for(var e=this.vm.specialObjects[Squeak.splOb_ExternalObjectsArray].pointers,t=this.vm.specialObjects[Squeak.splOb_ClassSemaphore];this.semaphoresToSignal.length;){var r=e[this.semaphoresToSignal.shift()-1];r.sqClass==t&&this.synchronousSignal(r)}},primitiveEnterCriticalSection:function(e){if(1<e)return!1;var t=this.vm.stackValue(e),r=e?this.vm.top():this.activeProcess(),i=t.pointers[Squeak.Mutex_owner];return i.isNil?(t.pointers[Squeak.Mutex_owner]=r,t.dirty=!0,this.popNandPushIfOK(e+1,this.vm.falseObj)):i===r?this.popNandPushIfOK(e+1,this.vm.trueObj):(this.popNandPushIfOK(e+1,this.vm.falseObj),this.linkProcessToList(r,t),this.transferTo(this.wakeHighestPriority())),!0},primitiveExitCriticalSection:function(e){var t=this.vm.top();if(this.isEmptyList(t))t.pointers[Squeak.Mutex_owner]=this.vm.nilObj;else{var r=this.removeFirstLinkOfList(t);t.pointers[Squeak.Mutex_owner]=r,t.dirty=!0,this.resume(r)}return!0},primitiveTestAndSetOwnershipOfCriticalSection:function(e){if(1<e)return!1;var t=this.vm.stackValue(e),r=e?this.vm.top():this.activeProcess(),i=t.pointers[Squeak.Mutex_owner];return i.isNil?(t.pointers[Squeak.Mutex_owner]=r,t.dirty=!0,this.popNandPushIfOK(e+1,this.vm.falseObj)):i===r?this.popNandPushIfOK(e+1,this.vm.trueObj):this.popNandPushIfOK(e+1,this.vm.nilObj),!0}},"vm functions",{primitiveGetAttribute:function(e){var t=this.stackInteger(0);if(!this.success)return!1;var r=this.display.argv,i=this.display.vmOptions,a=null;switch(t){case 0:a=r&&r[0]||this.filenameToSqueak(Squeak.vmPath+Squeak.vmFile);break;case 1:a=r&&r[1]||this.display.documentName;break;case 2:a=r&&r[2]||this.display.documentName;break;case 1001:a=Squeak.platformName;break;case 1002:a=Squeak.osVersion;break;case 1003:a=Squeak.platformSubtype;break;case 1004:a=Squeak.vmVersion+" "+Squeak.vmMakerVersion;break;case 1005:a=Squeak.windowSystem;break;case 1006:a=Squeak.vmBuild;break;case 1007:a=Squeak.vmInterpreterVersion;break;case 1009:a=Squeak.vmVersion+" Date: "+Squeak.vmDate;break;default:if(0<=t&&r&&r.length>t)a=r[t];else{if(!(t<0&&i&&i.length>-t-1))return!1;a=i[-t-1]}}return this.vm.popNandPush(e+1,this.makeStObject(a)),!0},setLowSpaceThreshold:function(){var e=this.stackInteger(0);return this.success&&(this.vm.lowSpaceThreshold=e),this.vm.stackValue(1)},primitiveVMParameter:function(e){var t=this.vm.image.isSpur?71:44;switch(e){case 0:for(var r=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassArray],t),i=0;i<t;i++)r.pointers[i]=this.makeStObject(this.vmParameterAt(i+1));return this.popNandPushIfOK(1,r);case 1:var a=this.stackInteger(0);return a<1||t<a?!1:this.popNandPushIfOK(2,this.makeStObject(this.vmParameterAt(a)));case 2:return this.popNandPushIfOK(3,0)}return!1},vmParameterAt:function(e){switch(e){case 1:case 2:return this.vm.image.oldSpaceBytes;case 3:return this.vm.image.totalMemory;case 4:return this.vm.image.allocationCount+this.vm.image.newSpaceCount;case 7:return this.vm.image.gcCount;case 8:return this.vm.image.gcMilliseconds;case 9:return this.vm.image.pgcCount;case 10:return this.vm.image.pgcMilliseconds;case 11:return this.vm.image.gcTenured;case 15:case 16:case 17:case 18:case 19:case 20:case 22:return 0;case 23:return this.vm.image.extraVMMemory;case 40:return 4;case 41:return this.vm.image.formatVersion();case 44:case 46:case 48:return 0;case 54:return this.vm.image.bytesLeft();case 65:return 0;case 67:return this.vm.image.totalMemory}return null},primitiveImageName:function(e){return 0==e?this.popNandPushIfOK(1,this.makeStString(this.filenameToSqueak(this.vm.image.name))):(this.vm.image.name=this.filenameFromSqueak(this.vm.top().bytesAsString()),Squeak.Settings.squeakImageName=this.vm.image.name,this.vm.popN(e),!0)},primitiveSnapshot:function(e){this.vm.popNandPush(1,this.vm.trueObj),this.vm.storeContextRegisters(),this.activeProcess().pointers[Squeak.Proc_suspendedContext]=this.vm.activeContext,this.vm.image.fullGC("snapshot");var t=this.vm.image.writeToBuffer();return Squeak.flushAllFiles&&(Squeak.flushAllFiles(),Squeak.filePut(this.vm.image.name,t)),this.vm.popNandPush(1,this.vm.falseObj),!0},primitiveQuit:function(e){return Squeak.flushAllFiles&&Squeak.flushAllFiles(),this.display.quitFlag=!0,this.vm.breakNow("quit"),!0},primitiveExitToDebugger:function(e){return this.vm.breakNow("debugger primitive"),!0},primitiveSetGCBiasToGrow:function(e){return this.fakePrimitive(".primitiveSetGCBiasToGrow",0,e)},primitiveSetGCBiasToGrowGCLimit:function(e){return this.fakePrimitive(".primitiveSetGCBiasToGrowGCLimit",0,e)}},"time",{primitiveRelinquishProcessorForMicroseconds:function(e){return this.vm.popN(e),this.vm.goIdle(),!0},millisecondClockValue:function(){return Date.now()-this.vm.startupTime&Squeak.MillisecondClockMask},millisecondClockValueSet:function(e){this.vm.startupTime=Date.now()-e},secondClock:function(){return this.pos32BitIntFor(Squeak.totalSeconds())},microsecondClock:function(e){var t=Date.now()-e.epoch;if("object"!=typeof performance)return this.pos53BitIntFor(1e3*t);var r=1e3*performance.now()%1e3|0,i=e.millis,a=e.micros;return t<i&&(t=i),t===i&&r<a&&t++,e.millis=t,e.micros=r,this.pos53BitIntFor(1e3*t+r)},microsecondClockUTC:function(){return this.microsecondClockUTCState||(this.microsecondClockUTCState={epoch:Squeak.EpochUTC,millis:0,micros:0}),this.microsecondClock(this.microsecondClockUTCState)},microsecondClockLocal:function(){return this.microsecondClockLocalState||(this.microsecondClockLocalState={epoch:Squeak.Epoch,millis:0,micros:0}),this.microsecondClock(this.microsecondClockLocalState)},primitiveUtcWithOffset:function(e){var t=new Date,r=this.pos53BitIntFor(1e3*t.getTime()),i=-60*t.getTimezoneOffset();if(0<e){var a=this.vm.stackValue(0);return a.pointers[0]=r,a.pointers[1]=i,this.popNandPushIfOK(e+1,a),!0}var s=[r,i];return this.popNandPushIfOK(e+1,this.makeStArray(s)),!0}}),Object.subclass("Squeak.Compiler","initialization",{initialize:function(e){if(e.method.methodSignFlag())return console.warn("Sista bytecode set not (yet) supported by this JIT"),{};this.vm=e,this.comments=!!Squeak.Compiler.comments,this.specialSelectors=["+","-","<",">","<=",">=","=","~=","*","/","\\\\","@","bitShift:","//","bitAnd:","bitOr:","at:","at:put:","size","next","nextPut:","atEnd","==","class","blockCopy:","value","value:","do:","new","new:","x","y"],this.doitCounter=0}},"accessing",{compile:function(e,t,r){if(!e.methodSignFlag())if(void 0===e.compiled)e.compiled=!1;else{this.singleStep=!1,this.debug=this.comments;var i=t&&t.className(),a=r&&r.bytesAsString();e.compiled=this.generate(e,i,a)}},enableSingleStepping:function(i,a,s){if(!i.compiled||!i.compiled.canSingleStep){this.singleStep=!0,this.debug=!0,a||this.vm.allMethodsDo(function(e,t,r){if(t===i)return a=e,s=r,!0});var e=a&&a.className(),t=s&&s.bytesAsString(),r=a&&a.allInstVarNames();i.compiled=this.generate(i,e,t,r),i.compiled.canSingleStep=!0}return!0},functionNameFor:function(e,t){if(void 0===e||"?"===e)return"DOIT_"+ ++this.doitCounter;if(!/[^a-zA-Z0-9:_]/.test(t))return(e+"_"+t).replace(/[: ]/g,"_");var r=t.replace(/./g,function(e){return{"|":"OR","~":"NOT","<":"LT","=":"EQ",">":"GT","&":"AND","@":"AT","*":"TIMES","+":"PLUS","\\":"MOD","-":"MINUS",",":"COMMA","/":"DIV","?":"IF"}[e]||"OPERATOR"});return e.replace(/[ ]/,"_")+"__"+r+"__"}},"generating",{generate:function(e,t,r,i){for(this.method=e,this.pc=0,this.endPC=0,this.prevPC=0,this.source=[],this.sourceLabels={},this.needsLabel={},this.sourcePos={},this.needsVar={},this.needsBreak=!1,t&&r&&this.source.push("// ",t,">>",r,"\n"),this.instVarNames=i,this.allVars=["context","stack","rcvr","inst[","temp[","lit["],this.sourcePos.context=this.source.length,this.source.push("var context = vm.activeContext;\n"),this.sourcePos.stack=this.source.length,this.source.push("var stack = context.pointers;\n"),this.sourcePos.rcvr=this.source.length,this.source.push("var rcvr = vm.receiver;\n"),this.sourcePos["inst["]=this.source.length,this.source.push("var inst = rcvr.pointers;\n"),this.sourcePos["temp["]=this.source.length,this.source.push("var temp = vm.homeContext.pointers;\n"),this.sourcePos["lit["]=this.source.length,this.source.push("var lit = vm.method.pointers;\n"),this.sourcePos["loop-start"]=this.source.length,this.source.push("while (true) switch (vm.pc) {\ncase 0:\n"),this.done=!1;!this.done;){var a=e.bytes[this.pc++],s=0;switch(248&a){case 0:case 8:this.generatePush("inst[",15&a,"]");break;case 16:case 24:this.generatePush("temp[",6+(15&a),"]");break;case 32:case 40:case 48:case 56:this.generatePush("lit[",1+(31&a),"]");break;case 64:case 72:case 80:case 88:this.generatePush("lit[",1+(31&a),"].pointers[1]");break;case 96:this.generatePopInto("inst[",7&a,"]");break;case 104:this.generatePopInto("temp[",6+(7&a),"]");break;case 112:switch(a){case 112:this.generatePush("rcvr");break;case 113:this.generatePush("vm.trueObj");break;case 114:this.generatePush("vm.falseObj");break;case 115:this.generatePush("vm.nilObj");break;case 116:this.generatePush("-1");break;case 117:this.generatePush("0");break;case 118:this.generatePush("1");break;case 119:this.generatePush("2")}break;case 120:switch(a){case 120:this.generateReturn("rcvr");break;case 121:this.generateReturn("vm.trueObj");break;case 122:this.generateReturn("vm.falseObj");break;case 123:this.generateReturn("vm.nilObj");break;case 124:this.generateReturn("stack[vm.sp]");break;case 125:this.generateBlockReturn();break;default:throw Error("unusedBytecode")}break;case 128:case 136:this.generateExtended(a);break;case 144:this.generateJump(1+(7&a));break;case 152:this.generateJumpIf(!1,1+(7&a));break;case 160:s=e.bytes[this.pc++],this.generateJump(256*((7&a)-4)+s);break;case 168:s=e.bytes[this.pc++],this.generateJumpIf(a<172,256*(3&a)+s);break;case 176:case 184:this.generateNumericOp(a);break;case 192:case 200:this.generateQuickPrim(a);break;case 208:case 216:this.generateSend("lit[",1+(15&a),"]",0,!1);break;case 224:case 232:this.generateSend("lit[",1+(15&a),"]",1,!1);break;case 240:case 248:this.generateSend("lit[",1+(15&a),"]",2,!1)}}var n=this.functionNameFor(t,r);return this.singleStep?(this.debug&&this.source.push("// all valid PCs have a label;\n"),this.source.push("default: throw Error('invalid PC');\n}")):(this.sourcePos["loop-end"]=this.source.length,this.source.push("default: vm.interpretOne(true); return;\n}"),this.deleteUnneededLabels()),this.deleteUnneededVariables(),new Function("'use strict';\nreturn function "+n+"(vm) {\n"+this.source.join("")+"}")()},generateExtended:function(e){var t,r;switch(e){case 128:switch((t=this.method.bytes[this.pc++])>>6){case 0:return void this.generatePush("inst[",63&t,"]");case 1:return void this.generatePush("temp[",6+(63&t),"]");case 2:return void this.generatePush("lit[",1+(63&t),"]");case 3:return void this.generatePush("lit[",1+(63&t),"].pointers[1]")}case 129:switch((t=this.method.bytes[this.pc++])>>6){case 0:return void this.generateStoreInto("inst[",63&t,"]");case 1:return void this.generateStoreInto("temp[",6+(63&t),"]");case 2:throw Error("illegal store into literal");case 3:return void this.generateStoreInto("lit[",1+(63&t),"].pointers[1]")}return;case 130:switch((t=this.method.bytes[this.pc++])>>6){case 0:return void this.generatePopInto("inst[",63&t,"]");case 1:return void this.generatePopInto("temp[",6+(63&t),"]");case 2:throw Error("illegal pop into literal");case 3:return void this.generatePopInto("lit[",1+(63&t),"].pointers[1]")}case 131:return t=this.method.bytes[this.pc++],void this.generateSend("lit[",1+(31&t),"]",t>>5,!1);case 132:switch(t=this.method.bytes[this.pc++],r=this.method.bytes[this.pc++],t>>5){case 0:return void this.generateSend("lit[",1+r,"]",31&t,!1);case 1:return void this.generateSend("lit[",1+r,"]",31&t,!0);case 2:return void this.generatePush("inst[",r,"]");case 3:return void this.generatePush("lit[",1+r,"]");case 4:return void this.generatePush("lit[",1+r,"].pointers[1]");case 5:return void this.generateStoreInto("inst[",r,"]");case 6:return void this.generatePopInto("inst[",r,"]");case 7:return void this.generateStoreInto("lit[",1+r,"].pointers[1]")}case 133:return t=this.method.bytes[this.pc++],void this.generateSend("lit[",1+(31&t),"]",t>>5,!0);case 134:return t=this.method.bytes[this.pc++],void this.generateSend("lit[",1+(63&t),"]",t>>6,!1);case 135:return void this.generateInstruction("pop","vm.sp--");case 136:return this.needsVar.stack=!0,void this.generateInstruction("dup","var dup = stack[vm.sp]; stack[++vm.sp] = dup");case 137:return this.needsVar.stack=!0,void this.generateInstruction("push thisContext","stack[++vm.sp] = vm.exportThisContext()");case 138:var i=127<(t=this.method.bytes[this.pc++]),a=127&t;return void this.generateClosureTemps(a,i);case 139:return t=this.method.bytes[this.pc++],r=this.method.bytes[this.pc++],void this.generateCallPrimitive(t+256*r);case 140:return t=this.method.bytes[this.pc++],r=this.method.bytes[this.pc++],void this.generatePush("temp[",6+r,"].pointers[",t,"]");case 141:return t=this.method.bytes[this.pc++],r=this.method.bytes[this.pc++],void this.generateStoreInto("temp[",6+r,"].pointers[",t,"]");case 142:return t=this.method.bytes[this.pc++],r=this.method.bytes[this.pc++],void this.generatePopInto("temp[",6+r,"].pointers[",t,"]");case 143:var s=15&(t=this.method.bytes[this.pc++]),n=t>>4,o=(r=this.method.bytes[this.pc++])<<8|this.method.bytes[this.pc++];return void this.generateClosureCopy(s,n,o)}},generatePush:function(e,t,r,i,a){this.debug&&this.generateDebugCode("push",e,t,r,i,a),this.generateLabel(),this.needsVar[e]=!0,this.needsVar.stack=!0,this.source.push("stack[++vm.sp] = ",e),void 0!==t&&(this.source.push(t,r),void 0!==i&&this.source.push(i,a)),this.source.push(";\n")},generateStoreInto:function(e,t,r,i,a){this.debug&&this.generateDebugCode("store into",e,t,r,i,a),this.generateLabel(),this.needsVar[e]=!0,this.needsVar.stack=!0,this.source.push(e),void 0!==t&&(this.source.push(t,r),void 0!==i&&this.source.push(i,a)),this.source.push(" = stack[vm.sp];\n"),this.generateDirty(e,t)},generatePopInto:function(e,t,r,i,a){this.debug&&this.generateDebugCode("pop into",e,t,r,i,a),this.generateLabel(),this.needsVar[e]=!0,this.needsVar.stack=!0,this.source.push(e),void 0!==t&&(this.source.push(t,r),void 0!==i&&this.source.push(i,a)),this.source.push(" = stack[vm.sp--];\n"),this.generateDirty(e,t)},generateReturn:function(e){this.debug&&this.generateDebugCode("return",e),this.generateLabel(),this.needsVar[e]=!0,this.source.push("vm.pc = ",this.pc,"; vm.doReturn(",e,"); return;\n"),this.needsBreak=!1,this.done=this.pc>this.endPC},generateBlockReturn:function(){this.debug&&this.generateDebugCode("block return"),this.generateLabel(),this.needsVar.stack=!0,this.source.push("vm.pc = ",this.pc,"; vm.doReturn(stack[vm.sp--], context.pointers[0]); return;\n"),this.needsBreak=!1},generateJump:function(e){var t=this.pc+e;this.debug&&this.generateDebugCode("jump to "+t),this.generateLabel(),this.needsVar.context=!0,this.source.push("vm.pc = ",t,"; "),e<0&&this.source.push("\nif (vm.interruptCheckCounter-- <= 0) {\n","   vm.checkForInterrupts();\n","   if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return;\n","}\n"),this.singleStep&&this.source.push("\nif (vm.breakOutOfInterpreter) return;\n"),this.source.push("continue;\n"),this.needsBreak=!1,this.needsLabel[t]=!0,t>this.endPC&&(this.endPC=t)},generateJumpIf:function(e,t){var r=this.pc+t;this.debug&&this.generateDebugCode("jump if "+e+" to "+r),this.generateLabel(),this.needsVar.stack=!0,this.source.push("var cond = stack[vm.sp--]; if (cond === vm.",e,"Obj) {vm.pc = ",r,"; "),this.singleStep&&this.source.push("if (vm.breakOutOfInterpreter) return; else "),this.source.push("continue}\n","else if (cond !== vm.",!e,"Obj) {vm.sp++; vm.pc = ",this.pc,"; vm.send(vm.specialObjects[25], 0, false); return}\n"),this.needsLabel[this.pc]=!0,this.needsLabel[r]=!0,r>this.endPC&&(this.endPC=r)},generateQuickPrim:function(e){switch(this.debug&&this.generateDebugCode("quick send #"+this.specialSelectors[16+(15&e)]),this.generateLabel(),e){case 192:return this.needsVar.stack=!0,this.source.push("var a, b; if ((a=stack[vm.sp-1]).sqClass === vm.specialObjects[7] && typeof (b=stack[vm.sp]) === 'number' && b>0 && b<=a.pointers.length) {\n","  stack[--vm.sp] = a.pointers[b-1];","} else { var c = vm.primHandler.objectAt(true,true,false); if (vm.primHandler.success) stack[--vm.sp] = c; else {\n","  vm.pc = ",this.pc,"; vm.sendSpecial(16); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return; }}\n"),void(this.needsLabel[this.pc]=!0);case 193:return this.needsVar.stack=!0,this.source.push("var a, b; if ((a=stack[vm.sp-2]).sqClass === vm.specialObjects[7] && typeof (b=stack[vm.sp-1]) === 'number' && b>0 && b<=a.pointers.length) {\n","  var c = stack[vm.sp]; stack[vm.sp-=2] = a.pointers[b-1] = c; a.dirty = true;","} else { vm.primHandler.objectAtPut(true,true,false); if (vm.primHandler.success) stack[vm.sp-=2] = c; else {\n","  vm.pc = ",this.pc,"; vm.sendSpecial(17); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return; }}\n"),void(this.needsLabel[this.pc]=!0);case 194:return this.needsVar.stack=!0,this.source.push("if (stack[vm.sp].sqClass === vm.specialObjects[7]) stack[vm.sp] = stack[vm.sp].pointersSize();\n","else if (stack[vm.sp].sqClass === vm.specialObjects[6]) stack[vm.sp] = stack[vm.sp].bytesSize();\n","else { vm.pc = ",this.pc,"; vm.sendSpecial(18); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return; }\n"),void(this.needsLabel[this.pc]=!0);case 198:return this.needsVar.stack=!0,void this.source.push("var cond = stack[vm.sp-1] === stack[vm.sp];\nstack[--vm.sp] = cond ? vm.trueObj : vm.falseObj;\n");case 199:return this.needsVar.stack=!0,void this.source.push("stack[vm.sp] = typeof stack[vm.sp] === 'number' ? vm.specialObjects[5] : stack[vm.sp].sqClass;\n");case 200:return this.needsVar.rcvr=!0,this.source.push("vm.pc = ",this.pc,"; if (!vm.primHandler.quickSendOther(rcvr, ",15&e,")) ","{vm.sendSpecial(",16+(15&e),"); return}\n"),this.needsLabel[this.pc]=!0,void(this.needsLabel[this.pc+2]=!0);case 201:case 202:case 203:return this.needsVar.rcvr=!0,this.source.push("vm.pc = ",this.pc,"; if (!vm.primHandler.quickSendOther(rcvr, ",15&e,")) vm.sendSpecial(",16+(15&e),"); return;\n"),void(this.needsLabel[this.pc]=!0)}this.needsVar.rcvr=!0,this.needsVar.context=!0,this.source.push("vm.pc = ",this.pc,"; if (!vm.primHandler.quickSendOther(rcvr, ",15&e,"))"," vm.sendSpecial(",16+(15&e),");\n","if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return;\n"),this.needsBreak=!1,this.needsLabel[this.pc]=!0},generateNumericOp:function(e){switch(this.debug&&this.generateDebugCode("quick send #"+this.specialSelectors[15&e]),this.generateLabel(),this.needsLabel[this.pc]=!0,e){case 176:return this.needsVar.stack=!0,void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = vm.primHandler.signed32BitIntegerFor(a + b);\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(0); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return}\n");case 177:return this.needsVar.stack=!0,void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = vm.primHandler.signed32BitIntegerFor(a - b);\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(1); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return}\n");case 178:return this.needsVar.stack=!0,void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a < b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(2); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return}\n");case 179:return this.needsVar.stack=!0,void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a > b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(3); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return}\n");case 180:return this.needsVar.stack=!0,void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a <= b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(4); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return}\n");case 181:return this.needsVar.stack=!0,void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a >= b ? vm.trueObj : vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(5); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return}\n");case 182:return this.needsVar.stack=!0,void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a === b ? vm.trueObj : vm.falseObj;\n","} else if (a === b && a.float === a.float) {\n","   stack[--vm.sp] = vm.trueObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(6); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return}\n");case 183:return this.needsVar.stack=!0,void this.source.push("var a = stack[vm.sp - 1], b = stack[vm.sp];\n","if (typeof a === 'number' && typeof b === 'number') {\n","   stack[--vm.sp] = a !== b ? vm.trueObj : vm.falseObj;\n","} else if (a === b && a.float === a.float) {\n","   stack[--vm.sp] = vm.falseObj;\n","} else { vm.pc = ",this.pc,"; vm.sendSpecial(7); if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return}\n");case 184:return void this.source.push("vm.success = true; vm.resultIsFloat = false; if(!vm.pop2AndPushNumResult(vm.stackIntOrFloat(1) * vm.stackIntOrFloat(0))) { vm.pc = ",this.pc,"; vm.sendSpecial(8); return}\n");case 185:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.quickDivide(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(9); return}\n");case 186:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.mod(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(10); return}\n");case 187:return void this.source.push("vm.success = true; if(!vm.primHandler.primitiveMakePoint(1, true)) { vm.pc = ",this.pc,"; vm.sendSpecial(11); return}\n");case 188:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.safeShift(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(12); return}\n");case 189:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.div(vm.stackInteger(1),vm.stackInteger(0)))) { vm.pc = ",this.pc,"; vm.sendSpecial(13); return}\n");case 190:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.stackInteger(1) & vm.stackInteger(0))) { vm.pc = ",this.pc,"; vm.sendSpecial(14); return}\n");case 191:return void this.source.push("vm.success = true; if(!vm.pop2AndPushIntResult(vm.stackInteger(1) | vm.stackInteger(0))) { vm.pc = ",this.pc,"; vm.sendSpecial(15); return}\n")}},generateSend:function(e,t,r,i,a){this.debug&&this.generateDebugCode("send "+("lit["===e?this.method.pointers[t].bytesAsString():"...")),this.generateLabel(),this.needsVar[e]=!0,this.needsVar.context=!0,this.source.push("vm.pc = ",this.pc,"; vm.send(",e,t,r,", ",i,", ",a,"); ","if (context !== vm.activeContext || vm.breakOutOfInterpreter !== false) return;\n"),this.needsBreak=!1,this.needsLabel[this.pc]=!0},generateClosureTemps:function(e,t){if(this.debug&&this.generateDebugCode("closure temps"),this.generateLabel(),this.needsVar.stack=!0,this.source.push("var array = vm.instantiateClass(vm.specialObjects[7], ",e,");\n"),t){for(var r=0;r<e;r++)this.source.push("array.pointers[",r,"] = stack[vm.sp - ",e-r-1,"];\n");this.source.push("stack[vm.sp -= ",e-1,"] = array;\n")}else this.source.push("stack[++vm.sp] = array;\n")},generateClosureCopy:function(e,t,r){var i=this.pc,a=i+r;if(this.debug&&this.generateDebugCode("push closure("+i+"-"+(a-1)+"): "+t+" copied, "+e+" args"),this.generateLabel(),this.needsVar.stack=!0,this.source.push("var closure = vm.instantiateClass(vm.specialObjects[36], ",t,");\n","closure.pointers[0] = context; vm.reclaimableContextCount = 0;\n","closure.pointers[1] = ",i+4*this.method.pointers.length+1,";\n","closure.pointers[2] = ",e,";\n"),0<t){for(var s=0;s<t;s++)this.source.push("closure.pointers[",s+3,"] = stack[vm.sp - ",t-s-1,"];\n");this.source.push("stack[vm.sp -= ",t-1,"] = closure;\n")}else this.source.push("stack[++vm.sp] = closure;\n");this.source.push("vm.pc = ",a,";\n"),this.singleStep&&this.source.push("if (vm.breakOutOfInterpreter) return;\n"),this.source.push("continue;\n"),this.needsBreak=!1,this.needsLabel[i]=!0,this.needsLabel[a]=!0,a>this.endPC&&(this.endPC=a)},generateCallPrimitive:function(e){this.debug&&this.generateDebugCode("call primitive "+e),this.generateLabel(),129===this.method.bytes[this.pc]&&(this.needsVar.stack=!0,this.source.push("if (vm.primFailCode) {stack[vm.sp] = vm.getErrorObjectFromPrimFailCode(); vm.primFailCode = 0;}\n"))},generateDirty:function(e,t){switch(e){case"inst[":this.source.push("rcvr.dirty = true;\n");break;case"lit[":this.source.push(e,t,"].dirty = true;\n");break;case"temp[":break;default:throw Error("unexpected target "+e)}},generateLabel:function(){this.prevPC&&(this.sourceLabels[this.prevPC]=this.source.length,this.source.push("case ",this.prevPC,":\n")),this.prevPC=this.pc},generateDebugCode:function(e,t,r,i,a,s){this.needsBreak&&(this.source.push("if (vm.breakOutOfInterpreter) {vm.pc = ",this.prevPC,"; return}\n"),this.needsLabel[this.prevPC]=!0);for(var n=[],o=this.prevPC;o<this.pc;o++)n.push((this.method.bytes[o]+256).toString(16).slice(-2).toUpperCase());if(this.source.push("// ",this.prevPC," <",n.join(" "),"> ",e),t)switch(this.source.push(" "),t){case"vm.nilObj":this.source.push("nil");break;case"vm.trueObj":this.source.push("true");break;case"vm.falseObj":this.source.push("false");break;case"rcvr":this.source.push("self");break;case"stack[vm.sp]":this.source.push("top of stack");break;case"inst[":this.instVarNames?this.source.push(this.instVarNames[r]):this.source.push("inst var ",r);break;case"temp[":this.source.push("tmp",r-6),"]"!==i&&this.source.push("[",a,"]");break;case"lit[":var u=this.method.pointers[r];"]"===i?this.source.push(u):this.source.push(u.pointers[0].bytesAsString());break;default:this.source.push(t)}this.source.push("\n"),this.needsBreak=this.singleStep},generateInstruction:function(e,t){this.debug&&this.generateDebugCode(e),this.generateLabel(),this.source.push(t,";\n")},deleteUnneededLabels:function(){var e=!1;for(var t in this.sourceLabels)if(this.needsLabel[t])e=!0;else for(var r=0;r<3;r++)this.source[this.sourceLabels[t]+r]="";e||(this.source[this.sourcePos["loop-start"]]="",this.source[this.sourcePos["loop-end"]]="")},deleteUnneededVariables:function(){this.needsVar.stack&&(this.needsVar.context=!0),this.needsVar["inst["]&&(this.needsVar.rcvr=!0);for(var e=0;e<this.allVars.length;e++){var t=this.allVars[e];this.needsVar[t]||(this.source[this.sourcePos[t]]="")}}}),Object.extend(Squeak,"audio",{startAudioOut:function(){if(!this.audioOutContext){var e=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext;this.audioOutContext=e&&new e}return this.audioOutContext},startAudioIn:function(r,e){return this.audioInContext?(this.audioInSource.disconnect(),r(this.audioInContext,this.audioInSource)):(navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia?void navigator.getUserMedia({audio:!0,toString:function(){return"audio"}},function(e){var t=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext;this.audioInContext=t&&new t,this.audioInSource=this.audioInContext.createMediaStreamSource(e),r(this.audioInContext,this.audioInSource)},function(){e("cannot access microphone")}):e("test: audio input not supported"))},stopAudio:function(){this.audioInSource&&this.audioInSource.disconnect()}}),Object.extend(Squeak,"known classes",{BitBlt_dest:0,BitBlt_source:1,BitBlt_halftone:2,BitBlt_combinationRule:3,BitBlt_destX:4,BitBlt_destY:5,BitBlt_width:6,BitBlt_height:7,BitBlt_sourceX:8,BitBlt_sourceY:9,BitBlt_clipX:10,BitBlt_clipY:11,BitBlt_clipW:12,BitBlt_clipH:13,BitBlt_colorMap:14,BitBlt_warpBase:15,Form_bits:0,Form_width:1,Form_height:2,Form_depth:3,Form_offset:4}),Object.extend(Squeak.Primitives.prototype,"display",{displayDirty:function(){}}),Object.extend(Squeak.Primitives.prototype,"display",{initDisplay:function(e){this.display=e,this.display.vm=this.vm,this.indexedColors=[4294967295,4278190081,4294967295,4286611584,4294901760,4278255360,4278190335,4278255615,4294967040,4294902015,4280295456,4282400832,4284506208,4288651167,4290756543,4292861919,4278716424,4279242768,4279769112,4280821800,4281348144,4281874488,4282927176,4283453520,4283979864,4285032552,4285558896,4286085240,4287072135,4287598479,4288124823,4289177511,4289703855,4290230199,4291282887,4291809231,4292335575,4293388263,4293914607,4294440951,4278190081,4278203136,4278216192,4278229248,4278242304,4278255360,4278190131,4278203187,4278216243,4278229299,4278242355,4278255411,4278190182,4278203238,4278216294,4278229350,4278242406,4278255462,4278190233,4278203289,4278216345,4278229401,4278242457,4278255513,4278190284,4278203340,4278216396,4278229452,4278242508,4278255564,4278190335,4278203391,4278216447,4278229503,4278242559,4278255615,4281532416,4281545472,4281558528,4281571584,4281584640,4281597696,4281532467,4281545523,4281558579,4281571635,4281584691,4281597747,4281532518,4281545574,4281558630,4281571686,4281584742,4281597798,4281532569,4281545625,4281558681,4281571737,4281584793,4281597849,4281532620,4281545676,4281558732,4281571788,4281584844,4281597900,4281532671,4281545727,4281558783,4281571839,4281584895,4281597951,4284874752,4284887808,4284900864,4284913920,4284926976,4284940032,4284874803,4284887859,4284900915,4284913971,4284927027,4284940083,4284874854,4284887910,4284900966,4284914022,4284927078,4284940134,4284874905,4284887961,4284901017,4284914073,4284927129,4284940185,4284874956,4284888012,4284901068,4284914124,4284927180,4284940236,4284875007,4284888063,4284901119,4284914175,4284927231,4284940287,4288217088,4288230144,4288243200,4288256256,4288269312,4288282368,4288217139,4288230195,4288243251,4288256307,4288269363,4288282419,4288217190,4288230246,4288243302,4288256358,4288269414,4288282470,4288217241,4288230297,4288243353,4288256409,4288269465,4288282521,4288217292,4288230348,4288243404,4288256460,4288269516,4288282572,4288217343,4288230399,4288243455,4288256511,4288269567,4288282623,4291559424,4291572480,4291585536,4291598592,4291611648,4291624704,4291559475,4291572531,4291585587,4291598643,4291611699,4291624755,4291559526,4291572582,4291585638,4291598694,4291611750,4291624806,4291559577,4291572633,4291585689,4291598745,4291611801,4291624857,4291559628,4291572684,4291585740,4291598796,4291611852,4291624908,4291559679,4291572735,4291585791,4291598847,4291611903,4291624959,4294901760,4294914816,4294927872,4294940928,4294953984,4294967040,4294901811,4294914867,4294927923,4294940979,4294954035,4294967091,4294901862,4294914918,4294927974,4294941030,4294954086,4294967142,4294901913,4294914969,4294928025,4294941081,4294954137,4294967193,4294901964,4294915020,4294928076,4294941132,4294954188,4294967244,4294902015,4294915071,4294928127,4294941183,4294954239,4294967295]},primitiveBeCursor:function(e){if(this.display.cursorCanvas){var t=this.loadForm(this.stackNonInteger(e),!0),r=1===e?this.loadForm(this.stackNonInteger(0)):null;if(!this.success||!t)return!1;var i=this.display.cursorCanvas,a=i.getContext("2d"),s={left:0,top:0,right:t.width,bottom:t.height};i.width=t.width,i.height=t.height,1===t.depth?r?(t=this.cursorMergeMask(t,r),this.showForm(a,t,s,[0,4278190335,4294967295,4278190080])):this.showForm(a,t,s,[0,4278190080]):this.showForm(a,t,s,!0);var n=this.display.context.canvas,o=n.offsetWidth/n.width,u=this.display.highdpi?window.devicePixelRatio:1;i.style.width=(i.width*u*o|0)+"px",i.style.height=(i.height*u*o|0)+"px",this.display.cursorOffsetX=t.offsetX*o|0,this.display.cursorOffsetY=t.offsetY*o|0}return this.vm.popN(e),!0},cursorMergeMask:function(e,t){for(var r=new Uint32Array(16),i=0;i<16;i++){for(var a=e.bits[i],s=t.bits[i],n=2147483648,o=0,u=0;u<16;u++)o=o|(s&n)>>u|(a&n)>>u+1,n>>>=1;r[i]=o}return{obj:e.obj,bits:r,depth:2,width:16,height:16,offsetX:e.offsetX,offsetY:e.offsetY,msb:!0,pixPerWord:16,pitch:1}},primitiveBeDisplay:function(e){var t=this.vm.stackValue(0);return this.vm.specialObjects[Squeak.splOb_TheDisplay]=t,this.vm.popN(e),!0},primitiveReverseDisplay:function(e){if(this.reverseDisplay=!this.reverseDisplay,this.redrawDisplay(),this.display.cursorCanvas){for(var t=this.display.cursorCanvas,r=t.getContext("2d"),i=r.getImageData(0,0,t.width,t.height),a=new Uint32Array(i.data.buffer),s=0;s<a.length;s++)a[s]=16777215^a[s];r.putImageData(i,0,0)}return!0},primitiveShowDisplayRect:function(e){var t={left:this.stackInteger(3),top:this.stackInteger(1),right:this.stackInteger(2),bottom:this.stackInteger(0)};return!!this.success&&(this.redrawDisplay(t),this.vm.popN(e),!0)},redrawDisplay:function(e){var t=this.theDisplay(),r={left:0,top:0,right:t.width,bottom:t.height};e&&(e.left>r.left&&(r.left=e.left),e.right<r.right&&(r.right=e.right),e.top>r.top&&(r.top=e.top),e.bottom<r.bottom&&(r.bottom=e.bottom)),r.left<r.right&&r.top<r.bottom&&this.displayUpdate(t,r)},showForm:function(e,t,r,i){if(r){var a=r.left,s=r.top,n=r.right-a,o=r.bottom-s,u=e.createImageData(n,o),l=u.data;l.buffer||(l=new Uint8Array(n*o*4));var c=new Uint32Array(l.buffer);switch(t.depth){case 1:case 2:case 4:case 8:var h=i||this.swappedColors;if(!h){h=[];for(var f=0;f<256;f++){var p=(4278255360&(w=this.indexedColors[f]))+((16711680&w)>>16)+((255&w)<<16);h[f]=p}this.swappedColors=h}this.reverseDisplay&&(h=i?i.map(function(e){return 16777215^e}):(this.reversedColors||(this.reversedColors=h.map(function(e){return 16777215^e})),this.reversedColors));for(var d=(1<<t.depth)-1,m=32-(a%t.pixPerWord+1)*t.depth,b=0;b<o;b++){for(var v=t.pitch*s+(a/t.pixPerWord|0),g=m,k=t.bits[v],_=u.width*b,y=0;y<n;y++)c[_++]=h[k>>>g&d],(g-=t.depth)<0&&(g=32-t.depth,k=t.bits[++v]);s++}break;case 16:for(m=a%2?0:16,b=0;b<o;b++){for(v=t.pitch*s+(a/2|0),g=m,k=t.bits[v],_=u.width*b,y=0;y<n;y++){var S=k>>>g;c[_++]=((31744&S)>>7)+((992&S)<<6)+((31&S)<<19)+4278190080,(g-=16)<0&&(g=16,k=t.bits[++v])}s++}break;case 32:var O=i?0:4278190080;for(b=0;b<o;b++){for(v=t.pitch*s+a,_=u.width*b,y=0;y<n;y++){var w;p=4278255360&(w=t.bits[v++])|(16711680&w)>>16|(255&w)<<16|O;c[_++]=p}s++}break;default:throw Error("depth not implemented")}u.data!==l&&u.data.set(l),e.putImageData(u,r.left,r.top)}},primitiveDeferDisplayUpdates:function(e){var t=this.stackBoolean(0);return!!this.success&&(this.deferDisplayUpdates=t,this.vm.popN(e),!0)},primitiveForceDisplayUpdate:function(e){return this.vm.breakOut(),this.vm.popN(e),!0},primitiveScanCharacters:function(e){if(6!==e)return!1;var t=this.stackInteger(0),r=this.stackNonInteger(1),i=this.stackInteger(2),a=this.stackNonInteger(3),s=this.stackInteger(4),n=this.stackInteger(5);if(!this.success)return!1;if(r.pointersSize()<258||!a.isBytes())return!1;if(!(0<n&&0<s&&s<=a.bytesSize()))return!1;var o=this.stackNonInteger(6);if(!this.success||o.pointersSize()<4)return!1;var u=this.checkSmallInt(o.pointers[0]),l=this.checkSmallInt(o.pointers[1]),c=this.checkNonInteger(o.pointers[2]),h=this.checkNonInteger(o.pointers[3]);if(!this.success||256!==h.pointersSize())return!1;var f=c.pointersSize()-2;for(l=n;l<=s;){var p=a.bytes[l-1],d=r.pointers[p];if(!d.isNil)return this.ensureSmallInt(u),!!this.success&&(o.pointers[0]=u,o.pointers[1]=l,this.popNandPushIfOK(7,d));var m=this.checkSmallInt(h.pointers[p]);if(!this.success||m<0||f<m)return!1;var b=this.checkSmallInt(c.pointers[m]),v=this.checkSmallInt(c.pointers[m+1]);if(!this.success)return!1;var g=u+v-b;if(i<g)return this.ensureSmallInt(u),!!this.success&&(o.pointers[0]=u,o.pointers[1]=l,d=r.pointers[257],this.popNandPushIfOK(7,d));u=g+t,l+=1}return this.ensureSmallInt(u),!!this.success&&(o.pointers[0]=u,o.pointers[1]=s,d=r.pointers[256],this.popNandPushIfOK(7,d))},primitiveScreenSize:function(e){var t=this.display,r=t.width||t.context.canvas.width,i=t.height||t.context.canvas.height;return this.popNandPushIfOK(e+1,this.makePointWithXandY(r,i))},primitiveScreenScaleFactor:function(e){var t=1/(this.display.initialScale||1);return this.popNandPushIfOK(e+1,this.makeFloat(t))},primitiveSetFullScreen:function(e){var t=this.stackBoolean(0);if(!this.success)return!1;if(this.display.fullscreen!=t)if(this.display.fullscreenRequest){var r=this.vm.freeze();this.display.fullscreenRequest(t,function(){r()})}else this.display.fullscreen=t,this.vm.breakOut();return this.vm.popN(e),!0},primitiveTestDisplayDepth:function(e){return this.popNandPushBoolIfOK(e+1,0<=[1,2,4,8,16,32].indexOf(this.stackInteger(0)))},loadForm:function(e,t){if(e.isNil)return null;var r={obj:e,bits:e.pointers[Squeak.Form_bits].wordsOrBytes(),depth:e.pointers[Squeak.Form_depth],width:e.pointers[Squeak.Form_width],height:e.pointers[Squeak.Form_height]};if(t){var i=e.pointers[Squeak.Form_offset];r.offsetX=i.pointers?i.pointers[Squeak.Point_x]:0,r.offsetY=i.pointers?i.pointers[Squeak.Point_y]:0}if(0===r.width||0===r.height)return r;if(!(0<r.width&&0<r.height))return null;if(r.msb=0<r.depth,r.msb||(r.depth=-r.depth),!(0<r.depth))return null;if(r.pixPerWord=32/r.depth,r.pitch=(r.width+(r.pixPerWord-1))/r.pixPerWord|0,r.bits.length!==r.pitch*r.height){if(!(r.bits.length>r.pitch*r.height))return null;this.vm.warnOnce("loadForm(): "+r.bits.length+" !== "+r.pitch+"*"+r.height+"="+r.pitch*r.height)}return r},theDisplay:function(){return this.loadForm(this.vm.specialObjects[Squeak.splOb_TheDisplay])},displayDirty:function(e,t){this.deferDisplayUpdates||e!=this.vm.specialObjects[Squeak.splOb_TheDisplay]||this.displayUpdate(this.theDisplay(),t)},displayUpdate:function(e,t){this.showForm(this.display.context,e,t),this.display.lastTick=this.vm.lastTick,this.display.idle=0},primitiveBeep:function(e){var t=Squeak.startAudioOut();if(t){var r=t.createOscillator();r.connect(t.destination),r.type="square",r.frequency.value=880,r.start(),r.stop(t.currentTime+.05)}else this.vm.warnOnce("could not initialize audio");return this.popNIfOK(e)}}),Object.extend(Squeak,"files",{fsck:function(r,i,a,s){if(i=i||"",s=s||{dirs:0,files:0,bytes:0,deleted:0},!a&&(a={},Object.keys(Squeak.Settings).forEach(function(e){var t=e.match(/squeak-file(\.lz)?:(.*)$/);t&&(a[t[2]]=!0)}),window.SqueakDBFake&&Object.keys(SqueakDBFake.bigFiles).forEach(function(e){a[e]=!0}),"undefined"!=typeof indexedDB))return this.dbTransaction("readonly","fsck cursor",function(e){var t=e.openCursor();t.onsuccess=function(e){var t=e.target.result;t?(a[t.key]=!0,t.continue()):Squeak.fsck(r,i,a,s)},t.onerror=function(e){console.error("fsck failed")}});var e=Squeak.dirList(i);for(var t in e){var n=i+"/"+t;if(e[t][3])"squeak:"+n in Squeak.Settings?(Squeak.fsck(null,n,a,s),s.dirs++):(console.log("Deleting stale directory "+n),Squeak.dirDelete(n),s.deleted++);else a[n]?(a[n]=!1,s.files++,s.bytes+=e[t][4]):(console.log("Deleting stale file entry "+n),Squeak.fileDelete(n,!0),s.deleted++)}if(""===i){console.log("squeak fsck: "+s.dirs+" directories, "+s.files+" files, "+(s.bytes/1e6).toFixed(1)+" MBytes");var o=[];for(var n in a)a[n]&&o.push(n);if(0<o.length){for(var u=0;u<o.length;u++)console.log("Deleting orphaned file "+o[u]),delete Squeak.Settings["squeak-file:"+o[u]],delete Squeak.Settings["squeak-file.lz:"+o[u]],s.deleted++;"undefined"!=typeof indexedDB&&this.dbTransaction("readwrite","fsck delete",function(e){for(var t=0;t<o.length;t++)e.delete(o[t])})}r&&r(s)}},dbTransaction:function(r,i,a,s){function t(){a(Squeak.dbFake()),s&&s()}if("undefined"==typeof indexedDB)return t();function n(){var e=SqueakDB.transaction("files",r),t=e.objectStore("files");e.oncomplete=function(e){s&&s()},e.onerror=function(e){console.error(e.target.error.name+": "+i)},e.onabort=function(e){console.error(e.target.error.name+": aborting "+i),a(Squeak.dbFake()),s&&s()},a(t)}if(window.SqueakDB)return n();var e;try{e=indexedDB.open("squeak")}catch(e){}if(!e)return t();e.onsuccess=function(e){console.log("Opened files database."),window.SqueakDB=this.result,SqueakDB.onversionchange=function(e){delete window.SqueakDB,this.close()},SqueakDB.onerror=function(e){console.error("Error accessing database: "+e.target.error.name)},n()},e.onupgradeneeded=function(e){console.log("Creating files database"),e.target.result.createObjectStore("files")},e.onerror=function(e){console.error(e.target.error.name+": cannot open files database"),console.warn("Falling back to local storage"),t()},e.onblocked=function(e){console.log("Database upgrade needed, but was blocked."),console.warn("Falling back to local storage"),t()}},dbFake:function(){return"undefined"==typeof SqueakDBFake&&("undefined"==typeof indexedDB&&console.warn("IndexedDB not supported by this browser, using localStorage"),window.SqueakDBFake={bigFiles:{},bigFileThreshold:1e5,get:function(e){var t=SqueakDBFake.bigFiles[e];if(!t){var r=Squeak.Settings["squeak-file:"+e];if(!r){var i=Squeak.Settings["squeak-file.lz:"+e];i&&("object"==typeof LZString?r=LZString.decompressFromUTF16(i):console.error("LZString not loaded: cannot decompress "+e))}if(r){for(var a=new Uint8Array(r.length),s=0;s<a.length;s++)a[s]=255&r.charCodeAt(s);t=a.buffer}}var n={result:t};return setTimeout(function(){n.onsuccess&&n.onsuccess({target:n})},0),n},put:function(e,t){if(e.byteLength>SqueakDBFake.bigFileThreshold)SqueakDBFake.bigFiles[t]||console.log("File "+t+" ("+e.byteLength+" bytes) too large, storing in memory only"),SqueakDBFake.bigFiles[t]=e;else{var r=Squeak.bytesAsString(new Uint8Array(e));if("object"==typeof LZString){var i=LZString.compressToUTF16(r);Squeak.Settings["squeak-file.lz:"+t]=i,delete Squeak.Settings["squeak-file:"+t]}else Squeak.Settings["squeak-file:"+t]=r}var a={};return setTimeout(function(){a.onsuccess&&a.onsuccess()},0),a},delete:function(e){delete Squeak.Settings["squeak-file:"+e],delete Squeak.Settings["squeak-file.lz:"+e],delete SqueakDBFake.bigFiles[e];var t={};return setTimeout(function(){t.onsuccess&&t.onsuccess()},0),t},openCursor:function(){var e={};return setTimeout(function(){e.onsuccess&&e.onsuccess({target:e})},0),e}}),SqueakDBFake},fileGet:function(e,r,i){i=i||function(e){console.log(e)};var a=this.splitFilePath(e);if(!a.basename)return i("Invalid path: "+e);if(Squeak.debugFiles){console.log("Reading "+a.fullname);var t=r;r=function(e){console.log("Read "+e.byteLength+" bytes from "+a.fullname),t(e)}}if(window.SqueakDBFake&&SqueakDBFake.bigFiles[a.fullname])return r(SqueakDBFake.bigFiles[a.fullname]);this.dbTransaction("readonly","get "+e,function(e){var t=e.get(a.fullname);t.onerror=function(e){i(e.target.error.name)},t.onsuccess=function(e){if(void 0!==this.result)return r(this.result);Squeak.fetchTemplateFile(a.fullname,function(e){r(e)},function(){if("undefined"==typeof indexedDB)return i("file not found: "+a.fullname);var e=Squeak.dbFake().get(a.fullname);e.onerror=function(e){i("file not found: "+a.fullname)},e.onsuccess=function(e){r(this.result)}})}})},filePut:function(e,t,r){var i=this.splitFilePath(e);if(!i.basename)return null;var a=this.dirList(i.dirname);if(!a)return null;var s=a[i.basename],n=this.totalSeconds();if(s){if(s[3])return null}else s=[i.basename,n,0,!1,0],a[i.basename]=s;return Squeak.debugFiles&&(console.log("Writing "+i.fullname+" ("+t.byteLength+" bytes)"),0<t.byteLength&&e.endsWith(".log")&&console.log((new TextDecoder).decode(t).replace(/\r/g,"\n"))),s[2]=n,s[4]=t.byteLength||t.length||0,Squeak.Settings["squeak:"+i.dirname]=JSON.stringify(a),this.dbTransaction("readwrite","put "+e,function(e){e.put(t,i.fullname)},function(){r&&r()}),s},fileDelete:function(e,t){var r=this.splitFilePath(e);if(!r.basename)return!1;var i=this.dirList(r.dirname);if(!i)return!1;var a=i[r.basename];return!(!a||a[3])&&(delete i[r.basename],Squeak.Settings["squeak:"+r.dirname]=JSON.stringify(i),Squeak.debugFiles&&console.log("Deleting "+r.fullname),t||this.dbTransaction("readwrite","delete "+e,function(e){e.delete(r.fullname)}),!0)},fileRename:function(e,t){var r=this.splitFilePath(e);if(!r.basename)return!1;var i=this.splitFilePath(t);if(!i.basename)return!1;var a=this.dirList(r.dirname);if(!a)return!1;var s=a[r.basename];if(!s||s[3])return!1;var n=r.dirname==i.dirname,o=n?a:this.dirList(i.dirname);return!!o&&(!o[i.basename]&&(Squeak.debugFiles&&console.log("Renaming "+r.fullname+" to "+i.fullname),delete a[r.basename],s[0]=i.basename,o[i.basename]=s,Squeak.Settings["squeak:"+i.dirname]=JSON.stringify(o),n||(Squeak.Settings["squeak:"+r.dirname]=JSON.stringify(a)),this.fileGet(r.fullname,function(t){this.dbTransaction("readwrite","rename "+r.fullname+" to "+i.fullname,function(e){e.delete(r.fullname),e.put(t,i.fullname)})}.bind(this),function(e){console.log("File rename failed: "+e)}.bind(this)),!0))},fileExists:function(e){var t=this.splitFilePath(e);if(!t.basename)return!1;var r=this.dirList(t.dirname);if(!r)return!1;var i=r[t.basename];return!(!i||i[3])},dirCreate:function(e,t){var r=this.splitFilePath(e);if(!r.basename)return!1;t&&!Squeak.Settings["squeak:"+r.dirname]&&Squeak.dirCreate(r.dirname,!0);var i=this.dirList(r.dirname);if(!i)return!1;var a=i[r.basename];if(a)return a[3];Squeak.debugFiles&&console.log("Creating directory "+r.fullname);var s=this.totalSeconds(),n=[r.basename,s,s,!0,0];return i[r.basename]=n,Squeak.Settings["squeak:"+r.fullname]=JSON.stringify({}),Squeak.Settings["squeak:"+r.dirname]=JSON.stringify(i),!0},dirDelete:function(e){var t=this.splitFilePath(e);if(!t.basename)return!1;var r=this.dirList(t.dirname);if(!r)return!1;if(!r[t.basename])return!1;var i=this.dirList(t.fullname);if(i)for(var a in i)return!1;return Squeak.debugFiles&&console.log("Deleting directory "+t.fullname),delete r[t.basename],Squeak.Settings["squeak:"+t.dirname]=JSON.stringify(r),delete Squeak.Settings["squeak:"+t.fullname],!0},dirList:function(e,t){var r=this.splitFilePath(e),i=Squeak.Settings["squeak:"+r.fullname],a=t&&Squeak.Settings["squeak-template:"+r.fullname];function s(e,t){for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];e[i[0]]=i}}if(i||a){var n={};return a&&s(n,JSON.parse(a).entries),i&&s(n,JSON.parse(i)),n}return"/"==r.fullname?{}:null},splitFilePath:function(e){"/"!==e[0]&&(e="/"+e);var t=(e=e.replace(/\/\//g,"/")).match(/(.*)\/(.*)/);return{fullname:e,dirname:t[1]?t[1]:"/",basename:t[2]?t[2]:null}},splitUrl:function(e,t){var r=e.match(/(.*\/)?(.*)/),i=r[1]||"",a=r[2]||"";return i.match(/^[a-z]+:\/\//)||(t&&!t.match(/\/$/)&&(t+="/"),e=(i=(t||"")+i)+a),{full:e,uptoslash:i,filename:a}},flushFile:function(e){if(e.modified){var t=e.contents.buffer;t.byteLength!==e.size&&(t=new ArrayBuffer(e.size),new Uint8Array(t).set(e.contents.subarray(0,e.size))),Squeak.filePut(e.name,t),e.modified=!1}},flushAllFiles:function(){if("undefined"!=typeof SqueakFiles)for(var e in SqueakFiles)this.flushFile(SqueakFiles[e])},closeAllFiles:function(){Squeak.flushAllFiles(),delete window.SqueakFiles},fetchTemplateDir:function(s,n){function o(e,t){var r=JSON.parse(Squeak.Settings["squeak-template:"+e]);for(var i in r.entries){var a=r.entries[i];a[3]&&Squeak.fetchTemplateDir(e+"/"+a[0],t+"/"+a[0])}}if(s=Squeak.splitFilePath(s).fullname,Squeak.Settings["squeak-template:"+s])o(s,n);else{var t=n+"/sqindex.json",u=new XMLHttpRequest;u.open("GET",t,!0),u.onload=function(e){if(200==u.status){console.log("adding template "+s),function e(t){var r=Squeak.splitFilePath(t);if("/"!==r.dirname&&e(r.dirname),!(t=JSON.parse(Squeak.Settings["squeak-template:"+r.dirname]||'{"entries": {}}')).entries[r.basename]){var i=Squeak.totalSeconds();t.entries[r.basename]=[r.basename,i,i,!0,0],Squeak.Settings["squeak-template:"+r.dirname]=JSON.stringify(t)}}(s);var t=JSON.parse(u.response),r={url:n,entries:{}};for(var i in t){var a=t[i];r.entries[a[0]]=a}Squeak.Settings["squeak-template:"+s]=JSON.stringify(r),o(s,n)}else u.onerror(u.statusText)},u.onerror=function(e){console.log("cannot load template index "+t)},u.send()}},fetchTemplateFile:function(t,r,i){t=Squeak.splitFilePath(t);var e=Squeak.Settings["squeak-template:"+t.dirname];if(!e)return i();var a=JSON.parse(e).url;if(!a)return i();a+="/"+t.basename;var s=new XMLHttpRequest;s.open("get",a,!0),s.responseType="arraybuffer",s.timeout=3e4,s.onreadystatechange=function(){if(this.readyState==this.DONE)if(200==this.status){var e=this.response;console.log("Got "+e.byteLength+" bytes from "+a),Squeak.dirCreate(t.dirname,!0),Squeak.filePut(t.fullname,e),r(e)}else console.error("Download failed ("+this.status+") "+a),i()},console.log("Fetching "+a),s.send()}}),Object.extend(Squeak,"events",{Mouse_Blue:1,Mouse_Yellow:2,Mouse_Red:4,Keyboard_Shift:8,Keyboard_Ctrl:16,Keyboard_Alt:32,Keyboard_Cmd:64,Mouse_All:7,Keyboard_All:120,EventTypeNone:0,EventTypeMouse:1,EventTypeKeyboard:2,EventTypeDragDropFiles:3,EventKeyChar:0,EventKeyDown:1,EventKeyUp:2,EventDragEnter:1,EventDragMove:2,EventDragLeave:3,EventDragDrop:4}),Object.extend(Squeak.Primitives.prototype,"input",{primitiveClipboardText:function(e){if(0===e){if("string"!=typeof this.display.clipboardString)return!1;this.vm.popNandPush(1,this.makeStString(this.display.clipboardString))}else if(1===e){var t=this.vm.top();t.bytes&&(this.display.clipboardString=t.bytesAsString(),this.display.clipboardStringChanged=!0),this.vm.pop()}return!0},primitiveKeyboardNext:function(e){return this.popNandPushIfOK(e+1,this.ensureSmallInt(this.display.keys.shift()))},primitiveKeyboardPeek:function(e){var t=this.display.keys.length;return this.popNandPushIfOK(e+1,t?this.ensureSmallInt(this.display.keys[0]||0):this.vm.nilObj)},primitiveMouseButtons:function(e){return this.popNandPushIfOK(e+1,this.ensureSmallInt(this.display.buttons)),this.vm.breakOut(),20<this.display.idle++&&this.vm.goIdle(),!0},primitiveMousePoint:function(e){var t=this.ensureSmallInt(this.display.mouseX),r=this.ensureSmallInt(this.display.mouseY);return this.popNandPushIfOK(e+1,this.makePointWithXandY(t,r))},primitiveInputSemaphore:function(e){var t=this.stackInteger(0);return!!this.success&&(this.inputEventSemaIndex=t,this.display.signalInputEvent=function(){this.signalSemaphoreWithIndex(this.inputEventSemaIndex)}.bind(this),this.display.signalInputEvent(),this.popNIfOK(e))},primitiveInputWord:function(e){return this.popNandPushIfOK(1,0)},primitiveGetNextEvent:function(e){this.display.idle++;var t=this.stackNonInteger(0);return!!this.display.getNextEvent&&(this.display.getNextEvent(t.pointers,this.vm.startupTime),this.popNIfOK(e))}}),Object.extend(Squeak.Primitives.prototype,"initialization",{initPlugins:function(){Object.extend(this.builtinModules,{JavaScriptPlugin:this.findPluginFunctions("js_"),FilePlugin:this.findPluginFunctions("","primitive(Disable)?(File|Directory)"),DropPlugin:this.findPluginFunctions("","primitiveDropRequest"),SoundPlugin:this.findPluginFunctions("snd_"),JPEGReadWriter2Plugin:this.findPluginFunctions("jpeg2_"),SqueakFFIPrims:this.findPluginFunctions("ffi_","",!0),SecurityPlugin:{primitiveDisableImageWrite:this.fakePrimitive.bind(this,"SecurityPlugin.primitiveDisableImageWrite",0)},LocalePlugin:{primitiveTimezoneOffset:this.fakePrimitive.bind(this,"LocalePlugin.primitiveTimezoneOffset",0)}}),Object.extend(this.patchModules,{ScratchPlugin:this.findPluginFunctions("scratch_")})},findPluginFunctions:function(e,t,r){t=t||"(initialise|shutdown|prim)";var i={},a=new RegExp("^"+e+t,"i");for(var s in this)if(a.test(s)&&"function"==typeof this[s]){var n=s;e&&(n=s[e.length].toLowerCase()+s.slice(e.length+1)),i[n]=r?s:this[s].bind(this)}return i}}),Object.extend(Squeak,"known classes",{ExtLibFunc_handle:0,ExtLibFunc_flags:1,ExtLibFunc_argTypes:2,ExtLibFunc_name:3,ExtLibFunc_module:4,ExtLibFunc_errorCodeName:5},"FFI error codes",{FFINoCalloutAvailable:-1,FFIErrorGenericError:0,FFIErrorNotFunction:1,FFIErrorBadArgs:2,FFIErrorBadArg:3,FFIErrorIntAsPointer:4,FFIErrorBadAtomicType:5,FFIErrorCoercionFailed:6,FFIErrorWrongType:7,FFIErrorStructSize:8,FFIErrorCallType:9,FFIErrorBadReturn:10,FFIErrorBadAddress:11,FFIErrorNoModule:12,FFIErrorAddressNotFound:13,FFIErrorAttemptToPassVoid:14,FFIErrorModuleNotFound:15,FFIErrorBadExternalLibrary:16,FFIErrorBadExternalFunction:17,FFIErrorInvalidPointer:18,FFIErrorCallFrameTooBig:19},"FFI types",{FFITypeVoid:0,FFITypeBool:1,FFITypeUnsignedInt8:2,FFITypeSignedInt8:3,FFITypeUnsignedInt16:4,FFITypeSignedInt16:5,FFITypeUnsignedInt32:6,FFITypeSignedInt32:7,FFITypeUnsignedInt64:8,FFITypeSignedInt64:9,FFITypeUnsignedChar8:10,FFITypeSignedChar8:11,FFITypeSingleFloat:12,FFITypeDoubleFloat:13,FFITypeUnsignedChar16:14,FFITypeUnsignedChar32:15,FFIFlagAtomic:262144,FFIFlagPointer:131072,FFIFlagStructure:65536,FFIFlagAtomicPointer:393216,FFIFlagMask:458752,FFIStructSizeMask:65535,FFIAtomicTypeMask:251658240,FFIAtomicTypeShift:24}),Object.extend(Squeak.Primitives.prototype,"FFI",{ffi_lastError:0,calloutToFFI:function(e,t,r){this.ffi_lastError=Squeak.FFIErrorGenericError;var i=t.pointers[Squeak.ExtLibFunc_module].bytesAsString(),a=t.pointers[Squeak.ExtLibFunc_name].bytesAsString(),s=this.loadedModules[i];if(void 0===s&&(s=this.loadModule(i),(this.loadedModules[i]=s)||this.vm.warnOnce("FFI: module not found: "+i)),!s)return this.ffi_lastError=Squeak.FFIErrorModuleNotFound,!1;for(var n,o=t.pointers[Squeak.ExtLibFunc_argTypes].pointers,u=[],l=0;l<r.length;l++)u.push(this.ffiArgFromSt(r[l],o[l+1]));if(!(a in s)&&(this.vm.warnOnce("FFI: function not found: "+i+"::"+a)&&console.warn(u),s.ffiFunctionNotFoundHandler&&(n=s.ffiFunctionNotFoundHandler(a,u)),void 0===n))return this.ffi_lastError=Squeak.FFIErrorAddressNotFound,!1;n=s[a].apply(s,u);var c=this.ffiResultToSt(n,o[0]);return this.popNandPushIfOK(e+1,c)},ffiArgFromSt:function(e,t){var r=t.pointers[0].words[0];switch(r&Squeak.FFIFlagMask){case Squeak.FFIFlagAtomic:switch(i=(r&Squeak.FFIAtomicTypeMask)>>Squeak.FFIAtomicTypeShift){case Squeak.FFITypeVoid:return null;case Squeak.FFITypeBool:return!e.isFalse;case Squeak.FFITypeUnsignedInt8:case Squeak.FFITypeSignedInt8:case Squeak.FFITypeUnsignedInt16:case Squeak.FFITypeSignedInt16:case Squeak.FFITypeUnsignedInt32:case Squeak.FFITypeSignedInt32:case Squeak.FFITypeUnsignedInt64:case Squeak.FFITypeSignedInt64:case Squeak.FFITypeUnsignedChar8:case Squeak.FFITypeSignedChar8:case Squeak.FFITypeUnsignedChar16:case Squeak.FFITypeUnsignedChar32:if("number"==typeof e)return e;throw Error("FFI: expected integer, got "+e);case Squeak.FFITypeSingleFloat:case Squeak.FFITypeDoubleFloat:return"number"==typeof e?e:(e.isFloat,e.float);default:throw Error("FFI: unimplemented atomic arg type: "+i)}case Squeak.FFIFlagAtomicPointer:var i;switch(i=(r&Squeak.FFIAtomicTypeMask)>>Squeak.FFIAtomicTypeShift){case Squeak.FFITypeUnsignedChar8:if(e.bytes)return e.bytesAsString();throw Error("FFI: expected string, got "+e);case Squeak.FFITypeUnsignedInt8:if(e.bytes)return e.bytes;if(e.words)return e.wordsAsUint8Array();throw Error("FFI: expected bytes, got "+e);case Squeak.FFITypeUnsignedInt32:if(e.words)return e.words;throw Error("FFI: expected words, got "+e);case Squeak.FFITypeSignedInt32:if(e.words)return e.wordsAsInt32Array();throw Error("FFI: expected words, got "+e);case Squeak.FFITypeSingleFloat:if(e.words)return e.wordsAsFloat32Array();if(e.isFloat)return new Float32Array([e.float]);throw Error("FFI: expected floats, got "+e);case Squeak.FFITypeVoid:if(e.words)return e.words.buffer;if(e.bytes)return e.bytes.buffer;throw Error("FFI: expected words or bytes, got "+e);default:throw Error("FFI: unimplemented atomic array arg type: "+i)}default:throw Error("FFI: unimplemented arg type flags: "+r)}},ffiResultToSt:function(e,t){var r=t.pointers[0].words[0];switch(r&Squeak.FFIFlagMask){case Squeak.FFIFlagAtomic:switch(i=(r&Squeak.FFIAtomicTypeMask)>>Squeak.FFIAtomicTypeShift){case Squeak.FFITypeVoid:return this.vm.nilObj;case Squeak.FFITypeBool:return e?this.vm.trueObj:this.vm.falseObj;case Squeak.FFITypeUnsignedInt8:case Squeak.FFITypeSignedInt8:case Squeak.FFITypeUnsignedInt16:case Squeak.FFITypeSignedInt16:case Squeak.FFITypeUnsignedInt32:case Squeak.FFITypeSignedInt32:case Squeak.FFITypeUnsignedInt64:case Squeak.FFITypeSignedInt64:case Squeak.FFITypeUnsignedChar8:case Squeak.FFITypeSignedChar8:case Squeak.FFITypeUnsignedChar16:case Squeak.FFITypeUnsignedChar32:case Squeak.FFITypeSingleFloat:case Squeak.FFITypeDoubleFloat:if("number"!=typeof e)throw Error("FFI: expected number, got "+e);return this.makeStObject(e);default:throw Error("FFI: unimplemented atomic return type: "+i)}case Squeak.FFIFlagAtomicPointer:var i;switch(i=(r&Squeak.FFIAtomicTypeMask)>>Squeak.FFIAtomicTypeShift){case Squeak.FFITypeSignedChar8:case Squeak.FFITypeUnsignedChar8:return this.makeStString(e);default:return this.makeStExternalData(e,t)}default:throw Error("FFI: unimplemented return type flags: "+r)}},makeStExternalData:function(e,t){var r=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassExternalAddress],4);r.jsData=e;var i=this.vm.instantiateClass(this.vm.specialObjects[Squeak.splOb_ClassExternalData],0);return i.pointers[0]=r,i.pointers[1]=t,i},primitiveCalloutToFFI:function(e,t){var r=t.pointers[1];if(!this.isKindOf(r,Squeak.splOb_ClassExternalFunction))return!1;for(var i=[],a=e-1;0<=a;a--)i.push(this.vm.stackValue(a));return this.calloutToFFI(e,r,i)},ffi_primitiveCalloutWithArgs:function(e){var t=this.stackNonInteger(1),r=this.stackNonInteger(0);return!!this.isKindOf(t,Squeak.splOb_ClassExternalFunction)&&this.calloutToFFI(e,t,r.pointers)},ffi_primitiveFFIGetLastError:function(e){return this.popNandPushIfOK(e+1,this.ffi_lastError)},ffi_primitiveFFIIntegerAt:function(e){var t=this.stackNonInteger(3),r=this.stackInteger(2),i=this.stackInteger(1),a=this.stackBoolean(0);if(!this.success)return!1;if(r<0||i<1||8<i||0!=(i&i-1))return!1;if(t.sqClass!==this.vm.specialObjects[Squeak.splOb_ClassExternalAddress])return this.vm.warnOnce("FFI: expected ExternalAddress, got "+t.sqClass.className()),!1;var s,n=t.jsData;if(void 0===n)return this.vm.warnOnce("FFI: expected ExternalAddress with jsData, got "+t),!1;if(1!==i||a)return this.vm.warnOnce("FFI: unimplemented integer type size: "+i+" signed: "+a),!1;if("string"==typeof n)s=n.charCodeAt(r-1)||0;else{if(!(n instanceof Uint8Array))return this.vm.warnOnce("FFI: expected string or Uint8Array, got "+typeof n),!1;s=n[r]||0}return this.popNandPushIfOK(e+1,s)}}),Object.extend(Squeak.Primitives.prototype,"JavaScriptPlugin",{js_primitiveDoUnderstand:function(e){var t=this.stackNonInteger(1),r=this.js_objectOrGlobal(t),i=this.stackNonInteger(0).pointers,a=i[0].bytesAsString(),s=i[1].pointers||[],n=!("jsObject"in t),o=null;try{var u=a.match(/([^:]*)/)[0];if(n||"new"!==u){if(!(u in r))return this.js_setError("Property not found: "+u);var l=r[u];if("function"==typeof l&&(!n||0<s.length))o=l.apply(r,this.js_fromStArray(s));else if(0==s.length)o=l;else{if(1!=s.length)return this.js_setError("Property "+u+" is not a function");r[u]=this.js_fromStObject(s[0])}}else if(0===s.length)o=new r;else{var c=[null].concat(this.js_fromStArray(s));o=new(Function.prototype.bind.apply(r,c))}}catch(e){return this.js_setError(e.message)}var h=this.makeStObject(o,t.sqClass);return this.popNandPushIfOK(e+1,h)},js_primitiveAsString:function(e){var t=this.js_objectOrGlobal(this.stackNonInteger(0));return this.popNandPushIfOK(e+1,this.makeStString(String(t)))},js_primitiveTypeof:function(e){var t=this.js_objectOrGlobal(this.stackNonInteger(0));return this.popNandPushIfOK(e+1,this.makeStString(typeof t))},js_primitiveAt:function(e){var t,r=this.stackNonInteger(1),i=this.vm.stackValue(0);try{var a=this.js_objectOrGlobal(r)[this.js_fromStObject(i)];t=this.makeStObject(a,r.sqClass)}catch(e){return this.js_setError(e.message)}return this.popNandPushIfOK(e+1,t)},js_primitiveAtPut:function(e){var t=this.stackNonInteger(2),r=this.vm.stackValue(1),i=this.vm.stackValue(0);try{var a=this.js_objectOrGlobal(t),s=this.js_fromStObject(r),n=this.js_fromStObject(i);a[s]=n}catch(e){return this.js_setError(e.message)}return this.popNandPushIfOK(e+1,i)},js_primitiveSqueakAsJSObject:function(e){var t=this.stackNonInteger(1),r=this.vm.stackValue(0);return this.success&&(t.jsObject=r),this.popNIfOK(e)},js_primitiveInitCallbacks:function(e){return this.js_callbackSema=this.stackInteger(0),this.js_activeCallback=null,this.popNIfOK(e)},js_primitiveGetActiveCallbackBlock:function(e){var t=this.js_activeCallback;return t?this.popNandPushIfOK(e+1,t.block):this.js_setError("No active callback")},js_primitiveGetActiveCallbackArgs:function(e){var t=this.stackNonInteger(e),r=this.js_activeCallback;if(!r)return this.js_setError("No active callback");try{var i=this.makeStArray(r.args,t);return this.popNandPushIfOK(e+1,i)}catch(e){return this.js_setError(e.message)}},js_primitiveReturnFromCallback:function(e){return 1===e&&(this.js_activeCallback?(this.js_activeCallback.result=this.vm.pop(),this.vm.breakOut(),!0):this.js_setError("No active callback"))},js_primitiveGetError:function(e){var t=this.makeStObject(this.js_error);return this.js_error=null,this.popNandPushIfOK(e+1,t)},js_setError:function(e){return this.js_error=String(e),!1},js_fromStObject:function(e){if("number"==typeof e)return e;if(e.jsObject)return e.jsObject;if(e.isFloat)return e.float;if(e.isNil)return null;if(e.isTrue)return!0;if(e.isFalse)return!1;if(e.bytes||e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassString])return e.bytesAsString();if(e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassArray])return this.js_fromStArray(e.pointers||[],!0);if(e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassBlockContext]||e.sqClass===this.vm.specialObjects[Squeak.splOb_ClassBlockClosure])return this.js_fromStBlock(e);throw Error("asJSArgument needed for "+e)},js_fromStArray:function(e,t){if(0<e.length&&t&&this.isAssociation(e[0]))return this.js_fromStDict(e);for(var r=[],i=0;i<e.length;i++)r.push(this.js_fromStObject(e[i]));return r},js_fromStDict:function(e){for(var t={},r=0;r<e.length;r++){var i=e[r].pointers;if(!i||2!==i.length)throw Error(i+" is not an Association");var a=this.js_fromStObject(i[0]),s=this.js_fromStObject(i[1]);t[a]=s}return t},js_fromStBlock:function(i){if(!this.js_callbackSema)throw Error("CallbackSemaphore not set");this.vm.reclaimableContextCount=0;var t=i.pointers[Squeak.BlockContext_argumentCount];"number"!=typeof t&&(t=i.pointers[Squeak.Closure_numArgs]);var a=this;return function(){for(var r=[],e=0;e<t;e++)r.push(arguments[e]);return new Promise(function(e,t){self.setTimeout(function(){a.js_executeCallbackAsync(i,r,e,t)},0)})}},js_executeCallbackAsync:function(e,t,r,i){var a=this;this.js_activeCallback||this.vm.frozen?self.setTimeout(function(){a.js_executeCallbackAsync(e,t,r,i)},0):this.js_executeCallback(e,t,r,i)},js_executeCallback:function(e,t,r,i){if(this.js_activeCallback)return console.error("Callback: already active");this.js_activeCallback={block:e,args:t,result:null},this.signalSemaphoreWithIndex(this.js_callbackSema),this.vm.forceInterruptCheck();for(var a=Date.now()+500;Date.now()<a&&!this.js_activeCallback.result;)this.vm.interpret();var s=this.js_activeCallback.result;if(this.js_activeCallback=null,s)try{r(this.js_fromStObject(s))}catch(e){r(s.toString())}else i(Error("SqueakJS timeout"))},js_objectOrGlobal:function(e){return"jsObject"in e?e.jsObject:self}}),Object.extend(Squeak.Primitives.prototype,"Obsolete",{primitiveFloatArrayAt:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveAt",e)},primitiveFloatArrayMulFloatArray:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveMulFloatArray",e)},primitiveFloatArrayAddScalar:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveAddScalar",e)},primitiveFloatArrayDivFloatArray:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveDivFloatArray",e)},primitiveFloatArrayDivScalar:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveDivScalar",e)},primitiveFloatArrayHash:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveHash",e)},primitiveFloatArrayAtPut:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveAtPut",e)},primitiveFloatArrayMulScalar:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveMulScalar",e)},primitiveFloatArrayAddFloatArray:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveAddFloatArray",e)},primitiveFloatArraySubScalar:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveSubScalar",e)},primitiveFloatArraySubFloatArray:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveSubFloatArray",e)},primitiveFloatArrayEqual:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveEqual",e)},primitiveFloatArrayDotProduct:function(e){return this.namedPrimitive("FloatArrayPlugin","primitiveDotProduct",e)},m23PrimitiveInvertRectInto:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveInvertRectInto",e)},m23PrimitiveTransformPoint:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveTransformPoint",e)},m23PrimitiveIsPureTranslation:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveIsPureTranslation",e)},m23PrimitiveComposeMatrix:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveComposeMatrix",e)},m23PrimitiveTransformRectInto:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveTransformRectInto",e)},m23PrimitiveIsIdentity:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveIsIdentity",e)},m23PrimitiveInvertPoint:function(e){return this.namedPrimitive("Matrix2x3Plugin","primitiveInvertPoint",e)},primitiveDeflateBlock:function(e){return this.namedPrimitive("ZipPlugin","primitiveDeflateBlock",e)},primitiveDeflateUpdateHashTable:function(e){return this.namedPrimitive("ZipPlugin","primitiveDeflateUpdateHashTable",e)},primitiveUpdateGZipCrc32:function(e){return this.namedPrimitive("ZipPlugin","primitiveUpdateGZipCrc32",e)},primitiveInflateDecompressBlock:function(e){return this.namedPrimitive("ZipPlugin","primitiveInflateDecompressBlock",e)},primitiveZipSendBlock:function(e){return this.namedPrimitive("ZipPlugin","primitiveZipSendBlock",e)},primitiveFFTTransformData:function(e){return this.namedPrimitive("FFTPlugin","primitiveFFTTransformData",e)},primitiveFFTScaleData:function(e){return this.namedPrimitive("FFTPlugin","primitiveFFTScaleData",e)},primitiveFFTPermuteData:function(e){return this.namedPrimitive("FFTPlugin","primitiveFFTPermuteData",e)},gePrimitiveMergeFillFrom:function(e){return this.namedPrimitive("B2DPlugin","primitiveMergeFillFrom",e)},gePrimitiveCopyBuffer:function(e){return this.namedPrimitive("B2DPlugin","primitiveCopyBuffer",e)},gePrimitiveAddRect:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddRect",e)},gePrimitiveAddGradientFill:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddGradientFill",e)},gePrimitiveSetClipRect:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetClipRect",e)},gePrimitiveSetBitBltPlugin:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetBitBltPlugin",e)},gePrimitiveRegisterExternalEdge:function(e){return this.namedPrimitive("B2DPlugin","primitiveRegisterExternalEdge",e)},gePrimitiveGetClipRect:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetClipRect",e)},gePrimitiveAddBezier:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddBezier",e)},gePrimitiveInitializeProcessing:function(e){return this.namedPrimitive("B2DPlugin","primitiveInitializeProcessing",e)},gePrimitiveRenderImage:function(e){return this.namedPrimitive("B2DPlugin","primitiveRenderImage",e)},gePrimitiveGetOffset:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetOffset",e)},gePrimitiveSetDepth:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetDepth",e)},gePrimitiveAddBezierShape:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddBezierShape",e)},gePrimitiveSetEdgeTransform:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetEdgeTransform",e)},gePrimitiveGetTimes:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetTimes",e)},gePrimitiveNextActiveEdgeEntry:function(e){return this.namedPrimitive("B2DPlugin","primitiveNextActiveEdgeEntry",e)},gePrimitiveAddBitmapFill:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddBitmapFill",e)},gePrimitiveGetDepth:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetDepth",e)},gePrimitiveAbortProcessing:function(e){return this.namedPrimitive("B2DPlugin","primitiveAbortProcessing",e)},gePrimitiveNextGlobalEdgeEntry:function(e){return this.namedPrimitive("B2DPlugin","primitiveNextGlobalEdgeEntry",e)},gePrimitiveGetFailureReason:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetFailureReason",e)},gePrimitiveDisplaySpanBuffer:function(e){return this.namedPrimitive("B2DPlugin","primitiveDisplaySpanBuffer",e)},gePrimitiveGetCounts:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetCounts",e)},gePrimitiveChangedActiveEdgeEntry:function(e){return this.namedPrimitive("B2DPlugin","primitiveChangedActiveEdgeEntry",e)},gePrimitiveRenderScanline:function(e){return this.namedPrimitive("B2DPlugin","primitiveRenderScanline",e)},gePrimitiveGetBezierStats:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetBezierStats",e)},gePrimitiveFinishedProcessing:function(e){return this.namedPrimitive("B2DPlugin","primitiveFinishedProcessing",e)},gePrimitiveNeedsFlush:function(e){return this.namedPrimitive("B2DPlugin","primitiveNeedsFlush",e)},gePrimitiveAddLine:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddLine",e)},gePrimitiveSetOffset:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetOffset",e)},gePrimitiveNextFillEntry:function(e){return this.namedPrimitive("B2DPlugin","primitiveNextFillEntry",e)},gePrimitiveInitializeBuffer:function(e){return this.namedPrimitive("B2DPlugin","primitiveInitializeBuffer",e)},gePrimitiveDoProfileStats:function(e){return this.namedPrimitive("B2DPlugin","primitiveDoProfileStats",e)},gePrimitiveAddActiveEdgeEntry:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddActiveEdgeEntry",e)},gePrimitiveSetAALevel:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetAALevel",e)},gePrimitiveNeedsFlushPut:function(e){return this.namedPrimitive("B2DPlugin","primitiveNeedsFlushPut",e)},gePrimitiveAddCompressedShape:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddCompressedShape",e)},gePrimitiveSetColorTransform:function(e){return this.namedPrimitive("B2DPlugin","primitiveSetColorTransform",e)},gePrimitiveAddOval:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddOval",e)},gePrimitiveRegisterExternalFill:function(e){return this.namedPrimitive("B2DPlugin","primitiveRegisterExternalFill",e)},gePrimitiveAddPolygon:function(e){return this.namedPrimitive("B2DPlugin","primitiveAddPolygon",e)},gePrimitiveGetAALevel:function(e){return this.namedPrimitive("B2DPlugin","primitiveGetAALevel",e)}}),Object.extend(Squeak.Primitives.prototype,"DropPlugin",{primitiveDropRequestFileHandle:function(e){var t=this.stackInteger(0),r=this.display.droppedFiles||[];if(t<1||r.length<t)return!1;var i=r[t-1],a=this.fileOpen(i,!1);if(!a)return!1;var s=this.makeFileHandle(i,a,!1);return this.popNandPushIfOK(e+1,s),!0},primitiveDropRequestFileName:function(e){var t=this.stackInteger(0),r=this.display.droppedFiles||[];if(t<1||r.length<t)return!1;var i=this.makeStString(this.filenameToSqueak(r[t-1]));return this.popNandPushIfOK(e+1,i)}}),Object.extend(Squeak.Primitives.prototype,"FilePlugin",{primitiveDirectoryCreate:function(e){var t=this.stackNonInteger(0);if(!this.success)return!1;var r=this.filenameFromSqueak(t.bytesAsString());if(this.success=Squeak.dirCreate(r),!this.success){var i=Squeak.splitFilePath(r);console.log("Directory not created: "+i.fullname)}return this.popNIfOK(e)},primitiveDirectoryDelete:function(e){var t=this.stackNonInteger(0);if(!this.success)return!1;var r=this.filenameFromSqueak(t.bytesAsString());return this.success=Squeak.dirDelete(r),this.popNIfOK(e)},primitiveDirectoryDelimitor:function(e){var t=this.emulateMac?":":"/";return this.popNandPushIfOK(1,this.charFromInt(t.charCodeAt(0)))},primitiveDirectoryEntry:function(e){var t=this.stackNonInteger(1),r=this.stackNonInteger(0);if(!this.success)return!1;var i=r.bytesAsString(),a=this.filenameFromSqueak(i),s=t.bytesAsString(),n=this.filenameFromSqueak(s),o=Squeak.dirList(n,!0);if(!o){var u=Squeak.splitFilePath(n);return console.log("Directory not found: "+u.fullname),!1}var l="."===a?[".",0,0,!0,0]:o[a];return this.popNandPushIfOK(e+1,this.makeStObject(l)),!0},primitiveDirectoryLookup:function(e){var t=this.stackInteger(0),r=this.stackNonInteger(1);if(!this.success)return!1;var i=r.bytesAsString(),a=this.filenameFromSqueak(i),s=Squeak.dirList(a,!0);if(!s){var n=Squeak.splitFilePath(a);return console.log("Directory not found: "+n.fullname),!1}Squeak.debugFiles&&1===t&&console.log("Reading directory "+a+" with "+Object.keys(s).length+" entries");var o=s[Object.keys(s).sort()[t-1]];return"/"===i&&(1===t?((o=o||[0,0,0,0,0])[0]="SqueakJS",o[3]=!0):o=null),this.popNandPushIfOK(e+1,this.makeStObject(o)),!0},primitiveDirectorySetMacTypeAndCreator:function(e){return this.popNIfOK(e)},primitiveFileAtEnd:function(e){var t=this.stackNonInteger(0);return!(!this.success||!t.file)&&(this.popNandPushIfOK(e+1,this.makeStObject(t.filePos>=t.file.size)),!0)},primitiveFileClose:function(e){var t=this.stackNonInteger(0);return!(!this.success||!t.file)&&("string"==typeof t.file?this.fileConsoleFlush(t.file):(this.fileClose(t.file),this.vm.breakOut(),t.file=null),this.popNIfOK(e))},primitiveFileDelete:function(e){var t=this.stackNonInteger(0);if(!this.success)return!1;var r=this.filenameFromSqueak(t.bytesAsString());return this.success=Squeak.fileDelete(r),this.popNIfOK(e)},primitiveFileFlush:function(e){var t=this.stackNonInteger(0);return!(!this.success||!t.file)&&("string"==typeof t.file?this.fileConsoleFlush(t.file):(Squeak.flushFile(t.file),this.vm.breakOut()),this.popNIfOK(e))},primitiveFileGetPosition:function(e){var t=this.stackNonInteger(0);return!(!this.success||!t.file)&&(this.popNandPushIfOK(e+1,this.makeLargeIfNeeded(t.filePos)),!0)},makeFileHandle:function(e,t,r){var i=this.makeStString("squeakjs:"+e);return i.file=t,i.fileWrite=r,i.filePos=0,i},primitiveFileOpen:function(e){var t=this.stackBoolean(0),r=this.stackNonInteger(1);if(!this.success)return!1;var i=this.filenameFromSqueak(r.bytesAsString()),a=this.fileOpen(i,t);if(!a)return!1;var s=this.makeFileHandle(a.name,a,t);return this.popNandPushIfOK(e+1,s),!0},primitiveFileRead:function(a){var s=this.stackInteger(0),n=this.stackInteger(1)-1,e=this.stackNonInteger(2),o=this.stackNonInteger(3);if(!this.success||!e.isWordsOrBytes()||!o.file)return!1;if(!s)return this.popNandPushIfOK(a+1,0);var u=e.bytes;return u||(u=e.wordsAsUint8Array(),n*=4,s*=4),!(n<0||n+s>u.length)&&("string"==typeof o.file?(this.popNandPushIfOK(a+1,0),!0):this.fileContentsDo(o.file,function(e){if(!e.contents)return this.popNandPushIfOK(a+1,0);var t=e.contents,r=u;s=Math.min(s,e.size-o.filePos);for(var i=0;i<s;i++)r[n+i]=t[o.filePos++];this.popNandPushIfOK(a+1,Math.max(0,s))}.bind(this)))},primitiveFileRename:function(e){var t=this.stackNonInteger(1),r=this.stackNonInteger(0);if(!this.success)return!1;var i=this.filenameFromSqueak(t.bytesAsString()),a=this.filenameFromSqueak(r.bytesAsString());return this.success=Squeak.fileRename(i,a),this.vm.breakOut(),this.popNIfOK(e)},primitiveFileSetPosition:function(e){var t=this.stackPos32BitInt(0),r=this.stackNonInteger(1);return!(!this.success||!r.file)&&(r.filePos=t,this.popNIfOK(e))},primitiveFileSize:function(e){var t=this.stackNonInteger(0);return!(!this.success||!t.file)&&(this.popNandPushIfOK(e+1,this.makeLargeIfNeeded(t.file.size)),!0)},primitiveFileStdioHandles:function(e){var t=[null,this.makeFileHandle("console.log","log",!0),this.makeFileHandle("console.error","error",!0)];return this.popNandPushIfOK(e+1,this.makeStArray(t)),!0},primitiveFileTruncate:function(e){var t=this.stackPos32BitInt(0),r=this.stackNonInteger(1);return!!(this.success&&r.file&&r.fileWrite)&&(r.file.size>t&&(r.file.size=t,r.file.modified=!0,r.filePos>r.file.size&&(r.filePos=r.file.size)),this.popNIfOK(e))},primitiveDisableFileAccess:function(e){return this.fakePrimitive("FilePlugin.primitiveDisableFileAccess",0,e)},primitiveFileWrite:function(s){var n=this.stackInteger(0),o=this.stackInteger(1)-1,e=this.stackNonInteger(2),u=this.stackNonInteger(3);if(!this.success||!u.file||!u.fileWrite)return!1;if(!n)return this.popNandPushIfOK(s+1,0);var l=e.bytes;return l||(l=e.wordsAsUint8Array(),o*=4,n*=4),!!l&&(!(o<0||o+n>l.length)&&("string"==typeof u.file?(this.fileConsoleWrite(u.file,l,o,n),this.popNandPushIfOK(s+1,n),!0):this.fileContentsDo(u.file,function(e){var t=l,r=e.contents||[];if(u.filePos+n>r.length){var i=0===r.length?u.filePos+n:Math.max(u.filePos+n,r.length+1e4);e.contents=new Uint8Array(i),e.contents.set(r),r=e.contents}for(var a=0;a<n;a++)r[u.filePos++]=t[o+a];u.filePos>e.size&&(e.size=u.filePos),e.modified=!0,this.popNandPushIfOK(s+1,n)}.bind(this))))},fileOpen:function(e,t){"undefined"==typeof SqueakFiles&&(window.SqueakFiles={});var r=Squeak.splitFilePath(e);if(!r.basename)return null;var i=Squeak.dirList(r.dirname,!0);if(!i)return null;var a=i[r.basename],s=null;if(a){if(n=SqueakFiles[r.fullname])return++n.refCount,n}else{if(!t)return console.log("File not found: "+r.fullname),null;if(s=new Uint8Array,!(a=Squeak.filePut(r.fullname,s.buffer)))return console.log("Cannot create file: "+r.fullname),null}var n={name:r.fullname,size:a[4],contents:s,modified:!1,refCount:1};return SqueakFiles[n.name]=n},fileClose:function(e){Squeak.flushFile(e),0==--e.refCount&&delete SqueakFiles[e.name]},fileContentsDo:function(i,a){if(i.contents)a(i);else{if(!1===i.contents)return!1;this.vm.freeze(function(t){var r=function(e){console.log("File get failed: "+e),i.contents=!1,t(),a(i)}.bind(this),e=function(e){if(null==e)return r(i.name);i.contents=this.asUint8Array(e),t(),a(i)}.bind(this);Squeak.fileGet(i.name,e,r)}.bind(this))}return!0},fileConsoleBuffer:{log:"",error:""},fileConsoleWrite:function(e,t,r,i){var a=t.subarray(r,r+i),s=this.fileConsoleBuffer[e]+Squeak.bytesAsString(a),n=s.match("([^]*)\n(.*)");n&&(console[e](n[1]),s=n[2]),this.fileConsoleBuffer[e]=s},fileConsoleFlush:function(e){var t=this.fileConsoleBuffer[e];t&&(console[e](t),this.fileConsoleBuffer[e]="")}}),Object.extend(Squeak.Primitives.prototype,"JPEGReadWriter2Plugin",{jpeg2_primJPEGPluginIsPresent:function(e){return this.popNandPushIfOK(e+1,this.vm.trueObj)},jpeg2_primImageHeight:function(e){var t=this.stackNonInteger(0).wordsOrBytes();if(!t)return!1;var r=t[1];return this.popNandPushIfOK(e+1,r)},jpeg2_primImageWidth:function(e){var t=this.stackNonInteger(0).wordsOrBytes();if(!t)return!1;var r=t[0];return this.popNandPushIfOK(e+1,r)},jpeg2_primJPEGCompressStructSize:function(e){return this.popNandPushIfOK(e+1,0)},jpeg2_primJPEGDecompressStructSize:function(e){return this.popNandPushIfOK(e+1,8)},jpeg2_primJPEGErrorMgr2StructSize:function(e){return this.popNandPushIfOK(e+1,0)},jpeg2_primJPEGReadHeaderfromByteArrayerrorMgr:function(e){var t=this.stackNonInteger(2).wordsOrBytes(),r=this.stackNonInteger(1).bytes;if(!t||!r)return!1;var i=this.vm.freeze();return this.jpeg2_readImageFromBytes(r,function(e){this.jpeg2state={src:r,img:e},t[0]=e.width,t[1]=e.height,i()}.bind(this),function(){t[0]=0,t[1]=0,i()}.bind(this)),this.popNIfOK(e)},jpeg2_primJPEGReadImagefromByteArrayonFormdoDitheringerrorMgr:function(e){var t=this.stackNonInteger(3).bytes,r=this.stackNonInteger(2).pointers,i=this.stackBoolean(1);if(!this.success||!t||!r)return!1;var a=this.jpeg2state;if(!a||a.src!==t)return console.error("jpeg read did not match header info"),!1;var s=r[Squeak.Form_depth],n=this.jpeg2_getPixelsFromImage(a.img),o=r[Squeak.Form_bits].words;if(32===s)this.jpeg2_copyPixelsToForm32(n,o);else{if(16!==s)return!1;i?this.jpeg2_ditherPixelsToForm16(n,o):this.jpeg2_copyPixelsToForm16(n,o)}return this.popNIfOK(e)},jpeg2_primJPEGWriteImageonByteArrayformqualityprogressiveJPEGerrorMgr:function(e){return this.vm.warnOnce("JPEGReadWritePlugin2: writing not implemented yet"),!1},jpeg2_readImageFromBytes:function(e,t,r){var i=new Blob([e],{type:"image/jpeg"}),a=new Image;a.onload=function(){t(a)},a.onerror=function(){console.warn("could not render JPEG"),r()},a.src=(window.URL||window.webkitURL).createObjectURL(i)},jpeg2_getPixelsFromImage:function(e){var t=document.createElement("canvas"),r=t.getContext("2d");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height)},jpeg2_copyPixelsToForm32:function(e,t){for(var r=e.data,i=0;i<t.length;i++){var a=r[4*i+0],s=r[4*i+1],n=r[4*i+2];t[i]=4278190080|a<<16|s<<8|n}},jpeg2_copyPixelsToForm16:function(e,t){for(var r=e.width,i=e.height,a=e.data,s=0;s<i;s++)for(var n=0;n<r;n+=2){var o=s*i+n,u=a[4*o+0]>>3<<10|a[4*o+1]>>3<<5|a[4*o+2]>>3;0===u&&(u=1),0==(65535&(u=u<<16|a[4*o+4]>>3<<10|a[4*o+5]>>3<<5|a[4*o+6]>>3))&&(u|=1),t[o>>1]=u}},jpeg2_ditherPixelsToForm16:function(e,t){for(var r=e.width>>1,i=e.height,a=e.data,s=[2,0,14,12,1,3,13,15],n=[10,8,6,4,9,11,5,7],o=0;o<i;o++)for(var u=0;u<r;u++){var l,c,h=o*i+2*u<<2,f=a[h],p=a[1+h],d=a[2+h],m=a[4+h],b=a[5+h],v=a[6+h],g=(3&o)<<1|1&u,k=s[g],_=n[g];c=(l=496*f>>8)>>4,f=k<(15&l)?c+1:c,c=(l=496*p>>8)>>4,p=k<(15&l)?c+1:c,c=(l=496*d>>8)>>4,d=k<(15&l)?c+1:c,c=(l=496*m>>8)>>4,m=_<(15&l)?c+1:c,c=(l=496*b>>8)>>4,b=_<(15&l)?c+1:c,c=(l=496*v>>8)>>4;var y=f<<10|p<<5|d;0===y&&(y=1),0==(65535&(y=y<<16|m<<10|b<<5|(v=_<(15&l)?c+1:c)))&&(y|=1),t[h>>3]=y}}}),Object.extend(Squeak.Primitives.prototype,"ScratchPluginAdditions",{scratch_primitiveOpenURL:function(e){var t=this.stackNonInteger(0).bytesAsString();if(""==t)return!1;if(/^\/SqueakJS\//.test(t)){t=t.slice(10);var r=Squeak.splitFilePath(t),i=Squeak.Settings["squeak-template:"+r.dirname];i&&(t=JSON.parse(i).url+"/"+r.basename)}return window.open(t,"_blank"),this.popNIfOK(e)},scratch_primitiveGetFolderPath:function(e){var t,r=this.stackInteger(0);if(!this.success)return!1;switch(r){case 1:t="/"}return!!t&&(this.vm.popNandPush(e+1,this.makeStString(this.filenameToSqueak(t))),!0)}}),Object.extend(Squeak.Primitives.prototype,"SoundPlugin",{snd_primitiveSoundStart:function(e){return this.snd_primitiveSoundStartWithSemaphore(e)},snd_primitiveSoundStartWithSemaphore:function(e){var t=this.stackInteger(e-1),r=this.stackInteger(e-2),i=this.stackBoolean(e-3),a=3<e?this.stackInteger(e-4):0;return!!this.success&&(this.audioContext=Squeak.startAudioOut(),this.audioContext?(this.audioSema=a,this.audioNextTimeSlot=0,this.audioBuffersReady=[],this.audioBuffersUnused=[this.audioContext.createBuffer(i?2:1,t,r),this.audioContext.createBuffer(i?2:1,t,r)],console.log("sound: started"),this.popNIfOK(e)):(this.vm.warnOnce("could not initialize audio"),!1))},snd_playNextBuffer:function(){if(this.audioContext&&0!==this.audioBuffersReady.length){var e=this.audioContext.createBufferSource();e.buffer=this.audioBuffersReady.shift(),e.connect(this.audioContext.destination),this.audioNextTimeSlot<this.audioContext.currentTime&&(0<this.audioNextTimeSlot&&console.log("sound "+this.audioContext.currentTime.toFixed(3)+": buffer underrun by "+(this.audioContext.currentTime-this.audioNextTimeSlot).toFixed(3)+" s"),this.audioNextTimeSlot=this.audioContext.currentTime),e.start(this.audioNextTimeSlot),this.audioNextTimeSlot+=e.buffer.duration,window.setTimeout(function(){this.audioContext&&this.vm.forceInterruptCheck&&(this.audioBuffersUnused.push(e.buffer),this.audioSema&&this.signalSemaphoreWithIndex(this.audioSema),this.vm.forceInterruptCheck())}.bind(this),1e3*(this.audioNextTimeSlot-this.audioContext.currentTime)),this.snd_playNextBuffer()}},snd_primitiveSoundAvailableSpace:function(e){if(!this.audioContext)return console.log("sound: no audio context"),!1;var t=0;if(0<this.audioBuffersUnused.length){var r=this.audioBuffersUnused[0];t=r.length*r.numberOfChannels*2}return this.popNandPushIfOK(e+1,t)},snd_primitiveSoundPlaySamples:function(e){if(!this.audioContext||0===this.audioBuffersUnused.length)return console.log("sound: play but no free buffers"),!1;var t=this.stackInteger(2),r=this.stackNonInteger(1).wordsAsInt16Array(),i=this.stackInteger(0)-1;if(!this.success||!r)return!1;for(var a=this.audioBuffersUnused.shift(),s=a.numberOfChannels,n=0;n<s;n++)for(var o=a.getChannelData(n),u=i+n,l=0;l<t;l++)o[l]=r[u]/32768,u+=s;return this.audioBuffersReady.push(a),this.snd_playNextBuffer(),this.popNIfOK(e)},snd_primitiveSoundPlaySilence:function(e){if(!this.audioContext||0===this.audioBuffersUnused.length)return console.log("sound: play but no free buffers"),!1;for(var t=this.audioBuffersUnused.shift(),r=t.numberOfChannels,i=t.length,a=0;a<r;a++)for(var s=t.getChannelData(a),n=0;n<i;n++)s[n]=0;return this.audioBuffersReady.push(t),this.snd_playNextBuffer(),this.popNandPushIfOK(e+1,i)},snd_primitiveSoundStop:function(e){return this.audioContext&&(this.audioContext=null,this.audioBuffersReady=null,this.audioBuffersUnused=null,this.audioNextTimeSlot=0,this.audioSema=0,console.log("sound: stopped")),this.popNIfOK(e)},snd_primitiveSoundStartRecording:function(i){if(3!==i)return!1;var t=this.stackNonInteger(3),a=this.stackInteger(2),s=this.stackBoolean(1),n=this.stackInteger(0);if(!this.success)return!1;var r=this.primMethod,o=this.vm.freeze(),u=this;return Squeak.startAudioIn(function(e,t){for(console.log("sound: recording started"),u.audioInContext=e,u.audioInSource=t,u.audioInSema=n,u.audioInBuffers=[],u.audioInBufferIndex=0,u.audioInOverSample=1;a*u.audioInOverSample<u.audioInContext.sampleRate;)u.audioInOverSample*=2;for(var r=1024*u.audioInOverSample;r/u.audioInContext.sampleRate<.1;)r*=2;u.audioInProcessor=e.createScriptProcessor(r,s?2:1,s?2:1),u.audioInProcessor.onaudioprocess=function(e){u.snd_recordNextBuffer(e.inputBuffer)},u.audioInSource.connect(u.audioInProcessor),u.audioInProcessor.connect(e.destination),u.vm.popN(i),window.setTimeout(o,0)},function(e){console.warn(e),u.vm.sendAsPrimitiveFailure(t,r,i),window.setTimeout(o,0)}),!0},snd_recordNextBuffer:function(e){this.audioInContext&&(5<this.audioInBuffers.length&&this.audioInBuffers.shift(),this.audioInBuffers.push(e),this.audioInSema&&this.signalSemaphoreWithIndex(this.audioInSema),this.vm.forceInterruptCheck())},snd_primitiveSoundGetRecordingSampleRate:function(e){if(!this.audioInContext)return!1;var t=this.audioInContext.sampleRate/this.audioInOverSample|0;return console.log("sound: actual recording rate "+t+"x"+this.audioInOverSample),this.popNandPushIfOK(e+1,t)},snd_primitiveSoundRecordSamples:function(e){var t=this.stackNonInteger(1).wordsAsInt16Array(),r=this.stackInteger(0)-1;if(!this.success)return!1;for(var i=0;r<t.length&&0!==this.audioInBuffers.length;){for(var a=this.audioInBuffers[0],s=a.numberOfChannels,n=s,o=this.audioInOverSample,u=(t.length-r)/n,l=(a.length-this.audioInBufferIndex)/o,c=Math.min(l,u),h=0;h<s;h++)for(var f=a.getChannelData(h),p=this.audioInBufferIndex,d=r+h,m=0;m<c;m++)t[d]=32768*f[p]&65535,d+=n,p+=o;i+=c*s,r+=c*s,p<a.length?this.audioInBufferIndex=p:(this.audioInBufferIndex=0,this.audioInBuffers.shift())}return this.popNandPushIfOK(e+1,i)},snd_primitiveSoundStopRecording:function(e){return this.audioInContext&&(this.audioInSource.disconnect(),this.audioInProcessor.disconnect(),this.audioInContext=null,this.audioInSema=0,this.audioInBuffers=null,this.audioInSource=null,this.audioInProcessor=null,console.log("sound recording stopped")),!0},snd_primitiveSoundSetRecordLevel:function(e){return!0}}),PS=1,QS=11,TS=0,US=0,VS=0,WS=null,XS=null,YS="ADPCMCodecPlugin 3 November 2014 (e)",ZS=null,function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("ADPCMCodecPlugin",{primitiveDecodeStereo:dT,primitiveEncodeStereo:fT,setInterpreter:gT,primitiveEncodeMono:eT,primitiveDecodeMono:cT,getModuleName:$S}):self.setTimeout(e,100)}(),NU=1,OU=11,YU=12,ZU=2,$U=3,_U=1,aV=0,bV=6,cV=0,dV=4,eV=1,fV=2,gV=3,hV=6,iV=0,jV=2,kV=1,lV=3,mV=16,nV=12,oV=11,pV=14,qV=13,rV=10,sV=18,tV=15,uV=14,vV=15,wV=21,xV=18,yV=16,zV=4,AV=5,BV=2,CV=3,DV=10,EV=0,FV=1,GV=12,HV=13,IV=18,JV=19,KV=20,LV=16,MV=28,NV=22,OV=17,PV=10,QV=4,RV=65536,SV=100,TV=121,UV=122,VV=114,WV=112,XV=101,YV=102,ZV=104,$V=103,_V=120,aW=119,bW=113,cW=123,dW=115,eW=108,fW=105,gW=106,hW=110,iW=107,jW=109,kW=111,lW=118,mW=117,nW=116,oW=8,pW=9,qW=7,rW=2,sW=1,tW=0,uW=6,vW=1024,wW=2,xW=255,yW=256,zW=65280,AW=4,BW=512,CW=768,DW=65535,EW=1,FW=7,GW=5,HW=254,IW=1,JW=5,KW=8,LW=3,MW=0,NW=6,OW=7,PW=2,QW=4,RW=4,SW=5,TW=6,UW=6,VW=2,WW=5,XW=4,YW=3,ZW=1,$W=6,_W=7,aX=8,bX=9,cX=4,dX=5,eX=10,fX=12,gX=12,hX=16,iX=14,jX=15,kX=13,lX=15,mX=14,nX=18,oX=19,pX=20,qX=16,rX=21,sX=17,tX=10,uX=12,vX=11,wX=51,xX=50,yX=53,zX=48,AX=52,BX=49,CX=13,DX=14,EX=109,FX=111,GX=108,HX=110,IX=10,JX=69,KX=43,LX=45,MX=42,NX=44,OX=24,PX=97,QX=107,RX=103,SX=93,TX=91,UX=101,VX=105,WX=99,XX=95,YX=88,ZX=113,$X=46,_X=47,aY=18,bY=37,cY=39,dY=36,eY=38,fY=11,gY=12,hY=17,iY=16,jY=128,kY=65,lY=66,mY=67,nY=68,oY=0,pY=1097753705,qY=256,rY=63,sY=8,tY=9,uY=80,vY=82,wY=84,xY=86,yY=1,zY=34,AY=35,BY=33,CY=32,DY=2,EY=64,FY=96,GY=106,HY=102,IY=92,JY=90,KY=100,LY=104,MY=98,NY=94,OY=3,PY=5,QY=null,RY="BitBltPlugin",SY=null,TY=0,UY=0,VY=0,WY=0,XY=0,YY=0,ZY=0,$Y=null,_Y=null,aZ=null,bZ="B2DPlugin 14 November 2014 (e)",cZ=null,dZ=0,eZ=null,fZ=null,function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("B2DPlugin",{primitiveMergeFillFrom:Y2,primitiveCopyBuffer:K2,primitiveAddRect:I2,primitiveAddGradientFill:E2,primitiveSetClipRect:i3,initialiseModule:N0,primitiveSetBitBltPlugin:h3,primitiveRegisterExternalEdge:c3,primitiveGetClipRect:Q2,primitiveAddBezier:A2,primitiveInitializeProcessing:X2,primitiveRenderImage:e3,primitiveGetOffset:U2,primitiveSetDepth:k3,primitiveAddBezierShape:B2,primitiveSetEdgeTransform:l3,getModuleName:t0,primitiveGetTimes:V2,primitiveNextActiveEdgeEntry:_2,primitiveAddBitmapFill:C2,primitiveGetDepth:S2,primitiveAbortProcessing:y2,primitiveNextGlobalEdgeEntry:b3,primitiveGetFailureReason:T2,primitiveDisplaySpanBuffer:L2,moduleUnloaded:_1,primitiveGetCounts:R2,primitiveChangedActiveEdgeEntry:J2,primitiveRenderScanline:f3,primitiveGetBezierStats:P2,primitiveFinishedProcessing:N2,setInterpreter:E3,primitiveNeedsFlush:Z2,primitiveAddLine:F2,primitiveSetOffset:m3,primitiveNextFillEntry:a3,primitiveInitializeBuffer:W2,primitiveDoProfileStats:M2,primitiveAddActiveEdgeEntry:z2,primitiveSetAALevel:g3,primitiveNeedsFlushPut:$2,primitiveAddCompressedShape:D2,primitiveSetColorTransform:j3,primitiveAddOval:G2,primitiveRegisterExternalFill:d3,primitiveAddPolygon:H2,primitiveGetAALevel:O2}):self.setTimeout(e,100)}(),gta=1,hta=11,qta=4294967295,rta=3,sta=13,tta=12,uta=10,vta=11,wta=14,xta=0,yta=4,zta=5,Ata=2,Bta=7,Cta=3,Dta=1,Eta=8,Fta=9,Gta=15,Hta=6,Ita=2,Jta=2,Kta=4,Lta=8,Mta=1,Nta=16384,Ota=0,Pta=3,Qta=2,Rta=1,Sta=1,Tta=43,Uta=0,Vta=0,Wta=0,Xta=0,Yta=0,Zta=0,$ta=0,_ta=0,aua=0,bua=0,cua=0,dua=0,eua=0,fua=0,gua=0,hua=null,iua=0,jua=null,kua=null,lua=0,mua=0,nua=0,oua=0,pua=0,qua=0,rua=0,sua=0,tua=0,uua=0,vua=0,wua=0,xua=0,yua=0,zua=0,Aua=0,Bua=new Array(4096),Cua=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5],Dua=[0,2,4,6,8,12,14,16],Eua=[0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],Fua=0,Gua=0,Hua=0,Iua=null,Jua=0,Kua=0,Lua=0,Mua=0,Nua=0,Oua=0,Pua=null,Qua=0,Rua=null,Sua=0,Tua=0,Uua=[0,1,3,0,15,31,0,0,255,0,0,0,0,0,0,0,65535,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1],Vua="BitBltPlugin 3 November 2014 (e)",Wua=0,Xua=0,Yua=0,Zua=new Array(43),$ua=0,_ua=null,ava=0,bva=0,cva=0,dva=0,eva=0,fva=0,gva=0,hva=0,iva=0,jva=0,kva=0,lva=0,mva=0,nva=0,ova=0,pva=0,qva=0,rva=null,sva=null,tva=0,uva=0,vva=0,wva=new Array(32),xva=0,yva=0,zva=0,function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("BitBltPlugin",{primitiveCopyBits:Xwa,copyBits:$va,moduleUnloaded:Iwa,primitiveDrawLoop:Zwa,primitiveDisplayString:Ywa,initialiseModule:vwa,loadBitBltFrom:ywa,setInterpreter:sxa,primitiveWarpBits:_wa,getModuleName:qwa,primitivePixelValueAt:$wa,copyBitsFromtoat:_va}):self.setTimeout(e,100)}(),registerCroquetPlugin(),GIa=1,HIa=11,LIa=0,MIa=null,NIa=0,OIa=null,PIa="FFTPlugin 3 November 2014 (e)",QIa=0,RIa=null,SIa=0,TIa=null,UIa=0,VIa=null,WIa=0,function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("FFTPlugin",{primitiveFFTTransformData:cJa,setInterpreter:eJa,primitiveFFTPermuteData:aJa,primitiveFFTScaleData:bJa,getModuleName:ZIa}):self.setTimeout(e,100)}(),WJa=1,XJa=11,ZJa=null,$Ja="FloatArrayPlugin 3 November 2014 (e)",function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("FloatArrayPlugin",{primitiveMulFloatArray:kKa,primitiveEqual:hKa,primitiveAtPut:dKa,primitiveAt:cKa,primitiveNormalize:mKa,primitiveSubFloatArray:nKa,primitiveDivFloatArray:eKa,primitiveAddScalar:bKa,primitiveDotProduct:gKa,primitiveSubScalar:oKa,setInterpreter:qKa,primitiveSum:pKa,getModuleName:_Ja,primitiveHashArray:iKa,primitiveMulScalar:lKa,primitiveLength:jKa,primitiveAddFloatArray:aKa,primitiveDivScalar:fKa}):self.setTimeout(e,100)}(),bMa=1,cMa=11,fMa=null,gMa="GeniePlugin v2.0 14 November 2014 (e)",function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("GeniePlugin",{primVersionNO:oMa,setInterpreter:pMa,primSameClassAbsoluteStrokeDistanceMyPoints_otherPoints_myVectors_otherVectors_mySquaredLengths_otherSquaredLengths_myAngles_otherAngles_maxSizeAndReferenceFlag_rowBase_rowInsertRemove_rowInsertRemoveCount:nMa,getModuleName:jMa}):self.setTimeout(e,100)}(),FNa=1,GNa=11,MNa=5,NNa=2,ONa=0,PNa=1,QNa=8,RNa=64,SNa=2446,TNa=22554,UNa=3196,VNa=4433,WNa=46802,XNa=6270,YNa=7373,ZNa=9633,$Na=91881,_Na=12299,aOa=116130,bOa=15137,cOa=16069,dOa=16819,eOa=20995,fOa=25172,gOa=1,hOa=2,iOa=4,jOa=8,kOa=16,lOa=128,mOa=255,nOa=11,oOa=10,pOa=0,qOa=127,rOa=3,sOa=null,tOa=0,uOa=new Array(128),vOa=new Array(11),wOa=new Array(128),xOa=new Array(11),yOa=null,zOa=0,AOa=0,BOa=null,COa=null,DOa=0,EOa=[0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63],FOa=0,GOa=0,HOa=null,IOa=0,JOa=0,KOa="JPEGReaderPlugin 3 November 2014 (e)",LOa=null,MOa=new Array(128),NOa=new Array(11),function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("JPEGReaderPlugin",{setInterpreter:hPa,primitiveIdctInt:fPa,primitiveColorConvertMCU:dPa,primitiveColorConvertGrayscaleMCU:cPa,primitiveDecodeMCU:ePa,getModuleName:XOa}):self.setTimeout(e,100)}(),lRa=1,mRa=11,rRa=null,sRa=0,tRa="KedamaPlugin 3 November 2014 (e)",uRa=0,vRa=0,wRa=0,xRa=0,function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("KedamaPlugin",{makeMaskLog:IRa,vectorGetDistanceTo:oSa,getScalarHeading:DRa,shutdownModule:iSa,primitiveAddScalar:SRa,primSetPixelsAtXY:ORa,turtleScalarSetX:jSa,primPixelAtXY:KRa,primUpHill:QRa,primScalarForward:NRa,primitiveDivArrays:TRa,getModuleName:CRa,primitiveSubArrays:XRa,scalarGetAngleTo:bSa,randomRange:aSa,setInterpreter:gSa,kedamaSetRandomSeed:GRa,drawTurtlesInArray:ARa,turtleScalarSetY:kSa,randomIntoIntegerArray:_Ra,getHeadingArrayInto:BRa,makeTurtlesMap:JRa,setHeadingArrayFrom:fSa,turtlesSetX:lSa,setScalarHeading:hSa,makeMask:HRa,primitiveDivScalar:URa,primitiveSubScalar:YRa,primPixelsAtXY:MRa,vectorGetAngleTo:nSa,primitiveMulArrays:VRa,primPixelAtXYPut:LRa,zoomBitmap:pSa,initialiseModule:ERa,primitiveAddArrays:RRa,scalarGetDistanceTo:cSa,turtlesSetY:mSa,randomIntoFloatArray:$Ra,primTurtlesForward:PRa,primitiveMulScalar:WRa}):self.setTimeout(e,100)}(),m_a=1,n_a=11,s_a=null,t_a=0,u_a="KedamaPlugin2 13 November 2014 (e)",v_a=0,w_a=0,x_a=0,y_a=0,function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("KedamaPlugin2",{primitiveAddArrays:S_a,getModuleName:D_a,primitiveMulArrays:f0a,drawTurtlesInArray:B_a,primitiveGTScalar:a0a,setScalarHeading:F0a,primitiveSubScalar:u0a,turtleScalarSetY:I0a,vectorGetAngleTo:L0a,primitiveRemArrays:r0a,primitiveLTArrays:d0a,primitiveAddScalar:T_a,primPixelsAtXY:N_a,primitiveMulScalar:g0a,primSetPixelsAtXY:P_a,setHeadingArrayFrom:D0a,primPixelAtXYPut:M_a,makeMaskLog:J_a,primitiveLTScalar:e0a,scalarGetAngleTo:z0a,primitiveOrByteArray:k0a,primitiveLEArrays:b0a,primitiveRemScalar:s0a,getHeadingArrayInto:C_a,turtlesSetX:J0a,primitivePredicateReplaceBytes:p0a,primitiveDivArrays:V_a,makeMask:I_a,primitiveLEScalar:c0a,kedamaSetRandomSeed:H_a,randomIntoIntegerArray:x0a,setInterpreter:E0a,primitivePredicateAtAllPutColor:m0a,makeTurtlesMap:K_a,randomIntoFloatArray:w0a,primUpHill:R_a,shutdownModule:G0a,primitiveDivScalar:W_a,primitiveGEArrays:Z_a,primitiveNotByteArray:j0a,randomRange:y0a,initialiseModule:F_a,getScalarHeading:E_a,primPixelAtXY:L_a,primitivePredicateAtAllPutNumber:n0a,primitiveEQArrays:X_a,primitiveNEArrays:h0a,primScalarForward:O_a,vectorGetDistanceTo:M0a,turtlesSetY:K0a,turtleScalarSetX:H0a,primTurtlesForward:Q_a,primitiveGEScalar:$_a,primitiveAndByteArray:U_a,primitivePredicateReplaceWords:q0a,primitiveGTArrays:__a,primitivePredicateAtAllPutObject:o0a,primitiveEQScalar:Y_a,primitivePredicateAtAllPutBoolean:l0a,zoomBitmap:N0a,primitiveNEScalar:i0a,scalarGetDistanceTo:A0a,primitiveSubArrays:t0a}):self.setTimeout(e,100)}(),Seb=1,Teb=11,Xeb=46,Yeb=34,Zeb=47,$eb=35,_eb=48,afb=36,bfb=49,cfb=37,dfb=38,efb=45,ffb=9,gfb=50,hfb=13,ifb=17,jfb=40,kfb=19,lfb=41,mfb=21,nfb=42,ofb=23,pfb=43,qfb=25,rfb=44,sfb=27,tfb=29,ufb=31,vfb=33,wfb=39,xfb=4,yfb=1e-4,zfb=0,Afb=12,Bfb=16,Cfb=18,Dfb=20,Efb=22,Ffb=24,Gfb=1,Hfb=26,Ifb=28,Jfb=10,Kfb=30,Lfb=32,Mfb=51,Nfb=2,Ofb=3.141592653589793,Pfb=12,Qfb=3,Rfb=13,Sfb=7,Tfb=4,Ufb=14,Vfb=8,Wfb=5,Xfb=15,Yfb=9,Zfb=6,$fb=16,_fb=10,agb=17,bgb=11,cgb=18,dgb=19,egb=7,fgb=8,ggb=20,hgb=1,igb=21,jgb=6,kgb=24,lgb=22,mgb=2,ngb=23,ogb=3,pgb=11,qgb=5,rgb=0,sgb=0,tgb=0,ugb=0,vgb=0,wgb=null,xgb=0,ygb=null,zgb="Klatt 3 November 2014 (e)",Agb=0,Bgb=0,Cgb=0,Dgb=0,Egb=0,Fgb=0,Ggb=null,Hgb=0,Igb=0,Jgb=0,Kgb=0,Lgb=0,Mgb=0,Ngb=0,Ogb=0,function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("Klatt",{setInterpreter:yhb,primitiveSynthesizeFrameIntoStartingAt:ghb,getModuleName:Zgb}):self.setTimeout(e,100)}(),xkb=1,ykb=11,Fkb=0,Gkb=null,Hkb="LargeIntegers v1.5 (e)",Ikb=1,Jkb=2,function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("LargeIntegers",{primDigitAddWith:ylb,primDigitBitShiftMagnitude:Dlb,primGetModuleName:Nlb,primDigitBitLogicWithOp:Alb,primCheckIfCModuleExists:vlb,primDigitCompare:Flb,primDigitMultiplyNegative:Jlb,primDigitBitShift:Clb,primNormalizePositive:Rlb,primDigitSubtractWith:Mlb,_primDigitBitShift:wlb,primDigitMultiplyWithNegative:Klb,primDigitSubtract:Llb,primDigitDivNegative:Hlb,primNormalizeNegative:Qlb,primDigitBitOr:Blb,primMontgomeryTimesModulo:Olb,primDigitBitAnd:zlb,primDigitDivWithNegative:Ilb,setInterpreter:Slb,primNormalize:Plb,primDigitBitXor:Elb,primDigitCompareWith:Glb,primDigitAdd:xlb,getModuleName:nlb,primAsLargeInteger:ulb,primAnyBitFromTo:tlb}):self.setTimeout(e,100)}(),ltb=1,mtb=11,ptb=null,qtb=0,rtb=0,stb=0,ttb=0,utb="Matrix2x3Plugin 3 November 2014 (e)",function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("Matrix2x3Plugin",{primitiveInvertPoint:Dtb,primitiveInvertRectInto:Etb,primitiveIsIdentity:Ftb,primitiveComposeMatrix:Ctb,setInterpreter:Ltb,primitiveTransformRectInto:Itb,primitiveIsPureTranslation:Gtb,getModuleName:vtb,primitiveTransformPoint:Htb}):self.setTimeout(e,100)}(),hvb=1,ivb=11,mvb=null,nvb="MiscPrimitivePlugin 3 November 2014 (e)",function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("MiscPrimitivePlugin",{primitiveConvert8BitSigned:tvb,primitiveCompareString:rvb,primitiveTranslateStringWithTable:zvb,primitiveStringHash:yvb,primitiveCompressToByteArray:svb,primitiveFindSubstring:wvb,primitiveIndexOfAsciiInString:xvb,setInterpreter:Avb,primitiveDecompressFromByteArray:uvb,getModuleName:qvb,primitiveFindFirstInString:vvb}):self.setTimeout(e,100)}(),rxb=1,sxb=11,wxb=null,xxb="ScratchPlugin 3 November 2014 (e)",function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("ScratchPlugin",{primitiveCondenseSound:Hxb,getModuleName:Bxb,primitiveFisheye:Kxb,primitiveWaterRipples1:Rxb,primitiveHalfSizeDiagonal:Mxb,primitiveScale:Qxb,primitiveDoubleSize:Ixb,setInterpreter:Txb,primitiveWhirl:Sxb,primitiveBlur:Fxb,primitiveBrightnessShift:Gxb,primitiveHalfSizeAverage:Lxb,primitiveSaturationShift:Pxb,primitiveHueShift:Nxb,primitiveInterpolate:Oxb,primitiveExtractChannel:Jxb}):self.setTimeout(e,100)}(),registerSocketPlugin(),registerSpeechPlugin(),registerSqueakSSL(),kIb=1,lIb=11,oIb=511,pIb=512,qIb=32768,rIb=536870912,sIb=null,tIb="SoundGenerationPlugin 3 November 2014 (e)",function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("SoundGenerationPlugin",{primitiveMixFMSound:wIb,primitiveMixSampledSound:zIb,setInterpreter:AIb,getModuleName:uIb,primitiveApplyReverb:vIb,primitiveMixPluckedSound:yIb,primitiveMixLoopedSampledSound:xIb}):self.setTimeout(e,100)}(),SKb=1,TKb=11,XKb=null,YKb="StarSqueakPlugin 3 November 2014 (e)",function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("StarSqueakPlugin",{primitiveDiffuseFromToWidthHeightDelta:_Kb,primitiveEvaporateRate:aLb,setInterpreter:cLb,primitiveMapFromToWidthHeightPatchSizeRgbFlagsShift:bLb,getModuleName:$Kb}):self.setTimeout(e,100)}(),aMb=1,bMb=11,jMb=32767,kMb=32768,lMb=32768,mMb=30,nMb=286,oMb=258,pMb=3,qMb=32767,rMb=32768,sMb=16,tMb=1,uMb=null,vMb="ZipPlugin 3 November 2014 (e)",wMb=0,xMb=0,yMb=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],zMb=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],AMb=0,BMb=0,CMb=0,DMb=null,EMb=0,FMb=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],GMb=null,HMb=0,IMb=[0,1,2,3,4,4,5,5,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,0,0,16,17,18,18,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29],JMb=null,KMb=null,LMb=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],MMb=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],NMb=null,OMb=null,PMb=0,QMb=null,RMb=0,SMb=0,TMb=null,UMb=0,VMb=null,WMb=0,XMb=[257,258,259,260,261,262,263,264,265,265,266,266,267,267,268,268,269,269,269,269,270,270,270,270,271,271,271,271,272,272,272,272,273,273,273,273,273,273,273,273,274,274,274,274,274,274,274,274,275,275,275,275,275,275,275,275,276,276,276,276,276,276,276,276,277,277,277,277,277,277,277,277,277,277,277,277,277,277,277,277,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,278,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,279,280,280,280,280,280,280,280,280,280,280,280,280,280,280,280,280,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,281,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,282,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,283,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284,284],YMb=0,ZMb=0,$Mb=null,_Mb=0,aNb=0,bNb=0,function e(){"object"==typeof Squeak&&Squeak.registerExternalModule?Squeak.registerExternalModule("ZipPlugin",{primitiveZipSendBlock:tNb,primitiveUpdateAdler32:rNb,primitiveUpdateGZipCrc32:sNb,primitiveDeflateUpdateHashTable:pNb,setInterpreter:vNb,getModuleName:jNb,primitiveDeflateBlock:oNb,primitiveInflateDecompressBlock:qNb}):self.setTimeout(e,100)}();var LZString$1={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_f:String.fromCharCode,compressToBase64:function(e){if(null==e)return"";var t,r,i,a,s,n,o,u="",l=0;for(e=LZString$1.compress(e);l<2*e.length;)l%2==0?(t=e.charCodeAt(l/2)>>8,r=255&e.charCodeAt(l/2),i=l/2+1<e.length?e.charCodeAt(l/2+1)>>8:NaN):(t=255&e.charCodeAt((l-1)/2),(l+1)/2<e.length?(r=e.charCodeAt((l+1)/2)>>8,i=255&e.charCodeAt((l+1)/2)):r=i=NaN),l+=3,a=t>>2,s=(3&t)<<4|r>>4,n=(15&r)<<2|i>>6,o=63&i,isNaN(r)?n=o=64:isNaN(i)&&(o=64),u=u+LZString$1._keyStr.charAt(a)+LZString$1._keyStr.charAt(s)+LZString$1._keyStr.charAt(n)+LZString$1._keyStr.charAt(o);return u},decompressFromBase64:function(e){if(null==e)return"";var t,r,i,a,s,n,o,u="",l=0,c=0,h=LZString$1._f;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)r=LZString$1._keyStr.indexOf(e.charAt(c++))<<2|(s=LZString$1._keyStr.indexOf(e.charAt(c++)))>>4,i=(15&s)<<4|(n=LZString$1._keyStr.indexOf(e.charAt(c++)))>>2,a=(3&n)<<6|(o=LZString$1._keyStr.indexOf(e.charAt(c++))),l%2==0?(t=r<<8,64!=n&&(u+=h(t|i)),64!=o&&(t=a<<8)):(u+=h(t|r),64!=n&&(t=i<<8),64!=o&&(u+=h(t|a))),l+=3;return LZString$1.decompress(u)},compressToUTF16:function(e){if(null==e)return"";var t,r,i,a="",s=0,n=LZString$1._f;for(e=LZString$1.compress(e),t=0;t<e.length;t++)switch(r=e.charCodeAt(t),s++){case 0:a+=n(32+(r>>1)),i=(1&r)<<14;break;case 1:a+=n(i+(r>>2)+32),i=(3&r)<<13;break;case 2:a+=n(i+(r>>3)+32),i=(7&r)<<12;break;case 3:a+=n(i+(r>>4)+32),i=(15&r)<<11;break;case 4:a+=n(i+(r>>5)+32),i=(31&r)<<10;break;case 5:a+=n(i+(r>>6)+32),i=(63&r)<<9;break;case 6:a+=n(i+(r>>7)+32),i=(127&r)<<8;break;case 7:a+=n(i+(r>>8)+32),i=(255&r)<<7;break;case 8:a+=n(i+(r>>9)+32),i=(511&r)<<6;break;case 9:a+=n(i+(r>>10)+32),i=(1023&r)<<5;break;case 10:a+=n(i+(r>>11)+32),i=(2047&r)<<4;break;case 11:a+=n(i+(r>>12)+32),i=(4095&r)<<3;break;case 12:a+=n(i+(r>>13)+32),i=(8191&r)<<2;break;case 13:a+=n(i+(r>>14)+32),i=(16383&r)<<1;break;case 14:a+=n(i+(r>>15)+32,32+(32767&r)),s=0}return a+n(i+32)},decompressFromUTF16:function(e){if(null==e)return"";for(var t,r,i="",a=0,s=0,n=LZString$1._f;s<e.length;){switch(r=e.charCodeAt(s)-32,a++){case 0:t=r<<1;break;case 1:i+=n(t|r>>14),t=(16383&r)<<2;break;case 2:i+=n(t|r>>13),t=(8191&r)<<3;break;case 3:i+=n(t|r>>12),t=(4095&r)<<4;break;case 4:i+=n(t|r>>11),t=(2047&r)<<5;break;case 5:i+=n(t|r>>10),t=(1023&r)<<6;break;case 6:i+=n(t|r>>9),t=(511&r)<<7;break;case 7:i+=n(t|r>>8),t=(255&r)<<8;break;case 8:i+=n(t|r>>7),t=(127&r)<<9;break;case 9:i+=n(t|r>>6),t=(63&r)<<10;break;case 10:i+=n(t|r>>5),t=(31&r)<<11;break;case 11:i+=n(t|r>>4),t=(15&r)<<12;break;case 12:i+=n(t|r>>3),t=(7&r)<<13;break;case 13:i+=n(t|r>>2),t=(3&r)<<14;break;case 14:i+=n(t|r>>1),t=(1&r)<<15;break;case 15:i+=n(t|r),a=0}s++}return LZString$1.decompress(i)},compress:function(e){if(null==e)return"";var t,r,i,a={},s={},n="",o="",u="",l=2,c=3,h=2,f="",p=0,d=0,m=LZString$1._f;for(i=0;i<e.length;i+=1)if(n=e.charAt(i),Object.prototype.hasOwnProperty.call(a,n)||(a[n]=c++,s[n]=!0),o=u+n,Object.prototype.hasOwnProperty.call(a,o))u=o;else{if(Object.prototype.hasOwnProperty.call(s,u)){if(u.charCodeAt(0)<256){for(t=0;t<h;t++)p<<=1,15==d?(d=0,f+=m(p),p=0):d++;for(r=u.charCodeAt(0),t=0;t<8;t++)p=p<<1|1&r,15==d?(d=0,f+=m(p),p=0):d++,r>>=1}else{for(r=1,t=0;t<h;t++)p=p<<1|r,15==d?(d=0,f+=m(p),p=0):d++,r=0;for(r=u.charCodeAt(0),t=0;t<16;t++)p=p<<1|1&r,15==d?(d=0,f+=m(p),p=0):d++,r>>=1}0==--l&&(l=Math.pow(2,h),h++),delete s[u]}else for(r=a[u],t=0;t<h;t++)p=p<<1|1&r,15==d?(d=0,f+=m(p),p=0):d++,r>>=1;0==--l&&(l=Math.pow(2,h),h++),a[o]=c++,u=String(n)}if(""!==u){if(Object.prototype.hasOwnProperty.call(s,u)){if(u.charCodeAt(0)<256){for(t=0;t<h;t++)p<<=1,15==d?(d=0,f+=m(p),p=0):d++;for(r=u.charCodeAt(0),t=0;t<8;t++)p=p<<1|1&r,15==d?(d=0,f+=m(p),p=0):d++,r>>=1}else{for(r=1,t=0;t<h;t++)p=p<<1|r,15==d?(d=0,f+=m(p),p=0):d++,r=0;for(r=u.charCodeAt(0),t=0;t<16;t++)p=p<<1|1&r,15==d?(d=0,f+=m(p),p=0):d++,r>>=1}0==--l&&(l=Math.pow(2,h),h++),delete s[u]}else for(r=a[u],t=0;t<h;t++)p=p<<1|1&r,15==d?(d=0,f+=m(p),p=0):d++,r>>=1;0==--l&&(l=Math.pow(2,h),h++)}for(r=2,t=0;t<h;t++)p=p<<1|1&r,15==d?(d=0,f+=m(p),p=0):d++,r>>=1;for(;;){if(p<<=1,15==d){f+=m(p);break}d++}return f},decompress:function(e){if(null==e)return"";if(""==e)return null;var t,r,i,a,s,n,o,u=[],l=4,c=4,h=3,f="",p="",d=LZString$1._f,m={string:e,val:e.charCodeAt(0),position:32768,index:1};for(t=0;t<3;t+=1)u[t]=t;for(i=0,s=Math.pow(2,2),n=1;n!=s;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=32768,m.val=m.string.charCodeAt(m.index++)),i|=(0<a?1:0)*n,n<<=1;switch(i){case 0:for(i=0,s=Math.pow(2,8),n=1;n!=s;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=32768,m.val=m.string.charCodeAt(m.index++)),i|=(0<a?1:0)*n,n<<=1;o=d(i);break;case 1:for(i=0,s=Math.pow(2,16),n=1;n!=s;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=32768,m.val=m.string.charCodeAt(m.index++)),i|=(0<a?1:0)*n,n<<=1;o=d(i);break;case 2:return""}for(r=p=u[3]=o;;){if(m.index>m.string.length)return"";for(i=0,s=Math.pow(2,h),n=1;n!=s;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=32768,m.val=m.string.charCodeAt(m.index++)),i|=(0<a?1:0)*n,n<<=1;switch(o=i){case 0:for(i=0,s=Math.pow(2,8),n=1;n!=s;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=32768,m.val=m.string.charCodeAt(m.index++)),i|=(0<a?1:0)*n,n<<=1;u[c++]=d(i),o=c-1,l--;break;case 1:for(i=0,s=Math.pow(2,16),n=1;n!=s;)a=m.val&m.position,m.position>>=1,0==m.position&&(m.position=32768,m.val=m.string.charCodeAt(m.index++)),i|=(0<a?1:0)*n,n<<=1;u[c++]=d(i),o=c-1,l--;break;case 2:return p}if(0==l&&(l=Math.pow(2,h),h++),u[o])f=u[o];else{if(o!==c)return null;f=r+r.charAt(0)}p+=f,u[c++]=r+f.charAt(0),r=f,0==--l&&(l=Math.pow(2,h),h++)}}};function setupFullscreen(r,e,i){var t,a=e.parentElement,s="fullscreenchange",n="fullscreenElement",o="fullscreenEnabled";function u(e){var t=(r.fullscreen=e)||i.fullscreen;a.style.background=t?"black":"",i.header&&(i.header.style.display=t?"none":""),i.footer&&(i.footer.style.display=t?"none":""),i.fullscreenCheckbox&&(i.fullscreenCheckbox.checked=e),setTimeout(window.onresize,0)}if(a.requestFullscreen||[{req:a.webkitRequestFullscreen,exit:document.webkitExitFullscreen,evt:"webkitfullscreenchange",elem:"webkitFullscreenElement",enable:"webkitFullscreenEnabled"},{req:a.mozRequestFullScreen,exit:document.mozCancelFullScreen,evt:"mozfullscreenchange",elem:"mozFullScreenElement",enable:"mozFullScreenEnabled"},{req:a.msRequestFullscreen,exit:document.msExitFullscreen,evt:"MSFullscreenChange",elem:"msFullscreenElement",enable:"msFullscreenEnabled"}].forEach(function(e){e.req&&(a.requestFullscreen=e.req,document.exitFullscreen=e.exit,s=e.evt,n=e.elem,o=e.enable)}),a.requestFullscreen)document.addEventListener(s,function(){u(a==document[n])}),t=function(){document[o]&&a==document[n]!=r.fullscreen&&(r.fullscreen?a.requestFullscreen():document.exitFullscreen())};else{var l=!1;t=function(){(i.header||i.footer)&&l!=r.fullscreen&&u(l=r.fullscreen)}}return i.fullscreenCheckbox&&(i.fullscreenCheckbox.onclick=function(){r.fullscreen=i.fullscreenCheckbox.checked,t()}),t}function setupSwapButtons(e){if(e.swapCheckbox){var t=Squeak.Settings.squeakImageName||"default",r=JSON.parse(Squeak.Settings["squeakSettings:"+t]||"{}");"swapButtons"in r&&(e.swapButtons=r.swapButtons),e.swapCheckbox.checked=e.swapButtons,e.swapCheckbox.onclick=function(){e.swapButtons=e.swapCheckbox.checked,r.swapButtons=e.swapButtons,Squeak.Settings["squeakSettings:"+t]=JSON.stringify(r)}}}function recordModifiers(e,t){var r=e.shiftKey,i=e.ctrlKey&&!e.altKey,a=e.metaKey||e.altKey&&!e.ctrlKey,s=(r?Squeak.Keyboard_Shift:0)+(i?Squeak.Keyboard_Ctrl:0)+(a?Squeak.Keyboard_Cmd:0);return t.buttons=t.buttons&~Squeak.Keyboard_All|s,s}"undefined"!=typeof module&&null!=module&&(module.exports=LZString$1),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JSZip=e()}}(function(){return function s(n,o,u){function l(r,e){if(!o[r]){if(!n[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(c)return c(r,!0);var i=new Error("Cannot find module '"+r+"'");throw i.code="MODULE_NOT_FOUND",i}var a=o[r]={exports:{}};n[r][0].call(a.exports,function(e){var t=n[r][1][e];return l(t||e)},a,a.exports,s,n,o,u)}return o[r].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,r){var p=e("./utils"),h=e("./support"),d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,i,a,s,n,o,u=[],l=0,c=e.length,h=c,f="string"!==p.getTypeOf(e);l<e.length;)h=c-l,i=f?(t=e[l++],r=l<c?e[l++]:0,l<c?e[l++]:0):(t=e.charCodeAt(l++),r=l<c?e.charCodeAt(l++):0,l<c?e.charCodeAt(l++):0),a=t>>2,s=(3&t)<<4|r>>4,n=1<h?(15&r)<<2|i>>6:64,o=2<h?63&i:64,u.push(d.charAt(a)+d.charAt(s)+d.charAt(n)+d.charAt(o));return u.join("")},r.decode=function(e){var t,r,i,a,s,n,o,u=0,l=0,c=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;for(e.charAt(e.length-1)===d.charAt(64)&&c--,e.charAt(e.length-2)===d.charAt(64)&&c--,o=new(h.uint8array?Uint8Array:Array)(c);u<e.length;)t=d.indexOf(e.charAt(u++))<<2|(a=d.indexOf(e.charAt(u++)))>>4,r=(15&a)<<4|(s=d.indexOf(e.charAt(u++)))>>2,i=(3&s)<<6|(n=d.indexOf(e.charAt(u++))),o[l++]=t,64!==s&&(o[l++]=r),64!==n&&(o[l++]=i);return o}},{"./support":27,"./utils":29}],2:[function(e,t,r){var i=e("./external"),a=e("./stream/DataWorker"),s=e("./stream/DataLengthProbe"),n=e("./stream/Crc32Probe");s=e("./stream/DataLengthProbe");function o(e,t,r,i,a){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=i,this.compressedContent=a}o.prototype={getContentWorker:function(){var e=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new s("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,r){return e.pipe(new n).pipe(new s("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new s("compressedSize")).withStreamInfo("compression",t)},t.exports=o},{"./external":6,"./stream/Crc32Probe":22,"./stream/DataLengthProbe":23,"./stream/DataWorker":24}],3:[function(e,t,r){var i=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(e){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":25}],4:[function(e,t,r){var i=e("./utils");var o=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?("string"!==i.getTypeOf(e)?function(e,t,r,i){var a=o,s=i+r;e^=-1;for(var n=i;n<s;n++)e=e>>>8^a[255&(e^t[n])];return-1^e}:function(e,t,r,i){var a=o,s=i+r;e^=-1;for(var n=i;n<s;n++)e=e>>>8^a[255&(e^t.charCodeAt(n))];return-1^e})(0|t,e,e.length,0):0}},{"./utils":29}],5:[function(e,t,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){var i=e("es6-promise").Promise;t.exports={Promise:i}},{"es6-promise":37}],7:[function(e,t,r){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,a=e("pako"),s=e("./utils"),n=e("./stream/GenericWorker"),o=i?"uint8array":"array";function u(e,t){n.call(this,"FlateWorker/"+e),this._pako=new a[e]({raw:!0,level:t.level||-1}),this.meta={};var r=this;this._pako.onData=function(e){r.push({data:e,meta:r.meta})}}r.magic="\b\0",s.inherits(u,n),u.prototype.processChunk=function(e){this.meta=e.meta,this._pako.push(s.transformTo(o,e.data),!1)},u.prototype.flush=function(){n.prototype.flush.call(this),this._pako.push([],!0)},u.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this._pako=null},r.compressWorker=function(e){return new u("Deflate",e)},r.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":25,"./utils":29,pako:38}],8:[function(e,t,r){function V(e,t){var r,i="";for(r=0;r<t;r++)i+=String.fromCharCode(255&e),e>>>=8;return i}function i(e,t,r,i,a,s){var n,o,u=e.file,l=e.compression,c=s!==R.utf8encode,h=M.transformTo("string",s(u.name)),f=M.transformTo("string",R.utf8encode(u.name)),p=u.comment,d=M.transformTo("string",s(p)),m=M.transformTo("string",R.utf8encode(p)),b=f.length!==u.name.length,v=m.length!==p.length,g="",k="",_="",y=u.dir,S=u.date,O={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(O.crc32=e.crc32,O.compressedSize=e.compressedSize,O.uncompressedSize=e.uncompressedSize);var w=0;t&&(w|=8),c||!b&&!v||(w|=2048);var I,F,P,A=0,x=0;y&&(A|=16),"UNIX"===a?(x=798,A|=(I=u.unixPermissions,F=y,(P=I)||(P=F?16893:33204),(65535&P)<<16)):(x=20,A|=63&(u.dosPermissions||0)),n=S.getUTCHours(),n<<=6,n|=S.getUTCMinutes(),n<<=5,n|=S.getUTCSeconds()/2,o=S.getUTCFullYear()-1980,o<<=4,o|=S.getUTCMonth()+1,o<<=5,o|=S.getUTCDate(),b&&(k=V(1,1)+V(j(h),4)+f,g+="up"+V(k.length,2)+k),v&&(_=V(1,1)+V(j(d),4)+m,g+="uc"+V(_.length,2)+_);var C="";return C+="\n\0",C+=V(w,2),C+=l.magic,C+=V(n,2),C+=V(o,2),C+=V(O.crc32,4),C+=V(O.compressedSize,4),C+=V(O.uncompressedSize,4),C+=V(h.length,2),C+=V(g.length,2),{fileRecord:q.LOCAL_FILE_HEADER+C+h+g,dirRecord:q.CENTRAL_FILE_HEADER+V(x,2)+C+V(d.length,2)+"\0\0\0\0"+V(A,4)+V(i,4)+h+g+d}}var M=e("../utils"),a=e("../stream/GenericWorker"),R=e("../utf8"),j=e("../crc32"),q=e("../signature");function s(e,t,r,i){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}M.inherits(s,a),s.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,a.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-i-1))/r:100}}))},s.prototype.openedSource=function(e){if(this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name,this.streamFiles&&!e.file.dir){var t=i(e,this.streamFiles,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:t.fileRecord,meta:{percent:0}})}else this.accumulate=!0},s.prototype.closedSource=function(e){this.accumulate=!1;var t,r=i(e,this.streamFiles,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),this.streamFiles&&!e.file.dir)this.push({data:(t=e,q.DATA_DESCRIPTOR+V(t.crc32,4)+V(t.compressedSize,4)+V(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},s.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r,i,a,s,n,o,u=this.bytesWritten-e,l=(r=this.dirRecords.length,i=u,a=e,s=this.zipComment,n=this.encodeFileName,o=M.transformTo("string",n(s)),q.CENTRAL_DIRECTORY_END+"\0\0\0\0"+V(r,2)+V(r,2)+V(i,4)+V(a,4)+V(o.length,2)+o);this.push({data:l,meta:{percent:100}})},s.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},s.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},s.prototype.error=function(e){var t=this._sources;if(!a.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},s.prototype.lock=function(){a.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=s},{"../crc32":4,"../signature":20,"../stream/GenericWorker":25,"../utf8":28,"../utils":29}],9:[function(e,t,r){var l=e("../compressions"),i=e("./ZipFileWorker");r.generateWorker=function(e,n,t){var o=new i(n.streamFiles,t,n.platform,n.encodeFileName),u=0;try{e.forEach(function(e,t){u++;var r=function(e,t){var r=e||t,i=l[r];if(!i)throw new Error(r+" is not a valid compression method !");return i}(t.options.compression,n.compression),i=t.options.compressionOptions||n.compressionOptions||{},a=t.dir,s=t.date;t._compressWorker(r,i).withStreamInfo("file",{name:e,dir:a,date:s,comment:t.comment||"",unixPermissions:t.unixPermissions,dosPermissions:t.dosPermissions}).pipe(o)}),o.entriesCount=u}catch(e){o.error(e)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.loadAsync=function(e,t){return(new i).loadAsync(e,t)},i.external=e("./external"),t.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":13,"./support":27}],11:[function(e,t,r){var i=e("./utils"),a=e("./external"),o=e("./utf8"),u=(i=e("./utils"),e("./zipEntries")),s=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(i){return new a.Promise(function(e,t){var r=i.decompressed.getContentWorker().pipe(new s);r.on("error",function(e){t(e)}).on("end",function(){r.streamInfo.crc32!==i.decompressed.crc32?t(new Error("Corrupted zip : CRC32 mismatch")):e()}).resume()})}t.exports=function(e,s){var n=this;return s=i.extend(s||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),l.isNode&&l.isStream(e)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",e,!0,s.optimizedBinaryString,s.base64).then(function(e){var t=new u(s);return t.load(e),t}).then(function(e){var t=[a.Promise.resolve(e)],r=e.files;if(s.checkCRC32)for(var i=0;i<r.length;i++)t.push(c(r[i]));return a.Promise.all(t)}).then(function(e){for(var t=e.shift(),r=t.files,i=0;i<r.length;i++){var a=r[i];n.file(a.fileNameStr,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:s.createFolders})}return t.zipComment.length&&(n.comment=t.zipComment),n})}},{"./external":6,"./nodejsUtils":12,"./stream/Crc32Probe":22,"./utf8":28,"./utils":29,"./zipEntries":30}],12:[function(e,t,r){(function(r){t.exports={isNode:void 0!==r,newBuffer:function(e,t){return new r(e,t)},isBuffer:function(e){return r.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],13:[function(e,t,r){function s(e,t,r){var i,a=u.getTypeOf(t);(r=u.extend(r||{},c)).date=r.date||new Date,null!==r.compression&&(r.compression=r.compression.toUpperCase()),"string"==typeof r.unixPermissions&&(r.unixPermissions=parseInt(r.unixPermissions,8)),r.unixPermissions&&16384&r.unixPermissions&&(r.dir=!0),r.dosPermissions&&16&r.dosPermissions&&(r.dir=!0),r.dir&&(e=b(e)),r.createFolders&&(i=m(e))&&v.call(this,i,!0);var s="string"===a&&!1===r.binary&&!1===r.base64;r.binary=!s,(t instanceof h&&0===t.uncompressedSize||r.dir||!t||0===t.length)&&(r.base64=!1,r.binary=!0,t="",r.compression="STORE",a="string");var n=null;n=t instanceof h||t instanceof l?t:p.isNode&&p.isStream(t)?new d(e,t):u.prepareContent(e,t,r.binary,r.optimizedBinaryString,r.base64);var o=new f(e,n,r);this.files[e]=o}var a=e("./utf8"),u=e("./utils"),l=e("./stream/GenericWorker"),n=e("./stream/StreamHelper"),c=e("./defaults"),h=e("./compressedObject"),f=e("./zipObject"),o=e("./generate"),p=e("./nodejsUtils"),d=e("./nodejs/NodejsStreamInputAdapter"),m=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},b=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},v=function(e,t){return t=void 0!==t?t:c.createFolders,e=b(e),this.files[e]||s.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function g(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var i={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,i;for(t in this.files)this.files.hasOwnProperty(t)&&(i=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,i))},filter:function(r){var i=[];return this.forEach(function(e,t){r(e,t)&&i.push(t)}),i},file:function(e,t,r){if(1!==arguments.length)return e=this.root+e,s.call(this,e,t,r),this;if(g(e)){var i=e;return this.filter(function(e,t){return!t.dir&&i.test(e)})}var a=this.files[this.root+e];return a&&!a.dir?a:null},folder:function(r){if(!r)return this;if(g(r))return this.filter(function(e,t){return t.dir&&r.test(e)});var e=this.root+r,t=v.call(this,e),i=this.clone();return i.root=t.name,i},remove:function(r){r=this.root+r;var e=this.files[r];if(e||("/"!==r.slice(-1)&&(r+="/"),e=this.files[r]),e&&!e.dir)delete this.files[r];else for(var t=this.filter(function(e,t){return t.name.slice(0,r.length)===r}),i=0;i<t.length;i++)delete this.files[t[i].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=u.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");u.checkSupport(r.type),"darwin"!==e.platform&&"freebsd"!==e.platform&&"linux"!==e.platform&&"sunos"!==e.platform||(e.platform="UNIX"),"win32"===e.platform&&(e.platform="DOS");var i=r.comment||this.comment||"";t=o.generateWorker(this,r,i)}catch(e){(t=new l("error")).error(e)}return new n(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=i},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":35,"./nodejsUtils":12,"./stream/GenericWorker":25,"./stream/StreamHelper":26,"./utf8":28,"./utils":29,"./zipObject":32}],14:[function(e,t,r){var i=e("./DataReader");function a(e){i.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(a,i),a.prototype.byteAt=function(e){return this.data[this.zero+e]},a.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),i=e.charCodeAt(2),a=e.charCodeAt(3),s=this.length-4;0<=s;--s)if(this.data[s]===t&&this.data[s+1]===r&&this.data[s+2]===i&&this.data[s+3]===a)return s-this.zero;return-1},a.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),i=e.charCodeAt(2),a=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&r===s[1]&&i===s[2]&&a===s[3]},a.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":29,"./DataReader":15}],15:[function(e,t,r){var i=e("../utils");function a(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return i.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=a},{"../utils":29}],16:[function(e,t,r){var i=e("./Uint8ArrayReader");function a(e){i.call(this,e)}e("../utils").inherits(a,i),a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":29,"./Uint8ArrayReader":18}],17:[function(e,t,r){var i=e("./DataReader");function a(e){i.call(this,e)}e("../utils").inherits(a,i),a.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},a.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},a.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":29,"./DataReader":15}],18:[function(e,t,r){var i=e("./ArrayReader");function a(e){i.call(this,e)}e("../utils").inherits(a,i),a.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":29,"./ArrayReader":14}],19:[function(e,t,r){var i=e("../utils"),a=e("../support"),s=e("./ArrayReader"),n=e("./StringReader"),o=e("./NodeBufferReader"),u=e("./Uint8ArrayReader");t.exports=function(e){var t=i.getTypeOf(e);return i.checkSupport(t),"string"!==t||a.uint8array?"nodebuffer"===t?new o(e):a.uint8array?new u(i.transformTo("uint8array",e)):new s(i.transformTo("array",e)):new n(e)}},{"../support":27,"../utils":29,"./ArrayReader":14,"./NodeBufferReader":16,"./StringReader":17,"./Uint8ArrayReader":18}],20:[function(e,t,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],21:[function(e,t,r){var i=e("./GenericWorker"),a=e("../utils");function s(e){i.call(this,"ConvertWorker to "+e),this.destType=e}a.inherits(s,i),s.prototype.processChunk=function(e){this.push({data:a.transformTo(this.destType,e.data),meta:e.meta})},t.exports=s},{"../utils":29,"./GenericWorker":25}],22:[function(e,t,r){var i=e("./GenericWorker"),a=e("../crc32");function s(){i.call(this,"Crc32Probe")}e("../utils").inherits(s,i),s.prototype.processChunk=function(e){this.streamInfo.crc32=a(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=s},{"../crc32":4,"../utils":29,"./GenericWorker":25}],23:[function(e,t,r){var i=e("../utils"),a=e("./GenericWorker");function s(e){a.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}i.inherits(s,a),s.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}a.prototype.processChunk.call(this,e)},t.exports=s},{"../utils":29,"./GenericWorker":25}],24:[function(e,t,r){var i=e("../utils"),a=e("./GenericWorker");function s(e){a.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=i.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}i.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=s},{"../utils":29,"./GenericWorker":25}],25:[function(e,t,r){function i(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=i},{}],26:[function(n,o,e){(function(u){var l=n("../utils"),a=n("./ConvertWorker"),s=n("./GenericWorker"),c=n("../base64"),t=n("../nodejs/NodejsStreamOutputAdapter"),r=n("../external");function i(e,o){return new r.Promise(function(t,r){var i=[],a=e._internalType,s=e._outputType,n=e._mimeType;e.on("data",function(e,t){i.push(e),o&&o(t)}).on("error",function(e){i=[],r(e)}).on("end",function(){try{var e=function(e,t,r){switch(e){case"blob":return l.newBlob(l.transformTo("arraybuffer",t),r);case"base64":return c.encode(t);default:return l.transformTo(e,t)}}(s,function(e,t){var r,i=0,a=null,s=0;for(r=0;r<t.length;r++)s+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(a=new Uint8Array(s),r=0;r<t.length;r++)a.set(t[r],i),i+=t[r].length;return a;case"nodebuffer":return u.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(a,i),n);t(e)}catch(e){r(e)}i=[]}).resume()})}function e(e,t,r){var i=t;switch(t){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string"}try{this._internalType=i,this._outputType=t,this._mimeType=r,l.checkSupport(i),this._worker=e.pipe(new a(i)),e.lock()}catch(e){this._worker=new s("error"),this._worker.error(e)}}e.prototype={accumulate:function(e){return i(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,function(e){t.call(r,e.data,e.meta)}):this._worker.on(e,function(){l.delay(t,arguments,r)}),this},resume:function(){return l.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(l.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new t(this,{objectMode:"nodebuffer"!==this._outputType},e)}},o.exports=e}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":35,"../utils":29,"./ConvertWorker":21,"./GenericWorker":25}],27:[function(i,e,a){(function(e){if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,a.nodebuffer=void 0!==e,a.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)a.blob=!1;else{var t=new ArrayBuffer(0);try{a.blob=0===new Blob([t],{type:"application/zip"}).size}catch(e){try{var r=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);r.append(t),a.blob=0===r.getBlob("application/zip").size}catch(e){a.blob=!1}}}a.nodestream=!!i("./nodejs/NodejsStreamOutputAdapter").prototype}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{"./nodejs/NodejsStreamOutputAdapter":35}],28:[function(e,t,s){for(var o=e("./utils"),u=e("./support"),r=e("./nodejsUtils"),i=e("./stream/GenericWorker"),l=new Array(256),a=0;a<256;a++)l[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;l[254]=l[254]=1;function n(){i.call(this,"utf-8 decode"),this.leftOver=null}function c(){i.call(this,"utf-8 encode")}s.utf8encode=function(e){return u.nodebuffer?r.newBuffer(e,"utf-8"):function(e){var t,r,i,a,s,n=e.length,o=0;for(a=0;a<n;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<n&&56320==(64512&(i=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(i-56320),a++),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new(u.uint8array?Uint8Array:Array)(o),a=s=0;s<o;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<n&&56320==(64512&(i=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(i-56320),a++),r<128?t[s++]=r:(r<2048?t[s++]=192|r>>>6:(r<65536?t[s++]=224|r>>>12:(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63),t[s++]=128|r>>>6&63),t[s++]=128|63&r);return t}(e)},s.utf8decode=function(e){return u.nodebuffer?o.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,i,a,s=e.length,n=new Array(2*s);for(t=r=0;t<s;)if((i=e[t++])<128)n[r++]=i;else if(4<(a=l[i]))n[r++]=65533,t+=a-1;else{for(i&=2===a?31:3===a?15:7;1<a&&t<s;)i=i<<6|63&e[t++],a--;1<a?n[r++]=65533:i<65536?n[r++]=i:(i-=65536,n[r++]=55296|i>>10&1023,n[r++]=56320|1023&i)}return n.length!==r&&(n.subarray?n=n.subarray(0,r):n.length=r),o.applyFromCharCode(n)}(e=o.transformTo(u.uint8array?"uint8array":"array",e))},o.inherits(n,i),n.prototype.processChunk=function(e){var t=o.transformTo(u.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(u.uint8array){var r=t;(t=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),t.set(r,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var i=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return!(r<0)&&0!==r&&r+l[e[r]]>t?r:t}(t),a=t;i!==t.length&&(u.uint8array?(a=t.subarray(0,i),this.leftOver=t.subarray(i,t.length)):(a=t.slice(0,i),this.leftOver=t.slice(i,t.length))),this.push({data:s.utf8decode(a),meta:e.meta})},n.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=n,o.inherits(c,i),c.prototype.processChunk=function(e){this.push({data:s.utf8encode(e.data),meta:e.meta})},s.Utf8EncodeWorker=c},{"./nodejsUtils":12,"./stream/GenericWorker":25,"./support":27,"./utils":29}],29:[function(e,t,u){var l=e("./support"),c=e("./base64"),r=e("./nodejsUtils"),i=e("asap"),h=e("./external");function a(e){return e}function f(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}u.newBlob=function(t,r){u.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return i.append(t),i.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var s={stringifyByChunk:function(e,t,r){var i=[],a=0,s=e.length;if(s<=r)return String.fromCharCode.apply(null,e);for(;a<s;)"array"===t||"nodebuffer"===t?i.push(String.fromCharCode.apply(null,e.slice(a,Math.min(a+r,s)))):i.push(String.fromCharCode.apply(null,e.subarray(a,Math.min(a+r,s)))),a+=r;return i.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return l.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return l.nodebuffer&&1===String.fromCharCode.apply(null,r.newBuffer(1)).length}catch(e){return!1}}()}};function n(e){var t=65536,r=u.getTypeOf(e),i=!0;if("uint8array"===r?i=s.applyCanBeUsed.uint8array:"nodebuffer"===r&&(i=s.applyCanBeUsed.nodebuffer),i)for(;1<t;)try{return s.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return s.stringifyByChar(e)}function o(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}u.applyFromCharCode=n;var p={};p.string={string:a,array:function(e){return f(e,new Array(e.length))},arraybuffer:function(e){return p.string.uint8array(e).buffer},uint8array:function(e){return f(e,new Uint8Array(e.length))},nodebuffer:function(e){return f(e,r.newBuffer(e.length))}},p.array={string:n,array:a,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBuffer(e)}},p.arraybuffer={string:function(e){return n(new Uint8Array(e))},array:function(e){return o(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:a,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBuffer(new Uint8Array(e))}},p.uint8array={string:n,array:function(e){return o(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:a,nodebuffer:function(e){return r.newBuffer(e)}},p.nodebuffer={string:n,array:function(e){return o(e,new Array(e.length))},arraybuffer:function(e){return p.nodebuffer.uint8array(e).buffer},uint8array:function(e){return o(e,new Uint8Array(e.length))},nodebuffer:a},u.transformTo=function(e,t){if(t=t||"",!e)return t;u.checkSupport(e);var r=u.getTypeOf(t);return p[r][e](t)},u.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":l.nodebuffer&&r.isBuffer(e)?"nodebuffer":l.uint8array&&e instanceof Uint8Array?"uint8array":l.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},u.checkSupport=function(e){if(!l[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},u.MAX_VALUE_16BITS=65535,u.MAX_VALUE_32BITS=-1,u.pretty=function(e){var t,r,i="";for(r=0;r<(e||"").length;r++)i+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return i},u.delay=function(e,t,r){i(function(){e.apply(r||null,t||[])})},u.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},u.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},u.prepareContent=function(i,a,s,n,o){return(l.blob&&a instanceof Blob&&"undefined"!=typeof FileReader?new h.Promise(function(t,r){var e=new FileReader;e.onload=function(e){t(e.target.result)},e.onerror=function(e){r(e.target.error)},e.readAsArrayBuffer(a)}):h.Promise.resolve(a)).then(function(e){var t,r=u.getTypeOf(e);return r?("arraybuffer"===r?e=u.transformTo("uint8array",e):"string"===r&&(o?e=c.decode(e):s&&!0!==n&&(e=f(t=e,new(l.uint8array?Uint8Array:Array)(t.length)))),e):h.Promise.reject(new Error("The data of '"+i+"' is in an unsupported format !"))})}},{"./base64":1,"./external":6,"./nodejsUtils":12,"./support":27,asap:33}],30:[function(e,t,r){var i=e("./reader/readerFor"),a=e("./utils"),s=e("./signature"),n=e("./zipEntry"),o=(e("./utf8"),e("./support"));function u(e){this.files=[],this.loadOptions=e}u.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug : unexpected signature ("+a.pretty(t)+", expected "+a.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4)===t;return this.reader.setIndex(r),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",r=a.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(e=new n({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e<0)throw!this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip : can't find end of central directory");this.reader.setIndex(e);var t=e;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip : can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var i=t-r;if(0<i)this.isSignature(t,s.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=i(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=u},{"./reader/readerFor":19,"./signature":20,"./support":27,"./utf8":28,"./utils":29,"./zipEntry":31}],31:[function(e,t,r){var i=e("./reader/readerFor"),s=e("./utils"),a=e("./compressedObject"),n=e("./crc32"),o=e("./utf8"),u=e("./compressions"),l=e("./support");function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in u)if(u.hasOwnProperty(t)&&u[t].magic===e)return u[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=i(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,r,i,a=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index<a;)t=e.readInt(2),r=e.readInt(2),i=e.readData(r),this.extraFields[t]={id:t,length:r,value:i}},handleUTF8:function(){var e=l.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=s.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var a=s.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=i(e.value);return 1!==t.readInt(1)?null:n(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=i(e.value);return 1!==t.readInt(1)?null:n(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":19,"./support":27,"./utf8":28,"./utils":29}],32:[function(e,t,r){function i(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var s=e("./stream/StreamHelper"),a=e("./stream/DataWorker"),n=e("./utf8"),o=e("./compressedObject"),u=e("./stream/GenericWorker");i.prototype={internalStream:function(e){var t=e.toLowerCase(),r="string"===t||"text"===t;"binarystring"!==t&&"text"!==t||(t="string");var i=this._decompressWorker(),a=!this._dataBinary;return a&&!r&&(i=i.pipe(new n.Utf8EncodeWorker)),!a&&r&&(i=i.pipe(new n.Utf8DecodeWorker)),new s(i,t,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new n.Utf8EncodeWorker)),o.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var l=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<l.length;h++)i.prototype[l[h]]=c;t.exports=i},{"./compressedObject":2,"./stream/DataWorker":24,"./stream/GenericWorker":25,"./stream/StreamHelper":26,"./utf8":28}],33:[function(e,t,r){var i=e("./raw"),a=[],s=[],n=i.makeRequestCallFromTimer(function(){if(s.length)throw s.shift()});function o(e){var t;(t=a.length?a.pop():new u).task=e,i(t)}function u(){this.task=null}t.exports=o,u.prototype.call=function(){try{this.task.call()}catch(e){o.onerror?o.onerror(e):(s.push(e),n())}finally{this.task=null,a[a.length]=this}}},{"./raw":34}],34:[function(e,h,t){(function(e){function t(e){i.length||r(),i[i.length]=e}h.exports=t;var r,i=[],a=0;function s(){for(;a<i.length;){var e=a;if(a+=1,i[e].call(),1024<a){for(var t=0,r=i.length-a;t<r;t++)i[t]=i[t+a];i.length-=a,a=0}}i.length=0,a=0}var n,o,u,l=e.MutationObserver||e.WebKitMutationObserver;function c(i){return function(){var e=setTimeout(r,0),t=setInterval(r,50);function r(){clearTimeout(e),clearInterval(t),i()}}}r="function"==typeof l?(n=1,o=new l(s),u=document.createTextNode(""),o.observe(u,{characterData:!0}),function(){n=-n,u.data=n}):c(s),t.requestFlush=r,t.makeRequestCallFromTimer=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],35:[function(e,t,r){},{}],36:[function(e,t,r){var i,a=t.exports={},s=[],n=!1,o=-1;function u(){n=!1,i.length?s=i.concat(s):o=-1,s.length&&l()}function l(){if(!n){var e=setTimeout(u);n=!0;for(var t=s.length;t;){for(i=s,s=[];++o<t;)i&&i[o].run();o=-1,t=s.length}i=null,n=!1,clearTimeout(e)}}function c(e,t){this.fun=e,this.array=t}function h(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];s.push(new c(e,t)),1!==s.length||n||setTimeout(l,0)},c.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=h,a.addListener=h,a.once=h,a.off=h,a.removeListener=h,a.removeAllListeners=h,a.emit=h,a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],37:[function(U,X,e){(function(D,G){(function(){function l(e){return"function"==typeof e}var t,r,n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,o=function(e,t){v[i]=e,v[i+1]=t,2===(i+=2)&&(r?r(g):f())};var e="undefined"!=typeof window?window:void 0,a=e||{},s=a.MutationObserver||a.WebKitMutationObserver,u=void 0!==D&&"[object process]"==={}.toString.call(D),c="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function h(){return function(){setTimeout(g,1)}}var f,p,d,m,b,v=new Array(1e3);function g(){for(var e=0;e<i;e+=2){(0,v[e])(v[e+1]),v[e]=void 0,v[e+1]=void 0}i=0}function k(){}f=u?function(){D.nextTick(g)}:s?(d=0,m=new s(g),b=document.createTextNode(""),m.observe(b,{characterData:!0}),function(){b.data=d=++d%2}):c?((p=new MessageChannel).port1.onmessage=g,function(){p.port2.postMessage(0)}):(void 0===e&&"function"==typeof U?function(){try{var e=U("vertx");return t=e.runOnLoop||e.runOnContext,function(){t(g)}}catch(e){return h()}}:h)();var _=void 0,y=1,S=2,O=new M;function w(e,i,a){o(function(t){var r=!1,e=function(e,t,r,i){try{e.call(t,r,i)}catch(e){return e}}(a,i,function(e){r||(r=!0,(i!==e?F:A)(t,e))},function(e){r||(r=!0,x(t,e))},t._label);!r&&e&&(r=!0,x(t,e))},e)}function I(e,t){if(t.constructor===e.constructor)i=e,(a=t)._state===y?A(i,a._result):a._state===S?x(i,a._result):C(a,void 0,function(e){F(i,e)},function(e){x(i,e)});else{var r=function(e){try{return e.then}catch(e){return O.error=e,O}}(t);r===O?x(e,O.error):void 0!==r&&l(r)?w(e,t,r):A(e,t)}var i,a}function F(e,t){var r;e===t?x(e,new TypeError("You cannot resolve a promise with itself")):("function"==typeof(r=t)||"object"==typeof r&&null!==r?I:A)(e,t)}function P(e){e._onerror&&e._onerror(e._result),V(e)}function A(e,t){e._state===_&&(e._result=t,e._state=y,0!==e._subscribers.length&&o(V,e))}function x(e,t){e._state===_&&(e._state=S,e._result=t,o(P,e))}function C(e,t,r,i){var a=e._subscribers,s=a.length;e._onerror=null,a[s]=t,a[s+y]=r,a[s+S]=i,0===s&&e._state&&o(V,e)}function V(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var i,a,s=e._result,n=0;n<t.length;n+=3)i=t[n],a=t[n+r],i?j(r,i,a,s):a(s);e._subscribers.length=0}}function M(){this.error=null}var R=new M;function j(e,t,r,i){var a,s,n,o,u=l(r);if(u){if((a=function(e,t){try{return e(t)}catch(e){return R.error=e,R}}(r,i))===R?(o=!0,s=a.error,a=null):n=!0,t===a)return void x(t,new TypeError("A promises callback cannot return that same promise."))}else a=i,n=!0;t._state!==_||(u&&n?F(t,a):o?x(t,s):e===y?A(t,a):e===S&&x(t,a))}function q(e,t){var r=this;r._instanceConstructor=e,r.promise=new e(k),r._validateInput(t)?(r._input=t,r.length=t.length,r._remaining=t.length,r._init(),0===r.length?A(r.promise,r._result):(r.length=r.length||0,r._enumerate(),0===r._remaining&&A(r.promise,r._result))):x(r.promise,r._validationError())}q.prototype._validateInput=function(e){return n(e)},q.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},q.prototype._init=function(){this._result=new Array(this.length)};var Y=q;q.prototype._enumerate=function(){for(var e=this.length,t=this.promise,r=this._input,i=0;t._state===_&&i<e;i++)this._eachEntry(r[i],i)},q.prototype._eachEntry=function(e,t){var r,i=this._instanceConstructor;"object"==typeof(r=e)&&null!==r?e.constructor===i&&e._state!==_?(e._onerror=null,this._settledAt(e._state,t,e._result)):this._willSettleAt(i.resolve(e),t):(this._remaining--,this._result[t]=e)},q.prototype._settledAt=function(e,t,r){var i=this.promise;i._state===_&&(this._remaining--,e===S?x(i,r):this._result[t]=r),0===this._remaining&&A(i,this._result)},q.prototype._willSettleAt=function(e,t){var r=this;C(e,void 0,function(e){r._settledAt(y,t,e)},function(e){r._settledAt(S,t,e)})};function N(e){var t=new this(k);if(!n(e))return x(t,new TypeError("You must pass an array to race.")),t;var r=e.length;function i(e){F(t,e)}function a(e){x(t,e)}for(var s=0;t._state===_&&s<r;s++)C(this.resolve(e[s]),void 0,i,a);return t}function B(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(k);return F(t,e),t}function W(e){var t=new this(k);return x(t,e),t}var T=0;var Z=E;function E(e){this._id=T++,this._state=void 0,this._result=void 0,this._subscribers=[],k!==e&&(l(e)||function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof E||function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}(),function(t,e){try{e(function(e){F(t,e)},function(e){x(t,e)})}catch(e){x(t,e)}}(this,e))}E.all=function(e){return new Y(this,e).promise},E.race=N,E.resolve=B,E.reject=W,E._setScheduler=function(e){r=e},E._setAsap=function(e){o=e},E._asap=o,E.prototype={constructor:E,then:function(e,t){var r=this._state;if(r===y&&!e||r===S&&!t)return this;var i=new this.constructor(k),a=this._result;if(r){var s=arguments[r-1];o(function(){j(r,i,s,a)})}else C(this,i,e,t);return i},catch:function(e){return this.then(null,e)}};var L=function(){var e;if(void 0!==G)e=G;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;t&&"[object Promise]"===Object.prototype.toString.call(t.resolve())&&!t.cast||(e.Promise=Z)},z={Promise:Z,polyfill:L};void 0!==X&&X.exports?X.exports=z:void 0!==this&&(this.ES6Promise=z),L()}).call(this)}).call(this,U("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:36}],38:[function(e,t,r){var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){var n=e("./zlib/deflate"),o=e("./utils/common"),u=e("./utils/strings"),a=e("./zlib/messages"),s=e("./zlib/zstream"),l=Object.prototype.toString,c=0,h=-1,f=0,p=8;function d(e){if(!(this instanceof d))return new d(e);this.options=o.assign({level:h,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==c)throw new Error(a[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var i;if(i="string"==typeof t.dictionary?u.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=n.deflateSetDictionary(this.strm,i))!==c)throw new Error(a[r]);this._dict_set=!0}}function i(e,t){var r=new d(t);if(r.push(e,!0),r.err)throw r.msg;return r.result}d.prototype.push=function(e,t){var r,i,a=this.strm,s=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:!0===t?4:0,"string"==typeof e?a.input=u.string2buf(e):"[object ArrayBuffer]"===l.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new o.Buf8(s),a.next_out=0,a.avail_out=s),1!==(r=n.deflate(a,i))&&r!==c)return this.onEnd(r),!(this.ended=!0);0!==a.avail_out&&(0!==a.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(u.buf2binstring(o.shrinkBuf(a.output,a.next_out))):this.onData(o.shrinkBuf(a.output,a.next_out)))}while((0<a.avail_in||0===a.avail_out)&&1!==r);return 4===i?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===c):2!==i||(this.onEnd(c),!(a.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=d,r.deflate=i,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,i(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,i(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){var f=e("./zlib/inflate"),p=e("./utils/common"),d=e("./utils/strings"),m=e("./zlib/constants"),i=e("./zlib/messages"),a=e("./zlib/zstream"),s=e("./zlib/gzheader"),b=Object.prototype.toString;function n(e){if(!(this instanceof n))return new n(e);this.options=p.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var r=f.inflateInit2(this.strm,t.windowBits);if(r!==m.Z_OK)throw new Error(i[r]);this.header=new s,f.inflateGetHeader(this.strm,this.header)}function o(e,t){var r=new n(t);if(r.push(e,!0),r.err)throw r.msg;return r.result}n.prototype.push=function(e,t){var r,i,a,s,n,o,u=this.strm,l=this.options.chunkSize,c=this.options.dictionary,h=!1;if(this.ended)return!1;i=t===~~t?t:!0===t?m.Z_FINISH:m.Z_NO_FLUSH,"string"==typeof e?u.input=d.binstring2buf(e):"[object ArrayBuffer]"===b.call(e)?u.input=new Uint8Array(e):u.input=e,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new p.Buf8(l),u.next_out=0,u.avail_out=l),(r=f.inflate(u,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&c&&(o="string"==typeof c?d.string2buf(c):"[object ArrayBuffer]"===b.call(c)?new Uint8Array(c):c,r=f.inflateSetDictionary(this.strm,o)),r===m.Z_BUF_ERROR&&!0===h&&(r=m.Z_OK,h=!1),r!==m.Z_STREAM_END&&r!==m.Z_OK)return this.onEnd(r),!(this.ended=!0);u.next_out&&(0!==u.avail_out&&r!==m.Z_STREAM_END&&(0!==u.avail_in||i!==m.Z_FINISH&&i!==m.Z_SYNC_FLUSH)||("string"===this.options.to?(a=d.utf8border(u.output,u.next_out),s=u.next_out-a,n=d.buf2string(u.output,a),u.next_out=s,u.avail_out=l-s,s&&p.arraySet(u.output,u.output,a,s,0),this.onData(n)):this.onData(p.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(h=!0)}while((0<u.avail_in||0===u.avail_out)&&r!==m.Z_STREAM_END);return r===m.Z_STREAM_END&&(i=m.Z_FINISH),i===m.Z_FINISH?(r=f.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===m.Z_OK):i!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(u.avail_out=0))},n.prototype.onData=function(e){this.chunks.push(e)},n.prototype.onEnd=function(e){e===m.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=p.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=n,r.inflate=o,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,o(e,t)},r.ungzip=o},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,r,i,a){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+i),a);else for(var s=0;s<i;s++)e[a+s]=t[r+s]},flattenChunks:function(e){var t,r,i,a,s,n;for(t=i=0,r=e.length;t<r;t++)i+=e[t].length;for(n=new Uint8Array(i),t=a=0,r=e.length;t<r;t++)s=e[t],n.set(s,a),a+=s.length;return n}},s={arraySet:function(e,t,r,i,a){for(var s=0;s<i;s++)e[a+s]=t[r+s]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,a)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(i)},{}],42:[function(e,t,r){var u=e("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var l=new u.Buf8(256),i=0;i<256;i++)l[i]=252<=i?6:248<=i?5:240<=i?4:224<=i?3:192<=i?2:1;function c(e,t){if(t<65537&&(e.subarray&&s||!e.subarray&&a))return String.fromCharCode.apply(null,u.shrinkBuf(e,t));for(var r="",i=0;i<t;i++)r+=String.fromCharCode(e[i]);return r}l[254]=l[254]=1,r.string2buf=function(e){var t,r,i,a,s,n=e.length,o=0;for(a=0;a<n;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<n&&56320==(64512&(i=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(i-56320),a++),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new u.Buf8(o),a=s=0;s<o;a++)55296==(64512&(r=e.charCodeAt(a)))&&a+1<n&&56320==(64512&(i=e.charCodeAt(a+1)))&&(r=65536+(r-55296<<10)+(i-56320),a++),r<128?t[s++]=r:(r<2048?t[s++]=192|r>>>6:(r<65536?t[s++]=224|r>>>12:(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63),t[s++]=128|r>>>6&63),t[s++]=128|63&r);return t},r.buf2binstring=function(e){return c(e,e.length)},r.binstring2buf=function(e){for(var t=new u.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,i,a,s,n=t||e.length,o=new Array(2*n);for(r=i=0;r<n;)if((a=e[r++])<128)o[i++]=a;else if(4<(s=l[a]))o[i++]=65533,r+=s-1;else{for(a&=2===s?31:3===s?15:7;1<s&&r<n;)a=a<<6|63&e[r++],s--;1<s?o[i++]=65533:a<65536?o[i++]=a:(a-=65536,o[i++]=55296|a>>10&1023,o[i++]=56320|1023&a)}return c(o,i)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return!(r<0)&&0!==r&&r+l[e[r]]>t?r:t}},{"./common":41}],43:[function(e,t,r){t.exports=function(e,t,r,i){for(var a=65535&e|0,s=e>>>16&65535|0,n=0;0!==r;){for(r-=n=2e3<r?2e3:r;s=s+(a=a+t[i++]|0)|0,--n;);a%=65521,s%=65521}return a|s<<16|0}},{}],44:[function(e,t,r){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){var o=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,i){var a=o,s=i+r;e^=-1;for(var n=i;n<s;n++)e=e>>>8^a[255&(e^t[n])];return-1^e}},{}],46:[function(e,t,r){var u,f=e("../utils/common"),l=e("./trees"),p=e("./adler32"),d=e("./crc32"),i=e("./messages"),c=0,h=4,m=0,b=-2,v=-1,g=4,a=2,k=8,_=9,s=286,n=30,o=19,y=2*s+1,S=15,O=3,w=258,I=w+O+1,F=42,P=113,A=1,x=2,C=3,V=4;function M(e,t){return e.msg=i[t],t}function R(e){return(e<<1)-(4<e?9:0)}function j(e){for(var t=e.length;0<=--t;)e[t]=0}function q(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(f.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function Y(e,t){l._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,q(e.strm)}function N(e,t){e.pending_buf[e.pending++]=t}function B(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function W(e,t){var r,i,a=e.max_chain_length,s=e.strstart,n=e.prev_length,o=e.nice_match,u=e.strstart>e.w_size-I?e.strstart-(e.w_size-I):0,l=e.window,c=e.w_mask,h=e.prev,f=e.strstart+w,p=l[s+n-1],d=l[s+n];e.prev_length>=e.good_match&&(a>>=2),o>e.lookahead&&(o=e.lookahead);do{if(l[(r=t)+n]===d&&l[r+n-1]===p&&l[r]===l[s]&&l[++r]===l[s+1]){s+=2,r++;do{}while(l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&l[++s]===l[++r]&&s<f);if(i=w-(f-s),s=f-w,n<i){if(e.match_start=t,o<=(n=i))break;p=l[s+n-1],d=l[s+n]}}}while((t=h[t&c])>u&&0!=--a);return n<=e.lookahead?n:e.lookahead}function T(e){var t,r,i,a,s,n,o,u,l,c,h=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=h+(h-I)){for(f.arraySet(e.window,e.window,h,h,0),e.match_start-=h,e.strstart-=h,e.block_start-=h,t=r=e.hash_size;i=e.head[--t],e.head[t]=h<=i?i-h:0,--r;);for(t=r=h;i=e.prev[--t],e.prev[t]=h<=i?i-h:0,--r;);a+=h}if(0===e.strm.avail_in)break;if(n=e.strm,o=e.window,u=e.strstart+e.lookahead,l=a,c=void 0,c=n.avail_in,l<c&&(c=l),r=0===c?0:(n.avail_in-=c,f.arraySet(o,n.input,n.next_in,c,u),1===n.state.wrap?n.adler=p(n.adler,o,c,u):2===n.state.wrap&&(n.adler=d(n.adler,o,c,u)),n.next_in+=c,n.total_in+=c,c),e.lookahead+=r,e.lookahead+e.insert>=O)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+O-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<O)););}while(e.lookahead<I&&0!==e.strm.avail_in)}function Z(e,t){for(var r,i;;){if(e.lookahead<I){if(T(e),e.lookahead<I&&t===c)return A;if(0===e.lookahead)break}if(r=0,e.lookahead>=O&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-I&&(e.match_length=W(e,r)),e.match_length>=O)if(i=l._tr_tally(e,e.strstart-e.match_start,e.match_length-O),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=O){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=l._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(Y(e,!1),0===e.strm.avail_out))return A}return e.insert=e.strstart<O-1?e.strstart:O-1,t===h?(Y(e,!0),0===e.strm.avail_out?C:V):e.last_lit&&(Y(e,!1),0===e.strm.avail_out)?A:x}function E(e,t){for(var r,i,a;;){if(e.lookahead<I){if(T(e),e.lookahead<I&&t===c)return A;if(0===e.lookahead)break}if(r=0,e.lookahead>=O&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=O-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-I&&(e.match_length=W(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===O&&4096<e.strstart-e.match_start)&&(e.match_length=O-1)),e.prev_length>=O&&e.match_length<=e.prev_length){for(a=e.strstart+e.lookahead-O,i=l._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-O),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+O-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=O-1,e.strstart++,i&&(Y(e,!1),0===e.strm.avail_out))return A}else if(e.match_available){if((i=l._tr_tally(e,0,e.window[e.strstart-1]))&&Y(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return A}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=l._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<O-1?e.strstart:O-1,t===h?(Y(e,!0),0===e.strm.avail_out?C:V):e.last_lit&&(Y(e,!1),0===e.strm.avail_out)?A:x}function L(e,t,r,i,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=i,this.func=a}function z(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new f.Buf16(2*y),this.dyn_dtree=new f.Buf16(2*(2*n+1)),this.bl_tree=new f.Buf16(2*(2*o+1)),j(this.dyn_ltree),j(this.dyn_dtree),j(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new f.Buf16(S+1),this.heap=new f.Buf16(2*s+1),j(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new f.Buf16(2*s+1),j(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function D(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=a,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?F:P,e.adler=2===t.wrap?0:1,t.last_flush=c,l._tr_init(t),m):M(e,b)}function G(e){var t,r=D(e);return r===m&&((t=e.state).window_size=2*t.w_size,j(t.head),t.max_lazy_match=u[t.level].max_lazy,t.good_match=u[t.level].good_length,t.nice_match=u[t.level].nice_length,t.max_chain_length=u[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=O-1,t.match_available=0,t.ins_h=0),r}function U(e,t,r,i,a,s){if(!e)return b;var n=1;if(t===v&&(t=6),i<0?(n=0,i=-i):15<i&&(n=2,i-=16),a<1||_<a||r!==k||i<8||15<i||t<0||9<t||s<0||g<s)return M(e,b);8===i&&(i=9);var o=new z;return(e.state=o).strm=e,o.wrap=n,o.gzhead=null,o.w_bits=i,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=a+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+O-1)/O),o.window=new f.Buf8(2*o.w_size),o.head=new f.Buf16(o.hash_size),o.prev=new f.Buf16(o.w_size),o.lit_bufsize=1<<a+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new f.Buf8(o.pending_buf_size),o.d_buf=o.lit_bufsize>>1,o.l_buf=3*o.lit_bufsize,o.level=t,o.strategy=s,o.method=r,G(e)}u=[new L(0,0,0,0,function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(T(e),0===e.lookahead&&t===c)return A;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+r;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,Y(e,!1),0===e.strm.avail_out))return A;if(e.strstart-e.block_start>=e.w_size-I&&(Y(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===h?(Y(e,!0),0===e.strm.avail_out?C:V):(e.strstart>e.block_start&&(Y(e,!1),e.strm.avail_out),A)}),new L(4,4,8,4,Z),new L(4,5,16,8,Z),new L(4,6,32,32,Z),new L(4,4,16,16,E),new L(8,16,32,32,E),new L(8,16,128,128,E),new L(8,32,128,256,E),new L(32,128,258,1024,E),new L(32,258,258,4096,E)],r.deflateInit=function(e,t){return U(e,t,k,15,8,0)},r.deflateInit2=U,r.deflateReset=G,r.deflateResetKeep=D,r.deflateSetHeader=function(e,t){return!e||!e.state||2!==e.state.wrap?b:(e.state.gzhead=t,m)},r.deflate=function(e,t){var r,i,a,s;if(!e||!e.state||5<t||t<0)return e?M(e,b):b;if(i=e.state,!e.output||!e.input&&0!==e.avail_in||666===i.status&&t!==h)return M(e,0===e.avail_out?-5:b);if(i.strm=e,r=i.last_flush,i.last_flush=t,i.status===F)if(2===i.wrap)e.adler=0,N(i,31),N(i,139),N(i,8),i.gzhead?(N(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),N(i,255&i.gzhead.time),N(i,i.gzhead.time>>8&255),N(i,i.gzhead.time>>16&255),N(i,i.gzhead.time>>24&255),N(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),N(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(N(i,255&i.gzhead.extra.length),N(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=d(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(N(i,0),N(i,0),N(i,0),N(i,0),N(i,0),N(i,9===i.level?2:2<=i.strategy||i.level<2?4:0),N(i,3),i.status=P);else{var n=k+(i.w_bits-8<<4)<<8;n|=(2<=i.strategy||i.level<2?0:i.level<6?1:6===i.level?2:3)<<6,0!==i.strstart&&(n|=32),n+=31-n%31,i.status=P,B(i,n),0!==i.strstart&&(B(i,e.adler>>>16),B(i,65535&e.adler)),e.adler=1}if(69===i.status)if(i.gzhead.extra){for(a=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>a&&(e.adler=d(e.adler,i.pending_buf,i.pending-a,a)),q(e),a=i.pending,i.pending!==i.pending_buf_size));)N(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>a&&(e.adler=d(e.adler,i.pending_buf,i.pending-a,a)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=d(e.adler,i.pending_buf,i.pending-a,a)),q(e),a=i.pending,i.pending===i.pending_buf_size)){s=1;break}s=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,N(i,s)}while(0!==s);i.gzhead.hcrc&&i.pending>a&&(e.adler=d(e.adler,i.pending_buf,i.pending-a,a)),0===s&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){a=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>a&&(e.adler=d(e.adler,i.pending_buf,i.pending-a,a)),q(e),a=i.pending,i.pending===i.pending_buf_size)){s=1;break}s=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,N(i,s)}while(0!==s);i.gzhead.hcrc&&i.pending>a&&(e.adler=d(e.adler,i.pending_buf,i.pending-a,a)),0===s&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&q(e),i.pending+2<=i.pending_buf_size&&(N(i,255&e.adler),N(i,e.adler>>8&255),e.adler=0,i.status=P)):i.status=P),0!==i.pending){if(q(e),0===e.avail_out)return i.last_flush=-1,m}else if(0===e.avail_in&&R(t)<=R(r)&&t!==h)return M(e,-5);if(666===i.status&&0!==e.avail_in)return M(e,-5);if(0!==e.avail_in||0!==i.lookahead||t!==c&&666!==i.status){var o=2===i.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(T(e),0===e.lookahead)){if(t===c)return A;break}if(e.match_length=0,r=l._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Y(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===h?(Y(e,!0),0===e.strm.avail_out?C:V):e.last_lit&&(Y(e,!1),0===e.strm.avail_out)?A:x}(i,t):3===i.strategy?function(e,t){for(var r,i,a,s,n=e.window;;){if(e.lookahead<=w){if(T(e),e.lookahead<=w&&t===c)return A;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=O&&0<e.strstart&&(i=n[a=e.strstart-1])===n[++a]&&i===n[++a]&&i===n[++a]){s=e.strstart+w;do{}while(i===n[++a]&&i===n[++a]&&i===n[++a]&&i===n[++a]&&i===n[++a]&&i===n[++a]&&i===n[++a]&&i===n[++a]&&a<s);e.match_length=w-(s-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=O?(r=l._tr_tally(e,1,e.match_length-O),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=l._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Y(e,!1),0===e.strm.avail_out))return A}return e.insert=0,t===h?(Y(e,!0),0===e.strm.avail_out?C:V):e.last_lit&&(Y(e,!1),0===e.strm.avail_out)?A:x}(i,t):u[i.level].func(i,t);if(o!==C&&o!==V||(i.status=666),o===A||o===C)return 0===e.avail_out&&(i.last_flush=-1),m;if(o===x&&(1===t?l._tr_align(i):5!==t&&(l._tr_stored_block(i,0,0,!1),3===t&&(j(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),q(e),0===e.avail_out))return i.last_flush=-1,m}return t!==h?m:i.wrap<=0?1:(2===i.wrap?(N(i,255&e.adler),N(i,e.adler>>8&255),N(i,e.adler>>16&255),N(i,e.adler>>24&255),N(i,255&e.total_in),N(i,e.total_in>>8&255),N(i,e.total_in>>16&255),N(i,e.total_in>>24&255)):(B(i,e.adler>>>16),B(i,65535&e.adler)),q(e),0<i.wrap&&(i.wrap=-i.wrap),0!==i.pending?m:1)},r.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==F&&69!==t&&73!==t&&91!==t&&103!==t&&t!==P&&666!==t?M(e,b):(e.state=null,t===P?M(e,-3):m):b},r.deflateSetDictionary=function(e,t){var r,i,a,s,n,o,u,l,c=t.length;if(!e||!e.state)return b;if(2===(s=(r=e.state).wrap)||1===s&&r.status!==F||r.lookahead)return b;for(1===s&&(e.adler=p(e.adler,t,c,0)),r.wrap=0,c>=r.w_size&&(0===s&&(j(r.head),r.strstart=0,r.block_start=0,r.insert=0),l=new f.Buf8(r.w_size),f.arraySet(l,t,c-r.w_size,r.w_size,0),t=l,c=r.w_size),n=e.avail_in,o=e.next_in,u=e.input,e.avail_in=c,e.next_in=0,e.input=t,T(r);r.lookahead>=O;){for(i=r.strstart,a=r.lookahead-(O-1);r.ins_h=(r.ins_h<<r.hash_shift^r.window[i+O-1])&r.hash_mask,r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++,--a;);r.strstart=i,r.lookahead=O-1,T(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=O-1,r.match_available=0,e.next_in=o,e.input=u,e.avail_in=n,r.wrap=s,m},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){t.exports=function(e,t){var r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O,w,I,F;r=e.state,i=e.next_in,I=e.input,a=i+(e.avail_in-5),s=e.next_out,F=e.output,n=s-(t-e.avail_out),o=s+(e.avail_out-257),u=r.dmax,l=r.wsize,c=r.whave,h=r.wnext,f=r.window,p=r.hold,d=r.bits,m=r.lencode,b=r.distcode,v=(1<<r.lenbits)-1,g=(1<<r.distbits)-1;e:do{d<15&&(p+=I[i++]<<d,d+=8,p+=I[i++]<<d,d+=8),k=m[p&v];t:for(;;){if(p>>>=_=k>>>24,d-=_,0===(_=k>>>16&255))F[s++]=65535&k;else{if(!(16&_)){if(0==(64&_)){k=m[(65535&k)+(p&(1<<_)-1)];continue t}if(32&_){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}y=65535&k,(_&=15)&&(d<_&&(p+=I[i++]<<d,d+=8),y+=p&(1<<_)-1,p>>>=_,d-=_),d<15&&(p+=I[i++]<<d,d+=8,p+=I[i++]<<d,d+=8),k=b[p&g];r:for(;;){if(p>>>=_=k>>>24,d-=_,!(16&(_=k>>>16&255))){if(0==(64&_)){k=b[(65535&k)+(p&(1<<_)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(S=65535&k,d<(_&=15)&&(p+=I[i++]<<d,(d+=8)<_&&(p+=I[i++]<<d,d+=8)),u<(S+=p&(1<<_)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(p>>>=_,d-=_,(_=s-n)<S){if(c<(_=S-_)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(w=f,(O=0)===h){if(O+=l-_,_<y){for(y-=_;F[s++]=f[O++],--_;);O=s-S,w=F}}else if(h<_){if(O+=l+h-_,(_-=h)<y){for(y-=_;F[s++]=f[O++],--_;);if(O=0,h<y){for(y-=_=h;F[s++]=f[O++],--_;);O=s-S,w=F}}}else if(O+=h-_,_<y){for(y-=_;F[s++]=f[O++],--_;);O=s-S,w=F}for(;2<y;)F[s++]=w[O++],F[s++]=w[O++],F[s++]=w[O++],y-=3;y&&(F[s++]=w[O++],1<y&&(F[s++]=w[O++]))}else{for(O=s-S;F[s++]=F[O++],F[s++]=F[O++],F[s++]=F[O++],2<(y-=3););y&&(F[s++]=F[O++],1<y&&(F[s++]=F[O++]))}break}}break}}while(i<a&&s<o);i-=y=d>>3,p&=(1<<(d-=y<<3))-1,e.next_in=i,e.next_out=s,e.avail_in=i<a?a-i+5:5-(i-a),e.avail_out=s<o?o-s+257:257-(s-o),r.hold=p,r.bits=d}},{}],49:[function(e,t,r){var x=e("../utils/common"),C=e("./adler32"),V=e("./crc32"),M=e("./inffast"),R=e("./inftrees"),j=1,q=2,Y=0,N=-2,B=1,i=852,a=592;function W(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function s(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new x.Buf16(320),this.work=new x.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function n(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=B,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new x.Buf32(i),t.distcode=t.distdyn=new x.Buf32(a),t.sane=1,t.back=-1,Y):N}function o(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,n(e)):N}function u(e,t){var r,i;return e&&e.state?(i=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?N:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,o(e))):N}function l(e,t){var r,i;return e?(i=new s,(e.state=i).window=null,(r=u(e,t))!==Y&&(e.state=null),r):N}var c,h,f=!0;function T(e){if(f){var t;for(c=new x.Buf32(512),h=new x.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(R(j,e.lens,0,288,c,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;R(q,e.lens,0,32,h,0,e.work,{bits:5}),f=!1}e.lencode=c,e.lenbits=9,e.distcode=h,e.distbits=5}function Z(e,t,r,i){var a,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new x.Buf8(s.wsize)),i>=s.wsize?(x.arraySet(s.window,t,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(i<(a=s.wsize-s.wnext)&&(a=i),x.arraySet(s.window,t,r-i,a,s.wnext),(i-=a)?(x.arraySet(s.window,t,r-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0}r.inflateReset=o,r.inflateReset2=u,r.inflateResetKeep=n,r.inflateInit=function(e){return l(e,15)},r.inflateInit2=l,r.inflate=function(e,t){var r,i,a,s,n,o,u,l,c,h,f,p,d,m,b,v,g,k,_,y,S,O,w,I,F=0,P=new x.Buf8(4),A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return N;12===(r=e.state).mode&&(r.mode=13),n=e.next_out,a=e.output,u=e.avail_out,s=e.next_in,i=e.input,o=e.avail_in,l=r.hold,c=r.bits,h=o,f=u,O=Y;e:for(;;)switch(r.mode){case B:if(0===r.wrap){r.mode=13;break}for(;c<16;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}if(2&r.wrap&&35615===l){P[r.check=0]=255&l,P[1]=l>>>8&255,r.check=V(r.check,P,2,0),c=l=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&l)){e.msg="unknown compression method",r.mode=30;break}if(c-=4,S=8+(15&(l>>>=4)),0===r.wbits)r.wbits=S;else if(S>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<S,e.adler=r.check=1,r.mode=512&l?10:12,c=l=0;break;case 2:for(;c<16;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}if(r.flags=l,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&(P[0]=255&l,P[1]=l>>>8&255,r.check=V(r.check,P,2,0)),c=l=0,r.mode=3;case 3:for(;c<32;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}r.head&&(r.head.time=l),512&r.flags&&(P[0]=255&l,P[1]=l>>>8&255,P[2]=l>>>16&255,P[3]=l>>>24&255,r.check=V(r.check,P,4,0)),c=l=0,r.mode=4;case 4:for(;c<16;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&(P[0]=255&l,P[1]=l>>>8&255,r.check=V(r.check,P,2,0)),c=l=0,r.mode=5;case 5:if(1024&r.flags){for(;c<16;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&(P[0]=255&l,P[1]=l>>>8&255,r.check=V(r.check,P,2,0)),c=l=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(o<(p=r.length)&&(p=o),p&&(r.head&&(S=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),x.arraySet(r.head.extra,i,s,p,S)),512&r.flags&&(r.check=V(r.check,i,p,s)),o-=p,s+=p,r.length-=p),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===o)break e;for(p=0;S=i[s+p++],r.head&&S&&r.length<65536&&(r.head.name+=String.fromCharCode(S)),S&&p<o;);if(512&r.flags&&(r.check=V(r.check,i,p,s)),o-=p,s+=p,S)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===o)break e;for(p=0;S=i[s+p++],r.head&&S&&r.length<65536&&(r.head.comment+=String.fromCharCode(S)),S&&p<o;);if(512&r.flags&&(r.check=V(r.check,i,p,s)),o-=p,s+=p,S)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;c<16;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}if(l!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}c=l=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;c<32;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}e.adler=r.check=W(l),c=l=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=n,e.avail_out=u,e.next_in=s,e.avail_in=o,r.hold=l,r.bits=c,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){l>>>=7&c,c-=7&c,r.mode=27;break}for(;c<3;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}switch(r.last=1&l,--c,3&(l>>>=1)){case 0:r.mode=14;break;case 1:if(T(r),r.mode=20,6!==t)break;l>>>=2,c-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}l>>>=2,c-=2;break;case 14:for(l>>>=7&c,c-=7&c;c<32;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}if((65535&l)!=(l>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&l,c=l=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(p=r.length){if(o<p&&(p=o),u<p&&(p=u),0===p)break e;x.arraySet(a,i,s,p,n),o-=p,s+=p,u-=p,n+=p,r.length-=p;break}r.mode=12;break;case 17:for(;c<14;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}if(r.nlen=257+(31&l),l>>>=5,c-=5,r.ndist=1+(31&l),l>>>=5,c-=5,r.ncode=4+(15&l),l>>>=4,c-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;c<3;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}r.lens[A[r.have++]]=7&l,l>>>=3,c-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,w={bits:r.lenbits},O=R(0,r.lens,0,19,r.lencode,0,r.work,w),r.lenbits=w.bits,O){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;v=(F=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,g=65535&F,!((b=F>>>24)<=c);){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}if(g<16)l>>>=b,c-=b,r.lens[r.have++]=g;else{if(16===g){for(I=b+2;c<I;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}if(l>>>=b,c-=b,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}S=r.lens[r.have-1],p=3+(3&l),l>>>=2,c-=2}else if(17===g){for(I=b+3;c<I;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}c-=b,S=0,p=3+(7&(l>>>=b)),l>>>=3,c-=3}else{for(I=b+7;c<I;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}c-=b,S=0,p=11+(127&(l>>>=b)),l>>>=7,c-=7}if(r.have+p>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;p--;)r.lens[r.have++]=S}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,w={bits:r.lenbits},O=R(j,r.lens,0,r.nlen,r.lencode,0,r.work,w),r.lenbits=w.bits,O){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,w={bits:r.distbits},O=R(q,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,w),r.distbits=w.bits,O){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=o&&258<=u){e.next_out=n,e.avail_out=u,e.next_in=s,e.avail_in=o,r.hold=l,r.bits=c,M(e,f),n=e.next_out,a=e.output,u=e.avail_out,s=e.next_in,i=e.input,o=e.avail_in,l=r.hold,c=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;v=(F=r.lencode[l&(1<<r.lenbits)-1])>>>16&255,g=65535&F,!((b=F>>>24)<=c);){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}if(v&&0==(240&v)){for(k=b,_=v,y=g;v=(F=r.lencode[y+((l&(1<<k+_)-1)>>k)])>>>16&255,g=65535&F,!(k+(b=F>>>24)<=c);){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}l>>>=k,c-=k,r.back+=k}if(l>>>=b,c-=b,r.back+=b,r.length=g,0===v){r.mode=26;break}if(32&v){r.back=-1,r.mode=12;break}if(64&v){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&v,r.mode=22;case 22:if(r.extra){for(I=r.extra;c<I;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;v=(F=r.distcode[l&(1<<r.distbits)-1])>>>16&255,g=65535&F,!((b=F>>>24)<=c);){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}if(0==(240&v)){for(k=b,_=v,y=g;v=(F=r.distcode[y+((l&(1<<k+_)-1)>>k)])>>>16&255,g=65535&F,!(k+(b=F>>>24)<=c);){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}l>>>=k,c-=k,r.back+=k}if(l>>>=b,c-=b,r.back+=b,64&v){e.msg="invalid distance code",r.mode=30;break}r.offset=g,r.extra=15&v,r.mode=24;case 24:if(r.extra){for(I=r.extra;c<I;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,c-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===u)break e;if(p=f-u,r.offset>p){if((p=r.offset-p)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}d=p>r.wnext?(p-=r.wnext,r.wsize-p):r.wnext-p,p>r.length&&(p=r.length),m=r.window}else m=a,d=n-r.offset,p=r.length;for(u<p&&(p=u),u-=p,r.length-=p;a[n++]=m[d++],--p;);0===r.length&&(r.mode=21);break;case 26:if(0===u)break e;a[n++]=r.length,u--,r.mode=21;break;case 27:if(r.wrap){for(;c<32;){if(0===o)break e;o--,l|=i[s++]<<c,c+=8}if(f-=u,e.total_out+=f,r.total+=f,f&&(e.adler=r.check=(r.flags?V:C)(r.check,a,f,n-f)),f=u,(r.flags?l:W(l))!==r.check){e.msg="incorrect data check",r.mode=30;break}c=l=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;c<32;){if(0===o)break e;o--,l+=i[s++]<<c,c+=8}if(l!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}c=l=0}r.mode=29;case 29:O=1;break e;case 30:O=-3;break e;case 31:return-4;case 32:default:return N}return e.next_out=n,e.avail_out=u,e.next_in=s,e.avail_in=o,r.hold=l,r.bits=c,(r.wsize||f!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&Z(e,e.output,e.next_out,f-e.avail_out),h-=e.avail_in,f-=e.avail_out,e.total_in+=h,e.total_out+=f,r.total+=f,r.wrap&&f&&(e.adler=r.check=(r.flags?V:C)(r.check,a,f,e.next_out-f)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==h&&0===f||4===t)&&O===Y&&(O=-5),O},r.inflateEnd=function(e){if(!e||!e.state)return N;var t=e.state;return t.window&&(t.window=null),e.state=null,Y},r.inflateGetHeader=function(e,t){var r;return!e||!e.state||0==(2&(r=e.state).wrap)?N:((r.head=t).done=!1,Y)},r.inflateSetDictionary=function(e,t){var r,i=t.length;return!e||!e.state||0!==(r=e.state).wrap&&11!==r.mode?N:11===r.mode&&C(1,t,i,0)!==r.check?-3:Z(e,t,i,i)?(r.mode=31,-4):(r.havedict=1,Y)},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){var j=e("../utils/common"),q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],N=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],B=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,i,a,s,n,o){var u,l,c,h,f,p,d,m,b,v=o.bits,g=0,k=0,_=0,y=0,S=0,O=0,w=0,I=0,F=0,P=0,A=null,x=0,C=new j.Buf16(16),V=new j.Buf16(16),M=null,R=0;for(g=0;g<=15;g++)C[g]=0;for(k=0;k<i;k++)C[t[r+k]]++;for(S=v,y=15;1<=y&&0===C[y];y--);if(y<S&&(S=y),0===y)return a[s++]=20971520,a[s++]=20971520,o.bits=1,0;for(_=1;_<y&&0===C[_];_++);for(S<_&&(S=_),g=I=1;g<=15;g++)if(I<<=1,(I-=C[g])<0)return-1;if(0<I&&(0===e||1!==y))return-1;for(V[1]=0,g=1;g<15;g++)V[g+1]=V[g]+C[g];for(k=0;k<i;k++)0!==t[r+k]&&(n[V[t[r+k]]++]=k);if(p=0===e?(A=M=n,19):1===e?(A=q,x-=257,M=Y,R-=257,256):(A=N,M=B,-1),g=_,f=s,w=k=P=0,c=-1,h=(F=1<<(O=S))-1,1===e&&852<F||2===e&&592<F)return 1;for(;;){for(d=g-w,b=n[k]<p?(m=0,n[k]):n[k]>p?(m=M[R+n[k]],A[x+n[k]]):(m=96,0),u=1<<g-w,_=l=1<<O;a[f+(P>>w)+(l-=u)]=d<<24|m<<16|b|0,0!==l;);for(u=1<<g-1;P&u;)u>>=1;if(0!==u?(P&=u-1,P+=u):P=0,k++,0==--C[g]){if(g===y)break;g=t[r+n[k]]}if(S<g&&(P&h)!==c){for(0===w&&(w=S),f+=_,I=1<<(O=g-w);O+w<y&&!((I-=C[O+w])<=0);)O++,I<<=1;if(F+=1<<O,1===e&&852<F||2===e&&592<F)return 1;a[c=P&h]=S<<24|O<<16|f-s|0}}return 0!==P&&(a[f+P]=g-w<<24|64<<16|0),o.bits=S,0}},{"../utils/common":41}],51:[function(e,t,r){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){var u=e("../utils/common"),o=0,l=1;function i(e){for(var t=e.length;0<=--t;)e[t]=0}var c=0,n=29,h=256,f=h+1+n,p=30,d=19,b=2*f+1,v=15,a=16,m=7,g=256,k=16,_=17,y=18,S=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],w=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=new Array(2*(f+2));i(F);var P=new Array(2*p);i(P);var A=new Array(512);i(A);var x=new Array(256);i(x);var C=new Array(n);i(C);var V,M,R,j=new Array(p);function q(e,t,r,i,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=i,this.max_length=a,this.has_stree=e&&e.length}function s(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function Y(e){return e<256?A[e]:A[256+(e>>>7)]}function N(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function B(e,t,r){e.bi_valid>a-r?(e.bi_buf|=t<<e.bi_valid&65535,N(e,e.bi_buf),e.bi_buf=t>>a-e.bi_valid,e.bi_valid+=r-a):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function W(e,t,r){B(e,r[2*t],r[2*t+1])}function T(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function Z(e,t,r){var i,a,s=new Array(v+1),n=0;for(i=1;i<=v;i++)s[i]=n=n+r[i-1]<<1;for(a=0;a<=t;a++){var o=e[2*a+1];0!==o&&(e[2*a]=T(s[o]++,o))}}function E(e){var t;for(t=0;t<f;t++)e.dyn_ltree[2*t]=0;for(t=0;t<p;t++)e.dyn_dtree[2*t]=0;for(t=0;t<d;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*g]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function L(e){8<e.bi_valid?N(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function z(e,t,r,i){var a=2*t,s=2*r;return e[a]<e[s]||e[a]===e[s]&&i[t]<=i[r]}function D(e,t,r){for(var i=e.heap[r],a=r<<1;a<=e.heap_len&&(a<e.heap_len&&z(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!z(t,i,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=i}function G(e,t,r){var i,a,s,n,o=0;if(0!==e.last_lit)for(;i=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],a=e.pending_buf[e.l_buf+o],o++,0===i?W(e,a,t):(W(e,(s=x[a])+h+1,t),0!==(n=S[s])&&B(e,a-=C[s],n),W(e,s=Y(--i),r),0!==(n=O[s])&&B(e,i-=j[s],n)),o<e.last_lit;);W(e,g,t)}function U(e,t){var r,i,a,s=t.dyn_tree,n=t.stat_desc.static_tree,o=t.stat_desc.has_stree,u=t.stat_desc.elems,l=-1;for(e.heap_len=0,e.heap_max=b,r=0;r<u;r++)0!==s[2*r]?(e.heap[++e.heap_len]=l=r,e.depth[r]=0):s[2*r+1]=0;for(;e.heap_len<2;)s[2*(a=e.heap[++e.heap_len]=l<2?++l:0)]=1,e.depth[a]=0,e.opt_len--,o&&(e.static_len-=n[2*a+1]);for(t.max_code=l,r=e.heap_len>>1;1<=r;r--)D(e,s,r);for(a=u;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],D(e,s,1),i=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=i,s[2*a]=s[2*r]+s[2*i],e.depth[a]=(e.depth[r]>=e.depth[i]?e.depth[r]:e.depth[i])+1,s[2*r+1]=s[2*i+1]=a,e.heap[1]=a++,D(e,s,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,i,a,s,n,o,u=t.dyn_tree,l=t.max_code,c=t.stat_desc.static_tree,h=t.stat_desc.has_stree,f=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,d=t.stat_desc.max_length,m=0;for(s=0;s<=v;s++)e.bl_count[s]=0;for(u[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<b;r++)d<(s=u[2*u[2*(i=e.heap[r])+1]+1]+1)&&(s=d,m++),u[2*i+1]=s,l<i||(e.bl_count[s]++,n=0,p<=i&&(n=f[i-p]),o=u[2*i],e.opt_len+=o*(s+n),h&&(e.static_len+=o*(c[2*i+1]+n)));if(0!==m){do{for(s=d-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[d]--,m-=2}while(0<m);for(s=d;0!==s;s--)for(i=e.bl_count[s];0!==i;)l<(a=e.heap[--r])||(u[2*a+1]!==s&&(e.opt_len+=(s-u[2*a+1])*u[2*a],u[2*a+1]=s),i--)}}(e,t),Z(s,l,e.bl_count)}function X(e,t,r){var i,a,s=-1,n=t[1],o=0,u=7,l=4;for(0===n&&(u=138,l=3),t[2*(r+1)+1]=65535,i=0;i<=r;i++)a=n,n=t[2*(i+1)+1],++o<u&&a===n||(o<l?e.bl_tree[2*a]+=o:0!==a?(a!==s&&e.bl_tree[2*a]++,e.bl_tree[2*k]++):o<=10?e.bl_tree[2*_]++:e.bl_tree[2*y]++,s=a,l=(o=0)===n?(u=138,3):a===n?(u=6,3):(u=7,4))}function K(e,t,r){var i,a,s=-1,n=t[1],o=0,u=7,l=4;for(0===n&&(u=138,l=3),i=0;i<=r;i++)if(a=n,n=t[2*(i+1)+1],!(++o<u&&a===n)){if(o<l)for(;W(e,a,e.bl_tree),0!=--o;);else 0!==a?(a!==s&&(W(e,a,e.bl_tree),o--),W(e,k,e.bl_tree),B(e,o-3,2)):o<=10?(W(e,_,e.bl_tree),B(e,o-3,3)):(W(e,y,e.bl_tree),B(e,o-11,7));s=a,l=(o=0)===n?(u=138,3):a===n?(u=6,3):(u=7,4)}}i(j);var H=!1;function J(e,t,r,i){var a,s,n,o;B(e,(c<<1)+(i?1:0),3),s=t,n=r,o=!0,L(a=e),o&&(N(a,n),N(a,~n)),u.arraySet(a.pending_buf,a.window,s,n,a.pending),a.pending+=n}r._tr_init=function(e){H||(function(){var e,t,r,i,a,s=new Array(v+1);for(i=r=0;i<n-1;i++)for(C[i]=r,e=0;e<1<<S[i];e++)x[r++]=i;for(x[r-1]=i,i=a=0;i<16;i++)for(j[i]=a,e=0;e<1<<O[i];e++)A[a++]=i;for(a>>=7;i<p;i++)for(j[i]=a<<7,e=0;e<1<<O[i]-7;e++)A[256+a++]=i;for(t=0;t<=v;t++)s[t]=0;for(e=0;e<=143;)F[2*e+1]=8,e++,s[8]++;for(;e<=255;)F[2*e+1]=9,e++,s[9]++;for(;e<=279;)F[2*e+1]=7,e++,s[7]++;for(;e<=287;)F[2*e+1]=8,e++,s[8]++;for(Z(F,f+1,s),e=0;e<p;e++)P[2*e+1]=5,P[2*e]=T(e,5);V=new q(F,S,h+1,f,v),M=new q(P,O,0,p,v),R=new q(new Array(0),w,0,d,m)}(),H=!0),e.l_desc=new s(e.dyn_ltree,V),e.d_desc=new s(e.dyn_dtree,M),e.bl_desc=new s(e.bl_tree,R),e.bi_buf=0,e.bi_valid=0,E(e)},r._tr_stored_block=J,r._tr_flush_block=function(e,t,r,i){var a,s,n=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return o;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return l;for(t=32;t<h;t++)if(0!==e.dyn_ltree[2*t])return l;return o}(e)),U(e,e.l_desc),U(e,e.d_desc),n=function(e){var t;for(X(e,e.dyn_ltree,e.l_desc.max_code),X(e,e.dyn_dtree,e.d_desc.max_code),U(e,e.bl_desc),t=d-1;3<=t&&0===e.bl_tree[2*I[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),a=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=a&&(a=s)):a=s=r+5,r+4<=a&&-1!==t?J(e,t,r,i):4===e.strategy||s===a?(B(e,2+(i?1:0),3),G(e,F,P)):(B(e,4+(i?1:0),3),function(e,t,r,i){var a;for(B(e,t-257,5),B(e,r-1,5),B(e,i-4,4),a=0;a<i;a++)B(e,e.bl_tree[2*I[a]+1],3);K(e,e.dyn_ltree,t-1),K(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,n+1),G(e,e.dyn_ltree,e.dyn_dtree)),E(e),i&&L(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(x[r]+h+1)]++,e.dyn_dtree[2*Y(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){var t;B(e,2,3),W(e,g,F),16===(t=e).bi_valid?(N(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,r){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}]},{},[10])(10)}),function(o){if(!(void 0===o||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=o.document,u=function(){return o.URL||o.webkitURL||o},l=e.createElementNS("http://www.w3.org/1999/xhtml","a"),c="download"in l,h=/constructor/i.test(o.HTMLElement)||o.safari,f=/CriOS\/[\d]+/.test(navigator.userAgent),p=o.setImmediate||o.setTimeout,d=function(e){p(function(){throw e},0)},m=function(e){setTimeout(function(){"string"==typeof e?u().revokeObjectURL(e):e.remove()},4e4)},b=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},i=function(e,r,t){t||(e=b(e));function i(){!function(e,t,r){for(var i=(t=[].concat(t)).length;i--;){var a=e["on"+t[i]];if("function"==typeof a)try{a.call(e,r||e)}catch(e){d(e)}}}(s,"writestart progress write writeend".split(" "))}var a,s=this,n="application/octet-stream"===e.type;if(s.readyState=s.INIT,c)return a=u().createObjectURL(e),void p(function(){var e,t;l.href=a,l.download=r,e=l,t=new MouseEvent("click"),e.dispatchEvent(t),i(),m(a),s.readyState=s.DONE},0);!function(){if((f||n&&h)&&o.FileReader){var t=new FileReader;return t.onloadend=function(){var e=f?t.result:t.result.replace(/^data:[^;]*;/,"data:attachment/file;");o.open(e,"_blank")||(o.location.href=e),e=void 0,s.readyState=s.DONE,i()},t.readAsDataURL(e),s.readyState=s.INIT}(a=a||u().createObjectURL(e),n)?o.location.href=a:o.open(a,"_blank")||(o.location.href=a);s.readyState=s.DONE,i(),m(a)}()},t=i.prototype;if("undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob)return;t.abort=function(){},t.readyState=t.INIT=0,t.WRITING=1,t.DONE=2,t.error=t.onwritestart=t.onprogress=t.onwrite=t.onabort=t.onerror=t.onwriteend=null,o.FileSaver_saveAs=function(e,t,r){return new i(e,t||e.name||"download",r)}}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||void 0),function(){var root="object"==typeof window?window:{},NODE_JS=!root.JS_SHA1_NO_NODE_JS&&"object"==typeof process&&process.versions&&process.versions.node;NODE_JS&&(root=global);var COMMON_JS=!root.JS_SHA1_NO_COMMON_JS&&"object"==typeof module&&module.exports,AMD="function"==typeof define&&define.amd,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[],createOutputMethod=function(t){return function(e){return new Sha1(!0).update(e)[t]()}},createMethod=function(){var t=createOutputMethod("hex");NODE_JS&&(t=nodeWrap(t)),t.create=function(){return new Sha1},t.update=function(e){return t.create().update(e)};for(var e=0;e<OUTPUT_TYPES.length;++e){var r=OUTPUT_TYPES[e];t[r]=createOutputMethod(r)}return t},nodeWrap=function(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if("string"==typeof e)return crypto.createHash("sha1").update(e,"utf8").digest("hex");if(e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(void 0===e.length)return method(e);return crypto.createHash("sha1").update(new Buffer(e)).digest("hex")};return nodeMethod};function Sha1(e){e?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Sha1.prototype.update=function(e){if(!this.finalized){var t="string"!=typeof e;t&&e.constructor===root.ArrayBuffer&&(e=new Uint8Array(e));for(var r,i,a=0,s=e.length||0,n=this.blocks;a<s;){if(this.hashed&&(this.hashed=!1,n[0]=this.block,n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0),t)for(i=this.start;a<s&&i<64;++a)n[i>>2]|=e[a]<<SHIFT[3&i++];else for(i=this.start;a<s&&i<64;++a)(r=e.charCodeAt(a))<128?n[i>>2]|=r<<SHIFT[3&i++]:(r<2048?n[i>>2]|=(192|r>>6)<<SHIFT[3&i++]:(r<55296||57344<=r?n[i>>2]|=(224|r>>12)<<SHIFT[3&i++]:(r=65536+((1023&r)<<10|1023&e.charCodeAt(++a)),n[i>>2]|=(240|r>>18)<<SHIFT[3&i++],n[i>>2]|=(128|r>>12&63)<<SHIFT[3&i++]),n[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++]),n[i>>2]|=(128|63&r)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,64<=i?(this.block=n[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Sha1.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],56<=t&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash()}},Sha1.prototype.hash=function(){var e,t,r=this.h0,i=this.h1,a=this.h2,s=this.h3,n=this.h4,o=this.blocks;for(e=16;e<80;++e)t=o[e-3]^o[e-8]^o[e-14]^o[e-16],o[e]=t<<1|t>>>31;for(e=0;e<20;e+=5)r=(t=(i=(t=(a=(t=(s=(t=(n=(t=r<<5|r>>>27)+(i&a|~i&s)+n+1518500249+o[e]<<0)<<5|n>>>27)+(r&(i=i<<30|i>>>2)|~r&a)+s+1518500249+o[e+1]<<0)<<5|s>>>27)+(n&(r=r<<30|r>>>2)|~n&i)+a+1518500249+o[e+2]<<0)<<5|a>>>27)+(s&(n=n<<30|n>>>2)|~s&r)+i+1518500249+o[e+3]<<0)<<5|i>>>27)+(a&(s=s<<30|s>>>2)|~a&n)+r+1518500249+o[e+4]<<0,a=a<<30|a>>>2;for(;e<40;e+=5)r=(t=(i=(t=(a=(t=(s=(t=(n=(t=r<<5|r>>>27)+(i^a^s)+n+1859775393+o[e]<<0)<<5|n>>>27)+(r^(i=i<<30|i>>>2)^a)+s+1859775393+o[e+1]<<0)<<5|s>>>27)+(n^(r=r<<30|r>>>2)^i)+a+1859775393+o[e+2]<<0)<<5|a>>>27)+(s^(n=n<<30|n>>>2)^r)+i+1859775393+o[e+3]<<0)<<5|i>>>27)+(a^(s=s<<30|s>>>2)^n)+r+1859775393+o[e+4]<<0,a=a<<30|a>>>2;for(;e<60;e+=5)r=(t=(i=(t=(a=(t=(s=(t=(n=(t=r<<5|r>>>27)+(i&a|i&s|a&s)+n-1894007588+o[e]<<0)<<5|n>>>27)+(r&(i=i<<30|i>>>2)|r&a|i&a)+s-1894007588+o[e+1]<<0)<<5|s>>>27)+(n&(r=r<<30|r>>>2)|n&i|r&i)+a-1894007588+o[e+2]<<0)<<5|a>>>27)+(s&(n=n<<30|n>>>2)|s&r|n&r)+i-1894007588+o[e+3]<<0)<<5|i>>>27)+(a&(s=s<<30|s>>>2)|a&n|s&n)+r-1894007588+o[e+4]<<0,a=a<<30|a>>>2;for(;e<80;e+=5)r=(t=(i=(t=(a=(t=(s=(t=(n=(t=r<<5|r>>>27)+(i^a^s)+n-899497514+o[e]<<0)<<5|n>>>27)+(r^(i=i<<30|i>>>2)^a)+s-899497514+o[e+1]<<0)<<5|s>>>27)+(n^(r=r<<30|r>>>2)^i)+a-899497514+o[e+2]<<0)<<5|a>>>27)+(s^(n=n<<30|n>>>2)^r)+i-899497514+o[e+3]<<0)<<5|i>>>27)+(a^(s=s<<30|s>>>2)^n)+r-899497514+o[e+4]<<0,a=a<<30|a>>>2;this.h0=this.h0+r<<0,this.h1=this.h1+i<<0,this.h2=this.h2+a<<0,this.h3=this.h3+s<<0,this.h4=this.h4+n<<0},Sha1.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,i=this.h3,a=this.h4;return HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a]},Sha1.prototype.toString=Sha1.prototype.hex,Sha1.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,r=this.h2,i=this.h3,a=this.h4;return[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24&255,r>>16&255,r>>8&255,255&r,i>>24&255,i>>16&255,i>>8&255,255&i,a>>24&255,a>>16&255,a>>8&255,255&a]},Sha1.prototype.array=Sha1.prototype.digest,Sha1.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(20),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),e};var exports=createMethod();COMMON_JS?module.exports=exports:(root.sha1=exports,AMD&&define(function(){return exports}))}(),Object.extend(Squeak,{vmPath:"/",platformSubtype:"Browser",osVersion:navigator.userAgent,windowSystem:"HTML"}),window.SqueakJS={};var canUseMouseOffset=navigator.userAgent.match("AppleWebKit/");function updateMousePos(e,t,r){var i=canUseMouseOffset?e.offsetX:e.layerX,a=canUseMouseOffset?e.offsetY:e.layerY;r.cursorCanvas&&(r.cursorCanvas.style.left=i+t.offsetLeft+r.cursorOffsetX+"px",r.cursorCanvas.style.top=a+t.offsetTop+r.cursorOffsetY+"px");var s=i*t.width/t.offsetWidth|0,n=a*t.height/t.offsetHeight|0;r.mouseX=Math.max(0,Math.min(r.width,s)),r.mouseY=Math.max(0,Math.min(r.height,n))}function recordMouseEvent(e,t,r,i,a){if(updateMousePos(t,r,i),i.vm){var s=i.buttons&Squeak.Mouse_All;switch(e){case"mousedown":switch(t.button||0){case 0:s=Squeak.Mouse_Red;break;case 1:s=Squeak.Mouse_Yellow;break;case 2:s=Squeak.Mouse_Blue}a.swapButtons&&(s==Squeak.Mouse_Yellow?s=Squeak.Mouse_Blue:s==Squeak.Mouse_Blue&&(s=Squeak.Mouse_Yellow));break;case"mousemove":break;case"mouseup":s=0}i.buttons=s|recordModifiers(t,i),i.eventQueue&&(i.eventQueue.push([Squeak.EventTypeMouse,t.timeStamp,i.mouseX,i.mouseY,i.buttons&Squeak.Mouse_All,i.buttons>>3]),i.signalInputEvent&&i.signalInputEvent()),i.idle=0,"mouseup"==e?i.runFor&&i.runFor(100):i.runNow&&i.runNow()}}function recordKeyboardEvent(e,t,r){if(r.vm){var i=r.buttons>>3<<8|e;r.eventQueue?(r.eventQueue.push([Squeak.EventTypeKeyboard,t,e,Squeak.EventKeyChar,r.buttons>>3,e]),r.signalInputEvent&&r.signalInputEvent(),r.keys[0]=i):i===r.vm.interruptKeycode?r.vm.interruptPending=!0:r.keys.push(i),r.idle=0,r.runNow&&r.runNow()}}function recordDragDropEvent(e,t,r,i){i.vm&&i.eventQueue&&(updateMousePos(t,r,i),i.eventQueue.push([Squeak.EventTypeDragDropFiles,t.timeStamp,e,i.mouseX,i.mouseY,i.buttons>>3,i.droppedFiles.length]),i.signalInputEvent&&i.signalInputEvent())}function fakeCmdOrCtrlKey(e,t,r){r.buttons&=~Squeak.Keyboard_All,r.buttons|=Squeak.Keyboard_Cmd|Squeak.Keyboard_Ctrl,r.keys=[],recordKeyboardEvent(e,t,r)}function makeSqueakEvent(e,t,r){t[0]=e[0],t[1]=e[1]-r&Squeak.MillisecondClockMask;for(var i=2;i<e.length;i++)t[i]=e[i]}function createSqueakDisplay(m,b){(b=b||{}).fullscreen&&(document.body.style.margin=0,document.body.style.backgroundColor="black",document.ontouchmove=function(e){e.preventDefault()},b.header&&(b.header.style.display="none"),b.footer&&(b.footer.style.display="none"));var v={context:m.getContext("2d"),fullscreen:!1,width:0,height:0,highdpi:b.highdpi,mouseX:0,mouseY:0,buttons:0,keys:[],eventQueue:null,clipboardString:"",clipboardStringChanged:!1,cursorCanvas:!1!==b.cursor&&document.createElement("canvas"),cursorOffsetX:0,cursorOffsetY:0,droppedFiles:[],signalInputEvent:null};setupSwapButtons(b),b.pixelated&&(m.classList.add("pixelated"),v.cursorCanvas&&v.cursorCanvas.classList.add("pixelated")),v.reset=function(){v.eventQueue=null,v.signalInputEvent=null,v.lastTick=0,v.getNextEvent=function(e,t){v.eventQueue=[],v.eventQueue.push=function(e){v.eventQueue.offset=Date.now()-e[1],delete v.eventQueue.push,v.eventQueue.push(e)},v.getNextEvent=function(e,t){var r=v.eventQueue.shift();r?makeSqueakEvent(r,e,t-v.eventQueue.offset):e[0]=Squeak.EventTypeNone},v.getNextEvent(e,t)}},v.reset();var o=setupFullscreen(v,m,b);v.fullscreenRequest=function(e,t){v.fullscreen!=e?(v.fullscreen=e,v.resizeTodo=t,v.resizeTodoTimeout=setTimeout(v.resizeDone,1e3),o()):t()},v.resizeDone=function(){clearTimeout(v.resizeTodoTimeout);var e=v.resizeTodo;e&&(v.resizeTodo=null,e())},v.clear=function(){m.width=m.width},v.showBanner=function(e,t){t=t||{};var r=v.context;r.clearRect(0,0,m.width,m.height),r.fillStyle=t.color||"#F90",r.font=t.font||"bold 48px sans-serif",!t.font&&r.measureText(e).width>m.width&&(r.font="bold 24px sans-serif"),r.textAlign="center",r.textBaseline="middle",r.fillText(e,m.width/2,m.height/2)},v.showProgress=function(e,t){t=t||{};var r=v.context,i=m.width/3|0,a=.5*m.width-i/2,s=.5*m.height+48;r.fillStyle=t.background||"#000",r.fillRect(a,s,i,24),r.lineWidth=2,r.strokeStyle=t.color||"#F90",r.strokeRect(a,s,i,24),r.fillStyle=t.color||"#F90",r.fillRect(a,s,i*e,24)},v.executeClipboardPaste=function(e,t){if(!v.vm)return!0;try{v.clipboardString=e,fakeCmdOrCtrlKey("v".charCodeAt(0),t,v)}catch(e){console.error("paste error "+e)}},v.executeClipboardCopy=function(e,t){if(!v.vm)return!0;v.clipboardStringChanged=!1,fakeCmdOrCtrlKey((e||"c").charCodeAt(0),t,v);for(var r=Date.now();!v.clipboardStringChanged&&Date.now()-r<500;)v.vm.interpret(20);if(v.clipboardStringChanged)try{return v.clipboardString}catch(e){console.error("copy error "+e)}},m.onmousedown=function(e){return o(),recordMouseEvent("mousedown",e,m,v,b),e.preventDefault(),!1},m.onmouseup=function(e){recordMouseEvent("mouseup",e,m,v,b),o(),e.preventDefault()},m.onmousemove=function(e){recordMouseEvent("mousemove",e,m,v,b),e.preventDefault()},m.oncontextmenu=function(){return!1};var g={state:"idle",button:0,x:0,y:0,dist:0,down:{}};function u(e){if(e.touches.length){g.x=g.y=0;for(var t=0;t<e.touches.length;t++)g.x+=e.touches[t].pageX/e.touches.length,g.y+=e.touches[t].pageY/e.touches.length}return{timeStamp:e.timeStamp,button:g.button,offsetX:g.x-m.offsetLeft,offsetY:g.y-m.offsetTop}}function a(e,t,r,i){var a=e-r,s=t-i;return Math.sqrt(a*a+s*s)}function l(e,t){return a(e.pageX,e.pageY,t.pageX,t.pageY)}function c(e,t,r,i){var a=v.cursorCanvas,s=r/m.width,n=v.highdpi?window.devicePixelRatio:1;if(m.style.left=(0|e)+"px",m.style.top=(0|t)+"px",m.style.width=(0|r)+"px",m.style.height=(0|i)+"px",a&&(a.style.left=(e+v.cursorOffsetX+v.mouseX*s|0)+"px",a.style.top=(t+v.cursorOffsetY+v.mouseY*s|0)+"px",a.style.width=(a.width*n*s|0)+"px",a.style.height=(a.height*n*s|0)+"px"),!b.pixelated){var o=window.devicePixelRatio*s;o%1==0||5<o?(m.classList.add("pixelated"),a&&a.classList.add("pixelated")):(m.classList.remove("pixelated"),a&&v.cursorCanvas.classList.remove("pixelated"))}return s}var h=5;if(m.ontouchstart=function(e){e.preventDefault();for(var t,r=u(e),i=0;i<e.changedTouches.length;i++)switch(g.state){case"idle":g.state="got1stFinger",g.first=r,setTimeout(function(){"got1stFinger"===g.state&&(g.state="mousing",g.button=r.button=0,recordMouseEvent("mousemove",r,m,v,b),recordMouseEvent("mousedown",r,m,v,b))},100);break;case"got1stFinger":g.state="got2ndFinger",t=e,g.dist=l(t.touches[0],t.touches[1]),g.down.x=g.x,g.down.y=g.y,g.down.dist=g.dist,g.down.left=m.offsetLeft,g.down.top=m.offsetTop,g.down.width=m.offsetWidth,g.down.height=m.offsetHeight,g.orig||(g.orig={left:g.down.left,top:g.down.top,right:g.down.left+g.down.width,bottom:g.down.top+g.down.height,width:g.down.width,height:g.down.height}),setTimeout(function(){"got2ndFinger"===g.state&&(10<Math.abs(g.down.dist-g.dist)||10<a(g.down.x,g.down.y,g.x,g.y)?g.state="zooming":(g.state="mousing",g.button=r.button=2,recordMouseEvent("mousemove",r,m,v,b),recordMouseEvent("mousedown",r,m,v,b)))},200)}},m.ontouchmove=function(e){e.preventDefault();var t=u(e);switch(g.state){case"got1stFinger":g.state="mousing",g.button=t.button=0,recordMouseEvent("mousemove",t,m,v,b),recordMouseEvent("mousedown",t,m,v,b);break;case"mousing":return void recordMouseEvent("mousemove",t,m,v,b);case"got2ndFinger":return void(1<e.touches.length&&(g.dist=l(e.touches[0],e.touches[1])));case"zooming":return void function(e){if(!(e.touches.length<2)){g.dist=l(e.touches[0],e.touches[1]);var t=g.orig.width/g.down.width,r=g.dist/g.down.dist,i=Math.min(Math.max(r,.95*t),t*h),a=g.down.width*i,s=g.orig.height*a/g.orig.width,n=g.down.left-(g.down.x-g.down.left)*(i-1)+(g.x-g.down.x),o=g.down.top-(g.down.y-g.down.top)*(i-1)+(g.y-g.down.y);c(n=Math.max(Math.min(n,g.orig.left+20),g.orig.right-a-20),o=Math.max(Math.min(o,g.orig.top+20),g.orig.bottom-s-20),a,s)}}(e)}},m.ontouchend=function(e){e.preventDefault(),o();for(var t,r,i,a,s=u(e),n=0;n<e.changedTouches.length;n++)switch(g.state){case"mousing":if(0<e.touches.length)break;return g.state="idle",void recordMouseEvent("mouseup",s,m,v,b);case"got1stFinger":return g.state="idle",g.button=s.button=0,recordMouseEvent("mousemove",s,m,v,b),recordMouseEvent("mousedown",s,m,v,b),void recordMouseEvent("mouseup",s,m,v,b);case"got2ndFinger":g.state="mousing",g.button=s.button=2,recordMouseEvent("mousemove",s,m,v,b),recordMouseEvent("mousedown",s,m,v,b);break;case"zooming":if(0<e.touches.length)break;return g.state="idle",i=r=t=void 0,t=m.offsetLeft,r=m.offsetTop,i=m.offsetWidth,m.offsetHeight,i=Math.min(Math.max(i,g.orig.width),g.orig.width*h),a=g.orig.height*i/g.orig.width,void(c(t=Math.max(Math.min(t,g.orig.left),g.orig.right-i),r=Math.max(Math.min(r,g.orig.top),g.orig.bottom-a),i,a)-v.initialScale<1e-4&&(g.orig=null,window.onresize()))}},m.ontouchcancel=function(e){m.ontouchend(e)},v.cursorCanvas){var e="absolute"===window.getComputedStyle(m).position;v.cursorCanvas.style.display="block",v.cursorCanvas.style.position=e?"absolute":"fixed",v.cursorCanvas.style.cursor="none",v.cursorCanvas.style.background="transparent",v.cursorCanvas.style.pointerEvents="none",m.parentElement.appendChild(v.cursorCanvas),m.style.cursor="none"}if(document.onkeypress=function(e){return!v.vm||(!!/[CXVR]/.test(String.fromCharCode(e.charCode+64))||(recordModifiers(e,v),recordKeyboardEvent(e.charCode,e.timeStamp,v),void e.preventDefault()))},document.onkeydown=function(e){if(o(),!v.vm)return!0;recordModifiers(e,v);var t={8:8,9:9,13:13,27:27,32:32,33:11,34:12,35:4,36:1,37:28,38:30,39:29,40:31,45:5,46:127}[e.keyCode];if(t)return recordKeyboardEvent(t,e.timeStamp,v),e.preventDefault();if(e.metaKey||e.altKey&&!e.ctrlKey){var r=e.key;if(!r&&e.keyIdentifier&&"U+"==e.keyIdentifier.slice(0,2)&&(r=String.fromCharCode(parseInt(e.keyIdentifier.slice(2),16))),r&&1==r.length){if(/[CXVR]/i.test(r))return!0;var i=r.charCodeAt(0);return/[A-Z]/.test(r)&&!e.shiftKey&&(i+=32),recordKeyboardEvent(i,e.timeStamp,v),e.preventDefault()}}},document.onkeyup=function(e){if(!v.vm)return!0;recordModifiers(e,v)},document.oncopy=function(e,t){var r=v.executeClipboardCopy(t,e.timeStamp);"string"==typeof r&&e.clipboardData.setData("Text",r),e.preventDefault()},document.oncut=function(e){if(!v.vm)return!0;document.oncopy(e,"x")},document.onpaste=function(e){var t=e.clipboardData.getData("Text");v.executeClipboardPaste(t,e.timeStamp),e.preventDefault()},"ontouchstart"in document){var t=document.createElement("div");t.innerHTML='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg width="50px" height="50px" viewBox="0 0 150 150" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="Page-1" stroke="none" fill="#000000"><rect x="33" y="105" width="10" height="10" rx="1"></rect><rect x="26" y="60" width="10" height="10" rx="1"></rect><rect x="41" y="60" width="10" height="10" rx="1"></rect><rect x="56" y="60" width="10" height="10" rx="1"></rect><rect x="71" y="60" width="10" height="10" rx="1"></rect><rect x="86" y="60" width="10" height="10" rx="1"></rect><rect x="101" y="60" width="10" height="10" rx="1"></rect><rect x="116" y="60" width="10" height="10" rx="1"></rect><rect x="108" y="105" width="10" height="10" rx="1"></rect><rect x="33" y="75" width="10" height="10" rx="1"></rect><rect x="48" y="75" width="10" height="10" rx="1"></rect><rect x="63" y="75" width="10" height="10" rx="1"></rect><rect x="78" y="75" width="10" height="10" rx="1"></rect><rect x="93" y="75" width="10" height="10" rx="1"></rect><rect x="108" y="75" width="10" height="10" rx="1"></rect><rect x="41" y="90" width="10" height="10" rx="1"></rect><rect x="26" y="90" width="10" height="10" rx="1"></rect><rect x="56" y="90" width="10" height="10" rx="1"></rect><rect x="71" y="90" width="10" height="10" rx="1"></rect><rect x="86" y="90" width="10" height="10" rx="1"></rect><rect x="101" y="90" width="10" height="10" rx="1"></rect><rect x="116" y="90" width="10" height="10" rx="1"></rect><rect x="48" y="105" width="55" height="10" rx="1"></rect><path d="M20.0056004,51 C18.3456532,51 17.0000001,52.3496496 17.0000001,54.0038284 L17.0000001,85.6824519 L17,120.003453 C17.0000001,121.6584 18.3455253,123 20.0056004,123 L131.9944,123 C133.654347,123 135,121.657592 135,119.997916 L135,54.0020839 C135,52.3440787 133.654475,51 131.9944,51 L20.0056004,51 Z" fill="none" stroke="#000000" stroke-width="2"></path><path d="M52.0410156,36.6054687 L75.5449219,21.6503905 L102.666016,36.6054687" id="Line" stroke="#000000" stroke-width="3" stroke-linecap="round" fill="none"></path></g></svg>',t.setAttribute("style","position:fixed;right:0;bottom:0;background-color:rgba(128,128,128,0.5);border-radius:5px"),m.parentElement.appendChild(t),t.onmousedown=function(e){m.contentEditable=!0,m.setAttribute("autocomplete","off"),m.setAttribute("autocorrect","off"),m.setAttribute("autocapitalize","off"),m.setAttribute("spellcheck","off"),m.focus(),e.preventDefault()},t.ontouchstart=t.onmousedown}function f(e){for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"==e.dataTransfer.types[t])return 1}return document.ondragover=function(e){e.preventDefault(),f(e)?(e.dataTransfer.dropEffect="copy",recordDragDropEvent(Squeak.EventDragMove,e,m,v)):e.dataTransfer.dropEffect="none"},document.ondragenter=function(e){f(e)&&recordDragDropEvent(Squeak.EventDragEnter,e,m,v)},document.ondragleave=function(e){f(e)&&recordDragDropEvent(Squeak.EventDragLeave,e,m,v)},document.ondrop=function(r){if(r.preventDefault(),!f(r))return!1;var i,a=[].slice.call(r.dataTransfer.files),s=[],n=null;return v.droppedFiles=[],a.forEach(function(t){v.droppedFiles.push(t.name);var e=new FileReader;e.onload=function(){var e=this.result;Squeak.filePut(t.name,e),s.push(t.name),i||!/.*image$/.test(t.name)||v.vm&&!confirm("Run "+t.name+" now?\n(cancel to use as file)")||(i=e,n=t.name),s.length==a.length&&(i?(SqueakJS.appName=n.slice(0,-6),SqueakJS.runImage(i,n,v,b)):recordDragDropEvent(Squeak.EventDragDrop,r,m,v))},e.readAsArrayBuffer(t)}),!1},window.onresize=function(){if(!g.orig){var e=window.innerWidth,t=window.innerHeight;if(setTimeout(function(){e==window.innerWidth&&t==window.innerHeight&&v.resizeDone()},300),!(b.header&&b.footer||b.fullscreen))return v.width=m.width,void(v.height=m.height);var r=b.fullscreen||v.fullscreen,i=r?0:b.header.offsetTop+b.header.offsetHeight,a=window.innerWidth,s=r?window.innerHeight:Math.max(100,b.footer.offsetTop-i),n=0,o=0;if(b.fixedWidth){v.width=b.fixedWidth,v.height=b.fixedHeight;var u=v.width/v.height;u<a/s?n=a-Math.floor(s*u):o=s-Math.floor(a/u),v.initialScale=(a-n)/v.width}else{b.minWidth||(b.minWidth=700),b.minHeight||(b.minHeight=700);var l=a<b.minWidth?b.minWidth/a:1,c=s<b.minHeight?b.minHeight/s:1,h=Math.max(l,c);v.highdpi&&(h*=window.devicePixelRatio),v.width=Math.floor(a*h),v.height=Math.floor(s*h),v.initialScale=a/v.width}if(m.style.left=0+Math.floor(n/2)+"px",m.style.top=i+Math.floor(o/2)+"px",m.style.width=a-n+"px",m.style.height=s-o+"px",m.width!=v.width||m.height!=v.height){var f=(b.fixedWidth||!v.resizeTodo)&&v.context.getImageData(0,0,m.width,m.height);m.width=v.width,m.height=v.height,f&&v.context.putImageData(f,0,0)}var p=v.cursorCanvas;h=m.offsetWidth/m.width;if(v.highdpi&&(h*=window.devicePixelRatio),p&&b.fixedWidth&&(p.style.width=p.width*h+"px",p.style.height=p.height*h+"px"),!b.pixelated){var d=window.devicePixelRatio*h;d%1==0||5<d?(m.classList.add("pixelated"),p&&p.classList.add("pixelated")):(m.classList.remove("pixelated"),p&&v.cursorCanvas.classList.remove("pixelated"))}}},window.onresize(),v}function setupSpinner(t,e){var r=e.spinner;return r?(r.onmousedown=function(e){confirm(SqueakJS.appName+" is busy. Interrupt?")&&(t.interruptPending=!0)},r.style):null}var spinnerAngle=0,becameBusy=0,loop;function updateSpinner(e,t,r,i){var a=0===t,s=r.lastTick-i.lastTick<500;!a||s?(e.display="none",becameBusy=0):0===becameBusy?becameBusy=r.lastTick:1e3<r.lastTick-becameBusy&&(e.display="block",spinnerAngle=(spinnerAngle+30)%360,e.webkitTransform=e.transform="rotate("+spinnerAngle+"deg)")}function processOptions(e){var t=(location.hash||location.search).slice(1),r=t&&t.split("&");if(r)for(var i=0;i<r.length;i++){var a=r[i].split("="),s=a[0],n=!0;if(1<a.length&&(n=decodeURIComponent(a.slice(1).join("="))).match(/^(true|false|null|[0-9"[{].*)$/))try{n=JSON.parse(n)}catch(e){"["===n[0]&&(n=n.slice(1,-1).split(","))}e[s]=n}var o=Squeak.splitFilePath(e.root||"/").fullname;Squeak.dirCreate(o,!0),/\/$/.test(o)||(o+="/"),e.root=o,SqueakJS.options=e}function fetchTemplates(e){if(e.templates){if(e.templates.constructor===Array){var t={};e.templates.forEach(function(e){t[e]=e}),e.templates=t}for(var r in e.templates){var i="/"==r[0]?r:e.root+r,a=new URL(e.url,document.baseURI).href,s=Squeak.splitUrl(e.templates[r],a).full;Squeak.fetchTemplateDir(i,s)}}}function processFile(e,t,r,i){Squeak.filePut(r.root+e.name,e.data,function(){console.log("Stored "+r.root+e.name),e.zip?processZip(e,t,r,i):i()})}function processZip(s,n,o,u){JSZip().loadAsync(s.data).then(function(e){var i=[];if(e.forEach(function(e){if(!o.image.name&&e.match(/\.image$/)&&(o.image.name=e),o.forceDownload||!Squeak.fileExists(o.root+e))i.push(e);else if(o.image.name===e){var t=u;u=function(){Squeak.fileGet(o.root+e,function(e){return o.image.data=e,t()},function(){return Squeak.fileDelete(o.root+s.name),processZip(s,n,o,t)})}}}),0===i.length)return u();var a=0;n.showBanner("Unzipping "+s.name),n.showProgress(0),i.forEach(function(r){console.log("Inflating "+s.name+": "+r),e.file(r).async("arraybuffer",function(e){n.showProgress((e.percent/100+a)/i.length)}).then(function(e){console.log("Expanded size of "+r+": "+e.byteLength);var t={};o.image.name===r&&(t=o.image),t.name=r,t.data=e,processFile(t,n,o,function(){++a===i.length&&u()})})})})}function checkExisting(t,r,i,a,e){if(!Squeak.fileExists(i.root+t.name))return e();t.image||t.zip?Squeak.fileGet(i.root+t.name,function(e){t.data=e,t.zip?processZip(t,r,i,a):a()},function(){return Squeak.fileDelete(i.root+t.name),e()}):a()}function downloadFile(r,t,i,a){t.showBanner("Downloading "+r.name);var s=new XMLHttpRequest,e=i.proxy||"";s.open("GET",e+r.url),i.ajax&&s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.responseType="arraybuffer",s.onprogress=function(e){e.lengthComputable&&t.showProgress(e.loaded/e.total)},s.onload=function(e){200==this.status?(r.data=this.response,processFile(r,t,i,a)):this.onerror(this.statusText)},s.onerror=function(e){if(i.proxy)return console.error(Squeak.bytesAsString(new Uint8Array(this.response))),alert("Failed to download:\n"+r.url);console.warn("Retrying with CORS proxy: "+r.url);var t=new XMLHttpRequest;t.open("GET","https://corsproxy.io/?"+r.url),i.ajax&&t.setRequestHeader("X-Requested-With","XMLHttpRequest"),t.responseType=s.responseType,t.onprogress=s.onprogress,t.onload=s.onload,t.onerror=function(){console.error(Squeak.bytesAsString(new Uint8Array(this.response))),alert("Failed to download:\n"+r.url)},t.send()},s.send()}function fetchFiles(r,i,a,s){!function e(){if(0===r.length)return s();var t=r.shift();a.forceDownload||t.forceDownload?downloadFile(t,i,a,e):checkExisting(t,i,a,function(){e()},function(){downloadFile(t,i,a,e)})}()}SqueakJS.runImage=function(t,a,s,n){window.onbeforeunload=function(e){var t=SqueakJS.appName+" is still running";return e.returnValue=t},window.clearTimeout(loop),s.reset(),s.clear(),s.showBanner("Loading "+SqueakJS.appName),s.showProgress(0);var o=this;window.setTimeout(function(){var e=new Squeak.Image(a);e.readFromBuffer(t,function(){s.quitFlag=!1;var t=new Squeak.Interpreter(e,s);SqueakJS.vm=t,Squeak.Settings.squeakImageName=a,setupSwapButtons(n),s.clear(),s.showBanner("Starting "+SqueakJS.appName);var r=setupSpinner(t,n);function i(){try{s.quitFlag?o.onQuit(t,s,n):t.interpret(50,function(e){"sleep"==e&&(e=200),r&&updateSpinner(r,e,t,s),loop=window.setTimeout(i,e)})}catch(e){console.error(e),alert(e)}}s.runNow=function(){window.clearTimeout(loop),i()},s.runFor=function(e){var t=Date.now()+e;do{if(s.quitFlag)return;s.runNow()}while(Date.now()<t)},i()},function(e){s.showProgress(e)})},0)},SqueakJS.runSqueak=function(e,t,r){processOptions(r),!e&&r.image&&(e=r.image);var i=r.url||e&&e.replace(/[^\/]*$/,"")||"";"/"===(r.url=i)[0]&&"/"!==i[1]&&1<i.length&&"/"===r.root&&(r.root=i),fetchTemplates(r);var a=createSqueakDisplay(t,r),s={url:null,name:null,image:!0,data:null},n=[];if(a.argv=r.argv,e){var o=Squeak.splitUrl(e,i);s.url=o.full,s.name=o.filename}r.files&&r.files.forEach(function(e){var t=Squeak.splitUrl(e,i);s.name===t.filename||(!s.url&&e.match(/\.image$/)?(s.name=t.filename,s.url=t.full):n.push({url:t.full,name:t.filename}))}),r.zip&&("string"==typeof r.zip?[r.zip]:r.zip).forEach(function(e){var t=Squeak.splitUrl(e,i);n.push({url:t.full,name:t.filename,zip:!0})});if(s.url&&n.push(s),r.document){o=Squeak.splitUrl(r.document,i);n.push({url:o.full,name:o.filename,forceDownload:!1!==r.forceDownload}),a.documentName=r.root+o.filename}return r.image=s,fetchFiles(n,a,r,function(){Squeak.fsck();var e=r.image;return e.name?e.data?(SqueakJS.appName=r.appName||e.name.replace(/\.image$/,""),void SqueakJS.runImage(e.data,r.root+e.name,a,r)):alert("could not find image "+e.name):alert("could not find an image")}),a},SqueakJS.quitSqueak=function(){SqueakJS.vm.quitFlag=!0},SqueakJS.onQuit=function(e,t,r){window.onbeforeunload=null,t.vm=null,r.spinner&&(r.spinner.style.display="none"),r.onQuit?r.onQuit(e,t,r):t.showBanner(SqueakJS.appName+" stopped.")},window.applicationCache&&applicationCache.addEventListener("updateready",function(){var e=window.SqueakJS&&SqueakJS.options&&SqueakJS.options.appName||"SqueakJS";confirm(e+" has been updated. Restart now?")&&(window.onbeforeunload=null,window.location.reload())})}();